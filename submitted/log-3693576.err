Already on 'yangexppp'
wandb: Currently logged in as: stevenzhou0816100. Use `wandb login --relogin` to force relogin
2024-08-05:18:57:17,702 INFO     [main.py:288] Verbosity set to INFO
2024-08-05:18:57:27,590 WARNING  [main.py:303]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2024-08-05:18:57:27,591 INFO     [main.py:378] Selected Tasks: ['mmlu_flan_cot_fewshot']
2024-08-05:18:57:27,625 INFO     [xevaluator.py:137] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2024-08-05:18:57:27,625 INFO     [xevaluator.py:184] Initializing xhf model, with arguments: {'pretrained': 'meta-llama/Meta-Llama-3-8B-Instruct', 'griffin': True, 'check': False, 'contextlength': 1500, 'kernel_size': 16, 'thr': 0.05}
2024-08-05:18:57:27,635 INFO     [xhuggingface.py:177] Using device 'cuda'
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:06<00:18,  6.07s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:12<00:12,  6.08s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:18<00:06,  6.02s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:19<00:00,  4.26s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:19<00:00,  4.92s/it]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
2024-08-05:18:58:48,233 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_prehistory on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 601.48it/s]
2024-08-05:18:58:48,240 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_logical_fallacies on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 600.06it/s]
2024-08-05:18:58:48,248 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_us_history on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 393.51it/s]
2024-08-05:18:58:48,259 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_international_law on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 583.07it/s]
2024-08-05:18:58:48,266 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_professional_law on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 470.83it/s]
2024-08-05:18:58:48,276 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_moral_disputes on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 585.65it/s]
2024-08-05:18:58:48,283 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_jurisprudence on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 609.84it/s]
2024-08-05:18:58:48,290 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_world_history on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 483.33it/s]
2024-08-05:18:58:48,299 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_moral_scenarios on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 609.28it/s]
2024-08-05:18:58:48,307 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_philosophy on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 623.41it/s]
2024-08-05:18:58:48,313 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_formal_logic on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 538.46it/s]
2024-08-05:18:58:48,321 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_world_religions on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 653.90it/s]
2024-08-05:18:58:48,328 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_european_history on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 348.25it/s]
2024-08-05:18:58:48,341 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_human_sexuality on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 634.61it/s]
2024-08-05:18:58:48,348 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_econometrics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 523.94it/s]
2024-08-05:18:58:48,356 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_macroeconomics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 615.63it/s]
2024-08-05:18:58:48,364 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_geography on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 626.04it/s]
2024-08-05:18:58:48,371 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_security_studies on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 515.24it/s]
2024-08-05:18:58:48,379 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_psychology on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 599.72it/s]
2024-08-05:18:58:48,387 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_microeconomics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 621.19it/s]
2024-08-05:18:58:48,394 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_government_and_politics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 603.21it/s]
2024-08-05:18:58:48,401 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_professional_psychology on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 570.27it/s]
2024-08-05:18:58:48,408 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_public_relations on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 622.88it/s]
2024-08-05:18:58:48,415 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_us_foreign_policy on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 618.13it/s]
2024-08-05:18:58:48,422 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_sociology on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 530.04it/s]
2024-08-05:18:58:48,431 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_global_facts on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 593.04it/s]
2024-08-05:18:58:48,438 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_professional_medicine on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 542.64it/s]
2024-08-05:18:58:48,446 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_business_ethics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 542.58it/s]
2024-08-05:18:58:48,454 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_medicine on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 551.77it/s]
2024-08-05:18:58:48,462 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_management on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 629.66it/s]
2024-08-05:18:58:48,469 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_human_aging on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 642.07it/s]
2024-08-05:18:58:48,476 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_marketing on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 619.41it/s]
2024-08-05:18:58:48,483 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_nutrition on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 597.39it/s]
2024-08-05:18:58:48,490 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_virology on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 643.94it/s]
2024-08-05:18:58:48,497 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_professional_accounting on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 569.09it/s]
2024-08-05:18:58:48,504 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_miscellaneous on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 641.77it/s]
2024-08-05:18:58:48,511 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_medical_genetics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 630.18it/s]
2024-08-05:18:58:48,518 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_clinical_knowledge on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 629.18it/s]
2024-08-05:18:58:48,525 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_mathematics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 559.43it/s]
2024-08-05:18:58:48,533 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_elementary_mathematics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 604.78it/s]
2024-08-05:18:58:48,540 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_statistics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 562.60it/s]
2024-08-05:18:58:48,547 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_astronomy on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 551.81it/s]
2024-08-05:18:58:48,555 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_electrical_engineering on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 603.78it/s]
2024-08-05:18:58:48,562 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_abstract_algebra on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 608.38it/s]
2024-08-05:18:58:48,570 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_machine_learning on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 534.61it/s]
2024-08-05:18:58:48,578 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_computer_science on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 509.19it/s]
2024-08-05:18:58:48,586 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_biology on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 554.97it/s]
2024-08-05:18:58:48,594 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_anatomy on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 533.83it/s]
2024-08-05:18:58:48,602 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_physics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 594.33it/s]
2024-08-05:18:58:48,610 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_computer_science on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 505.03it/s]
2024-08-05:18:58:48,618 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_conceptual_physics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 604.91it/s]
2024-08-05:18:58:48,625 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_mathematics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 603.97it/s]
2024-08-05:18:58:48,633 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_computer_security on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 604.63it/s]
2024-08-05:18:58:48,640 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_chemistry on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 592.98it/s]
2024-08-05:18:58:48,647 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_physics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 609.02it/s]
2024-08-05:18:58:48,654 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_chemistry on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 567.32it/s]
2024-08-05:18:58:48,662 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_biology on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 525.62it/s]
2024-08-05:18:58:48,670 INFO     [xevaluator.py:395] Running generate_until requests
Running generate_until requests:   0%|          | 0/228 [00:00<?, ?it/s]Running generate_until requests:   0%|          | 1/228 [00:48<3:02:07, 48.14s/it]Running generate_until requests:   1%|          | 2/228 [01:34<2:56:32, 46.87s/it]Running generate_until requests:   1%|▏         | 3/228 [02:25<3:03:35, 48.96s/it]Running generate_until requests:   2%|▏         | 4/228 [03:16<3:05:25, 49.67s/it]Running generate_until requests:   2%|▏         | 5/228 [04:04<3:02:33, 49.12s/it]Running generate_until requests:   3%|▎         | 6/228 [04:52<3:00:18, 48.73s/it]Running generate_until requests:   3%|▎         | 7/228 [05:39<2:57:46, 48.26s/it]Running generate_until requests:   4%|▎         | 8/228 [06:27<2:56:55, 48.25s/it]Running generate_until requests:   4%|▍         | 9/228 [07:20<3:00:42, 49.51s/it]Running generate_until requests:   4%|▍         | 10/228 [08:13<3:04:08, 50.68s/it]Running generate_until requests:   5%|▍         | 11/228 [09:05<3:04:39, 51.06s/it]Running generate_until requests:   5%|▌         | 12/228 [09:54<3:01:55, 50.53s/it]Running generate_until requests:   6%|▌         | 13/228 [10:44<3:00:15, 50.31s/it]Running generate_until requests:   6%|▌         | 14/228 [11:33<2:58:12, 49.97s/it]Running generate_until requests:   7%|▋         | 15/228 [12:23<2:57:18, 49.95s/it]Running generate_until requests:   7%|▋         | 16/228 [13:13<2:56:06, 49.84s/it]Running generate_until requests:   7%|▋         | 17/228 [14:02<2:54:44, 49.69s/it]Running generate_until requests:   8%|▊         | 18/228 [14:52<2:53:39, 49.62s/it]Running generate_until requests:   8%|▊         | 19/228 [15:41<2:52:41, 49.58s/it]Running generate_until requests:   9%|▉         | 20/228 [16:30<2:51:35, 49.50s/it]Running generate_until requests:   9%|▉         | 21/228 [17:19<2:50:19, 49.37s/it]Running generate_until requests:  10%|▉         | 22/228 [18:09<2:49:15, 49.30s/it]Running generate_until requests:  10%|█         | 23/228 [18:58<2:48:23, 49.28s/it]Running generate_until requests:  11%|█         | 24/228 [19:47<2:47:46, 49.34s/it]Running generate_until requests:  11%|█         | 25/228 [20:37<2:46:51, 49.32s/it]Running generate_until requests:  11%|█▏        | 26/228 [21:26<2:46:16, 49.39s/it]Running generate_until requests:  12%|█▏        | 27/228 [22:16<2:45:36, 49.44s/it]Running generate_until requests:  12%|█▏        | 28/228 [23:05<2:44:38, 49.39s/it]Running generate_until requests:  13%|█▎        | 29/228 [23:55<2:44:06, 49.48s/it]Running generate_until requests:  13%|█▎        | 30/228 [24:45<2:43:53, 49.66s/it]Running generate_until requests:  14%|█▎        | 31/228 [25:37<2:46:07, 50.60s/it]