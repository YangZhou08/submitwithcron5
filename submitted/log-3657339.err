Already on 'yangexppp'
wandb: Currently logged in as: stevenzhou0816100. Use `wandb login --relogin` to force relogin
2024-08-03:08:41:33,169 INFO     [main.py:288] Verbosity set to INFO
2024-08-03:08:41:42,529 INFO     [main.py:378] Selected Tasks: ['gsm8k_cot']
2024-08-03:08:41:42,562 INFO     [xevaluator.py:137] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2024-08-03:08:41:42,562 INFO     [xevaluator.py:184] Initializing xhf model, with arguments: {'pretrained': 'meta-llama/Meta-Llama-3-70B-Instruct', 'cats': True, 'check': False, 'contextlength': 1500, 'kernel_size': 16, 'thr': 0.05}
2024-08-03:08:41:42,572 INFO     [xhuggingface.py:176] Using device 'cuda'
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:05<02:38,  5.45s/it]Loading checkpoint shards:   7%|▋         | 2/30 [00:11<02:35,  5.54s/it]Loading checkpoint shards:  10%|█         | 3/30 [00:16<02:32,  5.66s/it]Loading checkpoint shards:  13%|█▎        | 4/30 [00:22<02:26,  5.62s/it]Loading checkpoint shards:  17%|█▋        | 5/30 [00:27<02:17,  5.50s/it]Loading checkpoint shards:  20%|██        | 6/30 [00:32<02:09,  5.41s/it]Loading checkpoint shards:  23%|██▎       | 7/30 [00:38<02:03,  5.36s/it]Loading checkpoint shards:  27%|██▋       | 8/30 [00:43<01:59,  5.43s/it]Loading checkpoint shards:  30%|███       | 9/30 [00:49<01:54,  5.47s/it]Loading checkpoint shards:  33%|███▎      | 10/30 [00:54<01:48,  5.41s/it]Loading checkpoint shards:  37%|███▋      | 11/30 [00:59<01:41,  5.36s/it]Loading checkpoint shards:  40%|████      | 12/30 [01:05<01:36,  5.35s/it]Loading checkpoint shards:  43%|████▎     | 13/30 [01:10<01:32,  5.41s/it]Loading checkpoint shards:  47%|████▋     | 14/30 [01:16<01:27,  5.45s/it]Loading checkpoint shards:  50%|█████     | 15/30 [01:21<01:20,  5.38s/it]Loading checkpoint shards:  53%|█████▎    | 16/30 [01:26<01:14,  5.33s/it]Loading checkpoint shards:  57%|█████▋    | 17/30 [01:31<01:09,  5.31s/it]Loading checkpoint shards:  60%|██████    | 18/30 [01:37<01:04,  5.40s/it]Loading checkpoint shards:  63%|██████▎   | 19/30 [01:43<00:59,  5.43s/it]Loading checkpoint shards:  67%|██████▋   | 20/30 [01:48<00:53,  5.35s/it]Loading checkpoint shards:  70%|███████   | 21/30 [01:53<00:47,  5.32s/it]Loading checkpoint shards:  73%|███████▎  | 22/30 [01:58<00:42,  5.29s/it]Loading checkpoint shards:  77%|███████▋  | 23/30 [02:04<00:37,  5.39s/it]Loading checkpoint shards:  80%|████████  | 24/30 [02:09<00:32,  5.44s/it]Loading checkpoint shards:  83%|████████▎ | 25/30 [02:15<00:26,  5.36s/it]Loading checkpoint shards:  87%|████████▋ | 26/30 [02:20<00:21,  5.31s/it]Loading checkpoint shards:  90%|█████████ | 27/30 [02:25<00:15,  5.27s/it]Loading checkpoint shards:  93%|█████████▎| 28/30 [02:31<00:10,  5.37s/it]Loading checkpoint shards:  97%|█████████▋| 29/30 [02:36<00:05,  5.42s/it]Loading checkpoint shards: 100%|██████████| 30/30 [02:39<00:00,  4.53s/it]Loading checkpoint shards: 100%|██████████| 30/30 [02:39<00:00,  5.30s/it]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
2024-08-03:08:50:51,177 WARNING  [task.py:322] [Task: gsm8k_cot] has_training_docs and has_validation_docs are False, using test_docs as fewshot_docs but this is not recommended.
2024-08-03:08:50:51,177 WARNING  [task.py:322] [Task: gsm8k_cot] has_training_docs and has_validation_docs are False, using test_docs as fewshot_docs but this is not recommended.
2024-08-03:08:50:51,260 INFO     [task.py:395] Building contexts for gsm8k_cot on rank 0...
  0%|          | 0/1319 [00:00<?, ?it/s] 13%|█▎        | 169/1319 [00:00<00:00, 1688.27it/s] 26%|██▌       | 339/1319 [00:00<00:00, 1694.69it/s] 39%|███▊      | 509/1319 [00:00<00:00, 1695.31it/s] 51%|█████▏    | 679/1319 [00:00<00:00, 1694.71it/s] 64%|██████▍   | 849/1319 [00:00<00:00, 1693.41it/s] 77%|███████▋  | 1019/1319 [00:00<00:00, 1693.11it/s] 90%|█████████ | 1190/1319 [00:00<00:00, 1695.46it/s]100%|██████████| 1319/1319 [00:00<00:00, 1695.09it/s]
2024-08-03:08:50:52,064 INFO     [xevaluator.py:395] Running generate_until requests
Running generate_until requests:   0%|          | 0/1319 [00:00<?, ?it/s]Running generate_until requests:   0%|          | 1/1319 [00:44<16:23:31, 44.77s/it]Running generate_until requests:   0%|          | 2/1319 [01:25<15:34:50, 42.59s/it]Running generate_until requests:   0%|          | 3/1319 [02:00<14:15:50, 39.02s/it]Running generate_until requests:   0%|          | 4/1319 [02:39<14:10:33, 38.81s/it]Running generate_until requests:   0%|          | 5/1319 [03:40<17:07:39, 46.92s/it]Running generate_until requests:   0%|          | 6/1319 [04:18<15:57:39, 43.76s/it]Running generate_until requests:   1%|          | 7/1319 [04:53<14:54:56, 40.93s/it]Running generate_until requests:   1%|          | 8/1319 [05:35<15:03:25, 41.35s/it]Running generate_until requests:   1%|          | 9/1319 [06:08<14:08:03, 38.84s/it]Running generate_until requests:   1%|          | 10/1319 [06:53<14:49:05, 40.75s/it]Running generate_until requests:   1%|          | 11/1319 [07:31<14:31:23, 39.97s/it]Running generate_until requests:   1%|          | 12/1319 [08:21<15:36:46, 43.00s/it]Running generate_until requests:   1%|          | 13/1319 [08:57<14:46:35, 40.73s/it]Running generate_until requests:   1%|          | 14/1319 [09:23<13:09:43, 36.31s/it]Running generate_until requests:   1%|          | 15/1319 [10:06<13:51:44, 38.27s/it]Running generate_until requests:   1%|          | 16/1319 [10:30<12:16:07, 33.90s/it]Running generate_until requests:   1%|▏         | 17/1319 [11:11<13:01:51, 36.03s/it]Running generate_until requests:   1%|▏         | 18/1319 [11:46<13:00:38, 36.00s/it]Running generate_until requests:   1%|▏         | 19/1319 [12:23<13:02:51, 36.13s/it]Running generate_until requests:   2%|▏         | 20/1319 [13:01<13:15:43, 36.75s/it]Running generate_until requests:   2%|▏         | 21/1319 [13:33<12:44:17, 35.33s/it]Running generate_until requests:   2%|▏         | 22/1319 [14:04<12:12:20, 33.88s/it]Running generate_until requests:   2%|▏         | 23/1319 [14:33<11:40:40, 32.44s/it]Running generate_until requests:   2%|▏         | 24/1319 [15:25<13:49:02, 38.41s/it]Running generate_until requests:   2%|▏         | 25/1319 [15:59<13:20:54, 37.14s/it]Running generate_until requests:   2%|▏         | 26/1319 [16:22<11:48:10, 32.86s/it]Running generate_until requests:   2%|▏         | 27/1319 [16:42<10:21:25, 28.86s/it]Running generate_until requests:   2%|▏         | 28/1319 [17:05<9:43:15, 27.11s/it] Running generate_until requests:   2%|▏         | 29/1319 [17:31<9:36:41, 26.82s/it]Running generate_until requests:   2%|▏         | 30/1319 [17:52<9:00:35, 25.16s/it]Running generate_until requests:   2%|▏         | 31/1319 [18:06<7:46:26, 21.73s/it]Running generate_until requests:   2%|▏         | 32/1319 [18:35<8:31:40, 23.85s/it]Running generate_until requests:   3%|▎         | 33/1319 [19:10<9:46:37, 27.37s/it]Running generate_until requests:   3%|▎         | 34/1319 [19:42<10:14:58, 28.72s/it]Running generate_until requests:   3%|▎         | 35/1319 [20:34<12:45:36, 35.78s/it]Running generate_until requests:   3%|▎         | 36/1319 [21:14<13:09:50, 36.94s/it]Running generate_until requests:   3%|▎         | 37/1319 [22:16<15:53:34, 44.63s/it]Running generate_until requests:   3%|▎         | 38/1319 [22:53<15:01:35, 42.23s/it]Running generate_until requests:   3%|▎         | 39/1319 [23:32<14:41:37, 41.33s/it]Running generate_until requests:   3%|▎         | 40/1319 [24:23<15:42:16, 44.20s/it]Running generate_until requests:   3%|▎         | 41/1319 [25:19<16:55:12, 47.66s/it]Running generate_until requests:   3%|▎         | 42/1319 [25:40<14:06:14, 39.76s/it]Running generate_until requests:   3%|▎         | 43/1319 [26:11<13:07:26, 37.03s/it]Running generate_until requests:   3%|▎         | 44/1319 [27:01<14:30:26, 40.96s/it]Running generate_until requests:   3%|▎         | 45/1319 [27:25<12:42:59, 35.93s/it]Running generate_until requests:   3%|▎         | 46/1319 [27:58<12:22:28, 34.99s/it]Running generate_until requests:   4%|▎         | 47/1319 [28:29<11:54:04, 33.68s/it]Running generate_until requests:   4%|▎         | 48/1319 [28:48<10:22:19, 29.38s/it]Running generate_until requests:   4%|▎         | 49/1319 [29:31<11:47:44, 33.44s/it]Running generate_until requests:   4%|▍         | 50/1319 [30:06<11:58:03, 33.95s/it]Running generate_until requests:   4%|▍         | 51/1319 [30:31<11:01:31, 31.30s/it]Running generate_until requests:   4%|▍         | 52/1319 [30:49<9:32:58, 27.13s/it] Running generate_until requests:   4%|▍         | 53/1319 [31:11<9:00:07, 25.60s/it]Running generate_until requests:   4%|▍         | 54/1319 [31:39<9:16:03, 26.37s/it]Running generate_until requests:   4%|▍         | 55/1319 [32:08<9:31:14, 27.12s/it]Running generate_until requests:   4%|▍         | 56/1319 [32:27<8:43:41, 24.88s/it]Running generate_until requests:   4%|▍         | 57/1319 [32:47<8:08:44, 23.24s/it]Running generate_until requests:   4%|▍         | 58/1319 [33:25<9:40:15, 27.61s/it]Running generate_until requests:   4%|▍         | 59/1319 [33:45<8:57:13, 25.58s/it]Running generate_until requests:   5%|▍         | 60/1319 [34:11<8:54:56, 25.49s/it]Running generate_until requests:   5%|▍         | 61/1319 [34:41<9:24:50, 26.94s/it]Running generate_until requests:   5%|▍         | 62/1319 [35:14<10:02:54, 28.78s/it]Running generate_until requests:   5%|▍         | 63/1319 [35:47<10:28:16, 30.01s/it]Running generate_until requests:   5%|▍         | 64/1319 [36:09<9:34:56, 27.49s/it] Running generate_until requests:   5%|▍         | 65/1319 [36:48<10:47:41, 30.99s/it]Running generate_until requests:   5%|▌         | 66/1319 [37:41<13:06:14, 37.65s/it]Running generate_until requests:   5%|▌         | 67/1319 [38:02<11:24:10, 32.79s/it]Running generate_until requests:   5%|▌         | 68/1319 [38:26<10:24:02, 29.93s/it]Running generate_until requests:   5%|▌         | 69/1319 [39:10<11:53:00, 34.22s/it]Running generate_until requests:   5%|▌         | 70/1319 [40:06<14:09:26, 40.81s/it]Running generate_until requests:   5%|▌         | 71/1319 [40:44<13:53:33, 40.08s/it]Running generate_until requests:   5%|▌         | 72/1319 [41:11<12:29:58, 36.09s/it]Running generate_until requests:   6%|▌         | 73/1319 [41:31<10:45:51, 31.10s/it]Running generate_until requests:   6%|▌         | 74/1319 [41:50<9:32:27, 27.59s/it] Running generate_until requests:   6%|▌         | 75/1319 [42:23<10:07:57, 29.32s/it]Running generate_until requests:   6%|▌         | 76/1319 [43:00<10:53:10, 31.53s/it]Running generate_until requests:   6%|▌         | 77/1319 [43:33<10:59:19, 31.85s/it]Running generate_until requests:   6%|▌         | 78/1319 [43:53<9:49:28, 28.50s/it] Running generate_until requests:   6%|▌         | 79/1319 [44:18<9:26:21, 27.40s/it]Running generate_until requests:   6%|▌         | 80/1319 [44:42<9:03:42, 26.33s/it]Running generate_until requests:   6%|▌         | 81/1319 [45:23<10:31:18, 30.60s/it]Running generate_until requests:   6%|▌         | 82/1319 [45:56<10:46:50, 31.38s/it]Running generate_until requests:   6%|▋         | 83/1319 [46:34<11:28:13, 33.41s/it]Running generate_until requests:   6%|▋         | 84/1319 [46:57<10:26:45, 30.45s/it]Running generate_until requests:   6%|▋         | 85/1319 [47:43<12:01:56, 35.10s/it]Running generate_until requests:   7%|▋         | 86/1319 [48:15<11:37:24, 33.94s/it]Running generate_until requests:   7%|▋         | 87/1319 [48:47<11:29:41, 33.59s/it]Running generate_until requests:   7%|▋         | 88/1319 [49:19<11:16:23, 32.97s/it]Running generate_until requests:   7%|▋         | 89/1319 [49:50<11:06:52, 32.53s/it]Running generate_until requests:   7%|▋         | 90/1319 [50:19<10:44:05, 31.44s/it]Running generate_until requests:   7%|▋         | 91/1319 [50:57<11:23:06, 33.38s/it]Running generate_until requests:   7%|▋         | 92/1319 [51:34<11:44:38, 34.46s/it]Running generate_until requests:   7%|▋         | 93/1319 [52:12<12:03:40, 35.42s/it]Running generate_until requests:   7%|▋         | 94/1319 [52:35<10:47:35, 31.72s/it]Running generate_until requests:   7%|▋         | 95/1319 [53:15<11:37:32, 34.19s/it]Running generate_until requests:   7%|▋         | 96/1319 [53:48<11:28:49, 33.79s/it]Running generate_until requests:   7%|▋         | 97/1319 [54:28<12:09:29, 35.82s/it]Running generate_until requests:   7%|▋         | 98/1319 [55:07<12:26:21, 36.68s/it]Running generate_until requests:   8%|▊         | 99/1319 [55:29<10:56:49, 32.30s/it]Running generate_until requests:   8%|▊         | 100/1319 [55:57<10:29:07, 30.97s/it]Running generate_until requests:   8%|▊         | 101/1319 [56:34<11:02:31, 32.64s/it]Running generate_until requests:   8%|▊         | 102/1319 [57:13<11:46:02, 34.81s/it]Running generate_until requests:   8%|▊         | 103/1319 [57:40<10:55:29, 32.34s/it]Running generate_until requests:   8%|▊         | 104/1319 [58:13<10:56:26, 32.42s/it]Running generate_until requests:   8%|▊         | 105/1319 [58:49<11:17:42, 33.49s/it]Running generate_until requests:   8%|▊         | 106/1319 [59:08<9:51:18, 29.25s/it] 