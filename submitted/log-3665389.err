Already on 'yangexppp'
wandb: Currently logged in as: stevenzhou0816100. Use `wandb login --relogin` to force relogin
2024-08-04:14:28:25,596 INFO     [main.py:288] Verbosity set to INFO
2024-08-04:14:28:35,850 WARNING  [main.py:303]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2024-08-04:14:28:35,851 INFO     [main.py:378] Selected Tasks: ['mmlu_flan_cot_fewshot']
2024-08-04:14:28:35,889 INFO     [xevaluator.py:137] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2024-08-04:14:28:35,889 INFO     [xevaluator.py:184] Initializing xhf model, with arguments: {'pretrained': 'meta-llama/Meta-Llama-3-8B-Instruct', 'cats': True, 'check': False, 'contextlength': 1500, 'kernel_size': 16, 'thr': 0.05}
2024-08-04:14:28:35,901 INFO     [xhuggingface.py:176] Using device 'cuda'
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:06<00:18,  6.31s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:12<00:12,  6.21s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:18<00:06,  6.14s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:20<00:00,  4.37s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:20<00:00,  5.04s/it]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
2024-08-04:14:29:55,892 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_prehistory on rank 0...
  0%|          | 0/35 [00:00<?, ?it/s]100%|██████████| 35/35 [00:00<00:00, 604.82it/s]
2024-08-04:14:29:55,952 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_logical_fallacies on rank 0...
  0%|          | 0/18 [00:00<?, ?it/s]100%|██████████| 18/18 [00:00<00:00, 596.94it/s]
2024-08-04:14:29:55,983 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_us_history on rank 0...
  0%|          | 0/22 [00:00<?, ?it/s]100%|██████████| 22/22 [00:00<00:00, 390.32it/s]
2024-08-04:14:29:56,042 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_international_law on rank 0...
  0%|          | 0/13 [00:00<?, ?it/s]100%|██████████| 13/13 [00:00<00:00, 572.87it/s]
2024-08-04:14:29:56,066 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_professional_law on rank 0...
  0%|          | 0/170 [00:00<?, ?it/s] 28%|██▊       | 48/170 [00:00<00:00, 473.59it/s] 56%|█████▋    | 96/170 [00:00<00:00, 469.39it/s] 85%|████████▍ | 144/170 [00:00<00:00, 469.97it/s]100%|██████████| 170/170 [00:00<00:00, 470.44it/s]
2024-08-04:14:29:56,438 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_moral_disputes on rank 0...
  0%|          | 0/38 [00:00<?, ?it/s]100%|██████████| 38/38 [00:00<00:00, 588.56it/s]
2024-08-04:14:29:56,505 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_jurisprudence on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 595.60it/s]
2024-08-04:14:29:56,524 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_world_history on rank 0...
  0%|          | 0/26 [00:00<?, ?it/s]100%|██████████| 26/26 [00:00<00:00, 476.66it/s]
2024-08-04:14:29:56,583 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_moral_scenarios on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 59%|█████▉    | 59/100 [00:00<00:00, 589.53it/s]100%|██████████| 100/100 [00:00<00:00, 593.93it/s]
2024-08-04:14:29:56,758 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_philosophy on rank 0...
  0%|          | 0/34 [00:00<?, ?it/s]100%|██████████| 34/34 [00:00<00:00, 618.99it/s]
2024-08-04:14:29:56,815 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_formal_logic on rank 0...
  0%|          | 0/14 [00:00<?, ?it/s]100%|██████████| 14/14 [00:00<00:00, 538.31it/s]
2024-08-04:14:29:56,842 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_world_religions on rank 0...
  0%|          | 0/19 [00:00<?, ?it/s]100%|██████████| 19/19 [00:00<00:00, 649.32it/s]
2024-08-04:14:29:56,872 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_european_history on rank 0...
  0%|          | 0/18 [00:00<?, ?it/s]100%|██████████| 18/18 [00:00<00:00, 341.64it/s]
2024-08-04:14:29:56,927 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_human_sexuality on rank 0...
  0%|          | 0/12 [00:00<?, ?it/s]100%|██████████| 12/12 [00:00<00:00, 629.88it/s]
2024-08-04:14:29:56,947 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_econometrics on rank 0...
  0%|          | 0/12 [00:00<?, ?it/s]100%|██████████| 12/12 [00:00<00:00, 521.07it/s]
2024-08-04:14:29:56,971 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_macroeconomics on rank 0...
  0%|          | 0/43 [00:00<?, ?it/s]100%|██████████| 43/43 [00:00<00:00, 622.81it/s]
2024-08-04:14:29:57,043 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_geography on rank 0...
  0%|          | 0/22 [00:00<?, ?it/s]100%|██████████| 22/22 [00:00<00:00, 619.04it/s]
2024-08-04:14:29:57,080 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_security_studies on rank 0...
  0%|          | 0/27 [00:00<?, ?it/s]100%|██████████| 27/27 [00:00<00:00, 504.82it/s]
2024-08-04:14:29:57,136 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_psychology on rank 0...
  0%|          | 0/60 [00:00<?, ?it/s]100%|██████████| 60/60 [00:00<00:00, 593.42it/s]100%|██████████| 60/60 [00:00<00:00, 592.70it/s]
2024-08-04:14:29:57,240 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_microeconomics on rank 0...
  0%|          | 0/26 [00:00<?, ?it/s]100%|██████████| 26/26 [00:00<00:00, 615.96it/s]
2024-08-04:14:29:57,284 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_government_and_politics on rank 0...
  0%|          | 0/21 [00:00<?, ?it/s]100%|██████████| 21/21 [00:00<00:00, 604.44it/s]
2024-08-04:14:29:57,320 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_professional_psychology on rank 0...
  0%|          | 0/69 [00:00<?, ?it/s] 83%|████████▎ | 57/69 [00:00<00:00, 563.45it/s]100%|██████████| 69/69 [00:00<00:00, 562.75it/s]
2024-08-04:14:29:57,447 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_public_relations on rank 0...
  0%|          | 0/12 [00:00<?, ?it/s]100%|██████████| 12/12 [00:00<00:00, 619.32it/s]
2024-08-04:14:29:57,467 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_us_foreign_policy on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 609.24it/s]
2024-08-04:14:29:57,486 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_sociology on rank 0...
  0%|          | 0/22 [00:00<?, ?it/s]100%|██████████| 22/22 [00:00<00:00, 606.91it/s]
2024-08-04:14:29:57,524 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_global_facts on rank 0...
  0%|          | 0/10 [00:00<?, ?it/s]100%|██████████| 10/10 [00:00<00:00, 606.60it/s]
2024-08-04:14:29:57,542 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_professional_medicine on rank 0...
  0%|          | 0/31 [00:00<?, ?it/s]100%|██████████| 31/31 [00:00<00:00, 517.71it/s]
2024-08-04:14:29:57,604 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_business_ethics on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 540.02it/s]
2024-08-04:14:29:57,626 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_medicine on rank 0...
  0%|          | 0/22 [00:00<?, ?it/s]100%|██████████| 22/22 [00:00<00:00, 546.71it/s]
2024-08-04:14:29:57,667 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_management on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 625.31it/s]
2024-08-04:14:29:57,686 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_human_aging on rank 0...
  0%|          | 0/23 [00:00<?, ?it/s]100%|██████████| 23/23 [00:00<00:00, 648.73it/s]
2024-08-04:14:29:57,723 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_marketing on rank 0...
  0%|          | 0/25 [00:00<?, ?it/s]100%|██████████| 25/25 [00:00<00:00, 613.17it/s]
2024-08-04:14:29:57,765 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_nutrition on rank 0...
  0%|          | 0/33 [00:00<?, ?it/s]100%|██████████| 33/33 [00:00<00:00, 596.43it/s]
2024-08-04:14:29:57,822 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_virology on rank 0...
  0%|          | 0/18 [00:00<?, ?it/s]100%|██████████| 18/18 [00:00<00:00, 634.81it/s]
2024-08-04:14:29:57,852 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_professional_accounting on rank 0...
  0%|          | 0/31 [00:00<?, ?it/s]100%|██████████| 31/31 [00:00<00:00, 559.13it/s]
2024-08-04:14:29:57,909 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_miscellaneous on rank 0...
  0%|          | 0/86 [00:00<?, ?it/s] 77%|███████▋  | 66/86 [00:00<00:00, 651.56it/s]100%|██████████| 86/86 [00:00<00:00, 650.85it/s]
2024-08-04:14:29:58,046 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_medical_genetics on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 619.40it/s]
2024-08-04:14:29:58,065 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_clinical_knowledge on rank 0...
  0%|          | 0/29 [00:00<?, ?it/s]100%|██████████| 29/29 [00:00<00:00, 608.58it/s]
2024-08-04:14:29:58,114 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_mathematics on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 556.56it/s]
2024-08-04:14:29:58,135 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_elementary_mathematics on rank 0...
  0%|          | 0/41 [00:00<?, ?it/s]100%|██████████| 41/41 [00:00<00:00, 605.36it/s]
2024-08-04:14:29:58,205 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_statistics on rank 0...
  0%|          | 0/23 [00:00<?, ?it/s]100%|██████████| 23/23 [00:00<00:00, 566.49it/s]
2024-08-04:14:29:58,247 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_astronomy on rank 0...
  0%|          | 0/16 [00:00<?, ?it/s]100%|██████████| 16/16 [00:00<00:00, 543.11it/s]
2024-08-04:14:29:58,278 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_electrical_engineering on rank 0...
  0%|          | 0/16 [00:00<?, ?it/s]100%|██████████| 16/16 [00:00<00:00, 599.81it/s]
2024-08-04:14:29:58,306 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_abstract_algebra on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 612.52it/s]
2024-08-04:14:29:58,324 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_machine_learning on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 529.93it/s]
2024-08-04:14:29:58,346 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_computer_science on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 514.79it/s]
2024-08-04:14:29:58,368 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_biology on rank 0...
  0%|          | 0/32 [00:00<?, ?it/s]100%|██████████| 32/32 [00:00<00:00, 545.56it/s]
2024-08-04:14:29:58,430 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_anatomy on rank 0...
  0%|          | 0/14 [00:00<?, ?it/s]100%|██████████| 14/14 [00:00<00:00, 538.63it/s]
2024-08-04:14:29:58,457 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_physics on rank 0...
  0%|          | 0/17 [00:00<?, ?it/s]100%|██████████| 17/17 [00:00<00:00, 588.49it/s]
2024-08-04:14:29:58,487 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_computer_science on rank 0...
  0%|          | 0/9 [00:00<?, ?it/s]100%|██████████| 9/9 [00:00<00:00, 500.55it/s]
2024-08-04:14:29:58,506 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_conceptual_physics on rank 0...
  0%|          | 0/26 [00:00<?, ?it/s]100%|██████████| 26/26 [00:00<00:00, 609.30it/s]
2024-08-04:14:29:58,550 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_mathematics on rank 0...
  0%|          | 0/29 [00:00<?, ?it/s]100%|██████████| 29/29 [00:00<00:00, 595.67it/s]
2024-08-04:14:29:58,600 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_computer_security on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 602.73it/s]
2024-08-04:14:29:58,619 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_chemistry on rank 0...
  0%|          | 0/22 [00:00<?, ?it/s]100%|██████████| 22/22 [00:00<00:00, 584.63it/s]
2024-08-04:14:29:58,658 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_physics on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 597.53it/s]
2024-08-04:14:29:58,678 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_chemistry on rank 0...
  0%|          | 0/8 [00:00<?, ?it/s]100%|██████████| 8/8 [00:00<00:00, 591.02it/s]
2024-08-04:14:29:58,692 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_biology on rank 0...
  0%|          | 0/16 [00:00<?, ?it/s]100%|██████████| 16/16 [00:00<00:00, 524.91it/s]
2024-08-04:14:29:58,724 INFO     [xevaluator.py:395] Running generate_until requests
Running generate_until requests:   0%|          | 0/1531 [00:00<?, ?it/s]Running generate_until requests:   0%|          | 1/1531 [00:23<9:48:05, 23.06s/it]Running generate_until requests:   0%|          | 2/1531 [01:11<16:09:19, 38.04s/it]Running generate_until requests:   0%|          | 3/1531 [01:34<13:14:16, 31.19s/it]Running generate_until requests:   0%|          | 4/1531 [02:23<16:11:42, 38.18s/it]Running generate_until requests:   0%|          | 5/1531 [02:36<12:23:07, 29.22s/it]Running generate_until requests:   0%|          | 6/1531 [02:53<10:32:37, 24.89s/it]Running generate_until requests:   0%|          | 7/1531 [03:17<10:27:35, 24.71s/it]Running generate_until requests:   1%|          | 8/1531 [04:06<13:41:31, 32.36s/it]Running generate_until requests:   1%|          | 9/1531 [04:18<11:03:54, 26.17s/it]Running generate_until requests:   1%|          | 10/1531 [04:32<9:24:58, 22.29s/it]Running generate_until requests:   1%|          | 11/1531 [05:21<12:49:58, 30.39s/it]Running generate_until requests:   1%|          | 12/1531 [05:33<10:29:33, 24.87s/it]Running generate_until requests:   1%|          | 13/1531 [06:10<12:00:27, 28.48s/it]Running generate_until requests:   1%|          | 14/1531 [06:27<10:35:59, 25.15s/it]Running generate_until requests:   1%|          | 15/1531 [07:18<13:46:31, 32.71s/it]Running generate_until requests:   1%|          | 16/1531 [08:08<16:02:12, 38.11s/it]Running generate_until requests:   1%|          | 17/1531 [08:19<12:36:40, 29.99s/it]Running generate_until requests:   1%|          | 18/1531 [08:33<10:34:02, 25.14s/it]Running generate_until requests:   1%|          | 19/1531 [09:26<14:02:30, 33.43s/it]Running generate_until requests:   1%|▏         | 20/1531 [10:18<16:25:21, 39.13s/it]Running generate_until requests:   1%|▏         | 21/1531 [10:46<15:00:47, 35.79s/it]Running generate_until requests:   1%|▏         | 22/1531 [11:06<12:56:21, 30.87s/it]Running generate_until requests:   2%|▏         | 23/1531 [11:57<15:32:21, 37.10s/it]Running generate_until requests:   2%|▏         | 24/1531 [12:49<17:24:31, 41.59s/it]Running generate_until requests:   2%|▏         | 25/1531 [12:59<13:25:13, 32.08s/it]Running generate_until requests:   2%|▏         | 26/1531 [13:54<16:16:22, 38.93s/it]Running generate_until requests:   2%|▏         | 27/1531 [14:36<16:35:57, 39.73s/it]Running generate_until requests:   2%|▏         | 28/1531 [15:28<18:06:45, 43.38s/it]Running generate_until requests:   2%|▏         | 29/1531 [16:19<19:07:26, 45.84s/it]Running generate_until requests:   2%|▏         | 30/1531 [17:11<19:50:17, 47.58s/it]Running generate_until requests:   2%|▏         | 31/1531 [17:31<16:23:21, 39.33s/it]Running generate_until requests:   2%|▏         | 32/1531 [17:58<14:50:09, 35.63s/it]Running generate_until requests:   2%|▏         | 33/1531 [18:12<12:07:44, 29.15s/it]Running generate_until requests:   2%|▏         | 34/1531 [18:22<9:43:19, 23.38s/it] Running generate_until requests:   2%|▏         | 35/1531 [19:14<13:18:22, 32.02s/it]