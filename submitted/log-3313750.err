Already on 'addinggriffin'
warning: fetch updated the current branch head.
fast-forwarding your working tree from
commit 3a2f7c2bda0cafa5fa6545352c8ece3bbdccfbb2.
error: Your local changes to the following files would be overwritten by merge:
	aqua_cot_prompts_5shot.txt
Please commit your changes or stash them before you merge.
error: The following untracked working tree files would be overwritten by merge:
	aqua_cot_prompts_5shot_old.txt
Please move or remove them before you merge.
Aborting
fatal: Cannot fast-forward your working tree.
After making sure that you saved anything precious from
$ git diff 3a2f7c2bda0cafa5fa6545352c8ece3bbdccfbb2
output, run
$ git reset --hard
to recover.
wandb: Currently logged in as: stevenzhou0816100. Use `wandb login --relogin` to force relogin
The following values were not passed to `accelerate launch` and had defaults used instead:
		More than one GPU was found, enabling multi-GPU training.
		If this was unintended please pass in `--num_processes=1`.
	`--mixed_precision` was set to a value of `'no'`
	`--dynamo_backend` was set to a value of `'no'`
To avoid this warning pass in values for each of the problematic parameters or run `accelerate config`.
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:19<00:59, 19.95s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:21<01:04, 21.49s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:21<01:03, 21.19s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:21<01:03, 21.21s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:20<01:02, 20.89s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:21<01:03, 21.20s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:21<01:03, 21.17s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:21<01:03, 21.12s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:35<00:34, 17.39s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:37<00:36, 18.09s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:37<00:36, 18.26s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:37<00:36, 18.26s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:37<00:36, 18.14s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:36<00:36, 18.02s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:37<00:36, 18.14s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:37<00:36, 18.12s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:51<00:16, 16.34s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:52<00:16, 16.81s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:52<00:16, 16.91s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:52<00:16, 16.98s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:52<00:16, 16.80s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:52<00:16, 16.79s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:52<00:16, 16.73s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:53<00:17, 17.06s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:55<00:00, 11.33s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:55<00:00, 13.79s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:55<00:00, 11.51s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:55<00:00, 13.89s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:55<00:00, 11.46s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:55<00:00, 13.92s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:55<00:00, 11.48s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:55<00:00, 13.93s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:55<00:00, 11.59s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:55<00:00, 13.94s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:55<00:00, 11.50s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:55<00:00, 13.94s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:56<00:00, 11.51s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:56<00:00, 14.03s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:55<00:00, 11.62s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:55<00:00, 13.94s/it]
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:369: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:369: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:369: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:369: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:369: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:369: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:369: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:369: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
  3%|▎         | 1/32 [00:02<01:31,  2.94s/it]  3%|▎         | 1/32 [00:03<01:45,  3.39s/it]  6%|▋         | 2/32 [00:04<00:56,  1.89s/it]  3%|▎         | 1/32 [00:04<02:21,  4.58s/it]  3%|▎         | 1/32 [00:04<02:23,  4.64s/it]  3%|▎         | 1/32 [00:04<02:32,  4.93s/it]  3%|▎         | 1/32 [00:06<03:08,  6.08s/it]  6%|▋         | 2/32 [00:06<01:37,  3.24s/it]  3%|▎         | 1/32 [00:06<03:33,  6.89s/it]  6%|▋         | 2/32 [00:06<01:36,  3.21s/it]  6%|▋         | 2/32 [00:07<01:43,  3.47s/it]  6%|▋         | 2/32 [00:09<02:13,  4.45s/it]  6%|▋         | 2/32 [00:09<02:24,  4.83s/it]  9%|▉         | 3/32 [00:10<01:42,  3.54s/it]  9%|▉         | 3/32 [00:12<01:57,  4.06s/it]  9%|▉         | 3/32 [00:12<01:47,  3.69s/it]  9%|▉         | 3/32 [00:16<02:43,  5.62s/it] 12%|█▎        | 4/32 [00:16<02:10,  4.67s/it]  3%|▎         | 1/32 [00:17<09:02, 17.51s/it] 12%|█▎        | 4/32 [00:22<02:43,  5.84s/it] 12%|█▎        | 4/32 [00:24<03:24,  7.31s/it]  6%|▋         | 2/32 [00:27<06:58, 13.96s/it]
 16%|█▌        | 5/32 [00:28<02:45,  6.15s/it] 16%|█▌        | 5/32 [00:31<03:07,  6.96s/it]  9%|▉         | 3/32 [00:36<07:23, 15.30s/it] 19%|█▉        | 6/32 [00:36<03:00,  6.93s/it]  6%|▋         | 2/32 [00:36<09:18, 18.61s/it] 22%|██▏       | 7/32 [00:39<02:17,  5.52s/it] 12%|█▎        | 4/32 [00:41<06:28, 13.88s/it]  9%|▉         | 3/32 [00:43<06:27, 13.35s/it]  6%|▋         | 2/32 [00:44<12:35, 25.18s/it] 16%|█▌        | 5/32 [00:44<04:27,  9.91s/it] 16%|█▌        | 5/32 [00:46<06:05, 13.55s/it]  9%|▉         | 3/32 [00:48<07:22, 15.24s/it] 19%|█▉        | 6/32 [00:49<03:32,  8.16s/it] 19%|█▉        | 6/32 [00:51<04:43, 10.91s/it] 12%|█▎        | 4/32 [00:53<05:23, 11.55s/it] 22%|██▏       | 7/32 [00:54<03:25,  8.22s/it] 16%|█▌        | 5/32 [00:57<03:57,  8.79s/it] 25%|██▌       | 8/32 [00:58<02:43,  6.83s/it] 19%|█▉        | 6/32 [00:59<02:42,  6.24s/it] 22%|██▏       | 7/32 [01:00<01:57,  4.70s/it] 12%|█▎        | 4/32 [01:06<09:47, 20.97s/it] 25%|██▌       | 8/32 [01:08<02:15,  5.64s/it] 25%|██▌       | 8/32 [01:09<05:18, 13.28s/it] 28%|██▊       | 9/32 [01:11<03:43,  9.71s/it] 31%|███▏      | 10/32 [01:12<02:34,  7.04s/it] 25%|██▌       | 8/32 [01:14<03:42,  9.27s/it]
 28%|██▊       | 9/32 [01:16<02:25,  6.34s/it] 34%|███▍      | 11/32 [01:16<02:09,  6.17s/it] 22%|██▏       | 7/32 [01:19<06:18, 15.13s/it] 25%|██▌       | 8/32 [01:20<04:18, 10.77s/it] 19%|█▉        | 6/32 [01:20<09:15, 21.37s/it] 38%|███▊      | 12/32 [01:21<01:56,  5.82s/it] 31%|███▏      | 10/32 [01:21<02:14,  6.14s/it] 34%|███▍      | 11/32 [01:23<01:38,  4.70s/it] 22%|██▏       | 7/32 [01:25<06:39, 15.97s/it] 41%|████      | 13/32 [01:26<01:45,  5.55s/it] 28%|██▊       | 9/32 [01:26<03:34,  9.32s/it] 25%|██▌       | 8/32 [01:28<04:42, 11.77s/it] 12%|█▎        | 4/32 [01:33<12:53, 27.61s/it] 28%|██▊       | 9/32 [01:34<03:48,  9.94s/it] 44%|████▍     | 14/32 [01:34<01:55,  6.42s/it] 16%|█▌        | 5/32 [01:36<10:51, 24.13s/it] 31%|███▏      | 10/32 [01:36<02:45,  7.52s/it] 47%|████▋     | 15/32 [01:36<01:26,  5.09s/it] 19%|█▉        | 6/32 [01:38<07:16, 16.79s/it] 34%|███▍      | 11/32 [01:38<02:04,  5.93s/it] 22%|██▏       | 7/32 [01:40<04:58, 11.94s/it] 38%|███▊      | 12/32 [01:41<01:37,  4.87s/it] 25%|██▌       | 8/32 [01:44<03:44,  9.35s/it] 41%|████      | 13/32 [01:44<01:25,  4.51s/it] 28%|██▊       | 9/32 [01:49<03:07,  8.17s/it] 31%|███▏      | 10/32 [01:51<02:17,  6.27s/it] 47%|████▋     | 15/32 [01:53<02:08,  7.55s/it]
 16%|█▌        | 5/32 [01:53<11:11, 24.89s/it] 31%|███▏      | 10/32 [01:55<05:40, 15.48s/it] 34%|███▍      | 11/32 [01:55<01:57,  5.58s/it] 38%|███▊      | 12/32 [01:58<01:32,  4.62s/it] 19%|█▉        | 6/32 [02:00<08:06, 18.71s/it] 44%|████▍     | 14/32 [02:00<02:20,  7.83s/it] 41%|████      | 13/32 [02:00<01:15,  3.95s/it] 34%|███▍      | 11/32 [02:00<04:18, 12.30s/it] 38%|███▊      | 12/32 [02:01<04:58, 14.91s/it] 38%|███▊      | 12/32 [02:02<03:02,  9.11s/it] 44%|████▍     | 14/32 [02:04<01:09,  3.84s/it] 47%|████▋     | 15/32 [02:04<01:53,  6.66s/it] 41%|████      | 13/32 [02:06<03:43, 11.79s/it] 47%|████▋     | 15/32 [02:08<01:07,  3.98s/it] 50%|█████     | 16/32 [02:11<01:49,  6.82s/it] 50%|█████     | 16/32 [02:12<01:01,  3.87s/it] 44%|████▍     | 14/32 [02:12<03:02, 10.17s/it] 22%|██▏       | 7/32 [02:14<07:13, 17.35s/it] 53%|█████▎    | 17/32 [02:16<01:01,  4.09s/it] 47%|████▋     | 15/32 [02:17<02:26,  8.59s/it] 56%|█████▋    | 18/32 [02:19<00:51,  3.68s/it] 25%|██▌       | 8/32 [02:21<05:33, 13.90s/it] 59%|█████▉    | 19/32 [02:23<00:50,  3.87s/it] 62%|██████▎   | 20/32 [02:26<00:42,  3.52s/it] 28%|██▊       | 9/32 [02:26<04:17, 11.19s/it] 53%|█████▎    | 17/32 [02:31<02:41, 10.78s/it] 41%|████      | 13/32 [02:32<04:48, 15.21s/it] 50%|█████     | 16/32 [02:37<03:12, 12.01s/it] 56%|█████▋    | 18/32 [02:37<02:12,  9.47s/it] 59%|█████▉    | 19/32 [02:42<01:45,  8.12s/it] 53%|█████▎    | 17/32 [02:43<02:31, 10.13s/it] 62%|██████▎   | 20/32 [02:47<01:24,  7.02s/it] 56%|█████▋    | 18/32 [02:48<02:01,  8.65s/it] 66%|██████▌   | 21/32 [02:50<01:05,  5.97s/it] 28%|██▊       | 9/32 [02:53<07:23, 19.27s/it]
 59%|█████▉    | 19/32 [02:54<01:40,  7.73s/it] 66%|██████▌   | 21/32 [02:56<02:04, 11.30s/it] 69%|██████▉   | 22/32 [02:58<01:05,  6.52s/it] 69%|██████▉   | 22/32 [02:58<01:27,  8.77s/it] 62%|██████▎   | 20/32 [03:00<01:27,  7.33s/it] 72%|███████▏  | 23/32 [03:00<00:46,  5.18s/it] 44%|████▍     | 14/32 [03:01<05:50, 19.48s/it] 47%|████▋     | 15/32 [03:03<04:02, 14.24s/it] 66%|██████▌   | 21/32 [03:04<01:11,  6.49s/it] 72%|███████▏  | 23/32 [03:05<01:13,  8.15s/it] 50%|█████     | 16/32 [03:07<02:57, 11.07s/it] 75%|███████▌  | 24/32 [03:07<00:51,  6.39s/it] 78%|███████▊  | 25/32 [03:09<00:33,  4.83s/it] 75%|███████▌  | 24/32 [03:09<00:49,  6.18s/it] 81%|████████▏ | 26/32 [03:12<00:25,  4.32s/it] 84%|████████▍ | 27/32 [03:15<00:19,  3.94s/it] 88%|████████▊ | 28/32 [03:17<00:14,  3.53s/it] 91%|█████████ | 29/32 [03:21<00:10,  3.62s/it] 50%|█████     | 16/32 [03:25<03:25, 12.85s/it]
 66%|██████▌   | 21/32 [03:26<01:47,  9.81s/it]
 94%|█████████▍| 30/32 [03:27<00:08,  4.14s/it] 97%|█████████▋| 31/32 [03:29<00:03,  3.72s/it] 78%|███████▊  | 25/32 [03:39<01:33, 13.36s/it] 81%|████████▏ | 26/32 [03:45<01:07, 11.23s/it]100%|██████████| 32/32 [03:58<00:00, 11.36s/it]100%|██████████| 32/32 [03:58<00:00,  7.47s/it]
 84%|████████▍ | 27/32 [04:15<01:24, 16.87s/it] 84%|████████▍ | 27/32 [04:17<00:47,  9.52s/it]
[rank2]:[E ProcessGroupNCCL.cpp:523] [Rank 2] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=53, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600193 milliseconds before timing out.
[rank2]:[E ProcessGroupNCCL.cpp:537] Some NCCL operations have failed or timed out. Due to the asynchronous nature of CUDA kernels, subsequent GPU operations might run on corrupted/incomplete data.
[rank2]:[E ProcessGroupNCCL.cpp:543] To avoid data inconsistency, we are taking the entire process down.
[rank2]:[E ProcessGroupNCCL.cpp:1182] [Rank 2] NCCL watchdog thread terminated with exception: [Rank 2] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=53, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600193 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:525 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7f9f1cbfcd87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x1e6 (0x7f9f1dda46e6 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::workCleanupLoop() + 0x19d (0x7f9f1dda7c3d in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x119 (0x7f9f1dda8839 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd6df4 (0x7f9f67abbdf4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #5: <unknown function> + 0x8609 (0x7f9f68eaa609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #6: clone + 0x43 (0x7f9f68c75353 in /lib/x86_64-linux-gnu/libc.so.6)

terminate called after throwing an instance of 'c10::DistBackendError'
  what():  [Rank 2] NCCL watchdog thread terminated with exception: [Rank 2] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=53, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600193 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:525 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7f9f1cbfcd87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x1e6 (0x7f9f1dda46e6 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::workCleanupLoop() + 0x19d (0x7f9f1dda7c3d in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x119 (0x7f9f1dda8839 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd6df4 (0x7f9f67abbdf4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #5: <unknown function> + 0x8609 (0x7f9f68eaa609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #6: clone + 0x43 (0x7f9f68c75353 in /lib/x86_64-linux-gnu/libc.so.6)

Exception raised from ncclCommWatchdog at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:1186 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7f9f1cbfcd87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0xdf6b11 (0x7f9f1dafeb11 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: <unknown function> + 0xd6df4 (0x7f9f67abbdf4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #3: <unknown function> + 0x8609 (0x7f9f68eaa609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #4: clone + 0x43 (0x7f9f68c75353 in /lib/x86_64-linux-gnu/libc.so.6)

[2024-07-11 06:05:05,141] torch.distributed.elastic.multiprocessing.api: [ERROR] failed (exitcode: -6) local_rank: 2 (pid: 1977996) of binary: /fsx-storygen/beidic/anaconda3/envs/griffin/bin/python3.9
Traceback (most recent call last):
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/bin/accelerate", line 8, in <module>
    sys.exit(main())
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/accelerate/commands/accelerate_cli.py", line 47, in main
    args.func(args)
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/accelerate/commands/launch.py", line 985, in launch_command
    multi_gpu_launcher(args)
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/accelerate/commands/launch.py", line 654, in multi_gpu_launcher
    distrib_run.run(args)
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/distributed/run.py", line 803, in run
    elastic_launch(
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 135, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 268, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
========================================================
main.py FAILED
--------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
--------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-11_06:05:05
  host      : a100-st-p4de24xlarge-41.fair-a100.hpcaas
  rank      : 2 (local_rank: 2)
  exitcode  : -6 (pid: 1977996)
  error_file: <N/A>
  traceback : Signal 6 (SIGABRT) received by PID 1977996
========================================================
