Your branch is up to date with 'origin/addinggriffin'.
Already up to date.
Already up to date.
/fsx-storygen/beidic/anaconda3/envs/griffin/bin/python
/fsx-storygen/beidic/anaconda3/envs/griffin/bin/python
The token has not been saved to the git credentials helper. Pass `add_to_git_credential=True` in this function directly or `--add-to-git-credential` if using via `huggingface-cli` if you want to set the git credential as well.
Token is valid (permission: fineGrained).
Your token has been saved to /data/home/beidic/.cache/huggingface/token
Login successful
NCCL_TIMEOUT 1800
NCCL_TIMEOUT 1800NCCL_TIMEOUT 1800
NCCL_TIMEOUT 1800NCCL_TIMEOUT 1800


NCCL_TIMEOUT 1800
NCCL_TIMEOUT 1800
NCCL_TIMEOUT 1800
is_distributed True
Namespace(tasks='csqa,strategyqa,sports,date', model='meta-llama/Llama-2-13b-chat-hf', device=None, limit=None, griffin=False, cats=True, check=True, kernel_size=16, spr=0.3, thr=0.1, widthtree=1, patternstrict=True, shotfive=True, shottwo=False, filteractiveenabled=False)
We now use eos_token as pad token
is_distributed True
Namespace(tasks='csqa,strategyqa,sports,date', model='meta-llama/Llama-2-13b-chat-hf', device=None, limit=None, griffin=False, cats=True, check=True, kernel_size=16, spr=0.3, thr=0.1, widthtree=1, patternstrict=True, shotfive=True, shottwo=False, filteractiveenabled=False)
is_distributed True
Namespace(tasks='csqa,strategyqa,sports,date', model='meta-llama/Llama-2-13b-chat-hf', device=None, limit=None, griffin=False, cats=True, check=True, kernel_size=16, spr=0.3, thr=0.1, widthtree=1, patternstrict=True, shotfive=True, shottwo=False, filteractiveenabled=False)
is_distributed True
Namespace(tasks='csqa,strategyqa,sports,date', model='meta-llama/Llama-2-13b-chat-hf', device=None, limit=None, griffin=False, cats=True, check=True, kernel_size=16, spr=0.3, thr=0.1, widthtree=1, patternstrict=True, shotfive=True, shottwo=False, filteractiveenabled=False)
is_distributed True
Namespace(tasks='csqa,strategyqa,sports,date', model='meta-llama/Llama-2-13b-chat-hf', device=None, limit=None, griffin=False, cats=True, check=True, kernel_size=16, spr=0.3, thr=0.1, widthtree=1, patternstrict=True, shotfive=True, shottwo=False, filteractiveenabled=False)
is_distributed True
Namespace(tasks='csqa,strategyqa,sports,date', model='meta-llama/Llama-2-13b-chat-hf', device=None, limit=None, griffin=False, cats=True, check=True, kernel_size=16, spr=0.3, thr=0.1, widthtree=1, patternstrict=True, shotfive=True, shottwo=False, filteractiveenabled=False)
is_distributed True
Namespace(tasks='csqa,strategyqa,sports,date', model='meta-llama/Llama-2-13b-chat-hf', device=None, limit=None, griffin=False, cats=True, check=True, kernel_size=16, spr=0.3, thr=0.1, widthtree=1, patternstrict=True, shotfive=True, shottwo=False, filteractiveenabled=False)
is_distributed True
Namespace(tasks='csqa,strategyqa,sports,date', model='meta-llama/Llama-2-13b-chat-hf', device=None, limit=None, griffin=False, cats=True, check=True, kernel_size=16, spr=0.3, thr=0.1, widthtree=1, patternstrict=True, shotfive=True, shottwo=False, filteractiveenabled=False)
beam width is 8
We now use eos_token as pad token
We now use eos_token as pad token
We now use eos_token as pad token
We now use eos_token as pad token
We now use eos_token as pad token
We now use eos_token as pad token
We now use eos_token as pad token
beam width is 8
beam width is 8
beam width is 8
beam width is 8
beam width is 8
beam width is 8
beam width is 8
tasks ['csqa', 'strategyqa', 'sports', 'date']tasks ['csqa', 'strategyqa', 'sports', 'date']

tasks ['csqa', 'strategyqa', 'sports', 'date']tasks ['csqa', 'strategyqa', 'sports', 'date']

tasks ['csqa', 'strategyqa', 'sports', 'date']tasks ['csqa', 'strategyqa', 'sports', 'date']tasks ['csqa', 'strategyqa', 'sports', 'date']
tasks ['csqa', 'strategyqa', 'sports', 'date']


length of dataset:  1224
length of dataset:  1224
length of dataset:  1224
length of dataset:  1224
length of dataset:  1224
length of dataset:  1224
length of dataset:  1224
beamwidth is 1beamwidth is 1beamwidth is 1beamwidth is 1



beamwidth is 1
length of dataset:  1224
beamwidth is 1
beamwidth is 1
beamwidth is 1
Answer c expected b
Answer e expected e
Answer a expected a
Answer c expected c
Answer a expected a
Answer d expected d
Answer c expected c
Answer d expected c
Answer e expected e
Answer e expected c
Answer b expected b
Answer d expected d
Answer a expected a
Answer b expected a
Answer b expected d
Answer a expected a
Answer t expected d
Answer b expected d
Answer d expected d
Answer a expected a
Answer e expected c
Answer e expected e
Answer b expected e
Answer a expected a
Answer d expected e
Answer b expected a
Answer d expected d
Answer a expected a
Answer d expected d
Answer c expected c
Answer c expected a
Answer d expected d
Answer d expected d
Answer d expected d
Answer d expected d
Answer b expected b
Answer c expected c
Answer e expected e
Answer d expected e
Answer e expected a
Answer e expected e
Answer b expected b
Answer e expected d
Answer e expected e
Answer a expected e
Answer b expected b
Answer d expected d
Answer c expected d
Answer b expected b
Answer b expected a
Answer e expected a
Answer a expected a
Answer e expected e
Skipping the batch
Answer a expected a
Answer a expected b
Answer b expected e
Answer b expected b
Answer a expected a
Answer b expected b
Answer e expected e
Answer d expected d
Answer d expected c
Answer e expected e
Answer c expected c
Answer b expected b
Answer a expected a
Answer e expected e
Answer e expected e
Answer a expected b
Answer b expected b
Answer c expected c
Answer d expected d
Answer d expected d
Answer d expected e
Answer d expected d
Answer b expected e
Answer a expected d
Answer c expected d
Answer a expected e
Answer c expected a
Answer a expected a
Answer e expected d
Answer a expected e
Answer d expected d
Answer e expected e
Answer c expected c
Answer c expected b
Answer e expected b
Answer b expected b
Answer e expected e
Answer a expected a
Answer c expected c
Answer d expected d
Answer a expected a
Answer b expected b
Answer d expected d
Answer d expected d
Answer a expected a
Answer d expected d
Answer c expected a
Answer e expected c
Answer a expected a
Answer a expected a
Answer d expected d
Answer e expected b
Skipping the batch
Answer e expected e
Skipping the batch
Answer e expected e
Answer b expected b
Answer e expected c
Answer e expected a
Answer   expected c
Answer b expected b
Answer a expected a
Answer e expected e
Answer e expected e
Answer b expected b
Answer e expected b
Answer a expected a
Answer d expected b
Answer e expected c
Answer b expected b
Answer e expected d
Answer e expected e
Answer d expected c
Answer e expected e
Answer d expected e
Answer a expected a
Answer d expected d
Answer e expected a
Answer e expected d
Answer c expected c
Answer d expected d
Answer d expected d
Answer d expected d
Answer e expected e
Answer b expected b
Answer b expected b
Answer e expected b
Answer a expected e
Answer a expected a
Answer e expected d
Answer e expected a
index 5 start communication
Answer e expected b
Answer d expected b
Answer a expected b
Answer e expected e
Answer d expected d
Answer b expected e
Answer d expected b
index 7 start communication
index 1 start communication
index 3 start communication
Answer e expected c
index 6 start communication
Answer e expected e
Answer b expected b
index 0 start communication
index 2 start communication
index 4 start communication
Here are the statistics for inference
Here are the statistics for inference
Here are the statistics for inference
Here are the statistics for inference
Here are the statistics for inference
Here are the statistics for inference
Here are the statistics for inference
Here are the statistics for inference
+--------+----------------+---------------------------+-----------------------------+---------------+-------------+---------+--------------------------------+------------------+----------------------------------+-----------------------+----------------------+
| Task   |   Num Sentence |   Total Generation Length |   Average Generation Length |   Total Steps |   Num Steps |     AAL |   Total Roll Back Length Error |   Error Instance |   Average Roll Back Length Error |   Effective Tree Size |   Drafting Tree Size |
+========+================+===========================+=============================+===============+=============+=========+================================+==================+==================================+=======================+======================+
| csqa   |           1221 |                    161590 |                     132.342 |        144356 |       16564 | 8.71504 |                         120668 |            12078 |                          9.99073 |                    16 |                    1 |
+--------+----------------+---------------------------+-----------------------------+---------------+-------------+---------+--------------------------------+------------------+----------------------------------+-----------------------+----------------------+
Answer no expected no
Answer yes expected no
Answer no expected no
Answer no expected yes
Answer no expected no
Answer no expected no
Answer no expected yes
Answer yes expected yes
Answer no expected yes
Answer no expected no
Answer no expected no
Skipping the batch
Skipping the batch
Answer no expected no
Skipping the batch
Answer yes expected yes
Answer no expected yes
Answer yes expected yes
Answer no expected yes
Answer no expected no
Answer no expected no
Answer no expected no
Answer no expected no
Answer no expected no
Skipping the batch
Answer no expected no
Answer no expected no
Answer yes expected yes
Answer no expected no
Answer no expected no
Answer no expected no
Answer no expected yes
Answer no expected no
Answer yes expected no
Skipping the batch
Answer no expected no
Answer no expected no
Skipping the batch
Answer yes expected yes
Answer no expected no
Answer no expected no
Answer yes expected yes
Answer no expected no
Answer no expected no
Answer no expected no
Answer yes expected yes
Answer yes expected yes
Skipping the batch
Answer no expected no
Answer no expected no
Answer no expected no
Answer yes expected yes
Answer no expected no
Answer no expected no
Answer no expected no
Answer no expected no
Answer yes expected yes
Answer yes expected yes
Answer no expected yes
Answer er is a muppet character known for his love of cookies. keebler is a company that makes cookies. the answer is no.

q: yes or no: could a na expected no
Answer yes expected yes
Answer yes expected yes
Answer yes expected no
Answer no expected no
index 0 start communication
index 7 start communication
index 1 start communication
index 5 start communication
index 3 start communication
index 6 start communication
index 4 start communication
index 2 start communication
Here are the statistics for inference
Here are the statistics for inferenceHere are the statistics for inferenceHere are the statistics for inference

Here are the statistics for inference
Here are the statistics for inferenceHere are the statistics for inference
Here are the statistics for inference


+------------+----------------+---------------------------+-----------------------------+---------------+-------------+---------+--------------------------------+------------------+----------------------------------+-----------------------+----------------------+
| Task       |   Num Sentence |   Total Generation Length |   Average Generation Length |   Total Steps |   Num Steps |     AAL |   Total Roll Back Length Error |   Error Instance |   Average Roll Back Length Error |   Effective Tree Size |   Drafting Tree Size |
+============+================+===========================+=============================+===============+=============+=========+================================+==================+==================================+=======================+======================+
| strategyqa |            457 |                     28073 |                     61.4289 |         22182 |        2779 | 7.98201 |                          22282 |             2157 |                          10.3301 |                    16 |                    1 |
+------------+----------------+---------------------------+-----------------------------+---------------+-------------+---------+--------------------------------+------------------+----------------------------------+-----------------------+----------------------+
Answer plausible expected plausible
Answer plausible expected implausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer implausible expected implausible
Answer implausible expected implausible
Answer plausible expected implausible
Answer plausible expected implausible
Answer implausible expected plausible
Answer implausible expected implausible
Answer plausible expected plausible
Answer implausible expected implausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected implausible
Answer implausible expected implausible
Answer plausible expected implausible
Answer implausible expected implausible
Answer implausible expected implausible
Answer plausible expected implausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer implausible expected implausible
Answer plausible expected plausible
Answer implausible expected implausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer implausible expected implausible
Answer plausible expected plausible
Answer implausible expected plausible
Answer implausible expected implausible
Answer implausible expected implausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer plausible expected plausible
Skipping the batch
Answer plausible expected plausible
Answer implausible expected implausible
Answer plausible expected plausible
Answer plausible expected implausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer plausible expected implausible
Answer implausible expected implausible
Answer implausible expected implausible
Answer plausible expected plausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer implausible expected plausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected plausible
Skipping the batch
Answer plausible expected implausible
Answer plausible expected plausible
Answer plausible expected plausible
Skipping the batch
Answer implausible expected plausible
Answer plausible expected plausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer implausible expected implausible
Answer plausible expected plausible
Answer implausible expected implausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer implausible expected implausible
Answer plausible expected plausible
Answer plausible expected implausible
Skipping the batch
Answer plausible expected plausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer implausible expected implausible
Answer plausible expected plausible
Answer plausible expected implausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer implausible expected implausible
Answer plausible expected plausible
Answer implausible expected implausible
Answer plausible expected plausible
Answer implausible expected implausible
Answer implausible expected implausible
Answer plausible expected plausible
Answer implausible expected implausible
Answer plausible expected implausible
Answer plausible expected implausible
Answer implausible expected implausible
Answer plausible expected implausible
Answer implausible expected plausible
Answer implausible expected implausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer implausible expected implausible
Answer implausible expected implausible
Answer implausible expected implausible
Answer plausible expected implausible
Answer implausible expected implausible
index 5 start communication
Answer plausible expected implausible
Answer plausible expected implausible
index 6 start communication
Answer implausible expected implausible
index 1 start communication
Answer plausible expected plausible
index 3 start communication
Answer plausible expected implausible
index 0 start communication
index 7 start communication
Skipping the batch
Skipping the batch
index 4 start communication
index 2 start communication
Here are the statistics for inferenceHere are the statistics for inference

Here are the statistics for inferenceHere are the statistics for inferenceHere are the statistics for inferenceHere are the statistics for inferenceHere are the statistics for inference
Here are the statistics for inference




+--------+----------------+---------------------------+-----------------------------+---------------+-------------+---------+--------------------------------+------------------+----------------------------------+-----------------------+----------------------+
| Task   |   Num Sentence |   Total Generation Length |   Average Generation Length |   Total Steps |   Num Steps |     AAL |   Total Roll Back Length Error |   Error Instance |   Average Roll Back Length Error |   Effective Tree Size |   Drafting Tree Size |
+========+================+===========================+=============================+===============+=============+=========+================================+==================+==================================+=======================+======================+
| sports |            970 |                     45327 |                     46.7289 |         28839 |        2968 | 9.71664 |                          18649 |             1745 |                          10.6871 |                    16 |                    1 |
+--------+----------------+---------------------------+-----------------------------+---------------+-------------+---------+--------------------------------+------------------+----------------------------------+-----------------------+----------------------+
Answer 12/31/2011 expected 12/31/2011
Answer 05/23/1943 expected 05/23/1943
Answer 02/28/2008 expected 02/29/2008
Answer 12/31/1929 expected 12/31/1929
Answer 6/19/2019 expected 06/20/2019
Answer 06/29/2002 expected 06/28/2002
Answer 06/01/2020 expected 05/30/2020
Answer 01/07/2018 expected 01/07/2018
Answer 01/09/1963 expected 01/09/1961
Answer 03/01/2001 expected 03/01/2017
Answer 04/30/2021 expected 04/30/2021
Skipping the batch
Answer 12/23/1962 expected 12/23/1960
Answer 04/03/1985 expected 04/03/1985
Skipping the batch
Answer 04/16/2009 expected 02/16/2009
Answer 12/31/1900 expected 01/01/1900
Skipping the batch
Answer 06/09/1943 expected 06/09/1943
Answer 02/29/2016 expected 02/29/2016
Answer 08/04/2002 expected 08/04/2002
Answer 11/17/1933 expected 11/18/1933
Answer 01/22/1987 expected 12/23/1986
Answer 06/02/1942 expected 06/02/1942
Answer 01/12/2008 expected 12/23/2007
Answer 02/19/2000 expected 02/19/2016
Skipping the batch
Skipping the batch
Answer 03/07/2016 expected 03/07/2016
Answer 09/10/2020 expected 09/05/2020
Answer 11/22/2018 expected 11/01/2019
Skipping the batch
Answer 02/02/2020 expected 02/01/2020
Answer 12/31/2014 expected 12/30/2014
Answer 02/22/2007 expected 02/21/2017
Answer 10/17/1924 expected 10/16/1924
Answer 06/02/1943 expected 06/02/1943
Answer 01/02/2007 expected 01/02/2007
Answer 01/22/2020 expected 01/02/2020
Answer 6/18/2018 expected 06/18/2018
Answer 11/21/2001 expected 11/21/2002
Answer 4/12/1969 expected 04/12/1969
Answer 02/26/1973 expected 02/23/1973
Answer 6/25/2019 expected 06/25/2019
index 1 start communication
index 5 start communication
index 3 start communication
Answer 02/03/2020 expected 02/03/2020
Answer 08/01/2021 expected 08/08/2021
Answer 7/7/1972 expected 07/07/1972
index 7 start communication
index 6 start communication
Answer 07/09/2017 expected 06/18/2017
Answer 03/12/2001 expected 03/12/2001
Answer 9/16/1924 expected 09/15/1924
index 2 start communication
Answer 02/29/2016 expected 02/28/2016
index 0 start communication
Skipping the batch
index 4 start communication
Here are the statistics for inference
+--------+----------------+---------------------------+-----------------------------+---------------+-------------+---------+--------------------------------+------------------+----------------------------------+-----------------------+----------------------+
| Task   |   Num Sentence |   Total Generation Length |   Average Generation Length |   Total Steps |   Num Steps |     AAL |   Total Roll Back Length Error |   Error Instance |   Average Roll Back Length Error |   Effective Tree Size |   Drafting Tree Size |
+========+================+===========================+=============================+===============+=============+=========+================================+==================+==================================+=======================+======================+
| date   |            353 |                     34376 |                     97.3824 |         29097 |        2555 | 11.3883 |                          11783 |             1214 |                          9.70593 |                    16 |                    1 |
+--------+----------------+---------------------------+-----------------------------+---------------+-------------+---------+--------------------------------+------------------+----------------------------------+-----------------------+----------------------+
Namespace(tasks='csqa,strategyqa,sports,date', model='meta-llama/Llama-2-13b-chat-hf', device='cuda:0', limit=None, griffin=False, cats=True, check=True, kernel_size=16, spr=0.3, thr=0.1, widthtree=1, patternstrict=True, shotfive=True, shottwo=False, filteractiveenabled=False)
+------------+---------+-----------+--------------+
| Task       |   Total |   Correct |   Solve Rate |
+============+=========+===========+==============+
| csqa       |    1221 |       821 |     0.6724   |
+------------+---------+-----------+--------------+
| strategyqa |     457 |       315 |     0.689278 |
+------------+---------+-----------+--------------+
| sports     |     970 |       706 |     0.727835 |
+------------+---------+-----------+--------------+
| date       |     353 |       184 |     0.521246 |
+------------+---------+-----------+--------------+
Here are the statistics for inference
Here are the statistics for inference
Here are the statistics for inference
Here are the statistics for inference
Here are the statistics for inference
Here are the statistics for inference
Here are the statistics for inference
