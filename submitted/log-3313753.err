Already on 'addinggriffin'
error: cannot lock ref 'refs/remotes/origin/addinggriffin': is at 207605f24ff00ff03720e24c6d7297fea7fed5b1 but expected 3a2f7c2bda0cafa5fa6545352c8ece3bbdccfbb2
From github.com:YangZhou08/CommonSenseReasoning
 ! 3a2f7c2..207605f  addinggriffin -> origin/addinggriffin  (unable to update local ref)
error: Your local changes to the following files would be overwritten by merge:
	aqua_cot_prompts_5shot.txt
Please commit your changes or stash them before you merge.
error: The following untracked working tree files would be overwritten by merge:
	aqua_cot_prompts_5shot_old.txt
Please move or remove them before you merge.
Aborting
wandb: Currently logged in as: stevenzhou0816100. Use `wandb login --relogin` to force relogin
The following values were not passed to `accelerate launch` and had defaults used instead:
		More than one GPU was found, enabling multi-GPU training.
		If this was unintended please pass in `--num_processes=1`.
	`--mixed_precision` was set to a value of `'no'`
	`--dynamo_backend` was set to a value of `'no'`
To avoid this warning pass in values for each of the problematic parameters or run `accelerate config`.
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:17<00:53, 17.74s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:17<00:52, 17.58s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:17<00:53, 17.70s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:17<00:53, 17.86s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:17<00:53, 17.74s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:17<00:53, 17.89s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:17<00:53, 17.78s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:17<00:53, 17.80s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:32<00:32, 16.21s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:32<00:32, 16.17s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:32<00:32, 16.12s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:32<00:32, 16.14s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:32<00:32, 16.10s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:32<00:32, 16.15s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:32<00:32, 16.17s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:33<00:32, 16.31s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:47<00:15, 15.53s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:48<00:15, 15.91s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:48<00:15, 16.00s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:48<00:15, 15.95s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:49<00:16, 16.31s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:48<00:15, 15.95s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:48<00:15, 15.93s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:48<00:15, 15.97s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:49<00:00, 10.27s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:49<00:00, 12.44s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:49<00:00, 10.20s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:49<00:00, 12.46s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:50<00:00, 10.26s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:50<00:00, 12.53s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:49<00:00, 10.22s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:50<00:00, 10.45s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:49<00:00, 12.46s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:50<00:00, 12.70s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:50<00:00, 10.25s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:50<00:00, 12.50s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:50<00:00, 10.25s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:50<00:00, 12.53s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:50<00:00, 10.26s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:50<00:00, 12.52s/it]
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:369: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:369: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:369: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:369: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:369: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:369: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:369: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:369: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
  3%|▎         | 1/32 [00:03<02:01,  3.93s/it]  3%|▎         | 1/32 [00:04<02:20,  4.52s/it]  6%|▋         | 2/32 [00:06<01:27,  2.91s/it]  3%|▎         | 1/32 [00:06<03:21,  6.51s/it]  6%|▋         | 2/32 [00:07<01:48,  3.61s/it]  6%|▋         | 2/32 [00:10<02:32,  5.09s/it]  3%|▎         | 1/32 [00:13<06:45, 13.08s/it]  6%|▋         | 2/32 [00:14<03:06,  6.22s/it]  9%|▉         | 3/32 [00:14<02:18,  4.77s/it]  9%|▉         | 3/32 [00:18<03:28,  7.20s/it] 12%|█▎        | 4/32 [00:25<03:11,  6.83s/it]  3%|▎         | 1/32 [00:31<16:01, 31.03s/it]  3%|▎         | 1/32 [00:31<16:15, 31.47s/it]  3%|▎         | 1/32 [00:31<16:07, 31.22s/it]  6%|▋         | 2/32 [00:35<07:41, 15.38s/it]  9%|▉         | 3/32 [00:36<04:22,  9.04s/it] 12%|█▎        | 4/32 [00:40<03:10,  6.79s/it]  3%|▎         | 1/32 [00:40<20:47, 40.26s/it]  3%|▎         | 1/32 [00:41<21:20, 41.30s/it]
 16%|█▌        | 5/32 [00:42<04:46, 10.63s/it]  9%|▉         | 3/32 [00:44<08:10, 16.90s/it]  6%|▋         | 2/32 [00:45<10:38, 21.27s/it] 12%|█▎        | 4/32 [00:50<05:53, 12.64s/it] 16%|█▌        | 5/32 [00:52<03:54,  8.69s/it]  9%|▉         | 3/32 [00:57<11:58, 24.77s/it] 12%|█▎        | 4/32 [01:05<10:33, 22.64s/it]  6%|▋         | 2/32 [01:10<17:16, 34.54s/it] 19%|█▉        | 6/32 [01:11<07:22, 17.01s/it]  9%|▉         | 3/32 [01:13<09:45, 20.18s/it] 22%|██▏       | 7/32 [01:15<05:17, 12.71s/it]  9%|▉         | 3/32 [01:15<12:11, 25.22s/it] 12%|█▎        | 4/32 [01:17<06:21, 13.61s/it] 25%|██▌       | 8/32 [01:19<03:54,  9.78s/it] 16%|█▌        | 5/32 [01:19<08:24, 18.68s/it] 16%|█▌        | 5/32 [01:20<04:24,  9.80s/it] 19%|█▉        | 6/32 [01:21<06:46, 15.65s/it] 19%|█▉        | 6/32 [01:21<02:57,  6.82s/it] 12%|█▎        | 4/32 [01:23<09:43, 20.86s/it]
 22%|██▏       | 7/32 [01:25<02:27,  5.91s/it] 28%|██▊       | 9/32 [01:29<03:45,  9.81s/it] 12%|█▎        | 4/32 [01:39<14:44, 31.59s/it] 12%|█▎        | 4/32 [01:45<12:38, 27.08s/it] 19%|█▉        | 6/32 [01:49<09:41, 22.36s/it] 22%|██▏       | 7/32 [01:50<08:21, 20.07s/it] 25%|██▌       | 8/32 [01:54<05:19, 13.33s/it] 31%|███▏      | 10/32 [01:58<05:48, 15.86s/it] 34%|███▍      | 11/32 [02:00<04:06, 11.72s/it] 16%|█▌        | 5/32 [02:10<14:07, 31.38s/it] 16%|█▌        | 5/32 [02:15<12:39, 28.13s/it] 22%|██▏       | 7/32 [02:18<10:16, 24.68s/it] 25%|██▌       | 8/32 [02:19<09:11, 22.98s/it] 25%|██▌       | 8/32 [02:20<06:57, 17.39s/it] 28%|██▊       | 9/32 [02:21<06:14, 16.28s/it] 28%|██▊       | 9/32 [02:23<07:00, 18.30s/it] 31%|███▏      | 10/32 [02:25<04:49, 13.16s/it] 34%|███▍      | 11/32 [02:26<03:19,  9.49s/it] 38%|███▊      | 12/32 [02:30<05:42, 17.12s/it] 19%|█▉        | 6/32 [02:41<13:33, 31.28s/it] 22%|██▏       | 7/32 [02:45<09:19, 22.38s/it] 19%|█▉        | 6/32 [02:45<12:26, 28.73s/it] 28%|██▊       | 9/32 [02:49<08:07, 21.17s/it] 22%|██▏       | 7/32 [02:49<08:38, 20.73s/it] 31%|███▏      | 10/32 [02:50<07:25, 20.26s/it] 31%|███▏      | 10/32 [02:51<05:32, 15.12s/it] 34%|███▍      | 11/32 [02:53<05:12, 14.89s/it] 34%|███▍      | 11/32 [02:53<03:51, 11.01s/it] 25%|██▌       | 8/32 [02:53<06:07, 15.31s/it] 38%|███▊      | 12/32 [02:55<03:42, 11.11s/it] 38%|███▊      | 12/32 [02:55<05:09, 15.48s/it] 41%|████      | 13/32 [02:59<03:44, 11.82s/it] 41%|████      | 13/32 [02:59<06:35, 20.84s/it] 44%|████▍     | 14/32 [03:03<04:40, 15.61s/it] 47%|████▋     | 15/32 [03:05<03:18, 11.67s/it] 50%|█████     | 16/32 [03:09<02:29,  9.32s/it] 53%|█████▎    | 17/32 [03:11<01:45,  7.03s/it] 56%|█████▋    | 18/32 [03:14<01:21,  5.80s/it] 25%|██▌       | 8/32 [03:16<10:03, 25.14s/it] 59%|█████▉    | 19/32 [03:16<01:02,  4.78s/it] 62%|██████▎   | 20/32 [03:22<01:00,  5.01s/it] 38%|███▊      | 12/32 [03:22<05:31, 16.60s/it] 28%|██▊       | 9/32 [03:23<07:37, 19.90s/it] 41%|████      | 13/32 [03:24<05:14, 16.55s/it] 66%|██████▌   | 21/32 [03:27<00:54,  4.96s/it] 69%|██████▉   | 22/32 [03:28<00:38,  3.83s/it] 44%|████▍     | 14/32 [03:28<05:07, 17.09s/it] 47%|████▋     | 15/32 [03:30<03:30, 12.37s/it] 28%|██▊       | 9/32 [03:47<10:20, 27.00s/it] 50%|█████     | 16/32 [03:49<03:52, 14.52s/it] 41%|████      | 13/32 [03:51<06:29, 20.49s/it] 31%|███▏      | 10/32 [03:53<08:25, 22.96s/it] 44%|████▍     | 14/32 [03:54<06:06, 20.37s/it] 53%|█████▎    | 17/32 [03:54<02:54, 11.64s/it] 47%|████▋     | 15/32 [03:55<04:08, 14.61s/it] 34%|███▍      | 11/32 [03:55<05:47, 16.55s/it] 72%|███████▏  | 23/32 [03:57<01:43, 11.46s/it] 56%|█████▋    | 18/32 [03:58<02:10,  9.33s/it] 78%|███████▊  | 25/32 [03:59<00:46,  6.67s/it] 59%|█████▉    | 19/32 [04:01<01:36,  7.39s/it] 31%|███▏      | 10/32 [04:18<10:21, 28.25s/it] 44%|████▍     | 14/32 [04:21<06:56, 23.15s/it] 34%|███▍      | 11/32 [04:21<07:13, 20.63s/it] 47%|████▋     | 15/32 [04:23<04:45, 16.79s/it] 50%|█████     | 16/32 [04:24<05:03, 19.00s/it] 38%|███▊      | 12/32 [04:24<06:51, 20.58s/it] 81%|████████▏ | 26/32 [04:29<01:13, 12.30s/it] 41%|████      | 13/32 [04:29<04:57, 15.64s/it] 62%|██████▎   | 20/32 [04:30<02:47, 13.94s/it] 84%|████████▍ | 27/32 [04:30<00:47,  9.51s/it] 50%|█████     | 16/32 [04:34<04:01, 15.12s/it] 88%|████████▊ | 28/32 [04:43<00:41, 10.37s/it] 66%|██████▌   | 21/32 [04:43<02:29, 13.61s/it] 38%|███▊      | 12/32 [04:52<07:56, 23.82s/it] 53%|█████▎    | 17/32 [04:53<05:30, 22.06s/it] 44%|████▍     | 14/32 [04:58<05:58, 19.92s/it] 53%|█████▎    | 17/32 [05:03<04:50, 19.40s/it] 56%|█████▋    | 18/32 [05:07<03:23, 14.53s/it] 59%|█████▉    | 19/32 [05:10<02:26, 11.29s/it] 47%|████▋     | 15/32 [05:11<05:00, 17.68s/it] 69%|██████▉   | 22/32 [05:12<03:02, 18.26s/it] 91%|█████████ | 29/32 [05:12<00:47, 15.69s/it] 62%|██████▎   | 20/32 [05:13<01:43,  8.65s/it] 72%|███████▏  | 23/32 [05:13<01:58, 13.15s/it] 50%|█████     | 16/32 [05:15<03:39, 13.72s/it] 75%|███████▌  | 24/32 [05:18<01:25, 10.71s/it] 53%|█████▎    | 17/32 [05:19<02:41, 10.79s/it] 56%|█████▋    | 18/32 [05:22<05:37, 24.14s/it] 78%|███████▊  | 25/32 [05:22<01:01,  8.75s/it] 41%|████      | 13/32 [05:24<08:14, 26.02s/it] 56%|█████▋    | 18/32 [05:24<02:02,  8.78s/it] 94%|█████████▍| 30/32 [05:30<00:32, 16.40s/it] 97%|█████████▋| 31/32 [05:33<00:12, 12.37s/it]100%|██████████| 32/32 [05:35<00:00,  9.41s/it]100%|██████████| 32/32 [05:35<00:00, 10.49s/it]
 66%|██████▌   | 21/32 [05:42<02:44, 14.91s/it] 59%|█████▉    | 19/32 [05:51<05:33, 25.65s/it] 81%|████████▏ | 26/32 [05:52<01:29, 14.87s/it] 59%|█████▉    | 19/32 [05:53<03:16, 15.12s/it] 44%|████▍     | 14/32 [05:55<08:16, 27.58s/it] 84%|████████▍ | 27/32 [05:55<00:57, 11.51s/it] 62%|██████▎   | 20/32 [05:55<02:12, 11.06s/it] 69%|██████▉   | 22/32 [05:56<02:26, 14.64s/it] 47%|████▋     | 15/32 [05:57<05:38, 19.91s/it] 66%|██████▌   | 21/32 [05:57<01:30,  8.22s/it] 88%|████████▊ | 28/32 [05:58<00:35,  8.89s/it] 72%|███████▏  | 23/32 [05:58<01:36, 10.73s/it] 91%|█████████ | 29/32 [06:01<00:21,  7.13s/it] 75%|███████▌  | 24/32 [06:02<01:09,  8.65s/it] 62%|██████▎   | 20/32 [06:02<04:14, 21.17s/it] 94%|█████████▍| 30/32 [06:03<00:11,  5.62s/it] 97%|█████████▋| 31/32 [06:06<00:04,  4.71s/it] 78%|███████▊  | 25/32 [06:16<01:12, 10.29s/it] 66%|██████▌   | 21/32 [06:17<03:33, 19.38s/it] 69%|██████▉   | 22/32 [06:23<02:32, 15.22s/it] 72%|███████▏  | 23/32 [06:24<01:39, 11.00s/it] 75%|███████▌  | 24/32 [06:27<01:08,  8.54s/it] 69%|██████▉   | 22/32 [06:26<02:26, 14.67s/it] 50%|█████     | 16/32 [06:28<06:12, 23.30s/it] 78%|███████▊  | 25/32 [06:29<00:46,  6.67s/it]100%|██████████| 32/32 [06:35<00:00, 11.97s/it]100%|██████████| 32/32 [06:35<00:00, 12.35s/it]
 81%|████████▏ | 26/32 [06:45<01:36, 16.00s/it] 72%|███████▏  | 23/32 [06:56<02:51, 19.08s/it] 81%|████████▏ | 26/32 [06:58<01:19, 13.33s/it] 75%|███████▌  | 24/32 [06:58<01:52, 14.07s/it] 53%|█████▎    | 17/32 [06:59<06:25, 25.69s/it] 78%|███████▊  | 25/32 [07:04<01:21, 11.62s/it] 81%|████████▏ | 26/32 [07:06<00:52,  8.71s/it] 84%|████████▍ | 27/32 [07:14<01:39, 19.98s/it] 84%|████████▍ | 27/32 [07:15<00:43,  8.72s/it] 88%|████████▊ | 28/32 [07:16<00:57, 14.48s/it] 88%|████████▊ | 28/32 [07:17<00:27,  6.86s/it] 84%|████████▍ | 27/32 [07:27<01:30, 18.05s/it] 56%|█████▋    | 18/32 [07:31<06:23, 27.37s/it] 88%|████████▊ | 28/32 [07:32<00:56, 14.24s/it] 59%|█████▉    | 19/32 [07:32<04:15, 19.66s/it] 94%|█████████▍| 30/32 [07:38<00:17,  8.98s/it] 97%|█████████▋| 31/32 [07:42<00:07,  7.71s/it]100%|██████████| 32/32 [07:43<00:00,  6.04s/it]100%|██████████| 32/32 [07:43<00:00, 14.49s/it]
 91%|█████████ | 29/32 [07:46<00:40, 13.60s/it] 91%|█████████ | 29/32 [07:48<00:59, 19.70s/it] 94%|█████████▍| 30/32 [07:51<00:22, 11.03s/it] 97%|█████████▋| 31/32 [07:55<00:08,  8.74s/it]100%|██████████| 32/32 [08:00<00:00,  7.67s/it]100%|██████████| 32/32 [08:00<00:00, 15.02s/it]
 62%|██████▎   | 20/32 [08:03<04:36, 23.05s/it] 94%|█████████▍| 30/32 [08:26<00:50, 25.24s/it] 66%|██████▌   | 21/32 [08:34<04:40, 25.48s/it] 97%|█████████▋| 31/32 [08:40<00:21, 21.85s/it]100%|██████████| 32/32 [08:48<00:00, 17.58s/it]100%|██████████| 32/32 [08:48<00:00, 16.51s/it]
 69%|██████▉   | 22/32 [09:05<04:31, 27.17s/it] 72%|███████▏  | 23/32 [09:09<03:00, 20.05s/it] 72%|███████▏  | 23/32 [09:12<03:36, 24.01s/it]
[rank6]:[E ProcessGroupNCCL.cpp:523] [Rank 6] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=53, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600074 milliseconds before timing out.
[rank6]:[E ProcessGroupNCCL.cpp:537] Some NCCL operations have failed or timed out. Due to the asynchronous nature of CUDA kernels, subsequent GPU operations might run on corrupted/incomplete data.
[rank6]:[E ProcessGroupNCCL.cpp:543] To avoid data inconsistency, we are taking the entire process down.
[rank6]:[E ProcessGroupNCCL.cpp:1182] [Rank 6] NCCL watchdog thread terminated with exception: [Rank 6] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=53, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600074 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:525 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7fb502cb9d87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x1e6 (0x7fb503e616e6 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::workCleanupLoop() + 0x19d (0x7fb503e64c3d in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x119 (0x7fb503e65839 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd6df4 (0x7fb54db78df4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #5: <unknown function> + 0x8609 (0x7fb54ef6c609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #6: clone + 0x43 (0x7fb54ed37353 in /lib/x86_64-linux-gnu/libc.so.6)

terminate called after throwing an instance of 'c10::DistBackendError'
  what():  [Rank 6] NCCL watchdog thread terminated with exception: [Rank 6] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=53, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600074 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:525 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7fb502cb9d87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x1e6 (0x7fb503e616e6 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::workCleanupLoop() + 0x19d (0x7fb503e64c3d in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x119 (0x7fb503e65839 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd6df4 (0x7fb54db78df4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #5: <unknown function> + 0x8609 (0x7fb54ef6c609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #6: clone + 0x43 (0x7fb54ed37353 in /lib/x86_64-linux-gnu/libc.so.6)

Exception raised from ncclCommWatchdog at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:1186 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7fb502cb9d87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0xdf6b11 (0x7fb503bbbb11 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: <unknown function> + 0xd6df4 (0x7fb54db78df4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #3: <unknown function> + 0x8609 (0x7fb54ef6c609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #4: clone + 0x43 (0x7fb54ed37353 in /lib/x86_64-linux-gnu/libc.so.6)

[rank4]:[E ProcessGroupNCCL.cpp:523] [Rank 4] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=53, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600435 milliseconds before timing out.
[2024-07-11 06:08:04,419] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 2069097 closing signal SIGTERM
[2024-07-11 06:08:04,419] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 2069101 closing signal SIGTERM
[2024-07-11 06:08:04,420] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 2069102 closing signal SIGTERM
[2024-07-11 06:08:04,420] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 2069104 closing signal SIGTERM
[2024-07-11 06:08:05,649] torch.distributed.elastic.multiprocessing.api: [ERROR] failed (exitcode: -6) local_rank: 6 (pid: 2069103) of binary: /fsx-storygen/beidic/anaconda3/envs/griffin/bin/python3.9
Traceback (most recent call last):
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/bin/accelerate", line 8, in <module>
    sys.exit(main())
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/accelerate/commands/accelerate_cli.py", line 47, in main
    args.func(args)
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/accelerate/commands/launch.py", line 985, in launch_command
    multi_gpu_launcher(args)
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/accelerate/commands/launch.py", line 654, in multi_gpu_launcher
    distrib_run.run(args)
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/distributed/run.py", line 803, in run
    elastic_launch(
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 135, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 268, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
========================================================
main.py FAILED
--------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
--------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-11_06:08:04
  host      : a100-st-p4de24xlarge-693.fair-a100.hpcaas
  rank      : 6 (local_rank: 6)
  exitcode  : -6 (pid: 2069103)
  error_file: <N/A>
  traceback : Signal 6 (SIGABRT) received by PID 2069103
========================================================
