fatal: Unable to create '/fsx-storygen/beidic/yang/GRIFFIN2/.git/index.lock': File exists.

Another git process seems to be running in this repository, e.g.
an editor opened by 'git commit'. Please make sure all processes
are terminated then try again. If it still fails, a git process
may have crashed in this repository earlier:
remove the file manually to continue.
fatal: Unable to create '/fsx-storygen/beidic/yang/GRIFFIN2/.git/index.lock': File exists.

Another git process seems to be running in this repository, e.g.
an editor opened by 'git commit'. Please make sure all processes
are terminated then try again. If it still fails, a git process
may have crashed in this repository earlier:
remove the file manually to continue.
From github.com:Infini-AI-Lab/GRIFFIN2
   1fd5359..be9525c  yangexppp22 -> origin/yangexppp22
wandb: Currently logged in as: stevenzhou0816100. Use `wandb login --relogin` to force relogin
2024-08-05:18:57:17,614 INFO     [main.py:288] Verbosity set to INFO
2024-08-05:18:57:27,590 WARNING  [main.py:303]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2024-08-05:18:57:27,591 INFO     [main.py:378] Selected Tasks: ['mmlu_flan_cot_fewshot']
2024-08-05:18:57:27,624 INFO     [xevaluator.py:137] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2024-08-05:18:57:27,624 INFO     [xevaluator.py:184] Initializing xhf model, with arguments: {'pretrained': 'meta-llama/Meta-Llama-3-8B-Instruct', 'griffin': False, 'check': False, 'contextlength': 1500, 'kernel_size': 16, 'thr': 0.05}
2024-08-05:18:57:27,634 INFO     [xhuggingface.py:177] Using device 'cuda'
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:06<00:18,  6.11s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:12<00:12,  6.19s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:18<00:06,  6.18s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:20<00:00,  4.37s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:20<00:00,  5.03s/it]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
2024-08-05:18:58:09,449 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_prehistory on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 600.39it/s]
2024-08-05:18:58:09,457 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_logical_fallacies on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 578.11it/s]
2024-08-05:18:58:09,464 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_us_history on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 392.77it/s]
2024-08-05:18:58:09,475 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_international_law on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 575.71it/s]
2024-08-05:18:58:09,483 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_professional_law on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 472.81it/s]
2024-08-05:18:58:09,492 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_moral_disputes on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 583.76it/s]
2024-08-05:18:58:09,500 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_jurisprudence on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 605.28it/s]
2024-08-05:18:58:09,507 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_world_history on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 481.23it/s]
2024-08-05:18:58:09,516 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_moral_scenarios on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 606.77it/s]
2024-08-05:18:58:09,523 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_philosophy on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 621.31it/s]
2024-08-05:18:58:09,530 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_formal_logic on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 536.73it/s]
2024-08-05:18:58:09,538 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_world_religions on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 652.35it/s]
2024-08-05:18:58:09,545 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_european_history on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 347.58it/s]
2024-08-05:18:58:09,558 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_human_sexuality on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 635.26it/s]
2024-08-05:18:58:09,565 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_econometrics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 525.19it/s]
2024-08-05:18:58:09,573 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_macroeconomics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 614.71it/s]
2024-08-05:18:58:09,580 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_geography on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 625.04it/s]
2024-08-05:18:58:09,587 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_security_studies on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 510.32it/s]
2024-08-05:18:58:09,596 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_psychology on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 595.78it/s]
2024-08-05:18:58:09,604 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_microeconomics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 617.08it/s]
2024-08-05:18:58:09,611 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_government_and_politics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 599.16it/s]
2024-08-05:18:58:09,618 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_professional_psychology on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 566.87it/s]
2024-08-05:18:58:09,625 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_public_relations on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 622.92it/s]
2024-08-05:18:58:09,632 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_us_foreign_policy on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 615.50it/s]
2024-08-05:18:58:09,639 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_sociology on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 525.37it/s]
2024-08-05:18:58:09,648 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_global_facts on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 590.00it/s]
2024-08-05:18:58:09,655 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_professional_medicine on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 537.25it/s]
2024-08-05:18:58:09,663 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_business_ethics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 539.70it/s]
2024-08-05:18:58:09,671 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_medicine on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 547.67it/s]
2024-08-05:18:58:09,679 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_management on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 633.84it/s]
2024-08-05:18:58:09,686 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_human_aging on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 640.18it/s]
2024-08-05:18:58:09,693 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_marketing on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 620.87it/s]
2024-08-05:18:58:09,700 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_nutrition on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 593.69it/s]
2024-08-05:18:58:09,707 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_virology on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 637.46it/s]
2024-08-05:18:58:09,714 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_professional_accounting on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 567.99it/s]
2024-08-05:18:58:09,722 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_miscellaneous on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 642.95it/s]
2024-08-05:18:58:09,729 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_medical_genetics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 629.56it/s]
2024-08-05:18:58:09,735 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_clinical_knowledge on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 624.83it/s]
2024-08-05:18:58:09,742 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_mathematics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 559.11it/s]
2024-08-05:18:58:09,750 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_elementary_mathematics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 604.87it/s]
2024-08-05:18:58:09,757 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_statistics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 564.45it/s]
2024-08-05:18:58:09,765 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_astronomy on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 551.59it/s]
2024-08-05:18:58:09,773 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_electrical_engineering on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 606.88it/s]
2024-08-05:18:58:09,780 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_abstract_algebra on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 609.15it/s]
2024-08-05:18:58:09,787 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_machine_learning on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 533.08it/s]
2024-08-05:18:58:09,795 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_computer_science on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 507.55it/s]
2024-08-05:18:58:09,804 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_biology on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 551.72it/s]
2024-08-05:18:58:09,812 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_anatomy on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 537.39it/s]
2024-08-05:18:58:09,820 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_physics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 591.00it/s]
2024-08-05:18:58:09,827 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_computer_science on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 504.29it/s]
2024-08-05:18:58:09,836 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_conceptual_physics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 597.52it/s]
2024-08-05:18:58:09,843 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_mathematics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 602.13it/s]
2024-08-05:18:58:09,850 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_computer_security on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 602.59it/s]
2024-08-05:18:58:09,857 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_chemistry on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 593.25it/s]
2024-08-05:18:58:09,865 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_physics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 606.64it/s]
2024-08-05:18:58:09,872 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_chemistry on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 585.43it/s]
2024-08-05:18:58:09,879 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_biology on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 540.22it/s]
2024-08-05:18:58:09,887 INFO     [xevaluator.py:395] Running generate_until requests
Running generate_until requests:   0%|          | 0/228 [00:00<?, ?it/s]Running generate_until requests:   0%|          | 1/228 [00:12<48:45, 12.89s/it]Running generate_until requests:   1%|          | 2/228 [00:33<1:06:30, 17.66s/it]Running generate_until requests:   1%|▏         | 3/228 [00:44<54:31, 14.54s/it]  Running generate_until requests:   2%|▏         | 4/228 [00:57<51:07, 13.69s/it]Running generate_until requests:   2%|▏         | 5/228 [01:45<1:36:48, 26.05s/it]Running generate_until requests:   3%|▎         | 6/228 [02:32<2:03:41, 33.43s/it]Running generate_until requests:   3%|▎         | 7/228 [03:21<2:21:39, 38.46s/it]Running generate_until requests:   4%|▎         | 8/228 [04:10<2:33:10, 41.77s/it]Running generate_until requests:   4%|▍         | 9/228 [04:59<2:41:16, 44.18s/it]Running generate_until requests:   4%|▍         | 10/228 [05:49<2:46:12, 45.74s/it]Running generate_until requests:   5%|▍         | 11/228 [06:38<2:48:53, 46.70s/it]Running generate_until requests:   5%|▌         | 12/228 [07:26<2:50:29, 47.36s/it]Running generate_until requests:   6%|▌         | 13/228 [08:16<2:51:44, 47.93s/it]Running generate_until requests:   6%|▌         | 14/228 [09:05<2:52:15, 48.29s/it]Running generate_until requests:   7%|▋         | 15/228 [09:54<2:52:13, 48.51s/it]Running generate_until requests:   7%|▋         | 16/228 [10:43<2:52:08, 48.72s/it]Running generate_until requests:   7%|▋         | 17/228 [11:32<2:51:23, 48.74s/it]Running generate_until requests:   8%|▊         | 18/228 [12:20<2:50:26, 48.70s/it]Running generate_until requests:   8%|▊         | 19/228 [13:09<2:49:59, 48.80s/it]Running generate_until requests:   9%|▉         | 20/228 [13:59<2:49:39, 48.94s/it]Running generate_until requests:   9%|▉         | 21/228 [14:48<2:48:56, 48.97s/it]Running generate_until requests:  10%|▉         | 22/228 [14:56<2:06:15, 36.77s/it]Running generate_until requests:  10%|█         | 23/228 [15:45<2:18:17, 40.48s/it]Running generate_until requests:  11%|█         | 24/228 [16:34<2:26:23, 43.06s/it]Running generate_until requests:  11%|█         | 25/228 [17:23<2:31:34, 44.80s/it]Running generate_until requests:  11%|█▏        | 26/228 [18:12<2:34:53, 46.01s/it]Running generate_until requests:  12%|█▏        | 27/228 [19:01<2:36:57, 46.85s/it]Running generate_until requests:  12%|█▏        | 28/228 [19:50<2:38:11, 47.46s/it]Running generate_until requests:  13%|█▎        | 29/228 [20:41<2:41:38, 48.74s/it]Running generate_until requests:  13%|█▎        | 30/228 [21:33<2:43:55, 49.67s/it]Running generate_until requests:  14%|█▎        | 31/228 [22:24<2:44:18, 50.04s/it]Running generate_until requests:  14%|█▍        | 32/228 [23:13<2:42:30, 49.75s/it]Running generate_until requests:  14%|█▍        | 33/228 [24:04<2:42:38, 50.04s/it]Running generate_until requests:  15%|█▍        | 34/228 [24:54<2:42:00, 50.10s/it]Running generate_until requests:  15%|█▌        | 35/228 [25:44<2:40:38, 49.94s/it]Running generate_until requests:  16%|█▌        | 36/228 [26:36<2:41:32, 50.48s/it]Running generate_until requests:  16%|█▌        | 37/228 [27:24<2:38:54, 49.92s/it]Running generate_until requests:  17%|█▋        | 38/228 [28:13<2:36:55, 49.55s/it]Running generate_until requests:  17%|█▋        | 39/228 [29:02<2:35:26, 49.35s/it]Running generate_until requests:  18%|█▊        | 40/228 [29:50<2:34:04, 49.17s/it]Running generate_until requests:  18%|█▊        | 41/228 [30:39<2:32:52, 49.05s/it]Running generate_until requests:  18%|█▊        | 42/228 [31:27<2:31:17, 48.80s/it]Running generate_until requests:  19%|█▉        | 43/228 [32:16<2:30:32, 48.83s/it]Running generate_until requests:  19%|█▉        | 44/228 [33:05<2:29:41, 48.81s/it]Running generate_until requests:  20%|█▉        | 45/228 [33:54<2:28:57, 48.84s/it]Running generate_until requests:  20%|██        | 46/228 [34:43<2:28:03, 48.81s/it]Running generate_until requests:  21%|██        | 47/228 [35:32<2:27:20, 48.84s/it]Running generate_until requests:  21%|██        | 48/228 [36:21<2:26:48, 48.94s/it]