Already on 'addinggriffin'
wandb: Currently logged in as: stevenzhou0816100. Use `wandb login --relogin` to force relogin
The following values were not passed to `accelerate launch` and had defaults used instead:
		More than one GPU was found, enabling multi-GPU training.
		If this was unintended please pass in `--num_processes=1`.
	`--mixed_precision` was set to a value of `'no'`
	`--dynamo_backend` was set to a value of `'no'`
To avoid this warning pass in values for each of the problematic parameters or run `accelerate config`.
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:57<00:57, 57.57s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:59<00:59, 59.99s/it]Loading checkpoint shards:  50%|█████     | 1/2 [01:00<01:00, 60.06s/it]Loading checkpoint shards:  50%|█████     | 1/2 [01:00<01:00, 60.25s/it]Loading checkpoint shards:  50%|█████     | 1/2 [01:00<01:00, 60.01s/it]Loading checkpoint shards:  50%|█████     | 1/2 [01:00<01:00, 60.02s/it]Loading checkpoint shards:  50%|█████     | 1/2 [01:00<01:00, 60.09s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:59<00:59, 59.81s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:09<00:00, 30.95s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:09<00:00, 34.94s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [01:10<00:00, 30.98s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:10<00:00, 35.33s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [01:10<00:00, 31.01s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:10<00:00, 35.37s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [01:10<00:00, 31.09s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:10<00:00, 35.46s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [01:10<00:00, 30.99s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:10<00:00, 35.35s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [01:10<00:00, 30.99s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:10<00:00, 35.34s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [01:16<00:00, 34.41s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:16<00:00, 38.26s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [01:16<00:00, 34.34s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:16<00:00, 38.16s/it]
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:403: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:403: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:403: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:403: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:403: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:403: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:403: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:403: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
  3%|▎         | 1/32 [00:27<14:03, 27.21s/it]  3%|▎         | 1/32 [00:28<14:51, 28.74s/it]  3%|▎         | 1/32 [00:29<15:22, 29.75s/it]  3%|▎         | 1/32 [00:30<15:52, 30.73s/it]  3%|▎         | 1/32 [00:34<17:48, 34.47s/it]  3%|▎         | 1/32 [00:36<19:01, 36.82s/it]  3%|▎         | 1/32 [00:54<28:06, 54.41s/it]  3%|▎         | 1/32 [00:57<29:39, 57.39s/it]  6%|▋         | 2/32 [00:58<14:55, 29.85s/it]  6%|▋         | 2/32 [01:02<15:39, 31.31s/it]  6%|▋         | 2/32 [01:02<15:37, 31.24s/it]  6%|▋         | 2/32 [01:02<15:49, 31.64s/it]  6%|▋         | 2/32 [01:06<16:24, 32.82s/it]  6%|▋         | 2/32 [01:16<19:11, 38.38s/it]  9%|▉         | 3/32 [01:21<12:31, 25.93s/it]  9%|▉         | 3/32 [01:22<13:01, 26.95s/it]  9%|▉         | 3/32 [01:27<13:41, 28.31s/it]  9%|▉         | 3/32 [01:36<15:43, 32.54s/it]  9%|▉         | 3/32 [01:40<16:06, 33.33s/it]  9%|▉         | 3/32 [01:47<16:59, 35.14s/it] 12%|█▎        | 4/32 [01:53<13:06, 28.11s/it]  6%|▋         | 2/32 [01:53<28:40, 57.35s/it] 12%|█▎        | 4/32 [01:55<13:41, 29.32s/it]  6%|▋         | 2/32 [01:55<28:57, 57.91s/it] 12%|█▎        | 4/32 [01:59<13:55, 29.85s/it] 12%|█▎        | 4/32 [02:10<15:03, 32.27s/it] 12%|█▎        | 4/32 [02:10<15:37, 33.48s/it] 12%|█▎        | 4/32 [02:21<16:12, 34.74s/it] 16%|█▌        | 5/32 [02:26<13:03, 29.03s/it] 16%|█▌        | 5/32 [02:27<13:40, 30.37s/it] 16%|█▌        | 5/32 [02:30<14:06, 31.36s/it] 16%|█▌        | 5/32 [02:41<14:32, 32.31s/it] 16%|█▌        | 5/32 [02:43<14:32, 32.30s/it]  9%|▉         | 3/32 [02:45<26:26, 54.70s/it]  9%|▉         | 3/32 [02:48<26:47, 55.42s/it] 16%|█▌        | 5/32 [02:48<14:19, 31.84s/it] 19%|█▉        | 6/32 [02:56<12:38, 29.17s/it] 19%|█▉        | 6/32 [02:59<13:22, 30.85s/it] 19%|█▉        | 6/32 [03:08<14:32, 33.57s/it] 19%|█▉        | 6/32 [03:08<13:16, 30.62s/it] 19%|█▉        | 6/32 [03:17<14:15, 32.90s/it] 19%|█▉        | 6/32 [03:20<13:47, 31.84s/it] 22%|██▏       | 7/32 [03:27<12:24, 29.77s/it] 22%|██▏       | 7/32 [03:27<12:29, 29.99s/it] 22%|██▏       | 7/32 [03:30<11:35, 27.84s/it] 12%|█▎        | 4/32 [03:38<25:18, 54.25s/it] 22%|██▏       | 7/32 [03:39<13:45, 33.01s/it] 12%|█▎        | 4/32 [03:46<26:25, 56.62s/it] 22%|██▏       | 7/32 [03:49<13:38, 32.75s/it] 22%|██▏       | 7/32 [03:52<13:21, 32.07s/it] 25%|██▌       | 8/32 [03:55<11:46, 29.46s/it] 25%|██▌       | 8/32 [04:00<12:17, 30.74s/it] 25%|██▌       | 8/32 [04:02<11:35, 29.00s/it] 25%|██▌       | 8/32 [04:16<13:35, 33.99s/it] 25%|██▌       | 8/32 [04:17<12:27, 31.15s/it] 28%|██▊       | 9/32 [04:24<11:13, 29.27s/it] 25%|██▌       | 8/32 [04:25<12:52, 32.18s/it] 16%|█▌        | 5/32 [04:28<23:39, 52.59s/it] 28%|██▊       | 9/32 [04:33<11:24, 29.75s/it] 28%|██▊       | 9/32 [04:35<12:17, 32.07s/it] 28%|██▊       | 9/32 [04:43<11:19, 29.56s/it] 16%|█▌        | 5/32 [04:43<25:35, 56.88s/it] 28%|██▊       | 9/32 [04:53<13:26, 35.04s/it] 31%|███▏      | 10/32 [04:54<10:45, 29.33s/it] 31%|███▏      | 10/32 [05:06<11:13, 30.62s/it] 31%|███▏      | 10/32 [05:10<12:09, 33.16s/it] 31%|███▏      | 10/32 [05:15<11:09, 30.42s/it] 31%|███▏      | 10/32 [05:24<12:25, 33.87s/it] 34%|███▍      | 11/32 [05:24<10:24, 29.72s/it] 19%|█▉        | 6/32 [05:27<23:39, 54.58s/it] 28%|██▊       | 9/32 [05:30<16:15, 42.40s/it] 19%|█▉        | 6/32 [05:39<24:26, 56.39s/it] 34%|███▍      | 11/32 [05:41<11:22, 32.51s/it] 34%|███▍      | 11/32 [05:41<11:14, 32.12s/it] 34%|███▍      | 11/32 [05:42<10:14, 29.28s/it] 34%|███▍      | 11/32 [05:56<11:35, 33.10s/it] 38%|███▊      | 12/32 [06:00<10:28, 31.40s/it] 38%|███▊      | 12/32 [06:02<09:35, 28.77s/it] 31%|███▏      | 10/32 [06:04<14:41, 40.06s/it] 38%|███▊      | 12/32 [06:14<10:48, 32.42s/it] 38%|███▊      | 12/32 [06:15<10:07, 30.40s/it] 22%|██▏       | 7/32 [06:20<22:36, 54.26s/it] 38%|███▊      | 12/32 [06:26<10:46, 32.35s/it] 22%|██▏       | 7/32 [06:27<22:26, 53.85s/it] 41%|████      | 13/32 [06:33<10:08, 32.05s/it] 34%|███▍      | 11/32 [06:35<12:57, 37.02s/it] 41%|████      | 13/32 [06:35<09:31, 30.08s/it] 41%|████      | 13/32 [06:44<10:05, 31.88s/it] 41%|████      | 13/32 [06:45<09:38, 30.46s/it] 41%|████      | 13/32 [07:02<10:35, 33.45s/it] 44%|████▍     | 14/32 [07:04<08:56, 29.80s/it] 44%|████▍     | 14/32 [07:05<09:36, 32.00s/it] 38%|███▊      | 12/32 [07:07<11:53, 35.68s/it] 44%|████▍     | 14/32 [07:13<08:53, 29.66s/it] 25%|██▌       | 8/32 [07:14<21:37, 54.05s/it] 44%|████▍     | 14/32 [07:14<09:24, 31.39s/it] 25%|██▌       | 8/32 [07:20<21:22, 53.45s/it] 47%|████▋     | 15/32 [07:31<08:08, 28.73s/it] 44%|████▍     | 14/32 [07:34<09:54, 33.01s/it] 47%|████▋     | 15/32 [07:37<09:06, 32.13s/it] 41%|████      | 13/32 [07:40<10:59, 34.73s/it] 47%|████▋     | 15/32 [07:46<08:41, 30.67s/it] 47%|████▋     | 15/32 [07:49<09:07, 32.20s/it] 47%|████▋     | 15/32 [08:01<08:48, 31.07s/it] 50%|█████     | 16/32 [08:02<07:58, 29.94s/it] 28%|██▊       | 9/32 [08:05<20:25, 53.30s/it] 50%|█████     | 16/32 [08:07<08:15, 30.96s/it] 44%|████▍     | 14/32 [08:11<10:06, 33.71s/it] 50%|█████     | 16/32 [08:17<08:19, 31.19s/it] 28%|██▊       | 9/32 [08:22<21:33, 56.24s/it] 50%|█████     | 16/32 [08:25<08:50, 33.19s/it] 53%|█████▎    | 17/32 [08:32<07:20, 29.34s/it] 50%|█████     | 16/32 [08:33<08:23, 31.46s/it] 47%|████▋     | 15/32 [08:38<08:57, 31.60s/it] 53%|█████▎    | 17/32 [08:38<07:55, 31.70s/it] 53%|█████▎    | 17/32 [08:44<07:25, 29.70s/it] 31%|███▏      | 10/32 [08:48<18:20, 50.01s/it] 53%|█████▎    | 17/32 [09:04<07:48, 31.26s/it] 50%|█████     | 16/32 [09:05<08:05, 30.34s/it] 53%|█████▎    | 17/32 [09:07<08:55, 35.68s/it] 56%|█████▋    | 18/32 [09:08<07:17, 31.22s/it] 56%|█████▋    | 18/32 [09:09<07:21, 31.56s/it] 56%|█████▋    | 18/32 [09:13<06:52, 29.48s/it] 31%|███▏      | 10/32 [09:18<20:30, 55.95s/it] 34%|███▍      | 11/32 [09:33<17:01, 48.62s/it] 56%|█████▋    | 18/32 [09:34<07:12, 30.89s/it] 53%|█████▎    | 17/32 [09:36<07:36, 30.45s/it] 59%|█████▉    | 19/32 [09:37<06:35, 30.39s/it] 59%|█████▉    | 19/32 [09:40<06:48, 31.43s/it] 59%|█████▉    | 19/32 [09:42<06:21, 29.32s/it] 56%|█████▋    | 18/32 [09:47<08:37, 36.96s/it] 59%|█████▉    | 19/32 [10:02<06:31, 30.14s/it] 56%|█████▋    | 18/32 [10:04<06:57, 29.84s/it] 34%|███▍      | 11/32 [10:08<19:00, 54.30s/it] 62%|██████▎   | 20/32 [10:09<06:10, 30.85s/it] 62%|██████▎   | 20/32 [10:11<05:53, 29.44s/it] 62%|██████▎   | 20/32 [10:13<06:21, 31.78s/it] 59%|█████▉    | 19/32 [10:26<08:09, 37.68s/it] 38%|███▊      | 12/32 [10:27<16:43, 50.18s/it] 62%|██████▎   | 20/32 [10:31<05:55, 29.64s/it] 59%|█████▉    | 19/32 [10:36<06:36, 30.48s/it] 66%|██████▌   | 21/32 [10:42<05:48, 31.66s/it] 66%|██████▌   | 21/32 [10:43<05:46, 31.51s/it] 66%|██████▌   | 21/32 [10:45<05:37, 30.67s/it] 38%|███▊      | 12/32 [11:01<17:55, 53.77s/it] 66%|██████▌   | 21/32 [11:01<05:29, 29.95s/it] 62%|██████▎   | 20/32 [11:04<07:32, 37.69s/it] 62%|██████▎   | 20/32 [11:05<05:58, 29.85s/it] 41%|████      | 13/32 [11:15<15:38, 49.39s/it] 69%|██████▉   | 22/32 [11:15<05:06, 30.66s/it] 69%|██████▉   | 22/32 [11:18<05:28, 32.90s/it] 69%|██████▉   | 22/32 [11:19<05:26, 32.67s/it] 69%|██████▉   | 22/32 [11:25<04:38, 27.89s/it] 66%|██████▌   | 21/32 [11:43<05:55, 32.35s/it] 72%|███████▏  | 23/32 [11:43<04:28, 29.81s/it] 72%|███████▏  | 23/32 [11:43<04:31, 30.20s/it] 66%|██████▌   | 21/32 [11:44<07:01, 38.36s/it] 72%|███████▏  | 23/32 [11:49<04:50, 32.23s/it] 41%|████      | 13/32 [11:51<16:42, 52.76s/it] 72%|███████▏  | 23/32 [11:57<04:23, 29.27s/it] 44%|████▍     | 14/32 [12:04<14:50, 49.45s/it] 75%|███████▌  | 24/32 [12:12<03:57, 29.71s/it] 78%|███████▊  | 25/32 [12:13<02:40, 22.99s/it] 69%|██████▉   | 22/32 [12:16<05:25, 32.55s/it] 75%|███████▌  | 24/32 [12:19<04:13, 31.71s/it] 69%|██████▉   | 22/32 [12:22<06:24, 38.41s/it] 75%|███████▌  | 24/32 [12:28<03:57, 29.68s/it] 78%|███████▊  | 25/32 [12:39<03:22, 28.97s/it] 81%|████████▏ | 26/32 [12:41<02:25, 24.19s/it] 44%|████▍     | 14/32 [12:43<15:42, 52.34s/it] 72%|███████▏  | 23/32 [12:47<04:49, 32.18s/it] 78%|███████▊  | 25/32 [12:48<03:35, 30.84s/it] 47%|████▋     | 15/32 [12:51<13:46, 48.60s/it] 72%|███████▏  | 23/32 [12:57<05:35, 37.30s/it] 78%|███████▊  | 25/32 [13:02<03:37, 31.04s/it] 81%|████████▏ | 26/32 [13:14<03:04, 30.75s/it] 84%|████████▍ | 27/32 [13:16<02:15, 27.08s/it] 75%|███████▌  | 24/32 [13:18<04:13, 31.72s/it] 81%|████████▏ | 26/32 [13:21<03:07, 31.28s/it] 47%|████▋     | 15/32 [13:30<14:24, 50.88s/it] 81%|████████▏ | 26/32 [13:36<03:11, 31.95s/it] 75%|███████▌  | 24/32 [13:46<05:26, 40.78s/it] 78%|███████▊  | 25/32 [13:46<03:34, 30.63s/it] 88%|████████▊ | 28/32 [13:47<01:51, 27.92s/it] 84%|████████▍ | 27/32 [13:46<02:36, 31.29s/it] 84%|████████▍ | 27/32 [13:50<02:33, 30.74s/it] 50%|█████     | 16/32 [13:53<13:59, 52.48s/it] 88%|████████▊ | 28/32 [14:15<02:01, 30.43s/it] 84%|████████▍ | 27/32 [14:17<02:52, 34.58s/it] 78%|███████▊  | 25/32 [14:17<04:25, 37.94s/it] 81%|████████▏ | 26/32 [14:17<03:05, 30.84s/it] 88%|████████▊ | 28/32 [14:22<02:04, 31.04s/it] 91%|█████████ | 29/32 [14:22<01:30, 30.12s/it] 50%|█████     | 16/32 [14:31<14:19, 53.73s/it] 84%|████████▍ | 27/32 [14:45<02:29, 29.82s/it] 94%|█████████▍| 30/32 [14:46<00:46, 23.48s/it] 53%|█████▎    | 17/32 [14:46<13:11, 52.77s/it] 81%|████████▏ | 26/32 [14:48<03:34, 35.69s/it] 94%|█████████▍| 30/32 [14:50<00:58, 29.33s/it] 88%|████████▊ | 28/32 [14:51<02:17, 34.40s/it] 91%|█████████ | 29/32 [14:58<01:37, 32.49s/it] 97%|█████████▋| 31/32 [15:17<00:28, 28.86s/it] 88%|████████▊ | 28/32 [15:20<02:05, 31.47s/it] 53%|█████▎    | 17/32 [15:20<13:06, 52.43s/it] 97%|█████████▋| 31/32 [15:21<00:26, 26.44s/it] 84%|████████▍ | 27/32 [15:23<02:58, 35.66s/it] 91%|█████████ | 29/32 [15:26<01:44, 34.75s/it] 94%|█████████▍| 30/32 [15:30<01:05, 32.60s/it] 56%|█████▋    | 18/32 [15:35<12:05, 51.79s/it]100%|██████████| 32/32 [15:45<00:00, 25.90s/it]100%|██████████| 32/32 [15:45<00:00, 29.56s/it]
100%|██████████| 32/32 [15:51<00:00, 30.24s/it]100%|██████████| 32/32 [15:51<00:00, 29.73s/it]
 91%|█████████ | 29/32 [15:52<01:35, 31.78s/it] 88%|████████▊ | 28/32 [15:56<02:19, 34.77s/it] 94%|█████████▍| 30/32 [16:00<01:08, 34.50s/it] 97%|█████████▋| 31/32 [16:03<00:32, 32.68s/it] 56%|█████▋    | 18/32 [16:13<12:17, 52.69s/it] 94%|█████████▍| 30/32 [16:19<01:00, 30.23s/it] 91%|█████████ | 29/32 [16:24<01:38, 32.87s/it] 59%|█████▉    | 19/32 [16:27<11:12, 51.69s/it] 97%|█████████▋| 31/32 [16:32<00:33, 33.72s/it]100%|██████████| 32/32 [16:37<00:00, 32.86s/it]100%|██████████| 32/32 [16:37<00:00, 31.16s/it]
 97%|█████████▋| 31/32 [16:50<00:30, 30.53s/it]100%|██████████| 32/32 [16:55<00:00, 30.59s/it]100%|██████████| 32/32 [16:55<00:00, 31.74s/it]
 59%|█████▉    | 19/32 [16:57<10:49, 49.95s/it] 94%|█████████▍| 30/32 [16:57<01:05, 32.95s/it]100%|██████████| 32/32 [17:17<00:00, 29.34s/it]100%|██████████| 32/32 [17:17<00:00, 32.42s/it]
 62%|██████▎   | 20/32 [17:25<10:44, 53.72s/it] 97%|█████████▋| 31/32 [17:30<00:32, 32.96s/it] 62%|██████▎   | 20/32 [17:54<10:25, 52.16s/it]100%|██████████| 32/32 [18:05<00:00, 33.34s/it]100%|██████████| 32/32 [18:05<00:00, 33.91s/it]
 66%|██████▌   | 21/32 [18:18<09:46, 53.33s/it] 66%|██████▌   | 21/32 [18:50<09:44, 53.16s/it] 69%|██████▉   | 22/32 [19:02<08:27, 50.73s/it] 69%|██████▉   | 22/32 [19:36<08:31, 51.15s/it] 72%|███████▏  | 23/32 [19:56<07:44, 51.59s/it] 72%|███████▏  | 23/32 [20:22<07:25, 49.48s/it] 75%|███████▌  | 24/32 [20:48<06:52, 51.55s/it] 75%|███████▌  | 24/32 [21:07<06:26, 48.30s/it] 78%|███████▊  | 25/32 [21:42<06:07, 52.45s/it] 78%|███████▊  | 25/32 [22:03<05:54, 50.71s/it] 81%|████████▏ | 26/32 [22:44<05:32, 55.44s/it] 81%|████████▏ | 26/32 [22:56<05:07, 51.21s/it] 84%|████████▍ | 27/32 [23:25<04:15, 51.02s/it] 84%|████████▍ | 27/32 [23:47<04:16, 51.27s/it] 88%|████████▊ | 28/32 [24:18<03:25, 51.49s/it] 88%|████████▊ | 28/32 [24:45<03:32, 53.06s/it] 91%|█████████ | 29/32 [25:11<02:36, 52.15s/it] 91%|█████████ | 29/32 [25:35<02:36, 52.27s/it][rank5]:[E ProcessGroupNCCL.cpp:523] [Rank 5] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=48, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600741 milliseconds before timing out.
[rank5]:[E ProcessGroupNCCL.cpp:537] Some NCCL operations have failed or timed out. Due to the asynchronous nature of CUDA kernels, subsequent GPU operations might run on corrupted/incomplete data.
[rank5]:[E ProcessGroupNCCL.cpp:543] To avoid data inconsistency, we are taking the entire process down.
[rank5]:[E ProcessGroupNCCL.cpp:1182] [Rank 5] NCCL watchdog thread terminated with exception: [Rank 5] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=48, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600741 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:525 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7fb14701ad87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x1e6 (0x7fb1481c26e6 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::workCleanupLoop() + 0x19d (0x7fb1481c5c3d in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x119 (0x7fb1481c6839 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd6df4 (0x7fb191ed9df4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #5: <unknown function> + 0x8609 (0x7fb1932c8609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #6: clone + 0x43 (0x7fb193093353 in /lib/x86_64-linux-gnu/libc.so.6)

terminate called after throwing an instance of 'c10::DistBackendError'
  what():  [Rank 5] NCCL watchdog thread terminated with exception: [Rank 5] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=48, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600741 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:525 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7fb14701ad87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x1e6 (0x7fb1481c26e6 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::workCleanupLoop() + 0x19d (0x7fb1481c5c3d in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x119 (0x7fb1481c6839 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd6df4 (0x7fb191ed9df4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #5: <unknown function> + 0x8609 (0x7fb1932c8609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #6: clone + 0x43 (0x7fb193093353 in /lib/x86_64-linux-gnu/libc.so.6)

Exception raised from ncclCommWatchdog at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:1186 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7fb14701ad87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0xdf6b11 (0x7fb147f1cb11 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: <unknown function> + 0xd6df4 (0x7fb191ed9df4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #3: <unknown function> + 0x8609 (0x7fb1932c8609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #4: clone + 0x43 (0x7fb193093353 in /lib/x86_64-linux-gnu/libc.so.6)

[2024-07-09 16:12:49,846] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 730267 closing signal SIGTERM
[2024-07-09 16:12:49,848] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 730268 closing signal SIGTERM
[2024-07-09 16:12:49,848] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 730269 closing signal SIGTERM
[2024-07-09 16:12:49,849] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 730270 closing signal SIGTERM
[2024-07-09 16:12:49,849] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 730271 closing signal SIGTERM
[2024-07-09 16:12:49,849] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 730273 closing signal SIGTERM
[2024-07-09 16:12:49,849] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 730274 closing signal SIGTERM
[2024-07-09 16:12:51,306] torch.distributed.elastic.multiprocessing.api: [ERROR] failed (exitcode: -6) local_rank: 5 (pid: 730272) of binary: /fsx-storygen/beidic/anaconda3/envs/griffin/bin/python3.9
Traceback (most recent call last):
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/bin/accelerate", line 8, in <module>
    sys.exit(main())
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/accelerate/commands/accelerate_cli.py", line 47, in main
    args.func(args)
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/accelerate/commands/launch.py", line 985, in launch_command
    multi_gpu_launcher(args)
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/accelerate/commands/launch.py", line 654, in multi_gpu_launcher
    distrib_run.run(args)
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/distributed/run.py", line 803, in run
    elastic_launch(
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 135, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 268, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
=======================================================
main.py FAILED
-------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
-------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-09_16:12:49
  host      : a100-st-p4de24xlarge-277.fair-a100.hpcaas
  rank      : 5 (local_rank: 5)
  exitcode  : -6 (pid: 730272)
  error_file: <N/A>
  traceback : Signal 6 (SIGABRT) received by PID 730272
=======================================================
