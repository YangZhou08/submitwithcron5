No local changes to save
Your branch is up to date with 'origin/yangex3'.
Updating b37e829..14b0465
Fast-forward
 debugging1.sh                            |  3 ++-
 llama12_static_cache_sdpa_with_check.py  |  1 +
 llama12_static_cache_sdpa_with_check3.py |  7 +++---
 llama12_static_cache_sdpa_with_treee.py  | 38 ++++++++++++++++++++------------
 xhuggingface.py                          |  4 ++--
 5 files changed, 33 insertions(+), 20 deletions(-)
Already up to date.
/fsx-storygen/beidic/anaconda3/envs/griffin/bin/python
/fsx-storygen/beidic/anaconda3/envs/griffin/bin/python
The token has not been saved to the git credentials helper. Pass `add_to_git_credential=True` in this function directly or `--add-to-git-credential` if using via `huggingface-cli` if you want to set the git credential as well.
Token is valid (permission: fineGrained).
Your token has been saved to /data/home/beidic/.cache/huggingface/token
Login successful
Namespace(model='xhf', tasks='gsm8k_cot', model_args='pretrained=meta-llama/Meta-Llama-3-8B-Instruct,griffin=True,check=False,contextlength=1500,kernel_size=16,thr=0.05', num_fewshot=None, batch_size='1', max_batch_size=None, device=None, output_path=None, limit=0.3, topp=1.1, topk=64, spr=0.25, sink=8, local=256, use_cache=None, cache_requests=None, check_integrity=False, write_out=False, log_samples=False, show_config=False, include_path=None, gen_kwargs=None, verbosity='INFO', wandb_args='', predict_only=False, seed=[0, 1234, 1234], trust_remote_code=False)
SDPA
before the first token, free memory 16060552192
input_ids shape torch.Size([1, 789])
after the first token, free memory 22263672320
warming up
time taken for a single forward pass 0.00963137149810791
after g allocated memory 22241747456
executinginputidsfull shape torch.Size([1, 16])
full time taken for a single forward pass 0.013155221939086914
after gfull allocated memory 22237644800
after measuring the time allocated memory 21840565760
acceptance length on average 14.2
time taken for a single forward pass 0.9162318706512451
after the generation allocated memory 21839638528
per token generation time 0.011597871780395508
before the first token, free memory 21831923200
input_ids shape torch.Size([1, 781])
after the first token, free memory 28015221760
warming up
time taken for a single forward pass 0.009614825248718262
after g allocated memory 27993891840
executinginputidsfull shape torch.Size([1, 16])
full time taken for a single forward pass 0.013170742988586425
after gfull allocated memory 27989789184
after measuring the time allocated memory 27596814336
acceptance length on average 15.0
time taken for a single forward pass 0.8208765983581543
after the generation allocated memory 27595887104
per token generation time 0.010994357398793668
before the first token, free memory 27588163072
input_ids shape torch.Size([1, 781])
after the first token, free memory 33771076608
warming up
time taken for a single forward pass 0.009643650054931641
after g allocated memory 33749746688
executinginputidsfull shape torch.Size([1, 16])
full time taken for a single forward pass 0.013169288635253906
after gfull allocated memory 33745644032
after measuring the time allocated memory 33352669184
acceptance length on average 14.5
time taken for a single forward pass 0.9484589099884033
after the generation allocated memory 33351741952
per token generation time 0.011331507928260771
before the first token, free memory 33344017920
input_ids shape torch.Size([1, 781])
after the first token, free memory 39526677504
warming up
time taken for a single forward pass 0.009609627723693847
after g allocated memory 39505347584
executinginputidsfull shape torch.Size([1, 16])
full time taken for a single forward pass 0.013217830657958984
after gfull allocated memory 39501244928
after measuring the time allocated memory 39108270080
acceptance length on average 13.19047619047619
time taken for a single forward pass 1.2220213413238525
after the generation allocated memory 39107342848
per token generation time 0.01236578708962549
before the first token, free memory 39099618816
input_ids shape torch.Size([1, 780])
after the first token, free memory 45282007040
warming up
time taken for a single forward pass 0.009646844863891602
after g allocated memory 45260709888
executinginputidsfull shape torch.Size([1, 16])
full time taken for a single forward pass 0.013171911239624023
after gfull allocated memory 45256607232
after measuring the time allocated memory 44863748096
acceptance length on average 13.5
time taken for a single forward pass 0.8876137733459473
after the generation allocated memory 44862820864
per token generation time 0.012139753148525577
before the first token, free memory 44855096832
input_ids shape torch.Size([1, 778])
after the first token, free memory 51036151808
warming up
time taken for a single forward pass 0.009609222412109375
after g allocated memory 51014887424
executinginputidsfull shape torch.Size([1, 16])
full time taken for a single forward pass 0.01316525936126709
after gfull allocated memory 51010784768
after measuring the time allocated memory 50619348992
acceptance length on average 13.21875
time taken for a single forward pass 1.0838143825531006
after the generation allocated memory 50618421760
per token generation time 0.012402989190339036
before the first token, free memory 50610697728
input_ids shape torch.Size([1, 775])
after the first token, free memory 56791046144
warming up
time taken for a single forward pass 0.009606099128723145
after g allocated memory 56769814528
executinginputidsfull shape torch.Size([1, 16])
full time taken for a single forward pass 0.013173675537109375
after gfull allocated memory 56765711872
after measuring the time allocated memory 56374949888
acceptance length on average 13.527777777777779
time taken for a single forward pass 0.8235714435577393
after the generation allocated memory 56374022656
per token generation time 0.012120412874825393
before the first token, free memory 56366298624
input_ids shape torch.Size([1, 772])
after the first token, free memory 62544484352
warming up
time taken for a single forward pass 0.009669685363769531
after g allocated memory 62523318272
executinginputidsfull shape torch.Size([1, 16])
full time taken for a single forward pass 0.013167595863342286
after gfull allocated memory 62519215616
after measuring the time allocated memory 62130550784
acceptance length on average 13.536585365853659
time taken for a single forward pass 0.9542312622070312
after the generation allocated memory 62129623552
per token generation time 0.012115220857571952
before the first token, free memory 62121898496
input_ids shape torch.Size([1, 768])
