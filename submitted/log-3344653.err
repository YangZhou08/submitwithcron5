wandb: Currently logged in as: stevenzhou0816100. Use `wandb login --relogin` to force relogin
The following values were not passed to `accelerate launch` and had defaults used instead:
		More than one GPU was found, enabling multi-GPU training.
		If this was unintended please pass in `--num_processes=1`.
	`--num_machines` was set to a value of `1`
	`--mixed_precision` was set to a value of `'no'`
	`--dynamo_backend` was set to a value of `'no'`
To avoid this warning pass in values for each of the problematic parameters or run `accelerate config`.
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:51<00:51, 51.40s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:52<00:52, 52.66s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:52<00:52, 52.67s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:53<00:53, 53.37s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:52<00:52, 52.79s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:52<00:52, 52.68s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:52<00:52, 52.69s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:52<00:52, 52.90s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:11<00:00, 32.41s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:11<00:00, 35.55s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [01:11<00:00, 32.77s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:11<00:00, 35.79s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [01:11<00:00, 32.68s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:11<00:00, 35.68s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [01:11<00:00, 32.69s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:11<00:00, 35.69s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [01:11<00:00, 32.73s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:11<00:00, 35.74s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [01:11<00:00, 32.68s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:11<00:00, 35.68s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [01:11<00:00, 32.99s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:11<00:00, 35.75s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [01:11<00:00, 32.82s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:11<00:00, 35.80s/it]
  0%|          | 0/21 [00:00<?, ?it/s]/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/bigcode-evaluation-harness/bigcode_eval/utils.py:119: UserWarning: n_copies (n_samples/batch_size) was changed from 1 to 2 because n_tasks isn't proportional to num devices
  warnings.warn(
  0%|          | 0/21 [00:00<?, ?it/s]  0%|          | 0/21 [00:00<?, ?it/s]  0%|          | 0/21 [00:00<?, ?it/s]  0%|          | 0/21 [00:00<?, ?it/s]  0%|          | 0/21 [00:00<?, ?it/s]  0%|          | 0/21 [00:00<?, ?it/s]  0%|          | 0/21 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.2` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.95` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:427: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.2` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.95` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:427: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.2` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.95` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:427: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.2` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.95` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:427: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.2` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.95` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:427: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.2` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.95` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:427: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.2` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.95` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:427: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.2` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.95` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:427: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
  5%|▍         | 1/21 [01:38<32:44, 98.22s/it]  5%|▍         | 1/21 [01:38<32:56, 98.83s/it]  5%|▍         | 1/21 [01:39<33:00, 99.01s/it]  5%|▍         | 1/21 [01:38<32:55, 98.78s/it]  5%|▍         | 1/21 [01:39<33:12, 99.63s/it]  5%|▍         | 1/21 [01:14<24:57, 74.89s/it]  5%|▍         | 1/21 [01:38<32:54, 98.71s/it]  5%|▍         | 1/21 [01:15<25:08, 75.44s/it] 10%|▉         | 2/21 [02:23<21:13, 67.03s/it] 10%|▉         | 2/21 [02:22<21:07, 66.71s/it] 10%|▉         | 2/21 [02:23<21:11, 66.94s/it] 10%|▉         | 2/21 [02:24<21:18, 67.28s/it] 10%|▉         | 2/21 [01:59<18:04, 57.10s/it] 10%|▉         | 2/21 [02:23<21:12, 66.96s/it] 10%|▉         | 2/21 [02:00<18:09, 57.33s/it] 10%|▉         | 2/21 [02:23<21:11, 66.91s/it] 14%|█▍        | 3/21 [03:11<17:28, 58.23s/it] 14%|█▍        | 3/21 [03:12<17:30, 58.37s/it] 14%|█▍        | 3/21 [03:11<17:27, 58.18s/it] 14%|█▍        | 3/21 [02:47<15:53, 52.96s/it] 14%|█▍        | 3/21 [03:10<17:25, 58.06s/it] 14%|█▍        | 3/21 [03:11<17:27, 58.19s/it] 14%|█▍        | 3/21 [02:47<15:51, 52.84s/it] 14%|█▍        | 3/21 [03:11<17:26, 58.17s/it] 19%|█▉        | 4/21 [04:21<17:46, 62.76s/it] 19%|█▉        | 4/21 [04:20<17:45, 62.65s/it] 19%|█▉        | 4/21 [04:20<17:46, 62.74s/it] 19%|█▉        | 4/21 [03:56<16:51, 59.49s/it] 19%|█▉        | 4/21 [03:57<16:52, 59.57s/it] 19%|█▉        | 4/21 [04:21<17:48, 62.84s/it] 19%|█▉        | 4/21 [04:20<17:46, 62.72s/it] 19%|█▉        | 4/21 [04:20<17:46, 62.73s/it] 24%|██▍       | 5/21 [04:56<15:53, 59.58s/it] 24%|██▍       | 5/21 [05:20<16:26, 61.67s/it] 24%|██▍       | 5/21 [05:20<16:26, 61.65s/it] 24%|██▍       | 5/21 [05:20<16:25, 61.60s/it] 24%|██▍       | 5/21 [05:20<16:26, 61.64s/it] 24%|██▍       | 5/21 [05:21<16:27, 61.72s/it] 24%|██▍       | 5/21 [05:20<16:26, 61.65s/it] 24%|██▍       | 5/21 [04:57<15:54, 59.63s/it] 29%|██▊       | 6/21 [06:08<14:13, 56.91s/it] 29%|██▊       | 6/21 [06:07<14:12, 56.86s/it] 29%|██▊       | 6/21 [06:08<14:13, 56.89s/it] 29%|██▊       | 6/21 [06:09<14:14, 56.94s/it] 29%|██▊       | 6/21 [06:08<14:13, 56.89s/it] 29%|██▊       | 6/21 [05:44<13:52, 55.53s/it] 29%|██▊       | 6/21 [05:44<13:53, 55.56s/it] 29%|██▊       | 6/21 [06:08<14:13, 56.89s/it] 33%|███▎      | 7/21 [07:02<13:01, 55.79s/it] 33%|███▎      | 7/21 [07:01<13:00, 55.75s/it] 33%|███▎      | 7/21 [07:01<13:00, 55.76s/it] 33%|███▎      | 7/21 [07:01<13:00, 55.76s/it] 33%|███▎      | 7/21 [06:37<12:47, 54.84s/it] 33%|███▎      | 7/21 [06:38<12:47, 54.86s/it] 33%|███▎      | 7/21 [07:01<13:00, 55.75s/it] 33%|███▎      | 7/21 [07:01<13:00, 55.73s/it] 38%|███▊      | 8/21 [07:54<11:49, 54.56s/it] 38%|███▊      | 8/21 [07:53<11:48, 54.53s/it] 38%|███▊      | 8/21 [07:53<11:48, 54.54s/it] 38%|███▊      | 8/21 [07:30<11:40, 53.92s/it] 38%|███▊      | 8/21 [07:53<11:48, 54.52s/it] 38%|███▊      | 8/21 [07:53<11:48, 54.53s/it] 38%|███▊      | 8/21 [07:29<11:40, 53.91s/it] 38%|███▊      | 8/21 [07:53<11:49, 54.54s/it] 43%|████▎     | 9/21 [09:07<12:05, 60.49s/it] 43%|████▎     | 9/21 [09:08<12:05, 60.50s/it] 43%|████▎     | 9/21 [09:07<12:05, 60.49s/it] 43%|████▎     | 9/21 [09:07<12:05, 60.48s/it] 43%|████▎     | 9/21 [09:07<12:05, 60.48s/it] 43%|████▎     | 9/21 [09:06<12:05, 60.47s/it] 43%|████▎     | 9/21 [08:43<12:00, 60.05s/it] 43%|████▎     | 9/21 [08:43<12:00, 60.06s/it] 48%|████▊     | 10/21 [10:08<11:07, 60.67s/it] 48%|████▊     | 10/21 [10:07<11:07, 60.67s/it] 48%|████▊     | 10/21 [10:08<11:07, 60.67s/it] 48%|████▊     | 10/21 [10:09<11:07, 60.68s/it] 48%|████▊     | 10/21 [10:08<11:07, 60.67s/it] 48%|████▊     | 10/21 [10:08<11:07, 60.67s/it] 48%|████▊     | 10/21 [09:44<11:04, 60.38s/it] 48%|████▊     | 10/21 [09:44<11:04, 60.37s/it] 52%|█████▏    | 11/21 [10:55<09:24, 56.50s/it] 52%|█████▏    | 11/21 [10:54<09:24, 56.49s/it] 52%|█████▏    | 11/21 [10:55<09:24, 56.50s/it] 52%|█████▏    | 11/21 [10:55<09:24, 56.50s/it] 52%|█████▏    | 11/21 [10:31<09:22, 56.29s/it] 52%|█████▏    | 11/21 [10:31<09:22, 56.30s/it] 52%|█████▏    | 11/21 [10:56<09:25, 56.50s/it] 52%|█████▏    | 11/21 [10:55<09:24, 56.50s/it] 57%|█████▋    | 12/21 [11:51<08:26, 56.28s/it] 57%|█████▋    | 12/21 [11:50<08:26, 56.28s/it] 57%|█████▋    | 12/21 [11:51<08:26, 56.28s/it] 57%|█████▋    | 12/21 [11:51<08:26, 56.28s/it] 57%|█████▋    | 12/21 [11:51<08:26, 56.28s/it] 57%|█████▋    | 12/21 [11:51<08:26, 56.29s/it] 57%|█████▋    | 12/21 [11:27<08:25, 56.14s/it] 57%|█████▋    | 12/21 [11:27<08:25, 56.14s/it] 62%|██████▏   | 13/21 [12:45<07:25, 55.72s/it] 62%|██████▏   | 13/21 [12:45<07:25, 55.72s/it] 62%|██████▏   | 13/21 [12:21<07:24, 55.62s/it] 62%|██████▏   | 13/21 [12:45<07:25, 55.72s/it] 62%|██████▏   | 13/21 [12:44<07:25, 55.71s/it] 62%|██████▏   | 13/21 [12:46<07:25, 55.72s/it] 62%|██████▏   | 13/21 [12:22<07:24, 55.62s/it] 62%|██████▏   | 13/21 [12:45<07:25, 55.72s/it]