wandb: Currently logged in as: stevenzhou0816100. Use `wandb login --relogin` to force relogin
The following values were not passed to `accelerate launch` and had defaults used instead:
		More than one GPU was found, enabling multi-GPU training.
		If this was unintended please pass in `--num_processes=1`.
	`--num_machines` was set to a value of `1`
	`--mixed_precision` was set to a value of `'no'`
	`--dynamo_backend` was set to a value of `'no'`
To avoid this warning pass in values for each of the problematic parameters or run `accelerate config`.
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:56<01:52, 56.44s/it]Loading checkpoint shards:  33%|███▎      | 1/3 [00:59<01:58, 59.35s/it]Loading checkpoint shards:  33%|███▎      | 1/3 [00:58<01:57, 58.50s/it]Loading checkpoint shards:  33%|███▎      | 1/3 [00:58<01:57, 58.53s/it]Loading checkpoint shards:  33%|███▎      | 1/3 [00:58<01:56, 58.45s/it]Loading checkpoint shards:  33%|███▎      | 1/3 [00:57<01:55, 57.99s/it]Loading checkpoint shards:  33%|███▎      | 1/3 [00:58<01:57, 58.66s/it]Loading checkpoint shards:  33%|███▎      | 1/3 [00:58<01:57, 58.76s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [01:40<00:48, 48.60s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [01:42<00:49, 49.87s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [01:41<00:49, 49.53s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [01:41<00:49, 49.31s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [01:41<00:49, 49.89s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [01:41<00:49, 49.50s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [01:41<00:49, 49.53s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [01:41<00:49, 49.50s/it]Loading checkpoint shards: 100%|██████████| 3/3 [02:04<00:00, 37.29s/it]Loading checkpoint shards: 100%|██████████| 3/3 [02:04<00:00, 41.36s/it]
Loading checkpoint shards: 100%|██████████| 3/3 [02:05<00:00, 37.73s/it]Loading checkpoint shards: 100%|██████████| 3/3 [02:05<00:00, 41.96s/it]
Loading checkpoint shards: 100%|██████████| 3/3 [02:04<00:00, 37.53s/it]Loading checkpoint shards: 100%|██████████| 3/3 [02:04<00:00, 37.42s/it]Loading checkpoint shards: 100%|██████████| 3/3 [02:04<00:00, 41.66s/it]
Loading checkpoint shards: 100%|██████████| 3/3 [02:04<00:00, 41.50s/it]
Loading checkpoint shards: 100%|██████████| 3/3 [02:05<00:00, 37.74s/it]Loading checkpoint shards: 100%|██████████| 3/3 [02:05<00:00, 41.67s/it]
Loading checkpoint shards: 100%|██████████| 3/3 [02:05<00:00, 37.55s/it]Loading checkpoint shards: 100%|██████████| 3/3 [02:05<00:00, 41.68s/it]
Loading checkpoint shards: 100%|██████████| 3/3 [02:05<00:00, 37.52s/it]Loading checkpoint shards: 100%|██████████| 3/3 [02:05<00:00, 41.67s/it]
Loading checkpoint shards: 100%|██████████| 3/3 [02:05<00:00, 37.54s/it]Loading checkpoint shards: 100%|██████████| 3/3 [02:05<00:00, 41.67s/it]
  0%|          | 0/48 [00:00<?, ?it/s]  0%|          | 0/48 [00:00<?, ?it/s]  0%|          | 0/48 [00:00<?, ?it/s]  0%|          | 0/48 [00:00<?, ?it/s]  0%|          | 0/48 [00:00<?, ?it/s]/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/bigcode-evaluation-harness/bigcode_eval/utils.py:119: UserWarning: n_copies (n_samples/batch_size) was changed from 1 to 2 because n_tasks isn't proportional to num devices
  warnings.warn(
  0%|          | 0/48 [00:00<?, ?it/s]  0%|          | 0/48 [00:00<?, ?it/s]  0%|          | 0/48 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.2` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.95` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:427: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.2` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.95` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:427: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.2` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.95` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:427: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.2` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.2` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.95` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.95` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:427: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:427: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.2` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.95` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:427: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.2` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.95` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:427: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.2` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.95` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:427: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `0` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
  2%|▏         | 1/48 [01:23<1:05:40, 83.85s/it]  2%|▏         | 1/48 [01:23<1:05:41, 83.87s/it]  2%|▏         | 1/48 [01:23<1:05:36, 83.76s/it]  2%|▏         | 1/48 [01:23<1:05:14, 83.28s/it]  2%|▏         | 1/48 [01:22<1:04:17, 82.08s/it]  2%|▏         | 1/48 [01:23<1:05:38, 83.79s/it]  2%|▏         | 1/48 [01:22<1:04:25, 82.24s/it]  2%|▏         | 1/48 [01:23<1:05:38, 83.79s/it]  4%|▍         | 2/48 [02:40<1:01:21, 80.04s/it]  4%|▍         | 2/48 [02:41<1:01:44, 80.54s/it]  4%|▍         | 2/48 [02:42<1:01:54, 80.74s/it]  4%|▍         | 2/48 [02:42<1:01:55, 80.78s/it]  4%|▍         | 2/48 [02:42<1:01:55, 80.77s/it]  4%|▍         | 2/48 [02:42<1:01:53, 80.73s/it]  4%|▍         | 2/48 [02:42<1:01:54, 80.74s/it]  4%|▍         | 2/48 [02:40<1:01:24, 80.10s/it]  6%|▋         | 3/48 [03:58<58:48, 78.42s/it]    6%|▋         | 3/48 [03:56<58:33, 78.07s/it]    6%|▋         | 3/48 [03:58<58:48, 78.41s/it]    6%|▋         | 3/48 [03:58<58:49, 78.44s/it]    6%|▋         | 3/48 [03:58<58:49, 78.43s/it]    6%|▋         | 3/48 [03:57<58:43, 78.31s/it]    6%|▋         | 3/48 [03:58<58:48, 78.42s/it]    6%|▋         | 3/48 [03:56<58:31, 78.04s/it]    8%|▊         | 4/48 [05:26<1:00:29, 82.49s/it]  8%|▊         | 4/48 [05:26<1:00:30, 82.50s/it]  8%|▊         | 4/48 [05:26<1:00:29, 82.49s/it]  8%|▊         | 4/48 [05:26<1:00:26, 82.43s/it]  8%|▊         | 4/48 [05:26<1:00:29, 82.49s/it]  8%|▊         | 4/48 [05:25<1:00:20, 82.28s/it]  8%|▊         | 4/48 [05:25<1:00:19, 82.26s/it]  8%|▊         | 4/48 [05:26<1:00:30, 82.51s/it] 10%|█         | 5/48 [06:45<58:04, 81.03s/it]   10%|█         | 5/48 [06:43<57:58, 80.90s/it]   10%|█         | 5/48 [06:45<58:04, 81.03s/it]   10%|█         | 5/48 [06:43<57:57, 80.88s/it]   10%|█         | 5/48 [06:45<58:04, 81.04s/it]   10%|█         | 5/48 [06:45<58:04, 81.03s/it]   10%|█         | 5/48 [06:44<58:02, 80.99s/it]   10%|█         | 5/48 [06:45<58:04, 81.03s/it]   12%|█▎        | 6/48 [07:49<52:43, 75.33s/it] 12%|█▎        | 6/48 [07:49<52:43, 75.33s/it] 12%|█▎        | 6/48 [07:47<52:39, 75.23s/it] 12%|█▎        | 6/48 [07:47<52:40, 75.24s/it] 12%|█▎        | 6/48 [07:49<52:43, 75.33s/it] 12%|█▎        | 6/48 [07:49<52:43, 75.33s/it] 12%|█▎        | 6/48 [07:49<52:43, 75.33s/it] 12%|█▎        | 6/48 [07:48<52:42, 75.30s/it] 15%|█▍        | 7/48 [09:03<51:06, 74.79s/it] 15%|█▍        | 7/48 [09:03<51:06, 74.79s/it] 15%|█▍        | 7/48 [09:03<51:06, 74.79s/it] 15%|█▍        | 7/48 [09:01<51:03, 74.73s/it] 15%|█▍        | 7/48 [09:03<51:06, 74.79s/it] 15%|█▍        | 7/48 [09:02<51:05, 74.77s/it] 15%|█▍        | 7/48 [09:03<51:06, 74.79s/it] 15%|█▍        | 7/48 [09:01<51:03, 74.72s/it] 17%|█▋        | 8/48 [10:14<49:02, 73.55s/it] 17%|█▋        | 8/48 [10:12<49:00, 73.51s/it] 17%|█▋        | 8/48 [10:13<49:01, 73.54s/it] 17%|█▋        | 8/48 [10:14<49:02, 73.56s/it] 17%|█▋        | 8/48 [10:14<49:02, 73.55s/it] 17%|█▋        | 8/48 [10:14<49:02, 73.55s/it] 17%|█▋        | 8/48 [10:12<49:00, 73.51s/it] 17%|█▋        | 8/48 [10:14<49:02, 73.56s/it] 19%|█▉        | 9/48 [11:17<45:44, 70.36s/it] 19%|█▉        | 9/48 [11:17<45:44, 70.36s/it] 19%|█▉        | 9/48 [11:15<45:42, 70.33s/it] 19%|█▉        | 9/48 [11:17<45:43, 70.36s/it] 19%|█▉        | 9/48 [11:17<45:44, 70.36s/it] 19%|█▉        | 9/48 [11:17<45:44, 70.36s/it] 19%|█▉        | 9/48 [11:15<45:42, 70.33s/it] 19%|█▉        | 9/48 [11:16<45:43, 70.35s/it] 21%|██        | 10/48 [12:55<50:02, 79.01s/it] 21%|██        | 10/48 [12:55<50:02, 79.00s/it] 21%|██        | 10/48 [12:54<50:01, 78.99s/it] 21%|██        | 10/48 [12:55<50:02, 79.01s/it] 21%|██        | 10/48 [12:55<50:02, 79.01s/it] 21%|██        | 10/48 [12:55<50:02, 79.01s/it] 21%|██        | 10/48 [12:55<50:02, 79.01s/it] 21%|██        | 10/48 [12:54<50:01, 78.99s/it] 23%|██▎       | 11/48 [14:31<52:12, 84.66s/it] 23%|██▎       | 11/48 [14:33<52:12, 84.67s/it] 23%|██▎       | 11/48 [14:33<52:12, 84.68s/it] 23%|██▎       | 11/48 [14:33<52:13, 84.68s/it] 23%|██▎       | 11/48 [14:31<52:12, 84.66s/it] 23%|██▎       | 11/48 [14:32<52:12, 84.67s/it] 23%|██▎       | 11/48 [14:33<52:13, 84.68s/it] 23%|██▎       | 11/48 [14:33<52:12, 84.68s/it] 25%|██▌       | 12/48 [15:36<47:12, 78.69s/it] 25%|██▌       | 12/48 [15:38<47:13, 78.70s/it] 25%|██▌       | 12/48 [15:38<47:13, 78.70s/it] 25%|██▌       | 12/48 [15:38<47:13, 78.70s/it] 25%|██▌       | 12/48 [15:38<47:13, 78.70s/it] 25%|██▌       | 12/48 [15:36<47:12, 78.69s/it] 25%|██▌       | 12/48 [15:37<47:13, 78.70s/it] 25%|██▌       | 12/48 [15:38<47:13, 78.70s/it] 27%|██▋       | 13/48 [16:38<42:47, 73.36s/it] 27%|██▋       | 13/48 [16:39<42:47, 73.36s/it] 27%|██▋       | 13/48 [16:39<42:47, 73.36s/it] 27%|██▋       | 13/48 [16:37<42:47, 73.35s/it] 27%|██▋       | 13/48 [16:39<42:47, 73.36s/it] 27%|██▋       | 13/48 [16:39<42:47, 73.36s/it] 27%|██▋       | 13/48 [16:37<42:47, 73.35s/it] 27%|██▋       | 13/48 [16:39<42:47, 73.36s/it]