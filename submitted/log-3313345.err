Already on 'addinggriffin'
wandb: Currently logged in as: stevenzhou0816100. Use `wandb login --relogin` to force relogin
The following values were not passed to `accelerate launch` and had defaults used instead:
		More than one GPU was found, enabling multi-GPU training.
		If this was unintended please pass in `--num_processes=1`.
	`--mixed_precision` was set to a value of `'no'`
	`--dynamo_backend` was set to a value of `'no'`
To avoid this warning pass in values for each of the problematic parameters or run `accelerate config`.
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:06<00:19,  6.37s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:06<00:19,  6.46s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:06<00:19,  6.41s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:06<00:19,  6.36s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:06<00:19,  6.34s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:06<00:19,  6.49s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:06<00:20,  6.72s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:06<00:20,  6.85s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:13<00:13,  6.77s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:13<00:13,  6.83s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:13<00:13,  6.80s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:13<00:13,  6.78s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:13<00:13,  6.81s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:13<00:13,  6.76s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:14<00:14,  7.09s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:14<00:14,  7.10s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:20<00:06,  6.76s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:20<00:06,  6.72s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:20<00:06,  6.75s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:20<00:06,  6.74s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:20<00:06,  6.78s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:20<00:06,  6.81s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:21<00:07,  7.06s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:21<00:07,  7.05s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:21<00:00,  4.69s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:21<00:00,  5.44s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:21<00:00,  4.68s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:21<00:00,  5.42s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:21<00:00,  4.67s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:21<00:00,  5.41s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:21<00:00,  4.68s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:21<00:00,  5.42s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:21<00:00,  4.69s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:21<00:00,  5.42s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:21<00:00,  4.70s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:21<00:00,  5.45s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:22<00:00,  4.90s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:22<00:00,  5.67s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:22<00:00,  4.90s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:22<00:00,  5.68s/it]
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:369: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:369: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:369: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:369: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:369: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:369: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:369: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:369: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
  3%|▎         | 1/32 [00:03<01:46,  3.44s/it]  3%|▎         | 1/32 [00:03<02:02,  3.96s/it]  3%|▎         | 1/32 [00:04<02:10,  4.22s/it]  6%|▋         | 2/32 [00:06<01:35,  3.19s/it]  6%|▋         | 2/32 [00:07<01:43,  3.45s/it]  6%|▋         | 2/32 [00:08<02:12,  4.42s/it]  3%|▎         | 1/32 [00:08<04:37,  8.96s/it]  9%|▉         | 3/32 [00:09<01:26,  2.98s/it]  9%|▉         | 3/32 [00:09<01:29,  3.10s/it]  6%|▋         | 2/32 [00:12<02:45,  5.52s/it]  9%|▉         | 3/32 [00:14<01:58,  4.07s/it] 12%|█▎        | 4/32 [00:17<02:15,  4.85s/it] 12%|█▎        | 4/32 [00:20<02:13,  4.75s/it] 16%|█▌        | 5/32 [00:20<01:54,  4.23s/it] 19%|█▉        | 6/32 [00:21<01:22,  3.16s/it] 22%|██▏       | 7/32 [00:22<01:04,  2.58s/it] 16%|█▌        | 5/32 [00:25<02:08,  4.77s/it]  3%|▎         | 1/32 [00:29<15:28, 29.97s/it]  3%|▎         | 1/32 [00:30<15:59, 30.95s/it]  6%|▋         | 2/32 [00:32<06:46, 13.56s/it] 19%|█▉        | 6/32 [00:33<02:33,  5.92s/it]  9%|▉         | 3/32 [00:35<04:21,  9.00s/it]  9%|▉         | 3/32 [00:38<07:42, 15.96s/it] 12%|█▎        | 4/32 [00:39<06:20, 13.60s/it]  3%|▎         | 1/32 [00:51<26:28, 51.25s/it]  3%|▎         | 1/32 [00:51<26:42, 51.70s/it] 25%|██▌       | 8/32 [00:52<04:28, 11.18s/it]  6%|▋         | 2/32 [00:55<11:53, 23.79s/it] 28%|██▊       | 9/32 [00:55<03:21,  8.77s/it] 31%|███▏      | 10/32 [00:57<02:24,  6.57s/it] 12%|█▎        | 4/32 [00:58<06:50, 14.65s/it]
 34%|███▍      | 11/32 [00:58<01:43,  4.92s/it]  6%|▋         | 2/32 [00:59<14:48, 29.62s/it]  6%|▋         | 2/32 [01:03<13:58, 27.94s/it] 12%|█▎        | 4/32 [01:06<08:07, 17.42s/it]  9%|▉         | 3/32 [01:06<08:36, 17.82s/it] 12%|█▎        | 4/32 [01:08<09:59, 21.41s/it] 22%|██▏       | 7/32 [01:11<06:56, 16.66s/it]  9%|▉         | 3/32 [01:12<09:24, 19.48s/it] 25%|██▌       | 8/32 [01:18<05:25, 13.55s/it] 28%|██▊       | 9/32 [01:21<03:51, 10.07s/it] 38%|███▊      | 12/32 [01:28<04:08, 12.40s/it]  9%|▉         | 3/32 [01:28<14:14, 29.46s/it] 41%|████      | 13/32 [01:31<03:00,  9.52s/it] 16%|█▌        | 5/32 [01:36<09:51, 21.92s/it] 16%|█▌        | 5/32 [01:37<10:56, 24.30s/it] 12%|█▎        | 4/32 [01:57<14:27, 30.99s/it] 12%|█▎        | 4/32 [01:58<13:44, 29.44s/it] 31%|███▏      | 10/32 [01:59<06:54, 18.83s/it] 44%|████▍     | 14/32 [02:00<04:39, 15.54s/it] 47%|████▋     | 15/32 [02:02<03:13, 11.40s/it] 12%|█▎        | 4/32 [02:03<14:56, 32.01s/it] 19%|█▉        | 6/32 [02:06<10:42, 24.71s/it] 19%|█▉        | 6/32 [02:07<11:19, 26.12s/it] 34%|███▍      | 11/32 [02:07<05:26, 15.54s/it] 38%|███▊      | 12/32 [02:11<03:55, 11.80s/it] 16%|█▌        | 5/32 [02:27<13:12, 29.37s/it] 50%|█████     | 16/32 [02:31<04:28, 16.81s/it] 53%|█████▎    | 17/32 [02:36<03:15, 13.05s/it] 22%|██▏       | 7/32 [02:36<11:01, 26.47s/it] 22%|██▏       | 7/32 [02:36<11:22, 27.28s/it] 25%|██▌       | 8/32 [02:39<07:37, 19.05s/it] 25%|██▌       | 8/32 [02:40<07:54, 19.76s/it] 56%|█████▋    | 18/32 [02:40<02:27, 10.54s/it] 28%|██▊       | 9/32 [02:43<05:35, 14.60s/it] 31%|███▏      | 10/32 [02:47<04:07, 11.26s/it] 59%|█████▉    | 19/32 [02:48<02:05,  9.65s/it] 16%|█▌        | 5/32 [02:48<17:14, 38.31s/it] 41%|████      | 13/32 [02:49<06:19, 19.97s/it] 34%|███▍      | 11/32 [02:49<02:59,  8.55s/it] 38%|███▊      | 12/32 [02:52<02:15,  6.78s/it] 16%|█▌        | 5/32 [02:55<17:33, 39.03s/it] 19%|█▉        | 6/32 [02:57<12:51, 29.66s/it] 44%|████▍     | 14/32 [02:58<04:58, 16.56s/it] 19%|█▉        | 6/32 [02:59<12:26, 28.71s/it] 47%|████▋     | 15/32 [03:02<03:37, 12.81s/it] 22%|██▏       | 7/32 [03:05<08:54, 21.38s/it] 28%|██▊       | 9/32 [03:09<08:37, 22.50s/it] 31%|███▏      | 10/32 [03:14<06:12, 16.94s/it] 62%|██████▎   | 20/32 [03:17<03:06, 15.54s/it] 34%|███▍      | 11/32 [03:17<04:28, 12.81s/it] 41%|████      | 13/32 [03:22<04:21, 13.74s/it] 38%|███▊      | 12/32 [03:24<03:40, 11.02s/it] 44%|████▍     | 14/32 [03:25<03:11, 10.63s/it] 22%|██▏       | 7/32 [03:26<12:17, 29.51s/it] 41%|████      | 13/32 [03:28<02:48,  8.87s/it] 25%|██▌       | 8/32 [03:28<08:19, 20.80s/it] 44%|████▍     | 14/32 [03:32<02:16,  7.57s/it] 50%|█████     | 16/32 [03:41<05:28, 20.56s/it] 53%|█████▎    | 17/32 [03:44<03:53, 15.53s/it] 19%|█▉        | 6/32 [03:46<18:40, 43.08s/it] 66%|██████▌   | 21/32 [03:47<03:36, 19.71s/it] 56%|█████▋    | 18/32 [03:47<02:43, 11.69s/it] 69%|██████▉   | 22/32 [03:52<02:33, 15.34s/it] 47%|████▋     | 15/32 [03:55<04:38, 16.36s/it] 72%|███████▏  | 23/32 [03:56<01:47, 11.92s/it] 25%|██▌       | 8/32 [03:56<12:19, 30.82s/it] 28%|██▊       | 9/32 [03:58<08:59, 23.46s/it] 31%|███▏      | 10/32 [04:00<06:14, 17.04s/it] 50%|█████     | 16/32 [04:00<03:29, 13.10s/it] 34%|███▍      | 11/32 [04:02<04:19, 12.34s/it] 47%|████▋     | 15/32 [04:03<04:04, 14.36s/it] 53%|█████▎    | 17/32 [04:02<02:26,  9.76s/it] 28%|██▊       | 9/32 [04:04<09:02, 23.57s/it] 56%|█████▋    | 18/32 [04:05<01:47,  7.71s/it] 31%|███▏      | 10/32 [04:07<06:23, 17.42s/it] 34%|███▍      | 11/32 [04:10<04:28, 12.81s/it] 59%|█████▉    | 19/32 [04:10<01:27,  6.77s/it] 75%|███████▌  | 24/32 [04:25<02:17, 17.18s/it] 59%|█████▉    | 19/32 [04:26<04:17, 19.78s/it] 62%|██████▎   | 20/32 [04:28<02:55, 14.59s/it] 78%|███████▊  | 25/32 [04:30<01:33, 13.36s/it] 38%|███▊      | 12/32 [04:31<05:49, 17.45s/it] 50%|█████     | 16/32 [04:33<05:05, 19.07s/it] 66%|██████▌   | 21/32 [04:35<02:13, 12.10s/it] 22%|██▏       | 7/32 [04:36<19:01, 45.65s/it] 62%|██████▎   | 20/32 [04:40<02:43, 13.61s/it] 53%|█████▎    | 17/32 [04:40<03:54, 15.66s/it] 34%|███▍      | 11/32 [04:41<08:56, 25.57s/it]
 25%|██▌       | 8/32 [04:43<13:14, 33.11s/it] 66%|██████▌   | 21/32 [04:43<01:56, 10.61s/it] 69%|██████▉   | 22/32 [04:45<01:21,  8.12s/it] 81%|████████▏ | 26/32 [04:59<01:49, 18.18s/it] 41%|████      | 13/32 [05:00<06:39, 21.01s/it] 44%|████▍     | 14/32 [05:04<04:42, 15.70s/it] 47%|████▋     | 15/32 [05:06<03:19, 11.75s/it] 56%|█████▋    | 18/32 [05:10<04:40, 20.01s/it] 59%|█████▉    | 19/32 [05:12<03:07, 14.41s/it] 69%|██████▉   | 22/32 [05:13<03:20, 20.05s/it] 28%|██▊       | 9/32 [05:15<12:32, 32.71s/it] 72%|███████▏  | 23/32 [05:15<02:11, 14.58s/it] 72%|███████▏  | 23/32 [05:15<02:10, 14.55s/it] 78%|███████▊  | 25/32 [05:19<01:00,  8.69s/it] 81%|████████▏ | 26/32 [05:24<00:47,  7.84s/it] 84%|████████▍ | 27/32 [05:28<01:47, 21.55s/it] 88%|████████▊ | 28/32 [05:32<01:04, 16.04s/it] 91%|█████████ | 29/32 [05:34<00:35, 11.99s/it] 94%|█████████▍| 30/32 [05:36<00:17,  8.90s/it] 50%|█████     | 16/32 [05:36<04:32, 17.02s/it] 97%|█████████▋| 31/32 [05:38<00:06,  6.87s/it] 53%|█████▎    | 17/32 [05:40<03:18, 13.21s/it] 62%|██████▎   | 20/32 [05:42<03:49, 19.12s/it] 56%|█████▋    | 18/32 [05:45<02:32, 10.88s/it] 31%|███▏      | 10/32 [05:46<11:50, 32.29s/it] 34%|███▍      | 11/32 [05:48<08:03, 23.00s/it] 59%|█████▉    | 19/32 [05:48<01:50,  8.52s/it] 38%|███▊      | 12/32 [05:51<05:41, 17.09s/it] 62%|██████▎   | 20/32 [05:52<01:22,  6.89s/it] 75%|███████▌  | 24/32 [05:54<02:54, 21.82s/it] 84%|████████▍ | 27/32 [05:54<01:07, 13.56s/it] 41%|████      | 13/32 [05:56<04:11, 13.22s/it] 78%|███████▊  | 25/32 [05:57<01:53, 16.18s/it] 88%|████████▊ | 28/32 [05:59<00:44, 11.24s/it] 91%|█████████ | 29/32 [06:06<00:30, 10.01s/it]100%|██████████| 32/32 [06:07<00:00, 13.64s/it]100%|██████████| 32/32 [06:07<00:00, 11.50s/it]
 66%|██████▌   | 21/32 [06:12<04:06, 22.39s/it] 66%|██████▌   | 21/32 [06:21<02:29, 13.58s/it] 69%|██████▉   | 22/32 [06:23<01:42, 10.21s/it] 72%|███████▏  | 23/32 [06:25<01:10,  7.83s/it] 44%|████▍     | 14/32 [06:27<05:35, 18.62s/it] 75%|███████▌  | 24/32 [06:29<00:52,  6.58s/it] 78%|███████▊  | 25/32 [06:34<00:41,  5.97s/it] 81%|████████▏ | 26/32 [06:35<02:17, 22.87s/it] 94%|█████████▍| 30/32 [06:35<00:31, 15.59s/it] 97%|█████████▋| 31/32 [06:37<00:11, 11.71s/it] 69%|██████▉   | 22/32 [06:41<04:05, 24.54s/it] 72%|███████▏  | 23/32 [06:45<02:42, 18.09s/it] 47%|████▋     | 15/32 [06:58<06:21, 22.46s/it] 81%|████████▏ | 26/32 [07:03<01:17, 12.93s/it] 50%|█████     | 16/32 [07:04<04:39, 17.47s/it] 84%|████████▍ | 27/32 [07:06<00:50, 10.14s/it]100%|██████████| 32/32 [07:07<00:00, 16.96s/it]100%|██████████| 32/32 [07:07<00:00, 13.36s/it]
 88%|████████▊ | 28/32 [07:08<00:30,  7.59s/it] 91%|█████████ | 29/32 [07:11<00:18,  6.12s/it] 84%|████████▍ | 27/32 [07:14<02:17, 27.56s/it] 75%|███████▌  | 24/32 [07:14<02:52, 21.54s/it] 94%|█████████▍| 30/32 [07:16<00:11,  5.82s/it] 88%|████████▊ | 28/32 [07:18<01:21, 20.44s/it] 97%|█████████▋| 31/32 [07:20<00:05,  5.33s/it] 94%|█████████▍| 30/32 [07:25<00:25, 12.72s/it] 97%|█████████▋| 31/32 [07:28<00:10, 10.33s/it]100%|██████████| 32/32 [07:29<00:00,  7.90s/it]100%|██████████| 32/32 [07:29<00:00, 14.05s/it]
 53%|█████▎    | 17/32 [07:35<05:23, 21.57s/it] 56%|█████▋    | 18/32 [07:37<03:36, 15.48s/it] 78%|███████▊  | 25/32 [07:44<02:47, 23.90s/it]100%|██████████| 32/32 [07:49<00:00, 12.47s/it]100%|██████████| 32/32 [07:49<00:00, 14.68s/it]
 81%|████████▏ | 26/32 [07:50<01:52, 18.71s/it] 84%|████████▍ | 27/32 [07:52<01:09, 13.80s/it] 88%|████████▊ | 28/32 [07:56<00:42, 10.71s/it] 59%|█████▉    | 19/32 [08:08<04:23, 20.29s/it] 59%|█████▉    | 19/32 [08:11<05:36, 25.88s/it]
 91%|█████████ | 29/32 [08:26<00:49, 16.37s/it] 94%|█████████▍| 30/32 [08:55<00:40, 20.33s/it] 97%|█████████▋| 31/32 [09:25<00:23, 23.12s/it]100%|██████████| 32/32 [09:27<00:00, 16.73s/it]100%|██████████| 32/32 [09:27<00:00, 17.72s/it]
[rank4]:[E ProcessGroupNCCL.cpp:523] [Rank 4] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=53, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600997 milliseconds before timing out.
[rank4]:[E ProcessGroupNCCL.cpp:537] Some NCCL operations have failed or timed out. Due to the asynchronous nature of CUDA kernels, subsequent GPU operations might run on corrupted/incomplete data.
[rank4]:[E ProcessGroupNCCL.cpp:543] To avoid data inconsistency, we are taking the entire process down.
[rank4]:[E ProcessGroupNCCL.cpp:1182] [Rank 4] NCCL watchdog thread terminated with exception: [Rank 4] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=53, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600997 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:525 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7f9e6a65fd87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x1e6 (0x7f9e6b8076e6 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::workCleanupLoop() + 0x19d (0x7f9e6b80ac3d in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x119 (0x7f9e6b80b839 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd6df4 (0x7f9eb551edf4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #5: <unknown function> + 0x8609 (0x7f9eb6912609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #6: clone + 0x43 (0x7f9eb66dd353 in /lib/x86_64-linux-gnu/libc.so.6)

terminate called after throwing an instance of 'c10::DistBackendError'
  what():  [Rank 4] NCCL watchdog thread terminated with exception: [Rank 4] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=53, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600997 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:525 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7f9e6a65fd87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x1e6 (0x7f9e6b8076e6 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::workCleanupLoop() + 0x19d (0x7f9e6b80ac3d in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x119 (0x7f9e6b80b839 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd6df4 (0x7f9eb551edf4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #5: <unknown function> + 0x8609 (0x7f9eb6912609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #6: clone + 0x43 (0x7f9eb66dd353 in /lib/x86_64-linux-gnu/libc.so.6)

Exception raised from ncclCommWatchdog at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:1186 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7f9e6a65fd87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0xdf6b11 (0x7f9e6b561b11 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: <unknown function> + 0xd6df4 (0x7f9eb551edf4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #3: <unknown function> + 0x8609 (0x7f9eb6912609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #4: clone + 0x43 (0x7f9eb66dd353 in /lib/x86_64-linux-gnu/libc.so.6)

[2024-07-11 03:48:48,311] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 2806204 closing signal SIGTERM
[2024-07-11 03:48:48,312] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 2806208 closing signal SIGTERM
[2024-07-11 03:48:48,312] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 2806209 closing signal SIGTERM
[2024-07-11 03:48:48,312] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 2806210 closing signal SIGTERM
[2024-07-11 03:48:49,405] torch.distributed.elastic.multiprocessing.api: [ERROR] failed (exitcode: -6) local_rank: 4 (pid: 2806207) of binary: /fsx-storygen/beidic/anaconda3/envs/griffin/bin/python3.9
Traceback (most recent call last):
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/bin/accelerate", line 8, in <module>
    sys.exit(main())
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/accelerate/commands/accelerate_cli.py", line 47, in main
    args.func(args)
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/accelerate/commands/launch.py", line 985, in launch_command
    multi_gpu_launcher(args)
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/accelerate/commands/launch.py", line 654, in multi_gpu_launcher
    distrib_run.run(args)
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/distributed/run.py", line 803, in run
    elastic_launch(
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 135, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 268, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
========================================================
main.py FAILED
--------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
--------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-11_03:48:48
  host      : a100-st-p4de24xlarge-172.fair-a100.hpcaas
  rank      : 4 (local_rank: 4)
  exitcode  : -6 (pid: 2806207)
  error_file: <N/A>
  traceback : Signal 6 (SIGABRT) received by PID 2806207
========================================================
