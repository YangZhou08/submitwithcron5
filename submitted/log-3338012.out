Your branch is up to date with 'origin/addinggriffin'.
Already up to date.
Already up to date.
/fsx-storygen/beidic/anaconda3/envs/griffin/bin/python
/fsx-storygen/beidic/anaconda3/envs/griffin/bin/python
The token has not been saved to the git credentials helper. Pass `add_to_git_credential=True` in this function directly or `--add-to-git-credential` if using via `huggingface-cli` if you want to set the git credential as well.
Token is valid (permission: fineGrained).
Your token has been saved to /data/home/beidic/.cache/huggingface/token
Login successful
NCCL_TIMEOUT 1800
is_distributed True
Namespace(tasks='csqa,sports,date', model='meta-llama/Llama-2-7b-hf', device=None, limit=None, griffin=True, cats=False, check=True, kernel_size=16, spr=0.4, thr=0.1, widthtree=4, patternstrict=False, shotfive=True, shottwo=False, filteractiveenabled=False)
NCCL_TIMEOUT 1800
We now use eos_token as pad token
NCCL_TIMEOUT 1800
NCCL_TIMEOUT 1800
NCCL_TIMEOUT 1800
NCCL_TIMEOUT 1800
NCCL_TIMEOUT 1800
NCCL_TIMEOUT 1800
beam width is 8
is_distributed True
Namespace(tasks='csqa,sports,date', model='meta-llama/Llama-2-7b-hf', device=None, limit=None, griffin=True, cats=False, check=True, kernel_size=16, spr=0.4, thr=0.1, widthtree=4, patternstrict=False, shotfive=True, shottwo=False, filteractiveenabled=False)
is_distributed True
Namespace(tasks='csqa,sports,date', model='meta-llama/Llama-2-7b-hf', device=None, limit=None, griffin=True, cats=False, check=True, kernel_size=16, spr=0.4, thr=0.1, widthtree=4, patternstrict=False, shotfive=True, shottwo=False, filteractiveenabled=False)
is_distributed True
Namespace(tasks='csqa,sports,date', model='meta-llama/Llama-2-7b-hf', device=None, limit=None, griffin=True, cats=False, check=True, kernel_size=16, spr=0.4, thr=0.1, widthtree=4, patternstrict=False, shotfive=True, shottwo=False, filteractiveenabled=False)
is_distributed True
Namespace(tasks='csqa,sports,date', model='meta-llama/Llama-2-7b-hf', device=None, limit=None, griffin=True, cats=False, check=True, kernel_size=16, spr=0.4, thr=0.1, widthtree=4, patternstrict=False, shotfive=True, shottwo=False, filteractiveenabled=False)
is_distributed True
Namespace(tasks='csqa,sports,date', model='meta-llama/Llama-2-7b-hf', device=None, limit=None, griffin=True, cats=False, check=True, kernel_size=16, spr=0.4, thr=0.1, widthtree=4, patternstrict=False, shotfive=True, shottwo=False, filteractiveenabled=False)
We now use eos_token as pad token
is_distributed True
Namespace(tasks='csqa,sports,date', model='meta-llama/Llama-2-7b-hf', device=None, limit=None, griffin=True, cats=False, check=True, kernel_size=16, spr=0.4, thr=0.1, widthtree=4, patternstrict=False, shotfive=True, shottwo=False, filteractiveenabled=False)
is_distributed True
Namespace(tasks='csqa,sports,date', model='meta-llama/Llama-2-7b-hf', device=None, limit=None, griffin=True, cats=False, check=True, kernel_size=16, spr=0.4, thr=0.1, widthtree=4, patternstrict=False, shotfive=True, shottwo=False, filteractiveenabled=False)
We now use eos_token as pad token
We now use eos_token as pad token
We now use eos_token as pad token
We now use eos_token as pad token
We now use eos_token as pad token
We now use eos_token as pad token
beam width is 8
beam width is 8
beam width is 8
beam width is 8
beam width is 8
beam width is 8
beam width is 8
tasks ['csqa', 'sports', 'date']
tasks ['csqa', 'sports', 'date']
tasks ['csqa', 'sports', 'date']
tasks ['csqa', 'sports', 'date']
tasks ['csqa', 'sports', 'date']
tasks ['csqa', 'sports', 'date']
tasks ['csqa', 'sports', 'date']
tasks ['csqa', 'sports', 'date']
length of dataset:  1224
length of dataset:  1224
length of dataset:  1224
beamwidth is 4
beamwidth is 4
length of dataset:  1224
beamwidth is 4
length of dataset:  1224
beamwidth is 4
beamwidth is 4
length of dataset:  1224
beamwidth is 4
length of dataset:  1224
beamwidth is 4
length of dataset:  1224
beamwidth is 4
Answer e expected b
Answer e expected e
Answer a expected a
Answer c expected c
Answer a expected a
Answer d expected d
Answer b expected c
Answer e expected c
Answer e expected e
Answer e expected c
Answer a expected b
Answer d expected d
Answer a expected a
Answer a expected a
Answer d expected d
Answer a expected a
Answer b expected d
Answer b expected d
Answer d expected d
Answer d expected a
Answer e expected c
Answer a expected e
Answer e expected e
Answer a expected a
Answer a expected e
Answer e expected a
Answer d expected d
Answer a expected a
Answer b expected d
Answer c expected c
Answer a expected a
Answer d expected d
Answer a expected d
Answer b expected d
Answer e expected d
Answer b expected b
Answer b expected c
Answer e expected e
Answer e expected e
Answer a expected a
Answer e expected e
Answer e expected b
Answer e expected d
Answer a expected e
Answer e expected e
Answer b expected b
Answer c expected d
Answer d expected d
Answer a expected b
Answer e expected a
Answer e expected a
Answer a expected a
Answer e expected e
Skipping the batch
Answer a expected a
Answer e expected b
Answer a expected e
Answer b expected b
Answer a expected a
Answer b expected b
Answer e expected e
Answer a expected d
Answer d expected c
Answer a expected e
Answer c expected c
Answer b expected b
Answer b expected a
Answer a expected e
Answer e expected e
Answer a expected b
Answer a expected b
Answer c expected c
Answer b expected d
Answer d expected d
Answer c expected e
Answer c expected d
Answer b expected e
Answer d expected d
Answer c expected d
Answer e expected e
Answer a expected a
Answer a expected a
Answer d expected d
Answer a expected e
Answer b expected d
Answer b expected e
Answer a expected c
Answer d expected b
Answer c expected b
Answer b expected b
Answer e expected e
Answer a expected a
Answer a expected c
Answer d expected d
Answer a expected a
Answer b expected b
Answer e expected d
Answer d expected d
Answer a expected a
Answer b expected d
Answer e expected a
Answer e expected c
Answer a expected a
Answer e expected a
Answer a expected d
Answer a expected b
Answer c expected e
Answer e expected e
Answer e expected b
Skipping the batch
Answer e expected c
Answer e expected a
Skipping the batch
Answer c expected c
Answer b expected b
Answer a expected a
Answer e expected e
Answer a expected e
Answer d expected b
Answer b expected b
Answer a expected a
Answer b expected b
Answer c expected c
Answer c expected b
Answer e expected d
Answer d expected e
Answer c expected c
Answer a expected e
Answer e expected e
Answer a expected a
Answer a expected d
Answer e expected a
Answer a expected d
Answer e expected c
Answer e expected d
Answer d expected d
Answer d expected d
Answer e expected e
Answer e expected b
Answer c expected b
Answer b expected b
Answer a expected e
Answer d expected a
Answer e expected d
Answer a expected a
Answer b expected b
Answer b expected b
Answer a expected b
Answer d expected e
Answer d expected d
Answer e expected e
Answer a expected b
Answer c expected c
Answer e expected e
Answer e expected b
index 0 start communication
index 3 start communication
index 4 start communication
index 7 start communication
index 5 start communication
index 1 start communication
index 6 start communication
index 2 start communication
Here are the statistics for inference
+--------+----------------+---------------------------+-----------------------------+---------------+-------------+---------+--------------------------------+------------------+----------------------------------+-----------------------+----------------------+
| Task   |   Num Sentence |   Total Generation Length |   Average Generation Length |   Total Steps |   Num Steps |     AAL |   Total Roll Back Length Error |   Error Instance |   Average Roll Back Length Error |   Effective Tree Size |   Drafting Tree Size |
+========+================+===========================+=============================+===============+=============+=========+================================+==================+==================================+=======================+======================+
| csqa   |           1221 |                    131349 |                     107.575 |        112284 |        7199 | 15.5972 |                           2900 |              299 |                            9.699 |               37.5117 |               3.8125 |
+--------+----------------+---------------------------+-----------------------------+---------------+-------------+---------+--------------------------------+------------------+----------------------------------+-----------------------+----------------------+
Here are the statistics for inference
Here are the statistics for inference
Here are the statistics for inference
Here are the statistics for inference
Here are the statistics for inference
Here are the statistics for inference
Here are the statistics for inference
Answer plausible expected plausible
Answer plausible expected implausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected implausible
Answer plausible expected implausible
Answer plausible expected implausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer implausible expected implausible
Answer plausible expected plausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected implausible
Answer implausible expected implausible
Answer plausible expected implausible
Answer implausible expected implausible
Answer plausible expected implausible
Answer implausible expected implausible
Skipping the batch
Answer plausible expected implausible
Answer plausible expected plausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer implausible expected implausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected implausible
Answer implausible expected implausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer plausible expected implausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer plausible expected implausible
Answer plausible expected implausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected plausible
Skipping the batch
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected plausible
Skipping the batch
Answer plausible expected plausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer plausible expected implausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer implausible expected implausible
Answer plausible expected plausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer plausible expected implausible
Answer plausible expected implausible
Skipping the batch
Answer plausible expected plausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer implausible expected implausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer plausible expected implausible
Skipping the batch
Answer plausible expected implausible
Answer plausible expected implausible
Answer plausible expected implausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer plausible expected implausible
Answer plausible expected implausible
Answer plausible expected implausible
Answer plausible expected implausible
Answer plausible expected implausible
Answer plausible expected implausible
Answer plausible expected implausible
Answer plausible expected implausible
index 3 start communication
index 5 start communication
index 4 start communication
Answer plausible expected plausible
index 7 start communication
Answer plausible expected implausible
index 0 start communication
index 1 start communication
Skipping the batch
index 6 start communication
index 2 start communication
Here are the statistics for inference
Here are the statistics for inference
Here are the statistics for inference
Here are the statistics for inference
Here are the statistics for inference
Here are the statistics for inference
Here are the statistics for inference
+--------+----------------+---------------------------+-----------------------------+---------------+-------------+---------+--------------------------------+------------------+----------------------------------+-----------------------+----------------------+
| Task   |   Num Sentence |   Total Generation Length |   Average Generation Length |   Total Steps |   Num Steps |     AAL |   Total Roll Back Length Error |   Error Instance |   Average Roll Back Length Error |   Effective Tree Size |   Drafting Tree Size |
+========+================+===========================+=============================+===============+=============+=========+================================+==================+==================================+=======================+======================+
| sports |            970 |                     47055 |                     48.5103 |         30565 |        1956 | 15.6263 |                            731 |               73 |                          10.0137 |               37.3328 |               3.8125 |
+--------+----------------+---------------------------+-----------------------------+---------------+-------------+---------+--------------------------------+------------------+----------------------------------+-----------------------+----------------------+Here are the statistics for inference

Answer 01/31/2011 expected 12/31/2011
Answer 06/01/1943 expected 05/23/1943
Answer 3/30/2008 expected 02/29/2008
Answer 12/30/1929 expected 12/31/1929
Answer 6/19/2019 expected 06/20/2019
Answer 7/28/2001 expected 06/28/2002
Answer 6/1/2020 expected 05/30/2020
Answer 12/31/2018 expected 01/07/2018
Skipping the batch
Answer 1/9/1958 expected 01/09/1961
Answer 02/28/2000 expected 03/01/2017
Answer 04/30/2021, then today is 05/01/2021.

 q: yesterday was april 30, 2021. wha expected 04/30/2021
Skipping the batch
Answer 1/1/1958 expected 12/23/1960
Skipping the batch
Answer 04/03/1985 expected 04/03/1985
Answer 10/16/2008 expected 02/16/2009
Answer 12/31/1899 expected 01/01/1900
Answer 06/09/1943 expected 06/09/1943
Skipping the batch
Answer /2000, then today is the last day of february 2000, which is 2/29/2000. if today is 2/29/2000, then today is 2/29/2000. if today is 2/29/2000, then today is 2/29/2000. if today is 2/29/2000, then today is 2/29/2000. if today is 2/29/2000, then today is 2/29/2000. if today is 2/29/2000, then today is 2/29/2000. if today is 2/29/2000, then today is 2/29/2000. if today is 2/29/2000, then today is 2/29/2000. if today is 2/29/2000, then today is 2 expected 02/29/2016
Skipping the batch
Answer 8/5/2002 expected 08/04/2002
Answer 11/16/1933 expected 11/18/1933
Answer 01/31/1987 expected 12/23/1986
Answer 06/01/1942 expected 06/02/1942
Answer 12/22/1957 expected 12/23/2007
Answer 2/29/1984 expected 02/19/2016
Answer 3/6/2000 expected 03/07/2016
Answer 3/13/2020 expected 09/05/2020
Answer 11/2/2019 expected 11/01/2019
Answer 02/20/2020 expected 02/01/2020
Answer 12/31/2014 expected 12/30/2014
Answer 2/20/2001 expected 02/21/2017
Answer 10/18/1924 expected 10/16/1924
Answer 06/02/1943 expected 06/02/1943
Answer 1/2/2007 expected 01/02/2007
Answer 01/21/2020 expected 01/02/2020
Answer 6/18/2018 expected 06/18/2018
Skipping the batch
Answer 11/21/2001 expected 11/21/2002
Answer 03/12/1969 expected 04/12/1969
Answer 2/5 expected 02/23/1973
Answer 6/25/2019 expected 06/25/2019
Answer 02/22/2020 expected 02/03/2020
Skipping the batch
Answer aug expected 08/08/2021
Answer 7/8/1971 expected 07/07/1972
Answer 5/1/2017 expected 06/18/2017
Answer 3/11/2001 expected 03/12/2001
Answer 10/16/1923 expected 09/15/1924
index 4 start communication
index 3 start communication
Answer 2/28/2001 expected 02/28/2016
index 0 start communication
index 7 start communication
index 1 start communication
index 5 start communication
index 2 start communication
index 6 start communication
Here are the statistics for inference
Here are the statistics for inferenceHere are the statistics for inference
Here are the statistics for inferenceHere are the statistics for inferenceHere are the statistics for inference



Here are the statistics for inference
Here are the statistics for inference
+--------+----------------+---------------------------+-----------------------------+---------------+-------------+---------+--------------------------------+------------------+----------------------------------+-----------------------+----------------------+
| Task   |   Num Sentence |   Total Generation Length |   Average Generation Length |   Total Steps |   Num Steps |     AAL |   Total Roll Back Length Error |   Error Instance |   Average Roll Back Length Error |   Effective Tree Size |   Drafting Tree Size |
+========+================+===========================+=============================+===============+=============+=========+================================+==================+==================================+=======================+======================+
| date   |            353 |                     25569 |                     72.4334 |         19613 |        1237 | 15.8553 |                            179 |               21 |                          8.52381 |               40.7276 |               3.8125 |
+--------+----------------+---------------------------+-----------------------------+---------------+-------------+---------+--------------------------------+------------------+----------------------------------+-----------------------+----------------------+
Namespace(tasks='csqa,sports,date', model='meta-llama/Llama-2-7b-hf', device='cuda:0', limit=None, griffin=True, cats=False, check=True, kernel_size=16, spr=0.4, thr=0.1, widthtree=4, patternstrict=False, shotfive=True, shottwo=False, filteractiveenabled=False)
+--------+---------+-----------+--------------+
| Task   |   Total |   Correct |   Solve Rate |
+========+=========+===========+==============+
| csqa   |    1221 |       594 |     0.486486 |
+--------+---------+-----------+--------------+
| sports |     970 |       522 |     0.538144 |
+--------+---------+-----------+--------------+
| date   |     353 |        94 |     0.266289 |
+--------+---------+-----------+--------------+
