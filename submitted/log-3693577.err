Already on 'yangexppp'
wandb: Currently logged in as: stevenzhou0816100. Use `wandb login --relogin` to force relogin
2024-08-05:18:57:17,522 INFO     [main.py:288] Verbosity set to INFO
2024-08-05:18:57:27,590 WARNING  [main.py:303]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2024-08-05:18:57:27,591 INFO     [main.py:378] Selected Tasks: ['mmlu_flan_cot_fewshot']
2024-08-05:18:57:27,624 INFO     [xevaluator.py:137] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2024-08-05:18:57:27,625 INFO     [xevaluator.py:184] Initializing xhf model, with arguments: {'pretrained': 'meta-llama/Meta-Llama-3-70B-Instruct', 'griffin': True, 'check': False, 'contextlength': 1500, 'kernel_size': 16, 'thr': 0.05}
2024-08-05:18:57:27,635 INFO     [xhuggingface.py:177] Using device 'cuda'
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:05<02:36,  5.40s/it]Loading checkpoint shards:   7%|▋         | 2/30 [00:10<02:32,  5.43s/it]Loading checkpoint shards:  10%|█         | 3/30 [00:17<02:40,  5.96s/it]Loading checkpoint shards:  13%|█▎        | 4/30 [00:23<02:32,  5.86s/it]Loading checkpoint shards:  17%|█▋        | 5/30 [00:28<02:21,  5.68s/it]Loading checkpoint shards:  20%|██        | 6/30 [00:33<02:12,  5.54s/it]Loading checkpoint shards:  23%|██▎       | 7/30 [00:38<02:04,  5.43s/it]Loading checkpoint shards:  27%|██▋       | 8/30 [00:44<02:00,  5.48s/it]Loading checkpoint shards:  30%|███       | 9/30 [00:50<01:55,  5.51s/it]Loading checkpoint shards:  33%|███▎      | 10/30 [00:55<01:49,  5.46s/it]Loading checkpoint shards:  37%|███▋      | 11/30 [01:00<01:42,  5.39s/it]Loading checkpoint shards:  40%|████      | 12/30 [01:05<01:36,  5.34s/it]Loading checkpoint shards:  43%|████▎     | 13/30 [01:11<01:32,  5.42s/it]Loading checkpoint shards:  47%|████▋     | 14/30 [01:17<01:27,  5.48s/it]Loading checkpoint shards:  50%|█████     | 15/30 [01:22<01:21,  5.42s/it]Loading checkpoint shards:  53%|█████▎    | 16/30 [01:27<01:15,  5.37s/it]Loading checkpoint shards:  57%|█████▋    | 17/30 [01:32<01:09,  5.33s/it]Loading checkpoint shards:  60%|██████    | 18/30 [01:38<01:04,  5.39s/it]Loading checkpoint shards:  63%|██████▎   | 19/30 [01:43<00:59,  5.43s/it]Loading checkpoint shards:  67%|██████▋   | 20/30 [01:50<00:58,  5.84s/it]Loading checkpoint shards:  70%|███████   | 21/30 [01:55<00:50,  5.65s/it]Loading checkpoint shards:  73%|███████▎  | 22/30 [02:01<00:44,  5.50s/it]Loading checkpoint shards:  77%|███████▋  | 23/30 [02:06<00:38,  5.51s/it]Loading checkpoint shards:  80%|████████  | 24/30 [02:12<00:33,  5.51s/it]Loading checkpoint shards:  83%|████████▎ | 25/30 [02:17<00:27,  5.43s/it]Loading checkpoint shards:  87%|████████▋ | 26/30 [02:22<00:21,  5.38s/it]Loading checkpoint shards:  90%|█████████ | 27/30 [02:27<00:15,  5.32s/it]Loading checkpoint shards:  93%|█████████▎| 28/30 [02:33<00:10,  5.44s/it]Loading checkpoint shards:  97%|█████████▋| 29/30 [02:39<00:05,  5.46s/it]Loading checkpoint shards: 100%|██████████| 30/30 [02:41<00:00,  4.57s/it]Loading checkpoint shards: 100%|██████████| 30/30 [02:41<00:00,  5.39s/it]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
2024-08-05:19:06:56,915 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_prehistory on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 605.24it/s]
2024-08-05:19:06:56,924 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_logical_fallacies on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 583.31it/s]
2024-08-05:19:06:56,931 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_us_history on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 396.65it/s]
2024-08-05:19:06:56,942 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_international_law on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 583.07it/s]
2024-08-05:19:06:56,950 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_professional_law on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 476.98it/s]
2024-08-05:19:06:56,959 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_moral_disputes on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 585.20it/s]
2024-08-05:19:06:56,967 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_jurisprudence on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 608.51it/s]
2024-08-05:19:06:56,974 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_world_history on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 486.78it/s]
2024-08-05:19:06:56,983 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_moral_scenarios on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 607.76it/s]
2024-08-05:19:06:56,990 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_philosophy on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 628.08it/s]
2024-08-05:19:06:56,997 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_formal_logic on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 542.74it/s]
2024-08-05:19:06:57,005 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_world_religions on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 662.03it/s]
2024-08-05:19:06:57,011 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_european_history on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 352.44it/s]
2024-08-05:19:06:57,024 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_human_sexuality on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 638.72it/s]
2024-08-05:19:06:57,031 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_econometrics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 528.25it/s]
2024-08-05:19:06:57,039 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_macroeconomics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 618.31it/s]
2024-08-05:19:06:57,047 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_geography on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 628.43it/s]
2024-08-05:19:06:57,054 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_security_studies on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 513.27it/s]
2024-08-05:19:06:57,063 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_psychology on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 599.91it/s]
2024-08-05:19:06:57,070 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_microeconomics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 623.73it/s]
2024-08-05:19:06:57,077 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_government_and_politics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 605.89it/s]
2024-08-05:19:06:57,084 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_professional_psychology on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 573.03it/s]
2024-08-05:19:06:57,091 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_public_relations on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 622.39it/s]
2024-08-05:19:06:57,098 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_us_foreign_policy on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 621.45it/s]
2024-08-05:19:06:57,105 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_sociology on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 613.20it/s]
2024-08-05:19:06:57,113 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_global_facts on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 611.37it/s]
2024-08-05:19:06:57,120 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_professional_medicine on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 544.43it/s]
2024-08-05:19:06:57,128 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_business_ethics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 549.69it/s]
2024-08-05:19:06:57,136 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_medicine on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 556.20it/s]
2024-08-05:19:06:57,144 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_management on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 638.50it/s]
2024-08-05:19:06:57,150 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_human_aging on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 645.20it/s]
2024-08-05:19:06:57,157 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_marketing on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 625.15it/s]
2024-08-05:19:06:57,164 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_nutrition on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 601.29it/s]
2024-08-05:19:06:57,171 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_virology on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 644.81it/s]
2024-08-05:19:06:57,178 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_professional_accounting on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 575.39it/s]
2024-08-05:19:06:57,185 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_miscellaneous on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 648.04it/s]
2024-08-05:19:06:57,192 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_medical_genetics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 636.49it/s]
2024-08-05:19:06:57,199 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_clinical_knowledge on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 637.87it/s]
2024-08-05:19:06:57,206 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_mathematics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 567.01it/s]
2024-08-05:19:06:57,213 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_elementary_mathematics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 613.67it/s]
2024-08-05:19:06:57,220 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_statistics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 568.33it/s]
2024-08-05:19:06:57,228 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_astronomy on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 557.62it/s]
2024-08-05:19:06:57,236 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_electrical_engineering on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 612.42it/s]
2024-08-05:19:06:57,243 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_abstract_algebra on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 618.72it/s]
2024-08-05:19:06:57,250 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_machine_learning on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 539.23it/s]
2024-08-05:19:06:57,258 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_computer_science on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 514.53it/s]
2024-08-05:19:06:57,266 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_biology on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 554.75it/s]
2024-08-05:19:06:57,274 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_anatomy on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 543.16it/s]
2024-08-05:19:06:57,282 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_physics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 594.26it/s]
2024-08-05:19:06:57,289 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_computer_science on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 510.78it/s]
2024-08-05:19:06:57,298 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_conceptual_physics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 607.25it/s]
2024-08-05:19:06:57,305 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_mathematics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 610.92it/s]
2024-08-05:19:06:57,312 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_computer_security on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 610.10it/s]
2024-08-05:19:06:57,319 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_chemistry on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 591.79it/s]
2024-08-05:19:06:57,326 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_physics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 608.16it/s]
2024-08-05:19:06:57,333 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_chemistry on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 594.58it/s]
2024-08-05:19:06:57,341 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_biology on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 543.71it/s]
2024-08-05:19:06:57,349 INFO     [xevaluator.py:395] Running generate_until requests
Running generate_until requests:   0%|          | 0/228 [00:00<?, ?it/s]Running generate_until requests:   0%|          | 1/228 [01:17<4:52:59, 77.44s/it]Running generate_until requests:   1%|          | 2/228 [01:48<3:09:32, 50.32s/it]Running generate_until requests:   1%|▏         | 3/228 [03:05<3:53:48, 62.35s/it]Running generate_until requests:   2%|▏         | 4/228 [04:20<4:11:50, 67.46s/it]Running generate_until requests:   2%|▏         | 5/228 [05:34<4:18:45, 69.62s/it]Running generate_until requests:   3%|▎         | 6/228 [06:46<4:21:22, 70.64s/it]Running generate_until requests:   3%|▎         | 7/228 [07:59<4:22:26, 71.25s/it]Running generate_until requests:   4%|▎         | 8/228 [08:11<3:12:02, 52.38s/it]Running generate_until requests:   4%|▍         | 9/228 [09:22<3:32:36, 58.25s/it]Running generate_until requests:   4%|▍         | 10/228 [10:33<3:46:27, 62.33s/it]Running generate_until requests:   5%|▍         | 11/228 [11:45<3:55:43, 65.18s/it]Running generate_until requests:   5%|▌         | 12/228 [12:56<4:01:19, 67.03s/it]Running generate_until requests:   6%|▌         | 13/228 [14:08<4:05:13, 68.43s/it]Running generate_until requests:   6%|▌         | 14/228 [15:19<4:06:45, 69.19s/it]Running generate_until requests:   7%|▋         | 15/228 [16:30<4:07:12, 69.63s/it]Running generate_until requests:   7%|▋         | 16/228 [17:40<4:07:09, 69.95s/it]Running generate_until requests:   7%|▋         | 17/228 [18:51<4:06:59, 70.23s/it]Running generate_until requests:   8%|▊         | 18/228 [20:01<4:05:30, 70.15s/it]Running generate_until requests:   8%|▊         | 19/228 [21:12<4:04:38, 70.23s/it]Running generate_until requests:   9%|▉         | 20/228 [22:22<4:03:52, 70.35s/it]Running generate_until requests:   9%|▉         | 21/228 [23:32<4:02:40, 70.34s/it]Running generate_until requests:  10%|▉         | 22/228 [24:43<4:01:45, 70.41s/it]Running generate_until requests:  10%|█         | 23/228 [25:53<4:00:23, 70.36s/it]Running generate_until requests:  11%|█         | 24/228 [27:03<3:58:57, 70.28s/it]Running generate_until requests:  11%|█         | 25/228 [28:14<3:57:43, 70.26s/it]Running generate_until requests:  11%|█▏        | 26/228 [29:24<3:56:26, 70.23s/it]Running generate_until requests:  12%|█▏        | 27/228 [30:34<3:55:17, 70.24s/it]Running generate_until requests:  12%|█▏        | 28/228 [31:45<3:54:25, 70.33s/it]Running generate_until requests:  13%|█▎        | 29/228 [32:55<3:52:58, 70.24s/it]Running generate_until requests:  13%|█▎        | 30/228 [34:05<3:51:30, 70.15s/it]Running generate_until requests:  14%|█▎        | 31/228 [35:15<3:50:15, 70.13s/it]Running generate_until requests:  14%|█▍        | 32/228 [36:25<3:49:13, 70.17s/it]Running generate_until requests:  14%|█▍        | 33/228 [37:35<3:47:57, 70.14s/it]