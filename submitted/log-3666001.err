Already on 'yangexppp'
wandb: Currently logged in as: stevenzhou0816100. Use `wandb login --relogin` to force relogin
2024-08-04:23:11:43,239 INFO     [main.py:288] Verbosity set to INFO
2024-08-04:23:11:52,750 INFO     [main.py:378] Selected Tasks: ['gsm8k_cot']
2024-08-04:23:11:52,778 INFO     [xevaluator.py:137] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2024-08-04:23:11:52,778 INFO     [xevaluator.py:184] Initializing xhf model, with arguments: {'pretrained': 'meta-llama/Meta-Llama-3-8B-Instruct', 'cats': True, 'check': True, 'contextlength': 1500, 'kernel_size': 16, 'thr': 0.1}
2024-08-04:23:11:52,786 INFO     [xhuggingface.py:176] Using device 'cuda'
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:17,  5.92s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:11<00:11,  5.78s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:17<00:05,  5.67s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:18<00:00,  4.04s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:18<00:00,  4.67s/it]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
2024-08-04:23:12:54,836 WARNING  [task.py:322] [Task: gsm8k_cot] has_training_docs and has_validation_docs are False, using test_docs as fewshot_docs but this is not recommended.
2024-08-04:23:12:54,836 WARNING  [task.py:322] [Task: gsm8k_cot] has_training_docs and has_validation_docs are False, using test_docs as fewshot_docs but this is not recommended.
2024-08-04:23:12:54,930 INFO     [task.py:395] Building contexts for gsm8k_cot on rank 0...
  0%|          | 0/1319 [00:00<?, ?it/s] 13%|█▎        | 169/1319 [00:00<00:00, 1687.25it/s] 26%|██▌       | 339/1319 [00:00<00:00, 1692.18it/s] 39%|███▊      | 509/1319 [00:00<00:00, 1692.93it/s] 51%|█████▏    | 679/1319 [00:00<00:00, 1693.97it/s] 64%|██████▍   | 849/1319 [00:00<00:00, 1693.35it/s] 77%|███████▋  | 1019/1319 [00:00<00:00, 1677.00it/s] 90%|█████████ | 1189/1319 [00:00<00:00, 1683.64it/s]100%|██████████| 1319/1319 [00:00<00:00, 1687.82it/s]
2024-08-04:23:12:55,736 INFO     [xevaluator.py:395] Running generate_until requests
Running generate_until requests:   0%|          | 0/1319 [00:00<?, ?it/s]Running generate_until requests:   0%|          | 1/1319 [00:33<12:17:27, 33.57s/it]Running generate_until requests:   0%|          | 2/1319 [00:58<10:24:51, 28.47s/it]Running generate_until requests:   0%|          | 3/1319 [01:18<8:55:47, 24.43s/it] Running generate_until requests:   0%|          | 4/1319 [01:40<8:38:09, 23.64s/it]Running generate_until requests:   0%|          | 5/1319 [02:25<11:26:52, 31.36s/it]Running generate_until requests:   0%|          | 6/1319 [02:56<11:26:09, 31.35s/it]Running generate_until requests:   1%|          | 7/1319 [03:19<10:20:46, 28.39s/it]Running generate_until requests:   1%|          | 8/1319 [03:44<9:59:23, 27.43s/it] Running generate_until requests:   1%|          | 9/1319 [04:04<9:06:36, 25.04s/it]Running generate_until requests:   1%|          | 10/1319 [04:26<8:48:37, 24.23s/it]Running generate_until requests:   1%|          | 11/1319 [04:52<8:55:11, 24.55s/it]Running generate_until requests:   1%|          | 12/1319 [05:17<8:59:30, 24.77s/it]Running generate_until requests:   1%|          | 13/1319 [05:37<8:26:03, 23.25s/it]Running generate_until requests:   1%|          | 14/1319 [05:54<7:44:42, 21.37s/it]Running generate_until requests:   1%|          | 15/1319 [06:08<6:56:34, 19.17s/it]Running generate_until requests:   1%|          | 16/1319 [06:27<6:59:20, 19.31s/it]Running generate_until requests:   1%|▏         | 17/1319 [06:50<7:19:41, 20.26s/it]Running generate_until requests:   1%|▏         | 18/1319 [07:15<7:52:34, 21.79s/it]Running generate_until requests:   1%|▏         | 19/1319 [07:49<9:10:20, 25.40s/it]Running generate_until requests:   2%|▏         | 20/1319 [08:14<9:10:27, 25.43s/it]Running generate_until requests:   2%|▏         | 21/1319 [08:32<8:18:18, 23.03s/it]Running generate_until requests:   2%|▏         | 22/1319 [08:50<7:43:10, 21.43s/it]Running generate_until requests:   2%|▏         | 23/1319 [09:07<7:18:29, 20.30s/it]Running generate_until requests:   2%|▏         | 24/1319 [09:34<7:59:54, 22.23s/it]Running generate_until requests:   2%|▏         | 25/1319 [09:58<8:08:07, 22.63s/it]Running generate_until requests:   2%|▏         | 26/1319 [10:24<8:33:39, 23.84s/it]Running generate_until requests:   2%|▏         | 27/1319 [10:36<7:15:41, 20.23s/it]Running generate_until requests:   2%|▏         | 28/1319 [10:56<7:16:47, 20.30s/it]Running generate_until requests:   2%|▏         | 29/1319 [11:20<7:35:49, 21.20s/it]Running generate_until requests:   2%|▏         | 30/1319 [11:37<7:11:48, 20.10s/it]Running generate_until requests:   2%|▏         | 31/1319 [11:49<6:17:52, 17.60s/it]Running generate_until requests:   2%|▏         | 32/1319 [12:12<6:53:13, 19.26s/it]Running generate_until requests:   3%|▎         | 33/1319 [12:35<7:18:12, 20.45s/it]Running generate_until requests:   3%|▎         | 34/1319 [12:59<7:35:43, 21.28s/it]Running generate_until requests:   3%|▎         | 35/1319 [13:30<8:42:42, 24.43s/it]Running generate_until requests:   3%|▎         | 36/1319 [13:45<7:40:54, 21.55s/it]Running generate_until requests:   3%|▎         | 37/1319 [14:14<8:27:02, 23.73s/it]Running generate_until requests:   3%|▎         | 38/1319 [14:43<8:59:40, 25.28s/it]Running generate_until requests:   3%|▎         | 39/1319 [15:12<9:21:23, 26.32s/it]Running generate_until requests:   3%|▎         | 40/1319 [15:44<9:56:07, 27.97s/it]Running generate_until requests:   3%|▎         | 41/1319 [16:10<9:44:07, 27.42s/it]Running generate_until requests:   3%|▎         | 42/1319 [16:27<8:40:42, 24.47s/it]Running generate_until requests:   3%|▎         | 43/1319 [16:48<8:14:37, 23.26s/it]Running generate_until requests:   3%|▎         | 44/1319 [17:20<9:11:16, 25.94s/it]Running generate_until requests:   3%|▎         | 45/1319 [17:32<7:41:20, 21.73s/it]Running generate_until requests:   3%|▎         | 46/1319 [17:52<7:33:38, 21.38s/it]Running generate_until requests:   4%|▎         | 47/1319 [18:21<8:22:16, 23.69s/it]Running generate_until requests:   4%|▎         | 48/1319 [18:36<7:24:19, 20.98s/it]Running generate_until requests:   4%|▎         | 49/1319 [19:02<7:57:36, 22.56s/it]Running generate_until requests:   4%|▍         | 50/1319 [19:26<8:01:43, 22.78s/it]Running generate_until requests:   4%|▍         | 51/1319 [19:43<7:28:16, 21.21s/it]Running generate_until requests:   4%|▍         | 52/1319 [19:58<6:45:46, 19.22s/it]Running generate_until requests:   4%|▍         | 53/1319 [20:22<7:17:57, 20.76s/it]Running generate_until requests:   4%|▍         | 54/1319 [20:38<6:44:57, 19.21s/it]Running generate_until requests:   4%|▍         | 55/1319 [20:44<5:23:51, 15.37s/it]Running generate_until requests:   4%|▍         | 56/1319 [21:06<6:04:51, 17.33s/it]Running generate_until requests:   4%|▍         | 57/1319 [21:22<5:54:49, 16.87s/it]Running generate_until requests:   4%|▍         | 58/1319 [21:50<7:06:18, 20.28s/it]Running generate_until requests:   4%|▍         | 59/1319 [22:11<7:11:34, 20.55s/it]Running generate_until requests:   5%|▍         | 60/1319 [22:43<8:23:09, 23.98s/it]Running generate_until requests:   5%|▍         | 61/1319 [23:04<8:02:14, 23.00s/it]Running generate_until requests:   5%|▍         | 62/1319 [23:19<7:09:44, 20.51s/it]Running generate_until requests:   5%|▍         | 63/1319 [23:50<8:20:42, 23.92s/it]Running generate_until requests:   5%|▍         | 64/1319 [24:11<7:57:27, 22.83s/it]Running generate_until requests:   5%|▍         | 65/1319 [24:45<9:11:26, 26.39s/it]Running generate_until requests:   5%|▌         | 66/1319 [25:00<7:57:10, 22.85s/it]Running generate_until requests:   5%|▌         | 67/1319 [25:17<7:21:09, 21.14s/it]Running generate_until requests:   5%|▌         | 68/1319 [25:32<6:38:35, 19.12s/it]Running generate_until requests:   5%|▌         | 69/1319 [26:00<7:37:52, 21.98s/it]Running generate_until requests:   5%|▌         | 70/1319 [26:32<8:37:14, 24.85s/it]Running generate_until requests:   5%|▌         | 71/1319 [26:49<7:50:47, 22.63s/it]Running generate_until requests:   5%|▌         | 72/1319 [27:07<7:19:40, 21.16s/it]Running generate_until requests:   6%|▌         | 73/1319 [27:24<6:56:41, 20.07s/it]Running generate_until requests:   6%|▌         | 74/1319 [27:36<6:04:14, 17.55s/it]Running generate_until requests:   6%|▌         | 75/1319 [27:54<6:03:46, 17.55s/it]Running generate_until requests:   6%|▌         | 76/1319 [28:20<6:57:18, 20.14s/it]Running generate_until requests:   6%|▌         | 77/1319 [28:43<7:17:10, 21.12s/it]Running generate_until requests:   6%|▌         | 78/1319 [29:12<8:06:16, 23.51s/it]Running generate_until requests:   6%|▌         | 79/1319 [29:36<8:04:37, 23.45s/it]Running generate_until requests:   6%|▌         | 80/1319 [29:56<7:45:54, 22.56s/it]Running generate_until requests:   6%|▌         | 81/1319 [30:08<6:38:20, 19.31s/it]Running generate_until requests:   6%|▌         | 82/1319 [30:31<7:02:34, 20.50s/it]Running generate_until requests:   6%|▋         | 83/1319 [30:57<7:37:22, 22.20s/it]Running generate_until requests:   6%|▋         | 84/1319 [31:12<6:52:08, 20.02s/it]Running generate_until requests:   6%|▋         | 85/1319 [31:47<8:22:34, 24.44s/it]Running generate_until requests:   7%|▋         | 86/1319 [32:08<7:58:37, 23.29s/it]Running generate_until requests:   7%|▋         | 87/1319 [32:39<8:48:23, 25.73s/it]Running generate_until requests:   7%|▋         | 88/1319 [32:58<8:06:27, 23.71s/it]Running generate_until requests:   7%|▋         | 89/1319 [33:36<9:31:40, 27.89s/it]Running generate_until requests:   7%|▋         | 90/1319 [34:01<9:14:50, 27.09s/it]Running generate_until requests:   7%|▋         | 91/1319 [34:31<9:34:25, 28.07s/it]Running generate_until requests:   7%|▋         | 92/1319 [34:52<8:46:16, 25.73s/it]Running generate_until requests:   7%|▋         | 93/1319 [35:21<9:06:18, 26.74s/it]Running generate_until requests:   7%|▋         | 94/1319 [35:38<8:09:01, 23.95s/it]Running generate_until requests:   7%|▋         | 95/1319 [35:59<7:46:51, 22.89s/it]Running generate_until requests:   7%|▋         | 96/1319 [36:22<7:49:08, 23.02s/it]Running generate_until requests:   7%|▋         | 97/1319 [36:42<7:32:33, 22.22s/it]Running generate_until requests:   7%|▋         | 98/1319 [37:12<8:16:15, 24.39s/it]Running generate_until requests:   8%|▊         | 99/1319 [37:35<8:11:26, 24.17s/it]Running generate_until requests:   8%|▊         | 100/1319 [37:59<8:07:24, 23.99s/it]Running generate_until requests:   8%|▊         | 101/1319 [38:19<7:45:54, 22.95s/it]Running generate_until requests:   8%|▊         | 102/1319 [38:49<8:26:56, 24.99s/it]Running generate_until requests:   8%|▊         | 103/1319 [39:10<7:59:24, 23.66s/it]Running generate_until requests:   8%|▊         | 104/1319 [39:30<7:39:56, 22.71s/it]Running generate_until requests:   8%|▊         | 105/1319 [39:57<8:01:47, 23.81s/it]Running generate_until requests:   8%|▊         | 106/1319 [40:08<6:47:58, 20.18s/it]Running generate_until requests:   8%|▊         | 107/1319 [40:49<8:51:06, 26.29s/it]Running generate_until requests:   8%|▊         | 108/1319 [41:15<8:50:12, 26.27s/it]Running generate_until requests:   8%|▊         | 109/1319 [41:35<8:14:13, 24.51s/it]Running generate_until requests:   8%|▊         | 110/1319 [42:10<9:16:10, 27.60s/it]Running generate_until requests:   8%|▊         | 111/1319 [42:25<7:57:39, 23.72s/it]Running generate_until requests:   8%|▊         | 112/1319 [42:48<7:55:26, 23.63s/it]Running generate_until requests:   9%|▊         | 113/1319 [43:03<7:00:38, 20.93s/it]Running generate_until requests:   9%|▊         | 114/1319 [43:29<7:30:54, 22.45s/it]Running generate_until requests:   9%|▊         | 115/1319 [43:49<7:17:16, 21.79s/it]Running generate_until requests:   9%|▉         | 116/1319 [44:18<7:59:21, 23.91s/it]Running generate_until requests:   9%|▉         | 117/1319 [44:41<7:54:25, 23.68s/it]Running generate_until requests:   9%|▉         | 118/1319 [44:59<7:17:10, 21.84s/it]Running generate_until requests:   9%|▉         | 119/1319 [45:22<7:24:13, 22.21s/it]Running generate_until requests:   9%|▉         | 120/1319 [45:39<6:55:25, 20.79s/it]Running generate_until requests:   9%|▉         | 121/1319 [46:03<7:10:13, 21.55s/it]Traceback (most recent call last):
  File "/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/GRIFFIN2/main.py", line 465, in <module>
    cli_evaluate()
  File "/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/GRIFFIN2/main.py", line 384, in cli_evaluate
    results = xevaluator.simple_evaluate(
  File "/fsx-storygen/beidic/anaconda3/envs/griffinn/lib/python3.9/site-packages/lm_eval/utils.py", line 288, in _wrapper
    return fn(*args, **kwargs)
  File "/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/GRIFFIN2/xevaluator.py", line 262, in simple_evaluate
    results = evaluate(
  File "/fsx-storygen/beidic/anaconda3/envs/griffinn/lib/python3.9/site-packages/lm_eval/utils.py", line 288, in _wrapper
    return fn(*args, **kwargs)
  File "/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/GRIFFIN2/xevaluator.py", line 407, in evaluate
    resps = getattr(lm, reqtype)(cloned_reqs)
  File "/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/GRIFFIN2/xhuggingface.py", line 1278, in generate_until
    cont = self._model_generate(
  File "/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/GRIFFIN2/xhuggingface.py", line 838, in _model_generate
    outputs = self.model.generate(
  File "/fsx-storygen/beidic/anaconda3/envs/griffinn/lib/python3.9/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/fsx-storygen/beidic/anaconda3/envs/griffinn/lib/python3.9/site-packages/transformers/generation/utils.py", line 1544, in generate
    return self.greedy_search(
  File "/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/GRIFFIN2/llama12pipa.py", line 445, in greedy_search
    staticinputids[:, length_inputids] = next_token 
IndexError: index 1003 is out of bounds for dimension 1 with size 1003
Running generate_until requests:   9%|▉         | 121/1319 [47:00<7:45:24, 23.31s/it]
