Already on 'yangexppp'
wandb: Currently logged in as: stevenzhou0816100. Use `wandb login --relogin` to force relogin
2024-08-05:14:44:37,786 INFO     [main.py:288] Verbosity set to INFO
2024-08-05:14:44:47,343 WARNING  [main.py:303]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2024-08-05:14:44:47,344 INFO     [main.py:378] Selected Tasks: ['mmlu_flan_cot_fewshot']
2024-08-05:14:44:47,375 INFO     [xevaluator.py:137] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2024-08-05:14:44:47,375 INFO     [xevaluator.py:184] Initializing xhf model, with arguments: {'pretrained': 'meta-llama/Meta-Llama-3-8B-Instruct', 'cats': True, 'check': False, 'contextlength': 1500, 'kernel_size': 16, 'thr': 0.05}
2024-08-05:14:44:47,385 INFO     [xhuggingface.py:177] Using device 'cuda'
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:17,  5.90s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:11<00:11,  5.94s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:17<00:05,  5.95s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:19<00:00,  4.24s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:19<00:00,  4.86s/it]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
2024-08-05:14:46:09,430 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_prehistory on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 603.43it/s]
2024-08-05:14:46:09,451 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_logical_fallacies on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 604.01it/s]
2024-08-05:14:46:09,470 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_us_history on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 391.34it/s]
2024-08-05:14:46:09,500 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_international_law on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 575.42it/s]
2024-08-05:14:46:09,520 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_professional_law on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 476.58it/s]
2024-08-05:14:46:09,545 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_moral_disputes on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 591.67it/s]
2024-08-05:14:46:09,565 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_jurisprudence on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 573.18it/s]
2024-08-05:14:46:09,585 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_world_history on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 476.05it/s]
2024-08-05:14:46:09,611 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_moral_scenarios on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 604.64it/s]
2024-08-05:14:46:09,631 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_philosophy on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 619.78it/s]
2024-08-05:14:46:09,649 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_formal_logic on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 540.16it/s]
2024-08-05:14:46:09,670 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_world_religions on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 496.79it/s]
2024-08-05:14:46:09,693 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_european_history on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 269.45it/s]
2024-08-05:14:46:09,736 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_human_sexuality on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 578.41it/s]
2024-08-05:14:46:09,756 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_econometrics on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 490.77it/s]
2024-08-05:14:46:09,780 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_macroeconomics on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 571.00it/s]
2024-08-05:14:46:09,800 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_geography on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 481.69it/s]
2024-08-05:14:46:09,824 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_security_studies on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 309.51it/s]
2024-08-05:14:46:09,862 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_psychology on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 362.38it/s]
2024-08-05:14:46:09,894 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_microeconomics on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 377.91it/s]
2024-08-05:14:46:09,924 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_government_and_politics on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 364.05it/s]
2024-08-05:14:46:09,955 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_professional_psychology on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 324.96it/s]
2024-08-05:14:46:09,991 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_public_relations on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 454.31it/s]
2024-08-05:14:46:10,016 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_us_foreign_policy on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 609.19it/s]
2024-08-05:14:46:10,035 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_sociology on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 605.41it/s]
2024-08-05:14:46:10,054 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_global_facts on rank 0...
  0%|          | 0/10 [00:00<?, ?it/s]100%|██████████| 10/10 [00:00<00:00, 608.88it/s]
2024-08-05:14:46:10,072 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_professional_medicine on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 530.39it/s]
2024-08-05:14:46:10,094 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_business_ethics on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 528.18it/s]
2024-08-05:14:46:10,116 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_medicine on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 548.44it/s]
2024-08-05:14:46:10,137 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_management on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 637.18it/s]
2024-08-05:14:46:10,155 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_human_aging on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 649.51it/s]
2024-08-05:14:46:10,173 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_marketing on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 615.25it/s]
2024-08-05:14:46:10,191 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_nutrition on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 593.23it/s]
2024-08-05:14:46:10,211 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_virology on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 640.44it/s]
2024-08-05:14:46:10,229 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_professional_accounting on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 561.58it/s]
2024-08-05:14:46:10,249 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_miscellaneous on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 652.21it/s]
2024-08-05:14:46:10,267 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_medical_genetics on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 623.23it/s]
2024-08-05:14:46:10,285 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_clinical_knowledge on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 631.55it/s]
2024-08-05:14:46:10,304 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_mathematics on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 559.34it/s]
2024-08-05:14:46:10,324 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_elementary_mathematics on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 603.14it/s]
2024-08-05:14:46:10,343 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_statistics on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 571.61it/s]
2024-08-05:14:46:10,363 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_astronomy on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 538.60it/s]
2024-08-05:14:46:10,384 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_electrical_engineering on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 566.79it/s]
2024-08-05:14:46:10,405 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_abstract_algebra on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 594.60it/s]
2024-08-05:14:46:10,424 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_machine_learning on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 532.04it/s]
2024-08-05:14:46:10,446 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_computer_science on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 517.89it/s]
2024-08-05:14:46:10,468 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_biology on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 549.42it/s]
2024-08-05:14:46:10,489 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_anatomy on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 540.33it/s]
2024-08-05:14:46:10,510 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_physics on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 590.94it/s]
2024-08-05:14:46:10,530 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_computer_science on rank 0...
  0%|          | 0/9 [00:00<?, ?it/s]100%|██████████| 9/9 [00:00<00:00, 506.24it/s]
2024-08-05:14:46:10,548 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_conceptual_physics on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 617.62it/s]
2024-08-05:14:46:10,567 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_mathematics on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 598.95it/s]
2024-08-05:14:46:10,586 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_computer_security on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 604.78it/s]
2024-08-05:14:46:10,605 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_chemistry on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 587.39it/s]
2024-08-05:14:46:10,625 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_physics on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 603.58it/s]
2024-08-05:14:46:10,644 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_chemistry on rank 0...
  0%|          | 0/8 [00:00<?, ?it/s]100%|██████████| 8/8 [00:00<00:00, 594.83it/s]
2024-08-05:14:46:10,658 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_biology on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 493.24it/s]
2024-08-05:14:46:10,681 INFO     [xevaluator.py:395] Running generate_until requests
Running generate_until requests:   0%|          | 0/621 [00:00<?, ?it/s]Running generate_until requests:   0%|          | 1/621 [00:50<8:45:38, 50.87s/it]Running generate_until requests:   0%|          | 2/621 [01:13<5:52:28, 34.17s/it]Running generate_until requests:   0%|          | 3/621 [02:00<6:53:31, 40.15s/it]Running generate_until requests:   1%|          | 4/621 [02:14<5:04:19, 29.59s/it]Running generate_until requests:   1%|          | 5/621 [03:02<6:14:17, 36.46s/it]Running generate_until requests:   1%|          | 6/621 [03:14<4:49:28, 28.24s/it]Running generate_until requests:   1%|          | 7/621 [03:28<4:00:18, 23.48s/it]Running generate_until requests:   1%|▏         | 8/621 [04:17<5:22:35, 31.58s/it]Running generate_until requests:   1%|▏         | 9/621 [04:29<4:20:12, 25.51s/it]Running generate_until requests:   2%|▏         | 10/621 [05:17<5:29:59, 32.41s/it]Running generate_until requests:   2%|▏         | 11/621 [06:07<6:24:54, 37.86s/it]Running generate_until requests:   2%|▏         | 12/621 [06:56<6:57:08, 41.10s/it]Running generate_until requests:   2%|▏         | 13/621 [07:44<7:19:14, 43.35s/it]Running generate_until requests:   2%|▏         | 14/621 [08:03<6:02:57, 35.88s/it]Running generate_until requests:   2%|▏         | 15/621 [08:54<6:47:49, 40.38s/it]Running generate_until requests:   3%|▎         | 16/621 [09:44<7:18:06, 43.45s/it]Running generate_until requests:   3%|▎         | 17/621 [10:04<6:03:59, 36.16s/it]Running generate_until requests:   3%|▎         | 18/621 [10:14<4:44:31, 28.31s/it]Running generate_until requests:   3%|▎         | 19/621 [11:04<5:52:01, 35.09s/it]Running generate_until requests:   3%|▎         | 20/621 [11:55<6:36:40, 39.60s/it]Running generate_until requests:   3%|▎         | 21/621 [12:45<7:08:56, 42.89s/it]Running generate_until requests:   4%|▎         | 22/621 [12:58<5:39:35, 34.02s/it]Running generate_until requests:   4%|▎         | 23/621 [13:30<5:31:39, 33.28s/it]Running generate_until requests:   4%|▍         | 24/621 [14:20<6:21:51, 38.38s/it]Running generate_until requests:   4%|▍         | 25/621 [15:11<6:57:52, 42.07s/it]Running generate_until requests:   4%|▍         | 26/621 [16:03<7:25:55, 44.97s/it]Running generate_until requests:   4%|▍         | 27/621 [16:53<7:42:25, 46.71s/it]Running generate_until requests:   5%|▍         | 28/621 [17:44<7:53:13, 47.88s/it]Running generate_until requests:   5%|▍         | 29/621 [17:57<6:09:14, 37.42s/it]Running generate_until requests:   5%|▍         | 30/621 [18:48<6:48:47, 41.50s/it]Running generate_until requests:   5%|▍         | 31/621 [19:40<7:18:22, 44.58s/it]Running generate_until requests:   5%|▌         | 32/621 [20:35<7:48:30, 47.73s/it]Running generate_until requests:   5%|▌         | 33/621 [21:26<7:58:35, 48.84s/it]Running generate_until requests:   5%|▌         | 34/621 [22:18<8:04:42, 49.54s/it]Running generate_until requests:   6%|▌         | 35/621 [23:08<8:06:05, 49.77s/it]Running generate_until requests:   6%|▌         | 36/621 [24:00<8:12:03, 50.47s/it]Running generate_until requests:   6%|▌         | 37/621 [24:50<8:10:45, 50.42s/it]Running generate_until requests:   6%|▌         | 38/621 [25:41<8:11:52, 50.62s/it]Running generate_until requests:   6%|▋         | 39/621 [26:35<8:21:17, 51.68s/it]Running generate_until requests:   6%|▋         | 40/621 [27:30<8:27:54, 52.45s/it]Running generate_until requests:   7%|▋         | 41/621 [28:20<8:21:15, 51.85s/it]Running generate_until requests:   7%|▋         | 42/621 [29:13<8:22:19, 52.05s/it]Running generate_until requests:   7%|▋         | 43/621 [30:06<8:25:54, 52.52s/it]Running generate_until requests:   7%|▋         | 44/621 [31:01<8:30:47, 53.12s/it]Running generate_until requests:   7%|▋         | 45/621 [31:52<8:24:12, 52.52s/it]Running generate_until requests:   7%|▋         | 46/621 [32:43<8:18:33, 52.02s/it]Running generate_until requests:   8%|▊         | 47/621 [33:34<8:14:38, 51.71s/it]