Switched to a new branch 'yangexppp'
wandb: Currently logged in as: stevenzhou0816100. Use `wandb login --relogin` to force relogin
2024-08-03:02:42:36,320 INFO     [main.py:288] Verbosity set to INFO
2024-08-03:02:42:46,805 WARNING  [main.py:303]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2024-08-03:02:42:46,806 INFO     [main.py:378] Selected Tasks: ['gsm8k_cot']
2024-08-03:02:42:46,840 INFO     [xevaluator.py:137] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2024-08-03:02:42:46,840 INFO     [xevaluator.py:184] Initializing xhf model, with arguments: {'pretrained': 'meta-llama/Meta-Llama-3-70B-Instruct', 'griffin': False, 'check': False, 'contextlength': 1500, 'kernel_size': 16, 'thr': 0.05}
2024-08-03:02:42:46,850 INFO     [xhuggingface.py:176] Using device 'cuda'
Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:05<02:47,  5.77s/it]Loading checkpoint shards:   7%|▋         | 2/30 [00:11<02:42,  5.80s/it]Loading checkpoint shards:  10%|█         | 3/30 [00:17<02:40,  5.95s/it]Loading checkpoint shards:  13%|█▎        | 4/30 [00:23<02:33,  5.89s/it]Loading checkpoint shards:  17%|█▋        | 5/30 [00:28<02:23,  5.73s/it]Loading checkpoint shards:  20%|██        | 6/30 [00:34<02:14,  5.61s/it]Loading checkpoint shards:  23%|██▎       | 7/30 [00:39<02:07,  5.56s/it]Loading checkpoint shards:  27%|██▋       | 8/30 [00:45<02:03,  5.63s/it]Loading checkpoint shards:  30%|███       | 9/30 [00:51<01:58,  5.63s/it]Loading checkpoint shards:  33%|███▎      | 10/30 [00:56<01:51,  5.56s/it]Loading checkpoint shards:  37%|███▋      | 11/30 [01:01<01:44,  5.49s/it]Loading checkpoint shards:  40%|████      | 12/30 [01:07<01:38,  5.46s/it]Loading checkpoint shards:  43%|████▎     | 13/30 [01:13<01:34,  5.53s/it]Loading checkpoint shards:  47%|████▋     | 14/30 [01:18<01:29,  5.58s/it]Loading checkpoint shards:  50%|█████     | 15/30 [01:23<01:22,  5.49s/it]Loading checkpoint shards:  53%|█████▎    | 16/30 [01:29<01:15,  5.42s/it]Loading checkpoint shards:  57%|█████▋    | 17/30 [01:34<01:09,  5.38s/it]Loading checkpoint shards:  60%|██████    | 18/30 [01:41<01:10,  5.85s/it]Loading checkpoint shards:  63%|██████▎   | 19/30 [01:47<01:03,  5.79s/it]Loading checkpoint shards:  67%|██████▋   | 20/30 [01:52<00:56,  5.66s/it]Loading checkpoint shards:  70%|███████   | 21/30 [01:57<00:50,  5.56s/it]Loading checkpoint shards:  73%|███████▎  | 22/30 [02:03<00:43,  5.49s/it]Loading checkpoint shards:  77%|███████▋  | 23/30 [02:08<00:39,  5.57s/it]Loading checkpoint shards:  80%|████████  | 24/30 [02:14<00:33,  5.61s/it]Loading checkpoint shards:  83%|████████▎ | 25/30 [02:19<00:27,  5.53s/it]Loading checkpoint shards:  87%|████████▋ | 26/30 [02:25<00:21,  5.47s/it]Loading checkpoint shards:  90%|█████████ | 27/30 [02:30<00:16,  5.41s/it]Loading checkpoint shards:  93%|█████████▎| 28/30 [02:36<00:10,  5.50s/it]Loading checkpoint shards:  97%|█████████▋| 29/30 [02:41<00:05,  5.54s/it]Loading checkpoint shards: 100%|██████████| 30/30 [02:44<00:00,  4.64s/it]Loading checkpoint shards: 100%|██████████| 30/30 [02:44<00:00,  5.48s/it]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
2024-08-03:02:45:37,758 WARNING  [task.py:322] [Task: gsm8k_cot] has_training_docs and has_validation_docs are False, using test_docs as fewshot_docs but this is not recommended.
2024-08-03:02:45:37,759 WARNING  [task.py:322] [Task: gsm8k_cot] has_training_docs and has_validation_docs are False, using test_docs as fewshot_docs but this is not recommended.
2024-08-03:02:45:37,832 INFO     [task.py:395] Building contexts for gsm8k_cot on rank 0...
  0%|          | 0/200 [00:00<?, ?it/s] 85%|████████▌ | 170/200 [00:00<00:00, 1694.04it/s]100%|██████████| 200/200 [00:00<00:00, 1693.65it/s]
2024-08-03:02:45:37,955 INFO     [xevaluator.py:395] Running generate_until requests
Running generate_until requests:   0%|          | 0/200 [00:00<?, ?it/s]Running generate_until requests:   0%|          | 1/200 [00:41<2:18:47, 41.85s/it]Running generate_until requests:   1%|          | 2/200 [01:14<2:01:03, 36.69s/it]Running generate_until requests:   2%|▏         | 3/200 [01:38<1:40:55, 30.74s/it]Running generate_until requests:   2%|▏         | 4/200 [02:17<1:50:44, 33.90s/it]Running generate_until requests:   2%|▎         | 5/200 [02:57<1:57:40, 36.21s/it]Running generate_until requests:   3%|▎         | 6/200 [03:32<1:55:06, 35.60s/it]Running generate_until requests:   4%|▎         | 7/200 [03:53<1:39:52, 31.05s/it]Running generate_until requests:   4%|▍         | 8/200 [04:29<1:44:22, 32.62s/it]Running generate_until requests:   4%|▍         | 9/200 [05:38<2:20:04, 44.01s/it]Running generate_until requests:   5%|▌         | 10/200 [06:01<1:58:44, 37.50s/it]Running generate_until requests:   6%|▌         | 11/200 [06:27<1:47:04, 33.99s/it]Running generate_until requests:   6%|▌         | 12/200 [07:13<1:58:10, 37.71s/it]Running generate_until requests:   6%|▋         | 13/200 [07:51<1:57:20, 37.65s/it]Running generate_until requests:   7%|▋         | 14/200 [08:21<1:49:48, 35.42s/it]Running generate_until requests:   8%|▊         | 15/200 [08:55<1:47:31, 34.87s/it]Running generate_until requests:   8%|▊         | 16/200 [09:28<1:45:45, 34.49s/it]Running generate_until requests:   8%|▊         | 17/200 [10:16<1:57:26, 38.50s/it]Running generate_until requests:   9%|▉         | 18/200 [10:45<1:47:55, 35.58s/it]Running generate_until requests:  10%|▉         | 19/200 [11:05<1:33:34, 31.02s/it]Running generate_until requests:  10%|█         | 20/200 [11:34<1:31:00, 30.33s/it]Running generate_until requests:  10%|█         | 21/200 [11:58<1:24:35, 28.35s/it]Running generate_until requests:  11%|█         | 22/200 [12:25<1:23:21, 28.10s/it]Running generate_until requests:  12%|█▏        | 23/200 [13:01<1:29:20, 30.29s/it]Running generate_until requests:  12%|█▏        | 24/200 [13:18<1:17:13, 26.33s/it]Running generate_until requests:  12%|█▎        | 25/200 [13:54<1:25:06, 29.18s/it]Running generate_until requests:  13%|█▎        | 26/200 [14:18<1:20:37, 27.80s/it]Running generate_until requests:  14%|█▎        | 27/200 [15:29<1:57:12, 40.65s/it]Running generate_until requests:  14%|█▍        | 28/200 [16:12<1:58:14, 41.25s/it]Running generate_until requests:  14%|█▍        | 29/200 [16:32<1:39:48, 35.02s/it]Running generate_until requests:  15%|█▌        | 30/200 [16:59<1:32:29, 32.65s/it]Running generate_until requests:  16%|█▌        | 31/200 [17:41<1:39:48, 35.44s/it]Running generate_until requests:  16%|█▌        | 32/200 [18:19<1:41:03, 36.09s/it]Running generate_until requests:  16%|█▋        | 33/200 [18:34<1:22:41, 29.71s/it]Running generate_until requests:  17%|█▋        | 34/200 [18:53<1:14:04, 26.78s/it]Running generate_until requests:  18%|█▊        | 35/200 [19:12<1:06:40, 24.25s/it]Running generate_until requests:  18%|█▊        | 36/200 [19:43<1:11:35, 26.19s/it]Running generate_until requests:  18%|█▊        | 37/200 [20:07<1:09:34, 25.61s/it]Running generate_until requests:  19%|█▉        | 38/200 [21:02<1:33:22, 34.58s/it]Running generate_until requests:  20%|█▉        | 39/200 [21:28<1:25:46, 31.96s/it]Running generate_until requests:  20%|██        | 40/200 [21:54<1:20:29, 30.18s/it]Running generate_until requests:  20%|██        | 41/200 [22:13<1:11:00, 26.80s/it]Running generate_until requests:  21%|██        | 42/200 [22:44<1:13:24, 27.87s/it]Running generate_until requests:  22%|██▏       | 43/200 [23:17<1:17:31, 29.63s/it]Running generate_until requests:  22%|██▏       | 44/200 [23:42<1:12:55, 28.05s/it]Running generate_until requests:  22%|██▎       | 45/200 [24:06<1:09:21, 26.85s/it]Running generate_until requests:  23%|██▎       | 46/200 [24:33<1:09:23, 27.03s/it]Running generate_until requests:  24%|██▎       | 47/200 [24:56<1:06:02, 25.90s/it]Running generate_until requests:  24%|██▍       | 48/200 [25:17<1:01:21, 24.22s/it]Running generate_until requests:  24%|██▍       | 49/200 [25:45<1:04:21, 25.57s/it]Running generate_until requests:  25%|██▌       | 50/200 [26:30<1:18:13, 31.29s/it]Running generate_until requests:  26%|██▌       | 51/200 [27:11<1:25:08, 34.29s/it]Running generate_until requests:  26%|██▌       | 52/200 [27:32<1:14:45, 30.31s/it]Running generate_until requests:  26%|██▋       | 53/200 [28:06<1:16:33, 31.25s/it]Running generate_until requests:  27%|██▋       | 54/200 [28:55<1:28:53, 36.53s/it]Running generate_until requests:  28%|██▊       | 55/200 [29:42<1:36:21, 39.87s/it]Running generate_until requests:  28%|██▊       | 56/200 [30:39<1:47:37, 44.84s/it]Running generate_until requests:  28%|██▊       | 57/200 [31:04<1:32:35, 38.85s/it]Running generate_until requests:  29%|██▉       | 58/200 [31:33<1:25:16, 36.03s/it]Running generate_until requests:  30%|██▉       | 59/200 [31:56<1:15:36, 32.18s/it]Running generate_until requests:  30%|███       | 60/200 [32:27<1:14:14, 31.82s/it]Running generate_until requests:  30%|███       | 61/200 [32:58<1:12:55, 31.48s/it]Running generate_until requests:  31%|███       | 62/200 [33:19<1:05:32, 28.50s/it]Running generate_until requests:  32%|███▏      | 63/200 [33:53<1:08:51, 30.16s/it]Running generate_until requests:  32%|███▏      | 64/200 [34:33<1:14:57, 33.07s/it]Running generate_until requests:  32%|███▎      | 65/200 [34:56<1:07:13, 29.88s/it]Running generate_until requests:  33%|███▎      | 66/200 [35:16<1:00:17, 27.00s/it]Running generate_until requests:  34%|███▎      | 67/200 [35:47<1:02:15, 28.08s/it]Running generate_until requests:  34%|███▍      | 68/200 [36:18<1:03:50, 29.02s/it]Running generate_until requests:  34%|███▍      | 69/200 [36:49<1:04:25, 29.51s/it]Running generate_until requests:  35%|███▌      | 70/200 [37:08<57:33, 26.56s/it]  Running generate_until requests:  36%|███▌      | 71/200 [37:31<54:52, 25.52s/it]Running generate_until requests:  36%|███▌      | 72/200 [38:06<1:00:25, 28.32s/it]Running generate_until requests:  36%|███▋      | 73/200 [38:40<1:03:31, 30.01s/it]Running generate_until requests:  37%|███▋      | 74/200 [39:00<56:43, 27.01s/it]  Running generate_until requests:  38%|███▊      | 75/200 [39:19<51:11, 24.58s/it]Running generate_until requests:  38%|███▊      | 76/200 [39:46<51:59, 25.16s/it]Running generate_until requests:  38%|███▊      | 77/200 [40:32<1:04:42, 31.56s/it]Running generate_until requests:  39%|███▉      | 78/200 [41:02<1:03:16, 31.12s/it]Running generate_until requests:  40%|███▉      | 79/200 [41:42<1:08:20, 33.89s/it]Running generate_until requests:  40%|████      | 80/200 [42:11<1:04:37, 32.31s/it]Running generate_until requests:  40%|████      | 81/200 [42:40<1:02:05, 31.31s/it]Running generate_until requests:  41%|████      | 82/200 [43:04<57:03, 29.02s/it]  Running generate_until requests:  42%|████▏     | 83/200 [43:39<1:00:00, 30.77s/it]Running generate_until requests:  42%|████▏     | 84/200 [44:08<58:43, 30.38s/it]  Running generate_until requests:  42%|████▎     | 85/200 [44:29<52:50, 27.57s/it]Running generate_until requests:  43%|████▎     | 86/200 [44:48<47:38, 25.07s/it]Running generate_until requests:  44%|████▎     | 87/200 [45:22<52:12, 27.72s/it]Running generate_until requests:  44%|████▍     | 88/200 [45:46<49:25, 26.48s/it]Running generate_until requests:  44%|████▍     | 89/200 [46:14<49:44, 26.89s/it]Running generate_until requests:  45%|████▌     | 90/200 [46:32<44:46, 24.42s/it]Running generate_until requests:  46%|████▌     | 91/200 [47:04<48:27, 26.68s/it]Running generate_until requests:  46%|████▌     | 92/200 [47:35<49:59, 27.77s/it]Running generate_until requests:  46%|████▋     | 93/200 [48:06<51:21, 28.80s/it]Running generate_until requests:  47%|████▋     | 94/200 [48:35<50:59, 28.86s/it]Running generate_until requests:  48%|████▊     | 95/200 [48:59<48:16, 27.58s/it]Running generate_until requests:  48%|████▊     | 96/200 [49:25<46:50, 27.02s/it]Running generate_until requests:  48%|████▊     | 97/200 [49:42<41:23, 24.12s/it]Running generate_until requests:  49%|████▉     | 98/200 [50:08<41:58, 24.69s/it]Running generate_until requests:  50%|████▉     | 99/200 [50:27<38:18, 22.76s/it]Running generate_until requests:  50%|█████     | 100/200 [50:47<36:32, 21.92s/it]Running generate_until requests:  50%|█████     | 101/200 [51:22<42:54, 26.01s/it]Running generate_until requests:  51%|█████     | 102/200 [51:47<41:43, 25.55s/it]Running generate_until requests:  52%|█████▏    | 103/200 [52:27<48:13, 29.83s/it]Running generate_until requests:  52%|█████▏    | 104/200 [52:46<42:46, 26.73s/it]Running generate_until requests:  52%|█████▎    | 105/200 [53:16<43:57, 27.76s/it]Running generate_until requests:  53%|█████▎    | 106/200 [53:45<44:08, 28.17s/it]Running generate_until requests:  54%|█████▎    | 107/200 [54:22<47:34, 30.69s/it]