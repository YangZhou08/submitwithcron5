Your branch is up to date with 'origin/addinggriffin'.
Already up to date.
Already up to date.
/fsx-storygen/beidic/anaconda3/envs/griffin/bin/python
/fsx-storygen/beidic/anaconda3/envs/griffin/bin/python
The token has not been saved to the git credentials helper. Pass `add_to_git_credential=True` in this function directly or `--add-to-git-credential` if using via `huggingface-cli` if you want to set the git credential as well.
Token is valid (permission: fineGrained).
Your token has been saved to /data/home/beidic/.cache/huggingface/token
Login successful
NCCL_TIMEOUT 1800
NCCL_TIMEOUT 1800
NCCL_TIMEOUT 1800
NCCL_TIMEOUT 1800
NCCL_TIMEOUT 1800
NCCL_TIMEOUT 1800
NCCL_TIMEOUT 1800
NCCL_TIMEOUT 1800
is_distributed True
Namespace(tasks='csqa,strategyqa,sports,date', model='meta-llama/Meta-Llama-3-8B-Instruct', device=None, limit=None, griffin=True, cats=False, check=True, kernel_size=16, spr=0.4, thr=0.1, widthtree=1, patternstrict=False, shotfive=True, shottwo=False, filteractiveenabled=False)
is_distributed True
Namespace(tasks='csqa,strategyqa,sports,date', model='meta-llama/Meta-Llama-3-8B-Instruct', device=None, limit=None, griffin=True, cats=False, check=True, kernel_size=16, spr=0.4, thr=0.1, widthtree=1, patternstrict=False, shotfive=True, shottwo=False, filteractiveenabled=False)
is_distributed True
Namespace(tasks='csqa,strategyqa,sports,date', model='meta-llama/Meta-Llama-3-8B-Instruct', device=None, limit=None, griffin=True, cats=False, check=True, kernel_size=16, spr=0.4, thr=0.1, widthtree=1, patternstrict=False, shotfive=True, shottwo=False, filteractiveenabled=False)
We now use eos_token as pad token
is_distributed True
Namespace(tasks='csqa,strategyqa,sports,date', model='meta-llama/Meta-Llama-3-8B-Instruct', device=None, limit=None, griffin=True, cats=False, check=True, kernel_size=16, spr=0.4, thr=0.1, widthtree=1, patternstrict=False, shotfive=True, shottwo=False, filteractiveenabled=False)
is_distributed True
Namespace(tasks='csqa,strategyqa,sports,date', model='meta-llama/Meta-Llama-3-8B-Instruct', device=None, limit=None, griffin=True, cats=False, check=True, kernel_size=16, spr=0.4, thr=0.1, widthtree=1, patternstrict=False, shotfive=True, shottwo=False, filteractiveenabled=False)
is_distributed True
is_distributed Trueis_distributed True

Namespace(tasks='csqa,strategyqa,sports,date', model='meta-llama/Meta-Llama-3-8B-Instruct', device=None, limit=None, griffin=True, cats=False, check=True, kernel_size=16, spr=0.4, thr=0.1, widthtree=1, patternstrict=False, shotfive=True, shottwo=False, filteractiveenabled=False)
Namespace(tasks='csqa,strategyqa,sports,date', model='meta-llama/Meta-Llama-3-8B-Instruct', device=None, limit=None, griffin=True, cats=False, check=True, kernel_size=16, spr=0.4, thr=0.1, widthtree=1, patternstrict=False, shotfive=True, shottwo=False, filteractiveenabled=False)Namespace(tasks='csqa,strategyqa,sports,date', model='meta-llama/Meta-Llama-3-8B-Instruct', device=None, limit=None, griffin=True, cats=False, check=True, kernel_size=16, spr=0.4, thr=0.1, widthtree=1, patternstrict=False, shotfive=True, shottwo=False, filteractiveenabled=False)

We now use eos_token as pad token
We now use eos_token as pad token
beam width is 8
We now use eos_token as pad token
We now use eos_token as pad token
We now use eos_token as pad token
We now use eos_token as pad token
We now use eos_token as pad token
beam width is 8
beam width is 8
beam width is 8
beam width is 8
beam width is 8
beam width is 8
beam width is 8
tasks ['csqa', 'strategyqa', 'sports', 'date']
tasks ['csqa', 'strategyqa', 'sports', 'date']tasks ['csqa', 'strategyqa', 'sports', 'date']

tasks ['csqa', 'strategyqa', 'sports', 'date']
tasks ['csqa', 'strategyqa', 'sports', 'date']
tasks ['csqa', 'strategyqa', 'sports', 'date']
tasks ['csqa', 'strategyqa', 'sports', 'date']
tasks ['csqa', 'strategyqa', 'sports', 'date']
length of dataset:  1224
length of dataset:  1224
beamwidth is 1
length of dataset:  1224
length of dataset:  1224
length of dataset:  1224
beamwidth is 1
beamwidth is 1
length of dataset:  1224
beamwidth is 1
length of dataset:  1224
beamwidth is 1
beamwidth is 1
beamwidth is 1
length of dataset:  1224
beamwidth is 1
Answer e expected b
Answer e expected e
Answer a expected a
Answer c expected c
Answer a expected a
Answer s expected d
Answer c expected c
Answer b expected c
Answer e expected e
Answer c expected c
Answer e expected b
Answer d expected d
Answer a expected a
Answer b expected a
Answer d expected d
Answer a expected a
Answer d expected d
Answer b expected d
Answer d expected d
Answer a expected a
Answer e expected c
Answer e expected e
Answer s expected e
Answer s expected a
Answer e expected e
Answer a expected a
Answer e expected d
Answer a expected a
Answer d expected d
Answer c expected c
Answer a expected a
Answer d expected d
Answer a expected d
Answer b expected d
Answer d expected d
Answer i expected b
Answer c expected c
Answer e expected e
Answer e expected e
Answer e expected a
Answer e expected e
Answer b expected b
Answer d expected d
Answer e expected e
Answer b expected e
Answer b expected b
Answer d expected d
Answer d expected d
Answer d expected b
Answer h expected a
Answer e expected a
Answer a expected a
Answer e expected e
Skipping the batch
Answer a expected a
Answer h expected b
Answer m expected e
Answer b expected b
Answer o expected a
Answer b expected b
Answer e expected e
Answer d expected d
Answer b expected c
Answer e expected e
Answer c expected c
Answer b expected b
Answer a expected a
Answer e expected e
Answer e expected e
Answer b expected b
Answer b expected b
Answer c expected c
Answer b expected d
Answer e expected d
Answer e expected e
Answer d expected d
Answer b expected e
Answer p expected d
Answer c expected d
Answer e expected e
Answer c expected a
Answer a expected a
Answer d expected d
Answer e expected e
Answer d expected d
Answer e expected e
Answer c expected c
Answer b expected b
Answer s expected b
Answer b expected b
Answer e expected e
Answer c expected a
Answer c expected c
Answer d expected d
Skipping the batch
Answer a expected a
Skipping the batch
Answer b expected b
Answer d expected d
Answer b expected d
Answer a expected a
Answer d expected d
Answer e expected a
Answer e expected c
Answer a expected a
Answer a expected a
Answer d expected d
Answer e expected b
Answer e expected e
Answer e expected e
Answer b expected b
Answer e expected c
Answer   expected a
Answer c expected c
Answer b expected b
Answer a expected a
Answer e expected e
Answer e expected e
Answer b expected b
Answer e expected b
Answer c expected a
Answer b expected b
Answer c expected c
Answer b expected b
index 5 start communication
index 6 start communication
index 3 start communication
Answer d expected d
Answer a expected e
index 2 start communication
Answer d expected c
index 4 start communication
Answer a expected e
Answer d expected e
Answer a expected a
index 7 start communication
Answer d expected d
Answer a expected a
Answer d expected d
Answer c expected c
Answer d expected d
Answer d expected d
Answer d expected d
Answer e expected e
Answer b expected b
Answer e expected b
Answer b expected b
Answer c expected e
Answer a expected a
Answer e expected d
Answer a expected a
Answer e expected b
Answer b expected b
Answer b expected b
Answer d expected e
Answer d expected d
Answer e expected e
Answer w expected b
Answer e expected c
Answer e expected e
Answer b expected b
index 0 start communication
index 1 start communication
Here are the statistics for inference
Here are the statistics for inference
Here are the statistics for inference
Here are the statistics for inference
Here are the statistics for inference
Here are the statistics for inference
Here are the statistics for inferenceHere are the statistics for inference

+--------+----------------+---------------------------+-----------------------------+---------------+-------------+--------+--------------------------------+------------------+----------------------------------+-----------------------+----------------------+
| Task   |   Num Sentence |   Total Generation Length |   Average Generation Length |   Total Steps |   Num Steps |    AAL |   Total Roll Back Length Error |   Error Instance |   Average Roll Back Length Error |   Effective Tree Size |   Drafting Tree Size |
+========+================+===========================+=============================+===============+=============+========+================================+==================+==================================+=======================+======================+
| csqa   |           1221 |                    130296 |                     106.713 |        111750 |       11441 | 9.7675 |                          71306 |             7659 |                          9.31009 |                    16 |                    1 |
+--------+----------------+---------------------------+-----------------------------+---------------+-------------+--------+--------------------------------+------------------+----------------------------------+-----------------------+----------------------+
Answer no expected no
Answer no expected no
Answer no expected no
Answer yes expected yes
Answer no expected no
Answer no expected no
Answer no expected yes
Answer yes expected yes
Skipping the batch
Answer no expected yes
Skipping the batch
Answer no expected no
Skipping the batch
Skipping the batch
Answer uires a society to be made. a society requires a complex system of production, distribution, and consumption. a society requires a system of government, laws, and regulations. a society requires a system of education, training, and skills. a society requires a system of communication, transportation, and infrastructure. a society requires a system of economy, trade, and commerce. a society requires a system of culture, art, and entertainment. a society requires a system of science, technology, and innovation. a society requires a system of healthcare, medicine, and research. a society requires a system of food, water, and shelter. a society requires a system of energy, resources, and waste management. a society requires a system of governance, diplomacy, and international relations. a society requires a system of education, training, and skills. a society requires a system of communication, transportation, and infrastructure. a society requires a system of economy, trade, and commerce. a society requires a system of culture, art, and entertainment. a society requires a system of science, technology, and innovation. a society requires a system of healthcare, medicine, and research. a society requires a system of food, water, and shelter. a society requires a system of energy, resources, and wast expected no
Answer no expected no
Answer no expected yes
Answer no expected yes
Answer no expected yes
Answer yes expected yes
Answer yes expected no
Answer no expected no
Answer no expected no
Answer no expected no
Answer no expected no
Answer no expected no
Answer no expected no
Answer no expected yes
Answer no expected no
Answer no expected no
Answer no expected no
Answer yes expected yes
Answer yes expected no
Answer no expected no
Skipping the batch
Answer no expected no
Answer no expected no
Skipping the batch
Answer yes expected yes
Answer no expected no
Answer no expected no
Skipping the batch
Answer yes expected yes
Answer no expected no
Answer no expected no
Answer no expected no
Answer yes expected yes
Answer no expected yes
Answer no expected no
Answer no expected no
Answer no expected no
Answer yes expected yes
Answer no expected no
Answer no expected no
index 3 start communication
index 7 start communication
index 5 start communication
index 6 start communication
index 2 start communication
Answer no expected no
Answer no expected no
index 4 start communication
Answer yes expected yes
Answer yes expected yes
Answer no expected yes
Answer no expected no
Answer yes expected yes
Answer yes expected yes
Answer yes expected no
Answer no expected no
index 0 start communication
index 1 start communication
Here are the statistics for inference
Here are the statistics for inferenceHere are the statistics for inference

Here are the statistics for inference
Here are the statistics for inference
Here are the statistics for inference
Here are the statistics for inference
Here are the statistics for inference
+------------+----------------+---------------------------+-----------------------------+---------------+-------------+---------+--------------------------------+------------------+----------------------------------+-----------------------+----------------------+
| Task       |   Num Sentence |   Total Generation Length |   Average Generation Length |   Total Steps |   Num Steps |     AAL |   Total Roll Back Length Error |   Error Instance |   Average Roll Back Length Error |   Effective Tree Size |   Drafting Tree Size |
+============+================+===========================+=============================+===============+=============+=========+================================+==================+==================================+=======================+======================+
| strategyqa |            457 |                     22513 |                     49.2626 |         15400 |        2942 | 5.23453 |                          31672 |             2739 |                          11.5633 |                    16 |                    1 |
+------------+----------------+---------------------------+-----------------------------+---------------+-------------+---------+--------------------------------+------------------+----------------------------------+-----------------------+----------------------+
Answer plausible expected plausible
Answer implausible expected implausible
Answer implausible expected implausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer implausible expected implausible
Answer implausible expected implausible
Answer implausible expected implausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer implausible expected implausible
Answer plausible expected plausible
Answer implausible expected implausible
Answer plausible expected plausible
Answer plausible expected plausible
Skipping the batch
Answer plausible expected plausible
Answer plausible expected plausible
Answer implausible expected implausible
Answer implausible expected implausible
Answer implausible expected implausible
Answer implausible expected implausible
Answer implausible expected implausible
Answer implausible expected implausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer implausible expected implausible
Answer plausible expected plausible
Answer implausible expected implausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer implausible expected implausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer implausible expected implausible
Answer implausible expected implausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer implausible expected implausible
Skipping the batch
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer implausible expected implausible
Answer plausible expected plausible
Answer plausible expected implausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer implausible expected implausible
Answer implausible expected implausible
Answer implausible expected implausible
Answer plausible expected plausible
Answer implausible expected implausible
Answer implausible expected plausible
Answer plausible expected plausible
Answer implausible expected implausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected implausible
Answer plausible expected plausible
Skipping the batch
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer implausible expected implausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer implausible expected implausible
Answer plausible expected plausible
Answer implausible expected implausible
Answer implausible expected implausible
Skipping the batch
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer plausible expected plausible
Answer implausible expected implausible
Answer plausible expected plausible
Answer implausible expected implausible
Answer plausible expected plausible
Answer plausible expected implausible
Answer plausible expected plausible
Answer implausible expected implausible
Answer plausible expected plausible
Answer plausible expected plausible
Skipping the batch
Answer implausible expected implausible
Answer plausible expected plausible
Answer implausible expected implausible
Answer implausible expected implausible
Answer plausible expected plausible
Answer implausible expected implausible
Answer plausible expected plausible
Answer implausible expected implausible
Answer plausible expected plausible
Answer implausible expected implausible
index 6 start communication
index 7 start communication
Answer implausible expected implausible
Answer plausible expected plausible
index 4 start communication
Answer implausible expected implausible
index 3 start communication
Answer implausible expected implausible
index 5 start communication
Answer plausible expected implausible
Answer implausible expected implausible
Answer plausible expected implausible
Answer plausible expected plausible
index 1 start communication
Answer implausible expected implausible
Answer plausible expected plausible
Answer plausible expected plausible
Skipping the batch
Answer implausible expected implausible
Answer plausible expected plausible
Answer implausible expected implausible
Answer plausible expected plausible
Answer implausible expected implausible
Answer plausible expected implausible
Answer implausible expected implausible
Answer implausible expected implausible
Answer implausible expected implausible
Answer implausible expected implausible
Answer implausible expected implausible
Answer implausible expected implausible
Answer implausible expected plausible
Answer implausible expected implausible
index 0 start communication
index 2 start communication
Here are the statistics for inference
Here are the statistics for inferenceHere are the statistics for inference

Here are the statistics for inference
Here are the statistics for inferenceHere are the statistics for inferenceHere are the statistics for inference


Here are the statistics for inference
+--------+----------------+---------------------------+-----------------------------+---------------+-------------+---------+--------------------------------+------------------+----------------------------------+-----------------------+----------------------+
| Task   |   Num Sentence |   Total Generation Length |   Average Generation Length |   Total Steps |   Num Steps |     AAL |   Total Roll Back Length Error |   Error Instance |   Average Roll Back Length Error |   Effective Tree Size |   Drafting Tree Size |
+========+================+===========================+=============================+===============+=============+=========+================================+==================+==================================+=======================+======================+
| sports |            970 |                     36440 |                      37.567 |         19950 |        1859 | 10.7316 |                           9794 |              968 |                          10.1178 |                    16 |                    1 |
+--------+----------------+---------------------------+-----------------------------+---------------+-------------+---------+--------------------------------+------------------+----------------------------------+-----------------------+----------------------+
Answer 12/31/2011 expected 12/31/2011
Answer 05/22/1943 expected 05/23/1943
Answer 02/29/2008 expected 02/29/2008
Answer 12/31/1929 expected 12/31/1929
Answer 6/20/2019 expected 06/20/2019
Answer 6/28/2002 expected 06/28/2002
Skipping the batch
Skipping the batch
Answer 5/29/2020 expected 05/30/2020
Answer 01/01/2018 expected 01/07/2018
Answer 01/09/1963 expected 01/09/1961
Answer 03/01/2017 expected 03/01/2017
Answer 04/30/2021 expected 04/30/2021
Skipping the batch
Answer 12/23/1962 expected 12/23/1960
Skipping the batch
Answer 04/03/1985 expected 04/03/1985
Answer 02/16/2009 expected 02/16/2009
Skipping the batch
Answer 01/01/1900 expected 01/01/1900
Answer 06/09/1943 expected 06/09/1943
Answer 02/29/2016 expected 02/29/2016
Answer 8/4/2002 expected 08/04/2002
Answer 11/18/1933 expected 11/18/1933
Answer 01/22/1987 expected 12/23/1986
Answer 06/02/1942 expected 06/02/1942
Answer 12/23/2007 expected 12/23/2007
Answer 02/19/2016 expected 02/19/2016
Answer 03/07/2016 expected 03/07/2016
Answer 08/06/2020 expected 09/05/2020
Answer 11/2/2019 expected 11/01/2019
Answer 02/01/2020 expected 02/01/2020
Answer 01/01/2015 expected 12/30/2014
Skipping the batch
Answer 02/21/2017 expected 02/21/2017
Answer 10/17/1924 expected 10/16/1924
Answer 06/02/1943 expected 06/02/1943
Answer 01/02/2007 expected 01/02/2007
Answer 01/02/2020 expected 01/02/2020
Answer 6/18/2018 expected 06/18/2018
Skipping the batch
Answer 11/21/2001 expected 11/21/2002
index 5 start communication
Answer 4/12/1969 expected 04/12/1969
index 6 start communication
index 4 start communication
Answer 02/25/1973 expected 02/23/1973
index 7 start communication
index 3 start communication
Answer 6/25/2019 expected 06/25/2019
Answer 02/03/2020 expected 02/03/2020
Answer 08/09/2021 expected 08/08/2021
Answer 7/8/1972 expected 07/07/1972
Answer 06/17/2017 expected 06/18/2017
index 1 start communication
index 2 start communication
Answer 03/12/2001 expected 03/12/2001
Answer 9/16/1924 expected 09/15/1924
Answer 02/28/2016 expected 02/28/2016
index 0 start communication
Here are the statistics for inference
Here are the statistics for inference
Here are the statistics for inferenceHere are the statistics for inference

Here are the statistics for inference
Here are the statistics for inference
+--------+----------------+---------------------------+-----------------------------+---------------+-------------+---------+--------------------------------+------------------+----------------------------------+-----------------------+----------------------+
| Task   |   Num Sentence |   Total Generation Length |   Average Generation Length |   Total Steps |   Num Steps |     AAL |   Total Roll Back Length Error |   Error Instance |   Average Roll Back Length Error |   Effective Tree Size |   Drafting Tree Size |
+========+================+===========================+=============================+===============+=============+=========+================================+==================+==================================+=======================+======================+
| date   |            353 |                     23321 |                     66.0652 |         17560 |        1322 | 13.2829 |                           3592 |              415 |                          8.65542 |                    16 |                    1 |
+--------+----------------+---------------------------+-----------------------------+---------------+-------------+---------+--------------------------------+------------------+----------------------------------+-----------------------+----------------------+
Namespace(tasks='csqa,strategyqa,sports,date', model='meta-llama/Meta-Llama-3-8B-Instruct', device='cuda:0', limit=None, griffin=True, cats=False, check=True, kernel_size=16, spr=0.4, thr=0.1, widthtree=1, patternstrict=False, shotfive=True, shottwo=False, filteractiveenabled=False)
+------------+---------+-----------+--------------+
| Task       |   Total |   Correct |   Solve Rate |
+============+=========+===========+==============+
| csqa       |    1221 |       856 |     0.701065 |
+------------+---------+-----------+--------------+
| strategyqa |     457 |       346 |     0.757112 |
+------------+---------+-----------+--------------+
| sports     |     970 |       918 |     0.946392 |
+------------+---------+-----------+--------------+
| date       |     353 |       234 |     0.66289  |
+------------+---------+-----------+--------------+
Here are the statistics for inference
Here are the statistics for inference
