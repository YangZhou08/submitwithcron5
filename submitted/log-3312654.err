Already on 'addinggriffin'
wandb: Currently logged in as: stevenzhou0816100. Use `wandb login --relogin` to force relogin
The following values were not passed to `accelerate launch` and had defaults used instead:
		More than one GPU was found, enabling multi-GPU training.
		If this was unintended please pass in `--num_processes=1`.
	`--mixed_precision` was set to a value of `'no'`
	`--dynamo_backend` was set to a value of `'no'`
To avoid this warning pass in values for each of the problematic parameters or run `accelerate config`.
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:19<00:59, 19.98s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:20<01:01, 20.66s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:21<01:03, 21.04s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:20<01:01, 20.47s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:20<01:02, 20.75s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:20<01:01, 20.47s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:20<01:01, 20.61s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:20<01:02, 20.71s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:38<00:38, 19.21s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:39<00:39, 19.69s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:39<00:39, 19.77s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:39<00:39, 19.80s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:39<00:40, 20.00s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:39<00:39, 19.69s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:39<00:39, 19.80s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:39<00:39, 19.86s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:54<00:17, 17.33s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:55<00:17, 17.96s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:55<00:17, 17.88s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:55<00:17, 17.92s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:55<00:18, 18.15s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:55<00:17, 17.91s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:55<00:17, 17.86s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:55<00:17, 17.85s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:56<00:00, 11.27s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:56<00:00, 14.06s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:56<00:00, 11.40s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:56<00:00, 14.21s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:57<00:00, 11.50s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:57<00:00, 14.28s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:57<00:00, 11.42s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:57<00:00, 14.26s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:56<00:00, 11.39s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:56<00:00, 14.19s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:57<00:00, 11.56s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:57<00:00, 14.33s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:56<00:00, 11.42s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:56<00:00, 14.25s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:57<00:00, 11.48s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:57<00:00, 14.27s/it]
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:369: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:369: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:369: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:369: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:369: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:369: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:369: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:369: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
  3%|▎         | 1/32 [00:05<02:52,  5.58s/it]  3%|▎         | 1/32 [00:05<03:02,  5.89s/it]  3%|▎         | 1/32 [00:06<03:16,  6.35s/it]  6%|▋         | 2/32 [00:08<02:03,  4.10s/it]  6%|▋         | 2/32 [00:09<02:08,  4.28s/it]  3%|▎         | 1/32 [00:08<04:34,  8.86s/it]  6%|▋         | 2/32 [00:10<02:40,  5.33s/it]  9%|▉         | 3/32 [00:11<01:39,  3.43s/it]  6%|▋         | 2/32 [00:11<02:31,  5.06s/it]  9%|▉         | 3/32 [00:11<01:44,  3.61s/it]  9%|▉         | 3/32 [00:13<01:44,  3.59s/it] 12%|█▎        | 4/32 [00:17<01:50,  3.94s/it] 12%|█▎        | 4/32 [00:19<02:24,  5.17s/it] 16%|█▌        | 5/32 [00:21<01:44,  3.85s/it] 16%|█▌        | 5/32 [00:22<01:59,  4.43s/it] 19%|█▉        | 6/32 [00:23<01:25,  3.28s/it] 22%|██▏       | 7/32 [00:24<01:06,  2.66s/it] 19%|█▉        | 6/32 [00:27<02:01,  4.67s/it]  3%|▎         | 1/32 [00:31<16:31, 31.98s/it]  3%|▎         | 1/32 [00:32<16:46, 32.46s/it]  6%|▋         | 2/32 [00:39<08:39, 17.30s/it]  9%|▉         | 3/32 [00:40<07:59, 16.53s/it] 12%|█▎        | 4/32 [00:42<06:34, 14.08s/it]  9%|▉         | 3/32 [00:44<05:43, 11.85s/it]  3%|▎         | 1/32 [00:44<23:09, 44.84s/it]  6%|▋         | 2/32 [00:46<09:51, 19.73s/it]  3%|▎         | 1/32 [00:49<25:21, 49.10s/it]  9%|▉         | 3/32 [00:52<06:28, 13.40s/it]  6%|▋         | 2/32 [00:53<11:26, 22.88s/it] 25%|██▌       | 8/32 [00:54<04:30, 11.27s/it] 22%|██▏       | 7/32 [00:57<05:21, 12.87s/it] 28%|██▊       | 9/32 [00:58<03:23,  8.83s/it] 31%|███▏      | 10/32 [00:59<02:25,  6.62s/it] 34%|███▍      | 11/32 [01:00<01:44,  4.96s/it]  6%|▋         | 2/32 [01:00<15:06, 30.22s/it] 12%|█▎        | 4/32 [01:01<07:08, 15.30s/it]
 25%|██▌       | 8/32 [01:02<04:11, 10.47s/it]  9%|▉         | 3/32 [01:04<08:20, 17.27s/it] 28%|██▊       | 9/32 [01:04<02:59,  7.79s/it] 12%|█▎        | 4/32 [01:10<10:08, 21.73s/it] 12%|█▎        | 4/32 [01:14<08:47, 18.83s/it]  9%|▉         | 3/32 [01:29<14:20, 29.66s/it] 38%|███▊      | 12/32 [01:30<04:09, 12.49s/it] 41%|████      | 13/32 [01:33<03:02,  9.61s/it] 31%|███▏      | 10/32 [01:33<05:18, 14.48s/it] 16%|█▌        | 5/32 [01:39<11:02, 24.55s/it] 34%|███▍      | 11/32 [01:40<04:11, 11.97s/it] 38%|███▊      | 12/32 [01:42<03:01,  9.09s/it] 12%|█▎        | 4/32 [01:43<13:02, 27.96s/it] 16%|█▌        | 5/32 [01:43<10:13, 22.71s/it] 12%|█▎        | 4/32 [01:54<14:11, 30.39s/it] 12%|█▎        | 4/32 [01:59<13:45, 29.49s/it] 44%|████▍     | 14/32 [02:03<04:41, 15.65s/it] 47%|████▋     | 15/32 [02:05<03:15, 11.48s/it] 19%|█▉        | 6/32 [02:09<11:23, 26.28s/it] 41%|████      | 13/32 [02:12<04:50, 15.29s/it] 19%|█▉        | 6/32 [02:12<10:49, 24.97s/it] 44%|████▍     | 14/32 [02:18<03:48, 12.68s/it] 47%|████▋     | 15/32 [02:22<02:46,  9.81s/it] 16%|█▌        | 5/32 [02:28<13:13, 29.39s/it] 16%|█▌        | 5/32 [02:32<16:07, 35.82s/it] 50%|█████     | 16/32 [02:34<04:30, 16.92s/it] 53%|█████▎    | 17/32 [02:38<03:17, 13.15s/it] 22%|██▏       | 7/32 [02:39<11:24, 27.39s/it] 22%|██▏       | 7/32 [02:42<10:59, 26.40s/it] 25%|██▌       | 8/32 [02:42<07:55, 19.83s/it] 56%|█████▋    | 18/32 [02:43<02:28, 10.62s/it] 16%|█▌        | 5/32 [02:44<16:53, 37.54s/it] 28%|██▊       | 9/32 [02:46<05:36, 14.64s/it] 25%|██▌       | 8/32 [02:46<07:42, 19.28s/it] 31%|███▏      | 10/32 [02:49<04:08, 11.29s/it] 59%|█████▉    | 19/32 [02:51<02:06,  9.71s/it] 50%|█████     | 16/32 [02:51<04:12, 15.78s/it] 34%|███▍      | 11/32 [02:52<02:59,  8.56s/it] 38%|███▊      | 12/32 [02:54<02:15,  6.77s/it] 53%|█████▎    | 17/32 [02:54<02:58, 11.91s/it] 19%|█▉        | 6/32 [02:54<12:11, 28.15s/it] 56%|█████▋    | 18/32 [02:56<02:05,  8.97s/it] 19%|█▉        | 6/32 [02:57<12:44, 29.39s/it] 22%|██▏       | 7/32 [03:01<08:44, 20.99s/it] 28%|██▊       | 9/32 [03:15<08:34, 22.39s/it] 62%|██████▎   | 20/32 [03:20<03:07, 15.66s/it] 19%|█▉        | 6/32 [03:22<17:36, 40.64s/it] 41%|████      | 13/32 [03:24<04:20, 13.72s/it] 59%|█████▉    | 19/32 [03:26<03:16, 15.14s/it] 22%|██▏       | 7/32 [03:27<12:13, 29.33s/it] 44%|████▍     | 14/32 [03:28<03:11, 10.61s/it] 62%|██████▎   | 20/32 [03:28<02:14, 11.18s/it] 25%|██▌       | 8/32 [03:29<08:16, 20.69s/it] 66%|██████▌   | 21/32 [03:33<01:42,  9.30s/it] 31%|███▏      | 10/32 [03:45<09:00, 24.58s/it] 34%|███▍      | 11/32 [03:46<06:09, 17.61s/it] 38%|███▊      | 12/32 [03:50<04:24, 13.25s/it] 66%|██████▌   | 21/32 [03:50<03:38, 19.84s/it] 25%|██▌       | 8/32 [03:51<12:08, 30.34s/it] 41%|████      | 13/32 [03:54<03:19, 10.49s/it] 69%|██████▉   | 22/32 [03:55<02:34, 15.43s/it] 47%|████▋     | 15/32 [03:57<04:38, 16.36s/it] 28%|██▊       | 9/32 [03:58<08:57, 23.38s/it] 28%|██▊       | 9/32 [03:59<08:53, 23.22s/it] 72%|███████▏  | 23/32 [03:59<01:47, 11.99s/it] 31%|███▏      | 10/32 [04:01<06:13, 16.99s/it] 31%|███▏      | 10/32 [04:02<06:17, 17.16s/it] 34%|███▍      | 11/32 [04:02<04:18, 12.30s/it] 69%|██████▉   | 22/32 [04:02<02:33, 15.39s/it] 50%|█████     | 16/32 [04:03<03:29, 13.10s/it] 72%|███████▏  | 23/32 [04:04<01:40, 11.20s/it] 34%|███▍      | 11/32 [04:04<04:24, 12.62s/it] 53%|█████▎    | 17/32 [04:05<02:26,  9.77s/it] 56%|█████▋    | 18/32 [04:08<01:48,  7.72s/it] 59%|█████▉    | 19/32 [04:12<01:28,  6.78s/it] 22%|██▏       | 7/32 [04:13<18:13, 43.74s/it] 25%|██▌       | 8/32 [04:18<12:35, 31.46s/it] 44%|████▍     | 14/32 [04:23<04:50, 16.15s/it] 75%|███████▌  | 24/32 [04:29<02:18, 17.29s/it] 38%|███▊      | 12/32 [04:32<05:48, 17.44s/it] 78%|███████▊  | 25/32 [04:33<01:34, 13.46s/it] 75%|███████▌  | 24/32 [04:33<02:13, 16.72s/it] 34%|███▍      | 11/32 [04:35<08:46, 25.08s/it]
 78%|███████▊  | 25/32 [04:36<01:26, 12.43s/it] 62%|██████▎   | 20/32 [04:42<02:44, 13.67s/it] 66%|██████▌   | 21/32 [04:46<01:57, 10.64s/it] 69%|██████▉   | 22/32 [04:48<01:21,  8.13s/it] 47%|████▋     | 15/32 [04:53<05:42, 20.17s/it] 28%|██▊       | 9/32 [04:56<12:55, 33.72s/it] 50%|█████     | 16/32 [04:58<04:12, 15.77s/it] 41%|████      | 13/32 [05:01<06:39, 21.01s/it] 31%|███▏      | 10/32 [05:01<09:04, 24.73s/it] 81%|████████▏ | 26/32 [05:03<01:49, 18.31s/it] 44%|████▍     | 14/32 [05:04<04:42, 15.69s/it] 34%|███▍      | 11/32 [05:05<06:23, 18.25s/it] 81%|████████▏ | 26/32 [05:05<01:45, 17.56s/it] 47%|████▋     | 15/32 [05:07<03:20, 11.77s/it] 38%|███▊      | 12/32 [05:12<04:57, 14.87s/it] 41%|████      | 13/32 [05:16<03:40, 11.59s/it] 72%|███████▏  | 23/32 [05:17<02:10, 14.55s/it] 44%|████▍     | 14/32 [05:20<02:51,  9.51s/it] 78%|███████▊  | 25/32 [05:21<01:00,  8.69s/it] 81%|████████▏ | 26/32 [05:26<00:46,  7.82s/it] 53%|█████▎    | 17/32 [05:27<04:57, 19.82s/it] 56%|█████▋    | 18/32 [05:29<03:19, 14.25s/it] 84%|████████▍ | 27/32 [05:32<01:48, 21.70s/it] 84%|████████▍ | 27/32 [05:35<01:45, 21.17s/it] 88%|████████▊ | 28/32 [05:36<01:04, 16.17s/it] 50%|█████     | 16/32 [05:36<04:32, 17.04s/it] 88%|████████▊ | 28/32 [05:38<01:02, 15.71s/it] 91%|█████████ | 29/32 [05:38<00:36, 12.10s/it] 94%|█████████▍| 30/32 [05:40<00:17,  8.98s/it] 53%|█████▎    | 17/32 [05:41<03:18, 13.24s/it] 97%|█████████▋| 31/32 [05:42<00:06,  6.93s/it] 94%|█████████▍| 30/32 [05:44<00:19,  9.78s/it] 56%|█████▋    | 18/32 [05:46<02:32, 10.88s/it] 97%|█████████▋| 31/32 [05:46<00:07,  7.95s/it]100%|██████████| 32/32 [05:47<00:00,  6.09s/it]100%|██████████| 32/32 [05:47<00:00, 10.85s/it]
 59%|█████▉    | 19/32 [05:49<01:50,  8.51s/it] 47%|████▋     | 15/32 [05:51<04:31, 15.98s/it] 62%|██████▎   | 20/32 [05:52<01:22,  6.87s/it] 84%|████████▍ | 27/32 [05:56<01:07, 13.52s/it] 59%|█████▉    | 19/32 [05:58<04:04, 18.81s/it] 88%|████████▊ | 28/32 [06:01<00:44, 11.21s/it] 59%|█████▉    | 19/32 [06:01<04:07, 19.02s/it]
 91%|█████████ | 29/32 [06:08<00:30, 10.00s/it]100%|██████████| 32/32 [06:12<00:00, 13.69s/it]100%|██████████| 32/32 [06:12<00:00, 11.63s/it]
 66%|██████▌   | 21/32 [06:21<02:28, 13.53s/it] 50%|█████     | 16/32 [06:22<05:28, 20.51s/it] 69%|██████▉   | 22/32 [06:23<01:41, 10.17s/it] 72%|███████▏  | 23/32 [06:26<01:10,  7.80s/it] 75%|███████▌  | 24/32 [06:29<00:52,  6.58s/it] 53%|█████▎    | 17/32 [06:30<04:11, 16.76s/it] 78%|███████▊  | 25/32 [06:34<00:41,  5.96s/it] 94%|█████████▍| 30/32 [06:37<00:31, 15.59s/it] 97%|█████████▋| 31/32 [06:40<00:11, 11.72s/it] 56%|█████▋    | 18/32 [07:01<04:54, 21.03s/it] 81%|████████▏ | 26/32 [07:03<01:17, 12.86s/it] 59%|█████▉    | 19/32 [07:03<03:16, 15.14s/it] 84%|████████▍ | 27/32 [07:06<00:50, 10.10s/it] 88%|████████▊ | 28/32 [07:08<00:30,  7.55s/it]100%|██████████| 32/32 [07:10<00:00, 17.28s/it]100%|██████████| 32/32 [07:10<00:00, 13.46s/it]
 91%|█████████ | 29/32 [07:11<00:18,  6.10s/it] 94%|█████████▍| 30/32 [07:16<00:11,  5.79s/it] 97%|█████████▋| 31/32 [07:20<00:05,  5.29s/it] 62%|██████▎   | 20/32 [07:34<03:58, 19.89s/it]100%|██████████| 32/32 [07:49<00:00, 12.43s/it]100%|██████████| 32/32 [07:49<00:00, 14.67s/it]
 66%|██████▌   | 21/32 [08:05<04:16, 23.30s/it] 69%|██████▉   | 22/32 [08:36<04:16, 25.64s/it] 72%|███████▏  | 23/32 [08:39<02:49, 18.88s/it] 75%|███████▌  | 24/32 [09:10<03:00, 22.51s/it] 78%|███████▊  | 25/32 [09:41<02:55, 25.00s/it] 81%|████████▏ | 26/32 [09:48<01:57, 19.56s/it] 84%|████████▍ | 27/32 [09:50<01:12, 14.43s/it] 88%|████████▊ | 28/32 [09:54<00:44, 11.18s/it] 91%|█████████ | 29/32 [10:25<00:51, 17.13s/it] 94%|█████████▍| 30/32 [10:56<00:42, 21.31s/it] 97%|█████████▋| 31/32 [11:27<00:24, 24.21s/it]100%|██████████| 32/32 [11:29<00:00, 17.54s/it]100%|██████████| 32/32 [11:29<00:00, 21.55s/it]
[rank5]:[E ProcessGroupNCCL.cpp:523] [Rank 5] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=53, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600911 milliseconds before timing out.
[rank5]:[E ProcessGroupNCCL.cpp:537] Some NCCL operations have failed or timed out. Due to the asynchronous nature of CUDA kernels, subsequent GPU operations might run on corrupted/incomplete data.
[rank5]:[E ProcessGroupNCCL.cpp:543] To avoid data inconsistency, we are taking the entire process down.
[rank5]:[E ProcessGroupNCCL.cpp:1182] [Rank 5] NCCL watchdog thread terminated with exception: [Rank 5] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=53, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600911 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:525 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7f2730f86d87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x1e6 (0x7f273212e6e6 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::workCleanupLoop() + 0x19d (0x7f2732131c3d in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x119 (0x7f2732132839 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd6df4 (0x7f277be45df4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #5: <unknown function> + 0x8609 (0x7f277d239609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #6: clone + 0x43 (0x7f277d004353 in /lib/x86_64-linux-gnu/libc.so.6)

terminate called after throwing an instance of 'c10::DistBackendError'
  what():  [Rank 5] NCCL watchdog thread terminated with exception: [Rank 5] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=53, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600911 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:525 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7f2730f86d87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x1e6 (0x7f273212e6e6 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::workCleanupLoop() + 0x19d (0x7f2732131c3d in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x119 (0x7f2732132839 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd6df4 (0x7f277be45df4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #5: <unknown function> + 0x8609 (0x7f277d239609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #6: clone + 0x43 (0x7f277d004353 in /lib/x86_64-linux-gnu/libc.so.6)

Exception raised from ncclCommWatchdog at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:1186 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7f2730f86d87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0xdf6b11 (0x7f2731e88b11 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: <unknown function> + 0xd6df4 (0x7f277be45df4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #3: <unknown function> + 0x8609 (0x7f277d239609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #4: clone + 0x43 (0x7f277d004353 in /lib/x86_64-linux-gnu/libc.so.6)

[rank4]:[E ProcessGroupNCCL.cpp:523] [Rank 4] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=53, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600343 milliseconds before timing out.
[rank4]:[E ProcessGroupNCCL.cpp:537] Some NCCL operations have failed or timed out. Due to the asynchronous nature of CUDA kernels, subsequent GPU operations might run on corrupted/incomplete data.
[rank4]:[E ProcessGroupNCCL.cpp:543] To avoid data inconsistency, we are taking the entire process down.
[rank4]:[E ProcessGroupNCCL.cpp:1182] [Rank 4] NCCL watchdog thread terminated with exception: [Rank 4] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=53, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600343 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:525 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7f81991b3d87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x1e6 (0x7f819a35b6e6 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::workCleanupLoop() + 0x19d (0x7f819a35ec3d in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x119 (0x7f819a35f839 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd6df4 (0x7f81e4072df4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #5: <unknown function> + 0x8609 (0x7f81e5466609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #6: clone + 0x43 (0x7f81e5231353 in /lib/x86_64-linux-gnu/libc.so.6)

terminate called after throwing an instance of 'c10::DistBackendError'
  what():  [Rank 4] NCCL watchdog thread terminated with exception: [Rank 4] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=53, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600343 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:525 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7f81991b3d87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x1e6 (0x7f819a35b6e6 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::workCleanupLoop() + 0x19d (0x7f819a35ec3d in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x119 (0x7f819a35f839 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd6df4 (0x7f81e4072df4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #5: <unknown function> + 0x8609 (0x7f81e5466609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #6: clone + 0x43 (0x7f81e5231353 in /lib/x86_64-linux-gnu/libc.so.6)

Exception raised from ncclCommWatchdog at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:1186 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7f81991b3d87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0xdf6b11 (0x7f819a0b5b11 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: <unknown function> + 0xd6df4 (0x7f81e4072df4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #3: <unknown function> + 0x8609 (0x7f81e5466609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #4: clone + 0x43 (0x7f81e5231353 in /lib/x86_64-linux-gnu/libc.so.6)

[2024-07-11 01:57:06,467] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 3102353 closing signal SIGTERM
[2024-07-11 01:57:06,468] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 3102360 closing signal SIGTERM
[2024-07-11 01:57:06,468] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 3102361 closing signal SIGTERM
[2024-07-11 01:57:06,469] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 3102362 closing signal SIGTERM
[2024-07-11 01:57:13,856] torch.distributed.elastic.multiprocessing.api: [ERROR] failed (exitcode: -6) local_rank: 4 (pid: 3102359) of binary: /fsx-storygen/beidic/anaconda3/envs/griffin/bin/python3.9
Traceback (most recent call last):
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/bin/accelerate", line 8, in <module>
    sys.exit(main())
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/accelerate/commands/accelerate_cli.py", line 47, in main
    args.func(args)
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/accelerate/commands/launch.py", line 985, in launch_command
    multi_gpu_launcher(args)
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/accelerate/commands/launch.py", line 654, in multi_gpu_launcher
    distrib_run.run(args)
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/distributed/run.py", line 803, in run
    elastic_launch(
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 135, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 268, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
========================================================
main.py FAILED
--------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
--------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-11_01:57:06
  host      : a100-st-p4de24xlarge-366.fair-a100.hpcaas
  rank      : 4 (local_rank: 4)
  exitcode  : -6 (pid: 3102359)
  error_file: <N/A>
  traceback : Signal 6 (SIGABRT) received by PID 3102359
========================================================
