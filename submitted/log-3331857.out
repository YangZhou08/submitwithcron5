Your branch is up to date with 'origin/addinggriffin'.
Already up to date.
Already up to date.
/fsx-storygen/beidic/anaconda3/envs/griffin/bin/python
/fsx-storygen/beidic/anaconda3/envs/griffin/bin/python
The token has not been saved to the git credentials helper. Pass `add_to_git_credential=True` in this function directly or `--add-to-git-credential` if using via `huggingface-cli` if you want to set the git credential as well.
Token is valid (permission: fineGrained).
Your token has been saved to /data/home/beidic/.cache/huggingface/token
Login successful
NCCL_TIMEOUT 1800
NCCL_TIMEOUT 1800NCCL_TIMEOUT 1800

NCCL_TIMEOUT 1800
NCCL_TIMEOUT 1800
NCCL_TIMEOUT 1800
NCCL_TIMEOUT 1800NCCL_TIMEOUT 1800

is_distributed True
Namespace(tasks='aqua', model='meta-llama/Meta-Llama-3-8B', device=None, limit=None, griffin=True, cats=False, check=False, kernel_size=None, spr=0.5, thr=0.1, widthtree=8, patternstrict=False, shotfive=True, shottwo=False, filteractiveenabled=False)
We now use eos_token as pad token
is_distributed True
Namespace(tasks='aqua', model='meta-llama/Meta-Llama-3-8B', device=None, limit=None, griffin=True, cats=False, check=False, kernel_size=None, spr=0.5, thr=0.1, widthtree=8, patternstrict=False, shotfive=True, shottwo=False, filteractiveenabled=False)
is_distributed True
Namespace(tasks='aqua', model='meta-llama/Meta-Llama-3-8B', device=None, limit=None, griffin=True, cats=False, check=False, kernel_size=None, spr=0.5, thr=0.1, widthtree=8, patternstrict=False, shotfive=True, shottwo=False, filteractiveenabled=False)
is_distributed True
Namespace(tasks='aqua', model='meta-llama/Meta-Llama-3-8B', device=None, limit=None, griffin=True, cats=False, check=False, kernel_size=None, spr=0.5, thr=0.1, widthtree=8, patternstrict=False, shotfive=True, shottwo=False, filteractiveenabled=False)
is_distributed True
Namespace(tasks='aqua', model='meta-llama/Meta-Llama-3-8B', device=None, limit=None, griffin=True, cats=False, check=False, kernel_size=None, spr=0.5, thr=0.1, widthtree=8, patternstrict=False, shotfive=True, shottwo=False, filteractiveenabled=False)
is_distributed True
Namespace(tasks='aqua', model='meta-llama/Meta-Llama-3-8B', device=None, limit=None, griffin=True, cats=False, check=False, kernel_size=None, spr=0.5, thr=0.1, widthtree=8, patternstrict=False, shotfive=True, shottwo=False, filteractiveenabled=False)
is_distributed True
Namespace(tasks='aqua', model='meta-llama/Meta-Llama-3-8B', device=None, limit=None, griffin=True, cats=False, check=False, kernel_size=None, spr=0.5, thr=0.1, widthtree=8, patternstrict=False, shotfive=True, shottwo=False, filteractiveenabled=False)
is_distributed True
Namespace(tasks='aqua', model='meta-llama/Meta-Llama-3-8B', device=None, limit=None, griffin=True, cats=False, check=False, kernel_size=None, spr=0.5, thr=0.1, widthtree=8, patternstrict=False, shotfive=True, shottwo=False, filteractiveenabled=False)
We now use eos_token as pad token
We now use eos_token as pad token
We now use eos_token as pad token
We now use eos_token as pad token
We now use eos_token as pad token
We now use eos_token as pad token
We now use eos_token as pad token
tasks ['aqua']
tasks ['aqua']
tasks ['aqua']tasks ['aqua']

tasks ['aqua']tasks ['aqua']tasks ['aqua']


tasks ['aqua']
Answer  expected e
Answer  expected c
Answer e expected e
Answer a expected b
Answer  expected a
Answer c expected d
Answer b expected b
Answer c expected c
Answer  expected b
Answer  expected e
Answer a expected b
Answer c expected c
Answer b expected b
Answer  expected d
Answer  expected d
Answer a expected d
Answer a expected a
Answer c expected d
Answer c expected b
Answer a expected a
Answer a expected b
Answer  expected e
Answer  expected a
Answer a expected a
Answer  expected c
Answer a expected a
Answer c expected d
Skipping the batch
Answer  expected c
Skipping the batch
Answer  expected d
Answer c expected a
Answer e expected b
index 5 start communication
index 7 start communication
Answer b expected c
index 0 start communication
index 6 start communication
index 4 start communication
index 2 start communication
index 3 start communication
index 1 start communication
Here are the statistics for inference
Here are the statistics for inference
Here are the statistics for inference
Here are the statistics for inference
Here are the statistics for inference
Here are the statistics for inference
Here are the statistics for inference
Here are the statistics for inference
+--------+----------------+---------------------------+-----------------------------+
| Task   |   Num Sentence |   Total Generation Length |   Average Generation Length |
+========+================+===========================+=============================+
| aqua   |            254 |                     35222 |                     138.669 |
+--------+----------------+---------------------------+-----------------------------+
Namespace(tasks='aqua', model='meta-llama/Meta-Llama-3-8B', device='cuda:0', limit=None, griffin=True, cats=False, check=False, kernel_size=None, spr=0.5, thr=0.1, widthtree=8, patternstrict=False, shotfive=True, shottwo=False, filteractiveenabled=False)
+--------+---------+-----------+--------------+
| Task   |   Total |   Correct |   Solve Rate |
+========+=========+===========+==============+
| aqua   |     254 |        58 |     0.228346 |
+--------+---------+-----------+--------------+
