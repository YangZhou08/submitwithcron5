Already on 'addinggriffin'
wandb: Currently logged in as: stevenzhou0816100. Use `wandb login --relogin` to force relogin
The following values were not passed to `accelerate launch` and had defaults used instead:
		More than one GPU was found, enabling multi-GPU training.
		If this was unintended please pass in `--num_processes=1`.
	`--mixed_precision` was set to a value of `'no'`
	`--dynamo_backend` was set to a value of `'no'`
To avoid this warning pass in values for each of the problematic parameters or run `accelerate config`.
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:17<00:53, 17.71s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:19<00:59, 19.98s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:19<00:57, 19.05s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:19<00:57, 19.05s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:19<00:57, 19.06s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:19<00:57, 19.05s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:19<00:57, 19.02s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:19<00:57, 19.06s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:34<00:34, 17.16s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:36<00:35, 17.89s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:36<00:35, 17.89s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:37<00:36, 18.32s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:36<00:35, 17.94s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:36<00:35, 17.92s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:35<00:35, 17.98s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:36<00:35, 17.95s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:49<00:15, 15.88s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:50<00:16, 16.42s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:50<00:16, 16.65s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:51<00:16, 16.70s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:50<00:16, 16.49s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:50<00:16, 16.51s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:50<00:16, 16.48s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:50<00:16, 16.48s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:51<00:00, 10.44s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:51<00:00, 12.93s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:52<00:00, 10.60s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:52<00:00, 13.04s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:52<00:00, 10.58s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:52<00:00, 13.12s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:52<00:00, 10.70s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:52<00:00, 13.13s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:52<00:00, 10.60s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:52<00:00, 13.13s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:52<00:00, 10.60s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:52<00:00, 13.13s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:53<00:00, 10.75s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:53<00:00, 13.39s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:52<00:00, 10.70s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:52<00:00, 13.18s/it]
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:403: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:403: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:403: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:403: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:403: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:403: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:403: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:403: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
  3%|▎         | 1/32 [00:25<13:12, 25.58s/it]  3%|▎         | 1/32 [00:25<13:14, 25.62s/it]  3%|▎         | 1/32 [00:27<14:01, 27.13s/it]  3%|▎         | 1/32 [00:28<14:33, 28.18s/it]  3%|▎         | 1/32 [00:33<17:18, 33.51s/it]  3%|▎         | 1/32 [00:36<18:49, 36.45s/it]  3%|▎         | 1/32 [00:46<23:46, 46.01s/it]  6%|▋         | 2/32 [00:50<12:41, 25.40s/it]  3%|▎         | 1/32 [00:54<28:03, 54.32s/it]  6%|▋         | 2/32 [00:54<13:36, 27.21s/it]  6%|▋         | 2/32 [00:55<13:59, 27.99s/it]  6%|▋         | 2/32 [00:59<15:11, 30.38s/it]  6%|▋         | 2/32 [01:09<17:14, 34.49s/it]  6%|▋         | 2/32 [01:10<17:39, 35.31s/it]  9%|▉         | 3/32 [01:18<12:51, 26.62s/it]  9%|▉         | 3/32 [01:20<12:50, 26.57s/it]  9%|▉         | 3/32 [01:22<13:19, 27.57s/it]  9%|▉         | 3/32 [01:33<15:33, 32.20s/it]  9%|▉         | 3/32 [01:38<15:39, 32.38s/it]  6%|▋         | 2/32 [01:40<25:27, 50.90s/it]  9%|▉         | 3/32 [01:40<15:54, 32.93s/it]  6%|▋         | 2/32 [01:44<25:50, 51.69s/it] 12%|█▎        | 4/32 [01:45<12:29, 26.77s/it] 12%|█▎        | 4/32 [01:47<12:21, 26.50s/it] 12%|█▎        | 4/32 [01:57<14:20, 30.74s/it] 12%|█▎        | 4/32 [01:58<13:39, 29.26s/it] 12%|█▎        | 4/32 [02:06<14:12, 30.43s/it] 16%|█▌        | 5/32 [02:14<12:01, 26.72s/it] 12%|█▎        | 4/32 [02:18<16:17, 34.89s/it] 16%|█▌        | 5/32 [02:19<13:13, 29.38s/it] 16%|█▌        | 5/32 [02:21<12:46, 28.40s/it] 16%|█▌        | 5/32 [02:23<12:32, 27.88s/it]  9%|▉         | 3/32 [02:24<23:13, 48.05s/it]  9%|▉         | 3/32 [02:28<23:26, 48.50s/it] 16%|█▌        | 5/32 [02:30<12:43, 28.27s/it] 19%|█▉        | 6/32 [02:39<11:18, 26.09s/it] 19%|█▉        | 6/32 [02:45<12:12, 28.18s/it] 19%|█▉        | 6/32 [02:46<11:48, 27.24s/it] 16%|█▌        | 5/32 [02:52<15:34, 34.60s/it] 19%|█▉        | 6/32 [02:52<12:14, 28.25s/it] 19%|█▉        | 6/32 [02:58<12:08, 28.00s/it] 22%|██▏       | 7/32 [03:03<10:36, 25.45s/it] 22%|██▏       | 7/32 [03:10<11:14, 26.99s/it] 22%|██▏       | 7/32 [03:11<10:57, 26.32s/it] 12%|█▎        | 4/32 [03:14<22:10, 47.52s/it] 22%|██▏       | 7/32 [03:16<11:10, 26.80s/it] 12%|█▎        | 4/32 [03:22<24:08, 51.72s/it] 22%|██▏       | 7/32 [03:24<11:28, 27.54s/it] 19%|█▉        | 6/32 [03:25<14:45, 34.08s/it] 25%|██▌       | 8/32 [03:30<10:23, 25.97s/it] 25%|██▌       | 8/32 [03:36<10:21, 25.88s/it] 25%|██▌       | 8/32 [03:37<10:50, 27.11s/it] 25%|██▌       | 8/32 [03:42<10:37, 26.55s/it] 16%|█▌        | 5/32 [03:56<20:26, 45.43s/it] 28%|██▊       | 9/32 [03:56<09:56, 25.94s/it] 25%|██▌       | 8/32 [03:57<11:36, 29.02s/it] 22%|██▏       | 7/32 [04:00<14:20, 34.41s/it] 16%|█▌        | 5/32 [04:02<21:26, 47.65s/it] 28%|██▊       | 9/32 [04:03<10:01, 26.16s/it] 28%|██▊       | 9/32 [04:03<10:17, 26.84s/it] 28%|██▊       | 9/32 [04:06<09:52, 25.75s/it] 31%|███▏      | 10/32 [04:21<09:23, 25.60s/it] 28%|██▊       | 9/32 [04:24<10:55, 28.51s/it] 31%|███▏      | 10/32 [04:27<09:22, 25.57s/it] 25%|██▌       | 8/32 [04:30<13:07, 32.82s/it] 31%|███▏      | 10/32 [04:32<10:05, 27.50s/it] 31%|███▏      | 10/32 [04:33<09:32, 26.03s/it] 19%|█▉        | 6/32 [04:39<19:21, 44.69s/it] 34%|███▍      | 11/32 [04:47<09:01, 25.80s/it] 19%|█▉        | 6/32 [04:51<20:44, 47.88s/it] 31%|███▏      | 10/32 [04:51<10:19, 28.15s/it] 34%|███▍      | 11/32 [04:54<09:07, 26.09s/it] 34%|███▍      | 11/32 [04:58<09:01, 25.79s/it] 34%|███▍      | 11/32 [04:59<09:32, 27.28s/it] 28%|██▊       | 9/32 [05:04<12:43, 33.18s/it] 38%|███▊      | 12/32 [05:11<08:26, 25.30s/it] 38%|███▊      | 12/32 [05:20<08:39, 25.98s/it] 22%|██▏       | 7/32 [05:21<18:15, 43.82s/it] 38%|███▊      | 12/32 [05:23<08:32, 25.65s/it] 34%|███▍      | 11/32 [05:25<10:24, 29.74s/it] 31%|███▏      | 10/32 [05:30<11:22, 31.02s/it] 38%|███▊      | 12/32 [05:33<09:43, 29.16s/it] 22%|██▏       | 7/32 [05:36<19:37, 47.10s/it] 41%|████      | 13/32 [05:39<08:15, 26.06s/it] 41%|████      | 13/32 [05:44<08:04, 25.50s/it] 41%|████      | 13/32 [05:53<08:32, 26.98s/it] 38%|███▊      | 12/32 [05:57<10:08, 30.40s/it] 41%|████      | 13/32 [05:58<08:50, 27.91s/it] 34%|███▍      | 11/32 [06:01<10:50, 30.97s/it] 44%|████▍     | 14/32 [06:05<07:46, 25.94s/it] 25%|██▌       | 8/32 [06:06<17:37, 44.05s/it] 44%|████▍     | 14/32 [06:09<07:37, 25.41s/it] 25%|██▌       | 8/32 [06:19<18:20, 45.86s/it] 44%|████▍     | 14/32 [06:20<08:02, 26.78s/it] 41%|████      | 13/32 [06:23<09:15, 29.25s/it] 44%|████▍     | 14/32 [06:25<08:19, 27.75s/it] 47%|████▋     | 15/32 [06:31<07:23, 26.08s/it] 38%|███▊      | 12/32 [06:31<10:17, 30.89s/it] 47%|████▋     | 15/32 [06:40<07:36, 26.86s/it] 47%|████▋     | 15/32 [06:46<07:32, 26.62s/it] 44%|████▍     | 14/32 [06:49<08:27, 28.21s/it] 47%|████▋     | 15/32 [06:52<07:46, 27.41s/it] 28%|██▊       | 9/32 [06:52<17:10, 44.82s/it] 41%|████      | 13/32 [06:57<09:16, 29.30s/it] 50%|█████     | 16/32 [06:58<06:58, 26.17s/it] 50%|█████     | 16/32 [07:04<06:57, 26.10s/it] 28%|██▊       | 9/32 [07:05<17:35, 45.89s/it] 50%|█████     | 16/32 [07:18<07:30, 28.13s/it] 47%|████▋     | 15/32 [07:20<08:15, 29.15s/it] 50%|█████     | 16/32 [07:21<07:29, 28.11s/it] 44%|████▍     | 14/32 [07:23<08:30, 28.38s/it] 53%|█████▎    | 17/32 [07:24<06:33, 26.22s/it] 53%|█████▎    | 17/32 [07:30<06:30, 26.02s/it] 31%|███▏      | 10/32 [07:39<16:37, 45.33s/it] 53%|█████▎    | 17/32 [07:44<06:54, 27.60s/it] 50%|█████     | 16/32 [07:45<07:24, 27.77s/it] 53%|█████▎    | 17/32 [07:49<06:58, 27.91s/it] 47%|████▋     | 15/32 [07:50<07:52, 27.77s/it] 31%|███▏      | 10/32 [07:52<16:58, 46.28s/it] 56%|█████▋    | 18/32 [07:53<06:17, 26.96s/it] 56%|█████▋    | 18/32 [07:57<06:10, 26.44s/it] 56%|█████▋    | 18/32 [08:12<06:28, 27.75s/it] 53%|█████▎    | 17/32 [08:13<06:59, 27.97s/it] 56%|█████▋    | 18/32 [08:18<06:36, 28.32s/it] 59%|█████▉    | 19/32 [08:19<05:46, 26.62s/it] 34%|███▍      | 11/32 [08:21<15:33, 44.43s/it] 59%|█████▉    | 19/32 [08:24<05:44, 26.54s/it] 50%|█████     | 16/32 [08:24<07:56, 29.78s/it] 34%|███▍      | 11/32 [08:38<16:07, 46.06s/it] 59%|█████▉    | 19/32 [08:38<05:54, 27.31s/it] 56%|█████▋    | 18/32 [08:39<06:22, 27.33s/it] 62%|██████▎   | 20/32 [08:43<05:12, 26.08s/it] 59%|█████▉    | 19/32 [08:47<06:10, 28.48s/it] 62%|██████▎   | 20/32 [08:48<05:10, 25.85s/it] 53%|█████▎    | 17/32 [08:55<07:31, 30.08s/it] 38%|███▊      | 12/32 [09:06<14:51, 44.59s/it] 62%|██████▎   | 20/32 [09:07<05:30, 27.57s/it] 59%|█████▉    | 19/32 [09:08<06:01, 27.82s/it] 66%|██████▌   | 21/32 [09:10<04:47, 26.17s/it] 66%|██████▌   | 21/32 [09:16<04:49, 26.30s/it] 62%|██████▎   | 20/32 [09:18<05:50, 29.20s/it] 38%|███▊      | 12/32 [09:18<14:47, 44.37s/it] 56%|█████▋    | 18/32 [09:23<06:52, 29.44s/it] 66%|██████▌   | 21/32 [09:34<05:02, 27.51s/it] 62%|██████▎   | 20/32 [09:35<05:32, 27.67s/it] 69%|██████▉   | 22/32 [09:36<04:22, 26.20s/it] 69%|██████▉   | 22/32 [09:43<04:25, 26.57s/it] 66%|██████▌   | 21/32 [09:44<05:12, 28.37s/it] 59%|█████▉    | 19/32 [09:47<06:01, 27.81s/it] 41%|████      | 13/32 [09:50<14:00, 44.26s/it] 69%|██████▉   | 22/32 [10:01<04:35, 27.50s/it] 72%|███████▏  | 23/32 [10:02<03:56, 26.27s/it] 41%|████      | 13/32 [10:03<14:01, 44.27s/it] 66%|██████▌   | 21/32 [10:03<05:03, 27.61s/it] 62%|██████▎   | 20/32 [10:12<05:23, 26.96s/it] 72%|███████▏  | 23/32 [10:12<04:07, 27.52s/it] 69%|██████▉   | 22/32 [10:12<04:42, 28.28s/it] 72%|███████▏  | 23/32 [10:28<04:03, 27.11s/it] 75%|███████▌  | 24/32 [10:30<03:32, 26.55s/it] 69%|██████▉   | 22/32 [10:30<04:35, 27.58s/it] 66%|██████▌   | 21/32 [10:37<04:49, 26.29s/it] 72%|███████▏  | 23/32 [10:38<04:07, 27.47s/it] 44%|████▍     | 14/32 [10:38<13:40, 45.61s/it] 75%|███████▌  | 24/32 [10:39<03:37, 27.21s/it] 44%|████▍     | 14/32 [10:49<13:31, 45.08s/it] 75%|███████▌  | 24/32 [10:53<03:32, 26.57s/it] 78%|███████▊  | 25/32 [10:56<03:05, 26.52s/it] 72%|███████▏  | 23/32 [11:00<04:14, 28.25s/it] 75%|███████▌  | 24/32 [11:02<03:32, 26.52s/it] 78%|███████▊  | 25/32 [11:04<03:04, 26.42s/it] 69%|██████▉   | 22/32 [11:07<04:34, 27.46s/it] 78%|███████▊  | 25/32 [11:20<03:06, 26.62s/it] 81%|████████▏ | 26/32 [11:24<02:41, 26.93s/it] 47%|████▋     | 15/32 [11:25<12:59, 45.87s/it] 78%|███████▊  | 25/32 [11:26<03:00, 25.81s/it] 75%|███████▌  | 24/32 [11:28<03:45, 28.19s/it] 81%|████████▏ | 26/32 [11:30<02:37, 26.29s/it] 72%|███████▏  | 23/32 [11:31<03:59, 26.65s/it] 47%|████▋     | 15/32 [11:35<12:49, 45.26s/it] 81%|████████▏ | 26/32 [11:45<02:37, 26.20s/it] 81%|████████▏ | 26/32 [11:54<02:37, 26.25s/it] 78%|███████▊  | 25/32 [11:56<03:15, 27.95s/it] 84%|████████▍ | 27/32 [11:56<02:12, 26.45s/it] 84%|████████▍ | 27/32 [11:57<02:23, 28.76s/it] 78%|███████▊  | 25/32 [11:59<02:24, 20.59s/it] 50%|█████     | 16/32 [12:12<12:17, 46.11s/it] 84%|████████▍ | 27/32 [12:18<02:21, 28.22s/it] 50%|█████     | 16/32 [12:21<12:06, 45.41s/it] 84%|████████▍ | 27/32 [12:21<02:12, 26.53s/it] 81%|████████▏ | 26/32 [12:23<02:46, 27.79s/it] 88%|████████▊ | 28/32 [12:24<01:47, 26.77s/it] 81%|████████▏ | 26/32 [12:24<02:10, 21.81s/it] 88%|████████▊ | 28/32 [12:24<01:53, 28.31s/it] 84%|████████▍ | 27/32 [12:49<01:53, 22.60s/it] 91%|█████████ | 29/32 [12:49<01:19, 26.34s/it] 88%|████████▊ | 28/32 [12:50<01:48, 27.23s/it] 91%|█████████ | 29/32 [12:51<01:23, 27.96s/it] 88%|████████▊ | 28/32 [12:54<02:02, 30.57s/it] 53%|█████▎    | 17/32 [12:56<11:23, 45.56s/it] 84%|████████▍ | 27/32 [12:57<02:27, 29.55s/it] 53%|█████▎    | 17/32 [13:08<11:27, 45.83s/it] 88%|████████▊ | 28/32 [13:16<01:35, 23.83s/it] 94%|█████████▍| 30/32 [13:16<00:54, 27.03s/it] 91%|█████████ | 29/32 [13:16<01:20, 27.00s/it] 94%|█████████▍| 30/32 [13:18<00:54, 27.16s/it] 88%|████████▊ | 28/32 [13:28<02:00, 30.03s/it] 94%|█████████▍| 30/32 [13:36<00:52, 26.26s/it] 56%|█████▋    | 18/32 [13:41<10:34, 45.31s/it] 91%|█████████ | 29/32 [13:42<01:13, 24.57s/it] 97%|█████████▋| 31/32 [13:43<00:27, 27.03s/it] 94%|█████████▍| 30/32 [13:43<00:54, 27.04s/it] 97%|█████████▋| 31/32 [13:44<00:26, 26.76s/it] 56%|█████▋    | 18/32 [13:52<10:36, 45.47s/it] 91%|█████████ | 29/32 [13:53<01:25, 28.58s/it] 97%|█████████▋| 31/32 [14:12<00:27, 27.58s/it]100%|██████████| 32/32 [14:13<00:00, 27.78s/it]100%|██████████| 32/32 [14:13<00:00, 26.67s/it]
100%|██████████| 32/32 [14:13<00:00, 27.44s/it]100%|██████████| 32/32 [14:13<00:00, 26.68s/it]
 94%|█████████▍| 30/32 [14:13<00:52, 26.37s/it] 94%|█████████▍| 30/32 [14:18<00:54, 27.32s/it] 97%|█████████▋| 31/32 [14:18<00:30, 30.08s/it] 59%|█████▉    | 19/32 [14:25<09:45, 45.07s/it] 59%|█████▉    | 19/32 [14:36<09:45, 45.05s/it] 97%|█████████▋| 31/32 [14:39<00:26, 26.22s/it]100%|██████████| 32/32 [14:39<00:00, 27.40s/it]100%|██████████| 32/32 [14:39<00:00, 27.49s/it]
 97%|█████████▋| 31/32 [14:43<00:26, 26.86s/it]100%|██████████| 32/32 [14:53<00:00, 31.27s/it]100%|██████████| 32/32 [14:53<00:00, 27.91s/it]
100%|██████████| 32/32 [15:03<00:00, 25.46s/it]100%|██████████| 32/32 [15:03<00:00, 28.23s/it]
100%|██████████| 32/32 [15:09<00:00, 26.52s/it]100%|██████████| 32/32 [15:09<00:00, 28.42s/it]
 62%|██████▎   | 20/32 [15:12<09:08, 45.70s/it] 62%|██████▎   | 20/32 [15:17<08:44, 43.73s/it] 66%|██████▌   | 21/32 [15:56<08:15, 45.09s/it] 66%|██████▌   | 21/32 [16:01<08:00, 43.69s/it] 69%|██████▉   | 22/32 [16:48<07:26, 44.66s/it] 69%|██████▉   | 22/32 [16:49<07:53, 47.32s/it] 72%|███████▏  | 23/32 [17:29<06:33, 43.69s/it] 72%|███████▏  | 23/32 [17:34<07:00, 46.73s/it] 75%|███████▌  | 24/32 [18:19<06:08, 46.12s/it] 75%|███████▌  | 24/32 [18:21<06:09, 46.20s/it] 78%|███████▊  | 25/32 [19:01<05:15, 45.14s/it] 78%|███████▊  | 25/32 [19:06<05:21, 45.90s/it] 81%|████████▏ | 26/32 [19:51<04:32, 45.46s/it] 81%|████████▏ | 26/32 [19:55<04:46, 47.69s/it] 84%|████████▍ | 27/32 [20:42<03:55, 47.13s/it] 84%|████████▍ | 27/32 [20:44<03:59, 47.92s/it] 88%|████████▊ | 28/32 [21:27<03:06, 46.67s/it] 88%|████████▊ | 28/32 [21:28<03:07, 46.95s/it] 91%|█████████ | 29/32 [22:08<02:14, 44.76s/it] 91%|█████████ | 29/32 [22:13<02:18, 46.20s/it] 94%|█████████▍| 30/32 [22:51<01:28, 44.24s/it] 94%|█████████▍| 30/32 [22:57<01:31, 45.77s/it] 97%|█████████▋| 31/32 [23:37<00:44, 44.99s/it] 97%|█████████▋| 31/32 [23:51<00:48, 48.12s/it][rank2]:[E ProcessGroupNCCL.cpp:523] [Rank 2] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=53, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600452 milliseconds before timing out.
[rank7]:[E ProcessGroupNCCL.cpp:523] [Rank 7] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=53, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600690 milliseconds before timing out.
[rank7]:[E ProcessGroupNCCL.cpp:537] Some NCCL operations have failed or timed out. Due to the asynchronous nature of CUDA kernels, subsequent GPU operations might run on corrupted/incomplete data.
[rank7]:[E ProcessGroupNCCL.cpp:543] To avoid data inconsistency, we are taking the entire process down.
[rank7]:[E ProcessGroupNCCL.cpp:1182] [Rank 7] NCCL watchdog thread terminated with exception: [Rank 7] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=53, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600690 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:525 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7f3a0b3f5d87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x1e6 (0x7f3a0c59d6e6 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::workCleanupLoop() + 0x19d (0x7f3a0c5a0c3d in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x119 (0x7f3a0c5a1839 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd6df4 (0x7f3a562b4df4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #5: <unknown function> + 0x8609 (0x7f3a576a3609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #6: clone + 0x43 (0x7f3a5746e353 in /lib/x86_64-linux-gnu/libc.so.6)

terminate called after throwing an instance of 'c10::DistBackendError'
  what():  [Rank 7] NCCL watchdog thread terminated with exception: [Rank 7] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=53, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600690 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:525 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7f3a0b3f5d87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x1e6 (0x7f3a0c59d6e6 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::workCleanupLoop() + 0x19d (0x7f3a0c5a0c3d in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x119 (0x7f3a0c5a1839 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd6df4 (0x7f3a562b4df4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #5: <unknown function> + 0x8609 (0x7f3a576a3609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #6: clone + 0x43 (0x7f3a5746e353 in /lib/x86_64-linux-gnu/libc.so.6)

Exception raised from ncclCommWatchdog at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:1186 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7f3a0b3f5d87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0xdf6b11 (0x7f3a0c2f7b11 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: <unknown function> + 0xd6df4 (0x7f3a562b4df4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #3: <unknown function> + 0x8609 (0x7f3a576a3609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #4: clone + 0x43 (0x7f3a5746e353 in /lib/x86_64-linux-gnu/libc.so.6)

[rank2]:[E ProcessGroupNCCL.cpp:537] Some NCCL operations have failed or timed out. Due to the asynchronous nature of CUDA kernels, subsequent GPU operations might run on corrupted/incomplete data.
[rank2]:[E ProcessGroupNCCL.cpp:543] To avoid data inconsistency, we are taking the entire process down.
[rank2]:[E ProcessGroupNCCL.cpp:1182] [Rank 2] NCCL watchdog thread terminated with exception: [Rank 2] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=53, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600452 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:525 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7f7aa1829d87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x1e6 (0x7f7aa29d16e6 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::workCleanupLoop() + 0x19d (0x7f7aa29d4c3d in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x119 (0x7f7aa29d5839 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd6df4 (0x7f7aec6e8df4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #5: <unknown function> + 0x8609 (0x7f7aedad7609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #6: clone + 0x43 (0x7f7aed8a2353 in /lib/x86_64-linux-gnu/libc.so.6)

terminate called after throwing an instance of 'c10::DistBackendError'
  what():  [Rank 2] NCCL watchdog thread terminated with exception: [Rank 2] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=53, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600452 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:525 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7f7aa1829d87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x1e6 (0x7f7aa29d16e6 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::workCleanupLoop() + 0x19d (0x7f7aa29d4c3d in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x119 (0x7f7aa29d5839 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd6df4 (0x7f7aec6e8df4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #5: <unknown function> + 0x8609 (0x7f7aedad7609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #6: clone + 0x43 (0x7f7aed8a2353 in /lib/x86_64-linux-gnu/libc.so.6)

Exception raised from ncclCommWatchdog at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:1186 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7f7aa1829d87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0xdf6b11 (0x7f7aa272bb11 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: <unknown function> + 0xd6df4 (0x7f7aec6e8df4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #3: <unknown function> + 0x8609 (0x7f7aedad7609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #4: clone + 0x43 (0x7f7aed8a2353 in /lib/x86_64-linux-gnu/libc.so.6)

100%|██████████| 32/32 [24:20<00:00, 44.43s/it]100%|██████████| 32/32 [24:20<00:00, 45.66s/it]
100%|██████████| 32/32 [24:44<00:00, 49.46s/it]100%|██████████| 32/32 [24:44<00:00, 46.38s/it]
[2024-07-09 16:12:56,644] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 626422 closing signal SIGTERM
[2024-07-09 16:12:56,647] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 626423 closing signal SIGTERM
[2024-07-09 16:12:56,647] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 626424 closing signal SIGTERM
[2024-07-09 16:12:56,647] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 626425 closing signal SIGTERM
[2024-07-09 16:12:56,647] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 626426 closing signal SIGTERM
[2024-07-09 16:12:56,647] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 626427 closing signal SIGTERM
[2024-07-09 16:12:56,648] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 626428 closing signal SIGTERM
[2024-07-09 16:13:22,723] torch.distributed.elastic.multiprocessing.api: [ERROR] failed (exitcode: -6) local_rank: 7 (pid: 626429) of binary: /fsx-storygen/beidic/anaconda3/envs/griffin/bin/python3.9
Traceback (most recent call last):
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/bin/accelerate", line 8, in <module>
    sys.exit(main())
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/accelerate/commands/accelerate_cli.py", line 47, in main
    args.func(args)
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/accelerate/commands/launch.py", line 985, in launch_command
    multi_gpu_launcher(args)
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/accelerate/commands/launch.py", line 654, in multi_gpu_launcher
    distrib_run.run(args)
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/distributed/run.py", line 803, in run
    elastic_launch(
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 135, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 268, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
=======================================================
main.py FAILED
-------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
-------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-09_16:12:56
  host      : a100-st-p4de24xlarge-437.fair-a100.hpcaas
  rank      : 7 (local_rank: 7)
  exitcode  : -6 (pid: 626429)
  error_file: <N/A>
  traceback : Signal 6 (SIGABRT) received by PID 626429
=======================================================
