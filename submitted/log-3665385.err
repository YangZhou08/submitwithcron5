Already on 'yangexppp'
wandb: Currently logged in as: stevenzhou0816100. Use `wandb login --relogin` to force relogin
2024-08-04:09:02:12,609 INFO     [main.py:288] Verbosity set to INFO
2024-08-04:09:02:23,181 WARNING  [main.py:303]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2024-08-04:09:02:23,183 INFO     [main.py:378] Selected Tasks: ['mmlu_flan_cot_fewshot']
2024-08-04:09:02:23,215 INFO     [xevaluator.py:137] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2024-08-04:09:02:23,215 INFO     [xevaluator.py:184] Initializing xhf model, with arguments: {'pretrained': 'meta-llama/Meta-Llama-3-8B-Instruct', 'griffin': False, 'check': False, 'contextlength': 1500, 'kernel_size': 16, 'thr': 0.05}
2024-08-04:09:02:23,224 INFO     [xhuggingface.py:176] Using device 'cuda'
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:17,  5.84s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:11<00:11,  5.80s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:17<00:05,  5.73s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:18<00:00,  4.06s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:18<00:00,  4.69s/it]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
2024-08-04:09:03:04,608 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_prehistory on rank 0...
  0%|          | 0/35 [00:00<?, ?it/s]100%|██████████| 35/35 [00:00<00:00, 615.25it/s]
2024-08-04:09:03:04,667 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_logical_fallacies on rank 0...
  0%|          | 0/18 [00:00<?, ?it/s]100%|██████████| 18/18 [00:00<00:00, 609.87it/s]
2024-08-04:09:03:04,698 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_us_history on rank 0...
  0%|          | 0/22 [00:00<?, ?it/s]100%|██████████| 22/22 [00:00<00:00, 398.76it/s]
2024-08-04:09:03:04,755 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_international_law on rank 0...
  0%|          | 0/13 [00:00<?, ?it/s]100%|██████████| 13/13 [00:00<00:00, 583.11it/s]
2024-08-04:09:03:04,778 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_professional_law on rank 0...
  0%|          | 0/170 [00:00<?, ?it/s] 29%|██▉       | 49/170 [00:00<00:00, 480.18it/s] 58%|█████▊    | 98/170 [00:00<00:00, 480.85it/s] 86%|████████▋ | 147/170 [00:00<00:00, 481.03it/s]100%|██████████| 170/170 [00:00<00:00, 480.67it/s]
2024-08-04:09:03:05,143 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_moral_disputes on rank 0...
  0%|          | 0/38 [00:00<?, ?it/s]100%|██████████| 38/38 [00:00<00:00, 599.65it/s]
2024-08-04:09:03:05,208 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_jurisprudence on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 603.75it/s]
2024-08-04:09:03:05,227 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_world_history on rank 0...
  0%|          | 0/26 [00:00<?, ?it/s]100%|██████████| 26/26 [00:00<00:00, 479.37it/s]
2024-08-04:09:03:05,285 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_moral_scenarios on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 62%|██████▏   | 62/100 [00:00<00:00, 611.26it/s]100%|██████████| 100/100 [00:00<00:00, 611.41it/s]
2024-08-04:09:03:05,454 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_philosophy on rank 0...
  0%|          | 0/34 [00:00<?, ?it/s]100%|██████████| 34/34 [00:00<00:00, 629.43it/s]
2024-08-04:09:03:05,510 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_formal_logic on rank 0...
  0%|          | 0/14 [00:00<?, ?it/s]100%|██████████| 14/14 [00:00<00:00, 546.57it/s]
2024-08-04:09:03:05,536 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_world_religions on rank 0...
  0%|          | 0/19 [00:00<?, ?it/s]100%|██████████| 19/19 [00:00<00:00, 663.51it/s]
2024-08-04:09:03:05,566 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_european_history on rank 0...
  0%|          | 0/18 [00:00<?, ?it/s]100%|██████████| 18/18 [00:00<00:00, 353.32it/s]
2024-08-04:09:03:05,619 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_human_sexuality on rank 0...
  0%|          | 0/12 [00:00<?, ?it/s]100%|██████████| 12/12 [00:00<00:00, 636.16it/s]
2024-08-04:09:03:05,639 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_econometrics on rank 0...
  0%|          | 0/12 [00:00<?, ?it/s]100%|██████████| 12/12 [00:00<00:00, 528.08it/s]
2024-08-04:09:03:05,662 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_macroeconomics on rank 0...
  0%|          | 0/43 [00:00<?, ?it/s]100%|██████████| 43/43 [00:00<00:00, 632.12it/s]
2024-08-04:09:03:05,733 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_geography on rank 0...
  0%|          | 0/22 [00:00<?, ?it/s]100%|██████████| 22/22 [00:00<00:00, 630.76it/s]
2024-08-04:09:03:05,769 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_security_studies on rank 0...
  0%|          | 0/27 [00:00<?, ?it/s]100%|██████████| 27/27 [00:00<00:00, 515.51it/s]
2024-08-04:09:03:05,823 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_psychology on rank 0...
  0%|          | 0/60 [00:00<?, ?it/s]100%|██████████| 60/60 [00:00<00:00, 601.88it/s]
2024-08-04:09:03:05,926 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_microeconomics on rank 0...
  0%|          | 0/26 [00:00<?, ?it/s]100%|██████████| 26/26 [00:00<00:00, 625.36it/s]
2024-08-04:09:03:05,969 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_government_and_politics on rank 0...
  0%|          | 0/21 [00:00<?, ?it/s]100%|██████████| 21/21 [00:00<00:00, 546.88it/s]
2024-08-04:09:03:06,009 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_professional_psychology on rank 0...
  0%|          | 0/69 [00:00<?, ?it/s] 84%|████████▍ | 58/69 [00:00<00:00, 574.08it/s]100%|██████████| 69/69 [00:00<00:00, 573.33it/s]
2024-08-04:09:03:06,133 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_public_relations on rank 0...
  0%|          | 0/12 [00:00<?, ?it/s]100%|██████████| 12/12 [00:00<00:00, 629.18it/s]
2024-08-04:09:03:06,153 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_us_foreign_policy on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 617.94it/s]
2024-08-04:09:03:06,172 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_sociology on rank 0...
  0%|          | 0/22 [00:00<?, ?it/s]100%|██████████| 22/22 [00:00<00:00, 616.93it/s]
2024-08-04:09:03:06,209 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_global_facts on rank 0...
  0%|          | 0/10 [00:00<?, ?it/s]100%|██████████| 10/10 [00:00<00:00, 620.47it/s]
2024-08-04:09:03:06,226 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_professional_medicine on rank 0...
  0%|          | 0/31 [00:00<?, ?it/s]100%|██████████| 31/31 [00:00<00:00, 543.69it/s]
2024-08-04:09:03:06,286 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_business_ethics on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 550.07it/s]
2024-08-04:09:03:06,307 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_medicine on rank 0...
  0%|          | 0/22 [00:00<?, ?it/s]100%|██████████| 22/22 [00:00<00:00, 558.21it/s]
2024-08-04:09:03:06,347 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_management on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 641.69it/s]
2024-08-04:09:03:06,365 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_human_aging on rank 0...
  0%|          | 0/23 [00:00<?, ?it/s]100%|██████████| 23/23 [00:00<00:00, 659.07it/s]
2024-08-04:09:03:06,402 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_marketing on rank 0...
  0%|          | 0/25 [00:00<?, ?it/s]100%|██████████| 25/25 [00:00<00:00, 623.65it/s]
2024-08-04:09:03:06,443 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_nutrition on rank 0...
  0%|          | 0/33 [00:00<?, ?it/s]100%|██████████| 33/33 [00:00<00:00, 605.30it/s]
2024-08-04:09:03:06,499 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_virology on rank 0...
  0%|          | 0/18 [00:00<?, ?it/s]100%|██████████| 18/18 [00:00<00:00, 651.50it/s]
2024-08-04:09:03:06,528 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_professional_accounting on rank 0...
  0%|          | 0/31 [00:00<?, ?it/s]100%|██████████| 31/31 [00:00<00:00, 575.58it/s]
2024-08-04:09:03:06,584 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_miscellaneous on rank 0...
  0%|          | 0/86 [00:00<?, ?it/s] 78%|███████▊  | 67/86 [00:00<00:00, 660.70it/s]100%|██████████| 86/86 [00:00<00:00, 660.23it/s]
2024-08-04:09:03:06,718 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_medical_genetics on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 629.01it/s]
2024-08-04:09:03:06,736 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_clinical_knowledge on rank 0...
  0%|          | 0/29 [00:00<?, ?it/s]100%|██████████| 29/29 [00:00<00:00, 640.97it/s]
2024-08-04:09:03:06,783 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_mathematics on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 565.48it/s]
2024-08-04:09:03:06,803 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_elementary_mathematics on rank 0...
  0%|          | 0/41 [00:00<?, ?it/s]100%|██████████| 41/41 [00:00<00:00, 614.29it/s]
2024-08-04:09:03:06,872 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_statistics on rank 0...
  0%|          | 0/23 [00:00<?, ?it/s]100%|██████████| 23/23 [00:00<00:00, 575.77it/s]
2024-08-04:09:03:06,913 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_astronomy on rank 0...
  0%|          | 0/16 [00:00<?, ?it/s]100%|██████████| 16/16 [00:00<00:00, 552.25it/s]
2024-08-04:09:03:06,943 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_electrical_engineering on rank 0...
  0%|          | 0/16 [00:00<?, ?it/s]100%|██████████| 16/16 [00:00<00:00, 613.54it/s]
2024-08-04:09:03:06,970 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_abstract_algebra on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 620.18it/s]
2024-08-04:09:03:06,988 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_machine_learning on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 535.58it/s]
2024-08-04:09:03:07,010 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_computer_science on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 521.75it/s]
2024-08-04:09:03:07,032 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_biology on rank 0...
  0%|          | 0/32 [00:00<?, ?it/s]100%|██████████| 32/32 [00:00<00:00, 555.65it/s]
2024-08-04:09:03:07,092 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_anatomy on rank 0...
  0%|          | 0/14 [00:00<?, ?it/s]100%|██████████| 14/14 [00:00<00:00, 545.84it/s]
2024-08-04:09:03:07,118 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_physics on rank 0...
  0%|          | 0/17 [00:00<?, ?it/s]100%|██████████| 17/17 [00:00<00:00, 599.74it/s]
2024-08-04:09:03:07,148 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_computer_science on rank 0...
  0%|          | 0/9 [00:00<?, ?it/s]100%|██████████| 9/9 [00:00<00:00, 509.51it/s]
2024-08-04:09:03:07,166 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_conceptual_physics on rank 0...
  0%|          | 0/26 [00:00<?, ?it/s]100%|██████████| 26/26 [00:00<00:00, 617.78it/s]
2024-08-04:09:03:07,209 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_mathematics on rank 0...
  0%|          | 0/29 [00:00<?, ?it/s]100%|██████████| 29/29 [00:00<00:00, 606.29it/s]
2024-08-04:09:03:07,259 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_computer_security on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 609.70it/s]
2024-08-04:09:03:07,278 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_chemistry on rank 0...
  0%|          | 0/22 [00:00<?, ?it/s]100%|██████████| 22/22 [00:00<00:00, 592.86it/s]
2024-08-04:09:03:07,316 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_physics on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 609.14it/s]
2024-08-04:09:03:07,335 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_chemistry on rank 0...
  0%|          | 0/8 [00:00<?, ?it/s]100%|██████████| 8/8 [00:00<00:00, 600.66it/s]
2024-08-04:09:03:07,349 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_biology on rank 0...
  0%|          | 0/16 [00:00<?, ?it/s]100%|██████████| 16/16 [00:00<00:00, 542.29it/s]
2024-08-04:09:03:07,379 INFO     [xevaluator.py:395] Running generate_until requests
Running generate_until requests:   0%|          | 0/1531 [00:00<?, ?it/s]Running generate_until requests:   0%|          | 1/1531 [00:18<7:49:34, 18.41s/it]Running generate_until requests:   0%|          | 2/1531 [00:27<5:33:53, 13.10s/it]Running generate_until requests:   0%|          | 3/1531 [00:41<5:46:15, 13.60s/it]Running generate_until requests:   0%|          | 4/1531 [01:01<6:45:28, 15.93s/it]Running generate_until requests:   0%|          | 5/1531 [01:46<11:09:21, 26.32s/it]Running generate_until requests:   0%|          | 6/1531 [01:59<9:17:15, 21.93s/it] Running generate_until requests:   0%|          | 7/1531 [02:44<12:27:39, 29.44s/it]Running generate_until requests:   1%|          | 8/1531 [03:29<14:34:21, 34.45s/it]Running generate_until requests:   1%|          | 9/1531 [03:40<11:22:22, 26.90s/it]Running generate_until requests:   1%|          | 10/1531 [03:50<9:15:22, 21.91s/it]Running generate_until requests:   1%|          | 11/1531 [04:36<12:17:25, 29.11s/it]Running generate_until requests:   1%|          | 12/1531 [04:47<10:00:57, 23.74s/it]Running generate_until requests:   1%|          | 13/1531 [05:07<9:33:51, 22.68s/it] Running generate_until requests:   1%|          | 14/1531 [05:25<8:51:06, 21.01s/it]Running generate_until requests:   1%|          | 15/1531 [06:10<11:55:30, 28.32s/it]Running generate_until requests:   1%|          | 16/1531 [06:55<14:01:42, 33.34s/it]Running generate_until requests:   1%|          | 17/1531 [07:07<11:17:59, 26.87s/it]Running generate_until requests:   1%|          | 18/1531 [07:51<13:29:47, 32.11s/it]Running generate_until requests:   1%|          | 19/1531 [08:05<11:11:57, 26.66s/it]Running generate_until requests:   1%|▏         | 20/1531 [08:50<13:31:54, 32.24s/it]Running generate_until requests:   1%|▏         | 21/1531 [09:20<13:10:17, 31.40s/it]Running generate_until requests:   1%|▏         | 22/1531 [10:08<15:16:38, 36.45s/it]Running generate_until requests:   2%|▏         | 23/1531 [10:20<12:14:11, 29.21s/it]Running generate_until requests:   2%|▏         | 24/1531 [11:07<14:28:32, 34.58s/it]Running generate_until requests:   2%|▏         | 25/1531 [11:55<16:04:25, 38.42s/it]Running generate_until requests:   2%|▏         | 26/1531 [12:42<17:07:53, 40.98s/it]Running generate_until requests:   2%|▏         | 27/1531 [13:07<15:07:31, 36.20s/it]Running generate_until requests:   2%|▏         | 28/1531 [13:53<16:25:19, 39.33s/it]Running generate_until requests:   2%|▏         | 29/1531 [14:40<17:21:21, 41.60s/it]Running generate_until requests:   2%|▏         | 30/1531 [15:02<14:49:36, 35.56s/it]Running generate_until requests:   2%|▏         | 31/1531 [15:22<12:52:39, 30.91s/it]Running generate_until requests:   2%|▏         | 32/1531 [16:09<14:54:06, 35.79s/it]Running generate_until requests:   2%|▏         | 33/1531 [16:21<11:56:17, 28.69s/it]Running generate_until requests:   2%|▏         | 34/1531 [17:09<14:21:36, 34.53s/it]Running generate_until requests:   2%|▏         | 35/1531 [18:00<16:21:27, 39.36s/it]Running generate_until requests:   2%|▏         | 36/1531 [18:50<17:42:06, 42.63s/it]Running generate_until requests:   2%|▏         | 37/1531 [19:15<15:27:21, 37.24s/it]Running generate_until requests:   2%|▏         | 38/1531 [20:02<16:43:25, 40.33s/it]Running generate_until requests:   3%|▎         | 39/1531 [20:50<17:41:10, 42.67s/it]Running generate_until requests:   3%|▎         | 40/1531 [21:41<18:38:14, 45.00s/it]Running generate_until requests:   3%|▎         | 41/1531 [22:31<19:12:57, 46.43s/it]Running generate_until requests:   3%|▎         | 42/1531 [23:18<19:20:54, 46.78s/it]Running generate_until requests:   3%|▎         | 43/1531 [24:05<19:23:16, 46.91s/it]Running generate_until requests:   3%|▎         | 44/1531 [24:53<19:24:31, 46.99s/it]Running generate_until requests:   3%|▎         | 45/1531 [25:39<19:23:03, 46.96s/it]Running generate_until requests:   3%|▎         | 46/1531 [26:26<19:20:39, 46.90s/it]Running generate_until requests:   3%|▎         | 47/1531 [27:13<19:16:53, 46.77s/it]Running generate_until requests:   3%|▎         | 48/1531 [28:00<19:20:57, 46.97s/it]Running generate_until requests:   3%|▎         | 49/1531 [28:47<19:21:24, 47.02s/it]Running generate_until requests:   3%|▎         | 50/1531 [29:34<19:18:56, 46.95s/it]Running generate_until requests:   3%|▎         | 51/1531 [30:21<19:18:20, 46.96s/it]Running generate_until requests:   3%|▎         | 52/1531 [31:08<19:17:29, 46.96s/it]Running generate_until requests:   3%|▎         | 53/1531 [31:55<19:15:30, 46.91s/it]