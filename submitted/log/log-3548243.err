fatal: Unable to create '/fsx-storygen/beidic/yang/GRIFFIN2/.git/index.lock': File exists.

Another git process seems to be running in this repository, e.g.
an editor opened by 'git commit'. Please make sure all processes
are terminated then try again. If it still fails, a git process
may have crashed in this repository earlier:
remove the file manually to continue.
error: cannot lock ref 'refs/remotes/origin/yangexp2threee': is at e12829f1d745757a95fa731ce90a16dcd92ef5bb but expected d0357fc3277f1e8a458184541a3280b1bc45da7f
From github.com:Infini-AI-Lab/GRIFFIN2
 ! d0357fc..e12829f  yangexp2threee -> origin/yangexp2threee  (unable to update local ref)
warning: fetch updated the current branch head.
fast-forwarding your working tree from
commit d0357fc3277f1e8a458184541a3280b1bc45da7f.
error: Your local changes to the following files would be overwritten by merge:
	debugging1.sh
	llama12_static_cache_sdpa_with_check.py
	xhuggingface.py
Please commit your changes or stash them before you merge.
Aborting
fatal: Cannot fast-forward your working tree.
After making sure that you saved anything precious from
$ git diff d0357fc3277f1e8a458184541a3280b1bc45da7f
output, run
$ git reset --hard
to recover.
wandb: Currently logged in as: stevenzhou0816100. Use `wandb login --relogin` to force relogin
2024-07-27:02:28:08,650 INFO     [main.py:288] Verbosity set to INFO
2024-07-27:02:28:18,737 WARNING  [main.py:303]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2024-07-27:02:28:18,738 INFO     [main.py:378] Selected Tasks: ['gsm8k_cot']
2024-07-27:02:28:18,763 INFO     [xevaluator.py:137] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2024-07-27:02:28:18,763 INFO     [xevaluator.py:184] Initializing xhf model, with arguments: {'pretrained': 'meta-llama/Meta-Llama-3-8B-Instruct', 'griffin': True, 'check': False, 'contextlength': 1500, 'kernel_size': 16, 'thr': 0.05}
2024-07-27:02:28:18,772 INFO     [xhuggingface.py:168] Using device 'cuda'
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:06<00:19,  6.59s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:13<00:13,  6.51s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:19<00:06,  6.45s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:21<00:00,  4.53s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:21<00:00,  5.25s/it]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
2024-07-27:02:29:22,383 WARNING  [task.py:322] [Task: gsm8k_cot] has_training_docs and has_validation_docs are False, using test_docs as fewshot_docs but this is not recommended.
2024-07-27:02:29:22,383 WARNING  [task.py:322] [Task: gsm8k_cot] has_training_docs and has_validation_docs are False, using test_docs as fewshot_docs but this is not recommended.
2024-07-27:02:29:22,470 INFO     [task.py:395] Building contexts for gsm8k_cot on rank 0...
  0%|          | 0/396 [00:00<?, ?it/s] 43%|████▎     | 169/396 [00:00<00:00, 1687.82it/s] 86%|████████▌ | 339/396 [00:00<00:00, 1693.70it/s]100%|██████████| 396/396 [00:00<00:00, 1690.11it/s]
2024-07-27:02:29:22,712 INFO     [xevaluator.py:395] Running generate_until requests
Running generate_until requests:   0%|          | 0/396 [00:00<?, ?it/s]Running generate_until requests:   0%|          | 1/396 [00:21<2:23:16, 21.76s/it]Running generate_until requests:   1%|          | 2/396 [00:41<2:14:10, 20.43s/it]Running generate_until requests:   1%|          | 3/396 [01:00<2:10:53, 19.98s/it]Running generate_until requests:   1%|          | 4/396 [01:20<2:09:43, 19.86s/it]Running generate_until requests:   1%|▏         | 5/396 [01:39<2:08:28, 19.72s/it]Running generate_until requests:   2%|▏         | 6/396 [01:59<2:07:33, 19.62s/it]Running generate_until requests:   2%|▏         | 7/396 [02:18<2:07:00, 19.59s/it]Running generate_until requests:   2%|▏         | 8/396 [02:38<2:06:38, 19.58s/it]Running generate_until requests:   2%|▏         | 9/396 [02:57<2:06:15, 19.57s/it]Running generate_until requests:   3%|▎         | 10/396 [03:17<2:06:03, 19.59s/it]Running generate_until requests:   3%|▎         | 11/396 [03:36<2:05:22, 19.54s/it]Running generate_until requests:   3%|▎         | 12/396 [03:56<2:04:53, 19.52s/it]Running generate_until requests:   3%|▎         | 13/396 [04:15<2:04:31, 19.51s/it]Running generate_until requests:   4%|▎         | 14/396 [04:35<2:04:04, 19.49s/it]Running generate_until requests:   4%|▍         | 15/396 [04:54<2:03:42, 19.48s/it]Running generate_until requests:   4%|▍         | 16/396 [05:15<2:06:23, 19.96s/it]Running generate_until requests:   4%|▍         | 17/396 [05:35<2:05:05, 19.80s/it]Running generate_until requests:   5%|▍         | 18/396 [05:54<2:04:09, 19.71s/it]Running generate_until requests:   5%|▍         | 19/396 [06:14<2:03:27, 19.65s/it]Running generate_until requests:   5%|▌         | 20/396 [06:33<2:02:50, 19.60s/it]Running generate_until requests:   5%|▌         | 21/396 [06:53<2:02:14, 19.56s/it]Running generate_until requests:   6%|▌         | 22/396 [07:12<2:01:51, 19.55s/it]Running generate_until requests:   6%|▌         | 23/396 [07:32<2:01:22, 19.52s/it]Running generate_until requests:   6%|▌         | 24/396 [07:51<2:00:53, 19.50s/it]Running generate_until requests:   6%|▋         | 25/396 [08:11<2:00:28, 19.48s/it]Running generate_until requests:   7%|▋         | 26/396 [08:30<2:00:05, 19.48s/it]Running generate_until requests:   7%|▋         | 27/396 [08:50<1:59:44, 19.47s/it]Running generate_until requests:   7%|▋         | 28/396 [09:09<1:59:51, 19.54s/it]Running generate_until requests:   7%|▋         | 29/396 [09:29<1:59:18, 19.51s/it]Running generate_until requests:   8%|▊         | 30/396 [09:48<1:58:54, 19.49s/it]Running generate_until requests:   8%|▊         | 31/396 [10:08<1:58:33, 19.49s/it]Running generate_until requests:   8%|▊         | 32/396 [10:27<1:58:24, 19.52s/it]Running generate_until requests:   8%|▊         | 33/396 [10:48<2:00:03, 19.85s/it]Running generate_until requests:   9%|▊         | 34/396 [11:07<1:59:03, 19.73s/it]Running generate_until requests:   9%|▉         | 35/396 [11:27<1:58:09, 19.64s/it]Running generate_until requests:   9%|▉         | 36/396 [11:46<1:57:37, 19.60s/it]Running generate_until requests:   9%|▉         | 37/396 [12:06<1:57:00, 19.56s/it]Running generate_until requests:  10%|▉         | 38/396 [12:25<1:56:27, 19.52s/it]Running generate_until requests:  10%|▉         | 39/396 [12:45<1:56:16, 19.54s/it]Running generate_until requests:  10%|█         | 40/396 [13:04<1:55:46, 19.51s/it]Running generate_until requests:  10%|█         | 41/396 [13:24<1:55:22, 19.50s/it]Running generate_until requests:  11%|█         | 42/396 [13:43<1:55:04, 19.50s/it]Running generate_until requests:  11%|█         | 43/396 [14:03<1:54:35, 19.48s/it]Running generate_until requests:  11%|█         | 44/396 [14:22<1:54:12, 19.47s/it]Running generate_until requests:  11%|█▏        | 45/396 [14:41<1:53:50, 19.46s/it]Running generate_until requests:  12%|█▏        | 46/396 [15:01<1:53:31, 19.46s/it]Running generate_until requests:  12%|█▏        | 47/396 [15:20<1:53:13, 19.46s/it]Running generate_until requests:  12%|█▏        | 48/396 [15:40<1:52:57, 19.47s/it]Running generate_until requests:  12%|█▏        | 49/396 [15:59<1:52:33, 19.46s/it]Running generate_until requests:  13%|█▎        | 50/396 [16:19<1:52:14, 19.46s/it]Running generate_until requests:  13%|█▎        | 51/396 [16:38<1:51:50, 19.45s/it]Running generate_until requests:  13%|█▎        | 52/396 [16:58<1:51:32, 19.46s/it]Running generate_until requests:  13%|█▎        | 53/396 [17:17<1:51:17, 19.47s/it]Running generate_until requests:  14%|█▎        | 54/396 [17:37<1:50:44, 19.43s/it]Running generate_until requests:  14%|█▍        | 55/396 [17:56<1:50:19, 19.41s/it]Running generate_until requests:  14%|█▍        | 56/396 [18:15<1:50:05, 19.43s/it]Running generate_until requests:  14%|█▍        | 57/396 [18:35<1:49:39, 19.41s/it]Running generate_until requests:  15%|█▍        | 58/396 [18:54<1:49:23, 19.42s/it]Running generate_until requests:  15%|█▍        | 59/396 [19:14<1:49:02, 19.41s/it]Running generate_until requests:  15%|█▌        | 60/396 [19:33<1:48:46, 19.42s/it]Running generate_until requests:  15%|█▌        | 61/396 [19:52<1:48:18, 19.40s/it]Running generate_until requests:  16%|█▌        | 62/396 [20:12<1:47:57, 19.39s/it]Running generate_until requests:  16%|█▌        | 63/396 [20:31<1:47:33, 19.38s/it]Running generate_until requests:  16%|█▌        | 64/396 [20:51<1:48:33, 19.62s/it]Running generate_until requests:  16%|█▋        | 65/396 [21:11<1:47:52, 19.55s/it]Running generate_until requests:  17%|█▋        | 66/396 [21:30<1:47:09, 19.48s/it]Running generate_until requests:  17%|█▋        | 67/396 [21:49<1:46:37, 19.44s/it]Running generate_until requests:  17%|█▋        | 68/396 [22:09<1:46:08, 19.42s/it]Running generate_until requests:  17%|█▋        | 69/396 [22:28<1:45:39, 19.39s/it]Running generate_until requests:  18%|█▊        | 70/396 [22:47<1:45:25, 19.40s/it]Running generate_until requests:  18%|█▊        | 71/396 [23:07<1:45:01, 19.39s/it]Running generate_until requests:  18%|█▊        | 72/396 [23:26<1:44:36, 19.37s/it]Running generate_until requests:  18%|█▊        | 73/396 [23:46<1:44:19, 19.38s/it]Running generate_until requests:  19%|█▊        | 74/396 [24:05<1:43:55, 19.36s/it]Running generate_until requests:  19%|█▉        | 75/396 [24:24<1:43:34, 19.36s/it]Running generate_until requests:  19%|█▉        | 76/396 [24:44<1:43:18, 19.37s/it]Running generate_until requests:  19%|█▉        | 77/396 [25:03<1:43:02, 19.38s/it]Running generate_until requests:  20%|█▉        | 78/396 [25:23<1:43:40, 19.56s/it]Running generate_until requests:  20%|█▉        | 79/396 [25:44<1:46:20, 20.13s/it]Running generate_until requests:  20%|██        | 80/396 [26:04<1:44:46, 19.89s/it]Running generate_until requests:  20%|██        | 81/396 [26:23<1:43:33, 19.73s/it]Running generate_until requests:  21%|██        | 82/396 [26:43<1:42:41, 19.62s/it]Running generate_until requests:  21%|██        | 83/396 [27:02<1:41:54, 19.53s/it]Running generate_until requests:  21%|██        | 84/396 [27:21<1:41:14, 19.47s/it]Running generate_until requests:  21%|██▏       | 85/396 [27:40<1:40:42, 19.43s/it]Running generate_until requests:  22%|██▏       | 86/396 [28:00<1:40:15, 19.41s/it]Running generate_until requests:  22%|██▏       | 87/396 [28:19<1:39:51, 19.39s/it]Running generate_until requests:  22%|██▏       | 88/396 [28:39<1:39:30, 19.39s/it]Running generate_until requests:  22%|██▏       | 89/396 [28:58<1:39:09, 19.38s/it]Running generate_until requests:  23%|██▎       | 90/396 [29:17<1:38:56, 19.40s/it]Running generate_until requests:  23%|██▎       | 91/396 [29:37<1:38:30, 19.38s/it]Running generate_until requests:  23%|██▎       | 92/396 [29:56<1:38:15, 19.39s/it]Running generate_until requests:  23%|██▎       | 93/396 [30:16<1:38:00, 19.41s/it]Running generate_until requests:  24%|██▎       | 94/396 [30:35<1:37:36, 19.39s/it]Running generate_until requests:  24%|██▍       | 95/396 [30:54<1:37:17, 19.39s/it]Running generate_until requests:  24%|██▍       | 96/396 [31:14<1:36:58, 19.39s/it]Running generate_until requests:  24%|██▍       | 97/396 [31:33<1:36:33, 19.38s/it]Running generate_until requests:  25%|██▍       | 98/396 [31:52<1:36:14, 19.38s/it]Running generate_until requests:  25%|██▌       | 99/396 [32:12<1:35:53, 19.37s/it]Running generate_until requests:  25%|██▌       | 100/396 [32:31<1:35:30, 19.36s/it]Running generate_until requests:  26%|██▌       | 101/396 [32:50<1:35:10, 19.36s/it]Running generate_until requests:  26%|██▌       | 102/396 [33:10<1:34:47, 19.34s/it]Running generate_until requests:  26%|██▌       | 103/396 [33:29<1:34:27, 19.34s/it]Running generate_until requests:  26%|██▋       | 104/396 [33:49<1:34:10, 19.35s/it]Running generate_until requests:  27%|██▋       | 105/396 [34:08<1:33:51, 19.35s/it]Running generate_until requests:  27%|██▋       | 106/396 [34:27<1:33:29, 19.34s/it]Running generate_until requests:  27%|██▋       | 107/396 [34:47<1:33:16, 19.36s/it]Running generate_until requests:  27%|██▋       | 108/396 [35:06<1:32:55, 19.36s/it]Running generate_until requests:  28%|██▊       | 109/396 [35:26<1:34:04, 19.67s/it]Running generate_until requests:  28%|██▊       | 110/396 [35:48<1:36:33, 20.26s/it]Running generate_until requests:  28%|██▊       | 111/396 [36:07<1:34:56, 19.99s/it]Running generate_until requests:  28%|██▊       | 112/396 [36:27<1:33:44, 19.80s/it]Running generate_until requests:  29%|██▊       | 113/396 [36:46<1:32:50, 19.68s/it]Running generate_until requests:  29%|██▉       | 114/396 [37:05<1:32:03, 19.59s/it]Running generate_until requests:  29%|██▉       | 115/396 [37:25<1:31:21, 19.51s/it]Running generate_until requests:  29%|██▉       | 116/396 [37:44<1:30:54, 19.48s/it]Running generate_until requests:  30%|██▉       | 117/396 [38:04<1:30:23, 19.44s/it]Running generate_until requests:  30%|██▉       | 118/396 [38:23<1:29:55, 19.41s/it]Running generate_until requests:  30%|███       | 119/396 [38:42<1:29:37, 19.41s/it]Running generate_until requests:  30%|███       | 120/396 [39:02<1:29:12, 19.39s/it]Running generate_until requests:  31%|███       | 121/396 [39:21<1:28:56, 19.41s/it]Running generate_until requests:  31%|███       | 122/396 [39:41<1:28:37, 19.41s/it]Running generate_until requests:  31%|███       | 123/396 [40:00<1:28:28, 19.45s/it]Running generate_until requests:  31%|███▏      | 124/396 [40:19<1:28:05, 19.43s/it]Running generate_until requests:  32%|███▏      | 125/396 [40:39<1:27:43, 19.42s/it]