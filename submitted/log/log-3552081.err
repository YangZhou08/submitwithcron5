Already on 'yangexp2threee'
warning: fetch updated the current branch head.
fast-forwarding your working tree from
commit 3828bef74bce9e650289220713cddec1f26f65a0.
error: Your local changes to the following files would be overwritten by merge:
	llama12_static_cache_sdpa_with_check.py
	llama12_static_cache_sdpa_with_treee.py
Please commit your changes or stash them before you merge.
Aborting
fatal: Cannot fast-forward your working tree.
After making sure that you saved anything precious from
$ git diff 3828bef74bce9e650289220713cddec1f26f65a0
output, run
$ git reset --hard
to recover.
wandb: Currently logged in as: stevenzhou0816100. Use `wandb login --relogin` to force relogin
2024-07-28:03:16:08,340 INFO     [main.py:288] Verbosity set to INFO
2024-07-28:03:16:17,964 WARNING  [main.py:303]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2024-07-28:03:16:17,965 INFO     [main.py:378] Selected Tasks: ['gsm8k_cot']
2024-07-28:03:16:17,988 INFO     [xevaluator.py:137] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2024-07-28:03:16:17,988 INFO     [xevaluator.py:184] Initializing xhf model, with arguments: {'pretrained': 'meta-llama/Meta-Llama-3-8B-Instruct', 'griffin': True, 'check': False, 'contextlength': 1500, 'kernel_size': 10, 'thr': 0.05, 'attentionimplementation': 'general'}
2024-07-28:03:16:17,997 INFO     [xhuggingface.py:168] Using device 'cuda'
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:06<00:20,  6.75s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:15<00:15,  7.87s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:21<00:07,  7.01s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:22<00:00,  4.85s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:22<00:00,  5.73s/it]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
2024-07-28:03:17:22,277 WARNING  [task.py:322] [Task: gsm8k_cot] has_training_docs and has_validation_docs are False, using test_docs as fewshot_docs but this is not recommended.
2024-07-28:03:17:22,277 WARNING  [task.py:322] [Task: gsm8k_cot] has_training_docs and has_validation_docs are False, using test_docs as fewshot_docs but this is not recommended.
2024-07-28:03:17:22,370 INFO     [task.py:395] Building contexts for gsm8k_cot on rank 0...
  0%|          | 0/396 [00:00<?, ?it/s] 43%|████▎     | 169/396 [00:00<00:00, 1684.66it/s] 86%|████████▌ | 339/396 [00:00<00:00, 1688.67it/s]100%|██████████| 396/396 [00:00<00:00, 1686.89it/s]
2024-07-28:03:17:22,614 INFO     [xevaluator.py:395] Running generate_until requests
Running generate_until requests:   0%|          | 0/396 [00:00<?, ?it/s]Running generate_until requests:   0%|          | 1/396 [00:10<1:09:31, 10.56s/it]Running generate_until requests:   1%|          | 2/396 [00:19<1:01:25,  9.35s/it]Running generate_until requests:   1%|          | 3/396 [00:27<58:55,  9.00s/it]  Running generate_until requests:   1%|          | 4/396 [00:36<58:12,  8.91s/it]Running generate_until requests:   1%|▏         | 5/396 [00:44<57:12,  8.78s/it]Running generate_until requests:   2%|▏         | 6/396 [00:53<57:34,  8.86s/it]Running generate_until requests:   2%|▏         | 7/396 [01:02<56:54,  8.78s/it]Running generate_until requests:   2%|▏         | 8/396 [01:11<56:20,  8.71s/it]Running generate_until requests:   2%|▏         | 9/396 [01:19<56:11,  8.71s/it]Running generate_until requests:   3%|▎         | 10/396 [01:28<55:52,  8.69s/it]Running generate_until requests:   3%|▎         | 11/396 [01:37<55:31,  8.65s/it]Running generate_until requests:   3%|▎         | 12/396 [01:45<55:07,  8.61s/it]Running generate_until requests:   3%|▎         | 13/396 [01:54<55:23,  8.68s/it]Running generate_until requests:   4%|▎         | 14/396 [02:03<55:40,  8.75s/it]Running generate_until requests:   4%|▍         | 15/396 [02:11<55:20,  8.71s/it]Running generate_until requests:   4%|▍         | 16/396 [02:20<54:48,  8.65s/it]Running generate_until requests:   4%|▍         | 17/396 [02:29<54:48,  8.68s/it]Running generate_until requests:   5%|▍         | 18/396 [02:37<54:32,  8.66s/it]Running generate_until requests:   5%|▍         | 19/396 [02:46<54:06,  8.61s/it]Running generate_until requests:   5%|▌         | 20/396 [02:55<54:21,  8.67s/it]Running generate_until requests:   5%|▌         | 21/396 [03:03<54:22,  8.70s/it]Running generate_until requests:   6%|▌         | 22/396 [03:12<53:53,  8.65s/it]Running generate_until requests:   6%|▌         | 23/396 [03:21<54:03,  8.69s/it]Running generate_until requests:   6%|▌         | 24/396 [03:29<53:50,  8.68s/it]Running generate_until requests:   6%|▋         | 25/396 [03:38<53:35,  8.67s/it]Running generate_until requests:   7%|▋         | 26/396 [03:47<53:16,  8.64s/it]Running generate_until requests:   7%|▋         | 27/396 [03:55<52:56,  8.61s/it]Running generate_until requests:   7%|▋         | 28/396 [04:04<52:50,  8.62s/it]Running generate_until requests:   7%|▋         | 29/396 [04:12<52:42,  8.62s/it]Running generate_until requests:   8%|▊         | 30/396 [04:21<52:20,  8.58s/it]Running generate_until requests:   8%|▊         | 31/396 [04:30<52:26,  8.62s/it]Running generate_until requests:   8%|▊         | 32/396 [04:38<52:06,  8.59s/it]Running generate_until requests:   8%|▊         | 33/396 [04:47<52:06,  8.61s/it]Running generate_until requests:   9%|▊         | 34/396 [04:55<51:49,  8.59s/it]Running generate_until requests:   9%|▉         | 35/396 [05:04<51:55,  8.63s/it]Running generate_until requests:   9%|▉         | 36/396 [05:13<51:33,  8.59s/it]Running generate_until requests:   9%|▉         | 37/396 [05:21<51:39,  8.63s/it]Running generate_until requests:  10%|▉         | 38/396 [05:30<51:51,  8.69s/it]Running generate_until requests:  10%|▉         | 39/396 [05:39<52:40,  8.85s/it]Running generate_until requests:  10%|█         | 40/396 [05:48<52:04,  8.78s/it]Running generate_until requests:  10%|█         | 41/396 [05:56<51:32,  8.71s/it]Running generate_until requests:  11%|█         | 42/396 [06:05<51:08,  8.67s/it]Running generate_until requests:  11%|█         | 43/396 [06:14<50:45,  8.63s/it]Running generate_until requests:  11%|█         | 44/396 [06:22<50:43,  8.65s/it]Running generate_until requests:  11%|█▏        | 45/396 [06:31<50:28,  8.63s/it]Running generate_until requests:  12%|█▏        | 46/396 [06:39<50:11,  8.60s/it]Running generate_until requests:  12%|█▏        | 47/396 [06:48<50:06,  8.61s/it]Running generate_until requests:  12%|█▏        | 48/396 [06:57<49:55,  8.61s/it]Running generate_until requests:  12%|█▏        | 49/396 [07:05<49:46,  8.61s/it]Running generate_until requests:  13%|█▎        | 50/396 [07:14<49:52,  8.65s/it]Running generate_until requests:  13%|█▎        | 51/396 [07:23<49:30,  8.61s/it]Running generate_until requests:  13%|█▎        | 52/396 [07:31<49:27,  8.63s/it]Running generate_until requests:  13%|█▎        | 53/396 [07:40<49:17,  8.62s/it]Running generate_until requests:  14%|█▎        | 54/396 [07:48<48:57,  8.59s/it]Running generate_until requests:  14%|█▍        | 55/396 [07:57<48:55,  8.61s/it]Running generate_until requests:  14%|█▍        | 56/396 [08:06<48:53,  8.63s/it]Running generate_until requests:  14%|█▍        | 57/396 [08:14<49:03,  8.68s/it]Running generate_until requests:  15%|█▍        | 58/396 [08:23<48:37,  8.63s/it]Running generate_until requests:  15%|█▍        | 59/396 [08:32<48:29,  8.63s/it]Running generate_until requests:  15%|█▌        | 60/396 [08:40<48:21,  8.64s/it]Running generate_until requests:  15%|█▌        | 61/396 [08:49<48:26,  8.67s/it]Running generate_until requests:  16%|█▌        | 62/396 [08:58<48:09,  8.65s/it]Running generate_until requests:  16%|█▌        | 63/396 [09:08<50:15,  9.06s/it]Running generate_until requests:  16%|█▌        | 64/396 [09:16<49:32,  8.95s/it]Running generate_until requests:  16%|█▋        | 65/396 [09:25<48:39,  8.82s/it]Running generate_until requests:  17%|█▋        | 66/396 [09:33<48:04,  8.74s/it]Running generate_until requests:  17%|█▋        | 67/396 [09:42<47:47,  8.72s/it]Running generate_until requests:  17%|█▋        | 68/396 [09:51<47:24,  8.67s/it]Running generate_until requests:  17%|█▋        | 69/396 [09:59<47:13,  8.67s/it]Running generate_until requests:  18%|█▊        | 70/396 [10:08<47:07,  8.67s/it]Running generate_until requests:  18%|█▊        | 71/396 [10:17<46:54,  8.66s/it]Running generate_until requests:  18%|█▊        | 72/396 [10:25<46:38,  8.64s/it]Running generate_until requests:  18%|█▊        | 73/396 [10:34<46:17,  8.60s/it]Running generate_until requests:  19%|█▊        | 74/396 [10:43<47:16,  8.81s/it]Running generate_until requests:  19%|█▉        | 75/396 [10:52<46:47,  8.75s/it]Running generate_until requests:  19%|█▉        | 76/396 [11:00<46:20,  8.69s/it]Running generate_until requests:  19%|█▉        | 77/396 [11:09<45:53,  8.63s/it]Running generate_until requests:  20%|█▉        | 78/396 [11:17<45:23,  8.56s/it]Running generate_until requests:  20%|█▉        | 79/396 [11:25<45:03,  8.53s/it]Running generate_until requests:  20%|██        | 80/396 [11:34<44:34,  8.46s/it]Running generate_until requests:  20%|██        | 81/396 [11:42<44:38,  8.50s/it]Running generate_until requests:  21%|██        | 82/396 [11:51<44:39,  8.53s/it]Running generate_until requests:  21%|██        | 83/396 [11:59<44:13,  8.48s/it]Running generate_until requests:  21%|██        | 84/396 [12:08<44:01,  8.47s/it]Running generate_until requests:  21%|██▏       | 85/396 [12:16<43:47,  8.45s/it]Running generate_until requests:  22%|██▏       | 86/396 [12:25<43:27,  8.41s/it]Running generate_until requests:  22%|██▏       | 87/396 [12:33<43:27,  8.44s/it]Running generate_until requests:  22%|██▏       | 88/396 [12:41<43:10,  8.41s/it]Running generate_until requests:  22%|██▏       | 89/396 [12:50<43:02,  8.41s/it]Running generate_until requests:  23%|██▎       | 90/396 [12:58<43:08,  8.46s/it]Running generate_until requests:  23%|██▎       | 91/396 [13:07<42:57,  8.45s/it]Running generate_until requests:  23%|██▎       | 92/396 [13:15<42:51,  8.46s/it]Running generate_until requests:  23%|██▎       | 93/396 [13:24<42:36,  8.44s/it]Running generate_until requests:  24%|██▎       | 94/396 [13:32<42:41,  8.48s/it]Running generate_until requests:  24%|██▍       | 95/396 [13:41<42:21,  8.44s/it]Running generate_until requests:  24%|██▍       | 96/396 [13:49<42:08,  8.43s/it]Running generate_until requests:  24%|██▍       | 97/396 [13:58<42:31,  8.53s/it]Running generate_until requests:  25%|██▍       | 98/396 [14:08<44:17,  8.92s/it]Running generate_until requests:  25%|██▌       | 99/396 [14:16<43:22,  8.76s/it]Running generate_until requests:  25%|██▌       | 100/396 [14:24<42:36,  8.64s/it]Running generate_until requests:  26%|██▌       | 101/396 [14:33<42:00,  8.54s/it]Running generate_until requests:  26%|██▌       | 102/396 [14:41<41:32,  8.48s/it]Running generate_until requests:  26%|██▌       | 103/396 [14:50<41:40,  8.53s/it]Running generate_until requests:  26%|██▋       | 104/396 [14:58<41:37,  8.55s/it]Running generate_until requests:  27%|██▋       | 105/396 [15:07<41:25,  8.54s/it]Running generate_until requests:  27%|██▋       | 106/396 [15:15<41:19,  8.55s/it]Running generate_until requests:  27%|██▋       | 107/396 [15:24<40:51,  8.48s/it]Running generate_until requests:  27%|██▋       | 108/396 [15:32<40:34,  8.45s/it]Running generate_until requests:  28%|██▊       | 109/396 [15:43<43:36,  9.12s/it]Running generate_until requests:  28%|██▊       | 110/396 [15:51<42:36,  8.94s/it]Running generate_until requests:  28%|██▊       | 111/396 [16:00<41:38,  8.77s/it]Running generate_until requests:  28%|██▊       | 112/396 [16:08<40:56,  8.65s/it]Running generate_until requests:  29%|██▊       | 113/396 [16:16<40:21,  8.56s/it]Running generate_until requests:  29%|██▉       | 114/396 [16:25<40:05,  8.53s/it]Running generate_until requests:  29%|██▉       | 115/396 [16:33<39:53,  8.52s/it]Running generate_until requests:  29%|██▉       | 116/396 [16:42<39:31,  8.47s/it]Running generate_until requests:  30%|██▉       | 117/396 [16:50<39:09,  8.42s/it]Running generate_until requests:  30%|██▉       | 118/396 [16:58<38:56,  8.40s/it]Running generate_until requests:  30%|███       | 119/396 [17:07<38:47,  8.40s/it]Running generate_until requests:  30%|███       | 120/396 [17:15<38:39,  8.40s/it]Running generate_until requests:  31%|███       | 121/396 [17:23<38:22,  8.37s/it]Running generate_until requests:  31%|███       | 122/396 [17:32<38:19,  8.39s/it]Running generate_until requests:  31%|███       | 123/396 [17:40<38:11,  8.39s/it]Running generate_until requests:  31%|███▏      | 124/396 [17:49<37:56,  8.37s/it]Running generate_until requests:  32%|███▏      | 125/396 [17:57<37:49,  8.37s/it]Running generate_until requests:  32%|███▏      | 126/396 [18:05<37:37,  8.36s/it]Running generate_until requests:  32%|███▏      | 127/396 [18:14<37:40,  8.40s/it]Running generate_until requests:  32%|███▏      | 128/396 [18:22<37:26,  8.38s/it]Running generate_until requests:  33%|███▎      | 129/396 [18:31<37:26,  8.42s/it]Running generate_until requests:  33%|███▎      | 130/396 [18:39<37:47,  8.53s/it]Running generate_until requests:  33%|███▎      | 131/396 [18:48<37:34,  8.51s/it]Running generate_until requests:  33%|███▎      | 132/396 [18:56<37:29,  8.52s/it]Running generate_until requests:  34%|███▎      | 133/396 [19:05<37:11,  8.48s/it]Running generate_until requests:  34%|███▍      | 134/396 [19:15<39:59,  9.16s/it]Running generate_until requests:  34%|███▍      | 135/396 [19:24<38:52,  8.94s/it]Running generate_until requests:  34%|███▍      | 136/396 [19:32<37:57,  8.76s/it]Running generate_until requests:  35%|███▍      | 137/396 [19:41<37:17,  8.64s/it]Running generate_until requests:  35%|███▍      | 138/396 [19:49<36:53,  8.58s/it]Running generate_until requests:  35%|███▌      | 139/396 [19:57<36:33,  8.54s/it]Running generate_until requests:  35%|███▌      | 140/396 [20:06<36:10,  8.48s/it]Running generate_until requests:  36%|███▌      | 141/396 [20:14<36:01,  8.48s/it]Running generate_until requests:  36%|███▌      | 142/396 [20:23<35:49,  8.46s/it]Running generate_until requests:  36%|███▌      | 143/396 [20:31<35:36,  8.44s/it]Running generate_until requests:  36%|███▋      | 144/396 [20:40<35:27,  8.44s/it]Running generate_until requests:  37%|███▋      | 145/396 [20:50<37:57,  9.08s/it]Running generate_until requests:  37%|███▋      | 146/396 [20:59<37:01,  8.88s/it]Running generate_until requests:  37%|███▋      | 147/396 [21:07<36:14,  8.73s/it]Running generate_until requests:  37%|███▋      | 148/396 [21:15<35:40,  8.63s/it]Running generate_until requests:  38%|███▊      | 149/396 [21:24<35:10,  8.54s/it]Running generate_until requests:  38%|███▊      | 150/396 [21:32<34:48,  8.49s/it]Running generate_until requests:  38%|███▊      | 151/396 [21:40<34:25,  8.43s/it]Running generate_until requests:  38%|███▊      | 152/396 [21:49<34:16,  8.43s/it]Running generate_until requests:  39%|███▊      | 153/396 [21:58<34:38,  8.55s/it]Running generate_until requests:  39%|███▉      | 154/396 [22:08<36:48,  9.13s/it]Running generate_until requests:  39%|███▉      | 155/396 [22:19<38:19,  9.54s/it]Running generate_until requests:  39%|███▉      | 156/396 [22:29<39:21,  9.84s/it]