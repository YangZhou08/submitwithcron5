Already on 'yangexp2threee'
error: cannot lock ref 'refs/remotes/origin/yangexp2threee': is at 4ef3e8a08cb284b5aea9f17030f566ae734f6252 but expected e12829f1d745757a95fa731ce90a16dcd92ef5bb
From github.com:Infini-AI-Lab/GRIFFIN2
 ! e12829f..4ef3e8a  yangexp2threee -> origin/yangexp2threee  (unable to update local ref)
error: Your local changes to the following files would be overwritten by merge:
	debugging1.sh
	llama12_static_cache_sdpa_with_check.py
	xhuggingface.py
Please commit your changes or stash them before you merge.
Aborting
wandb: Currently logged in as: stevenzhou0816100. Use `wandb login --relogin` to force relogin
2024-07-28:00:21:11,059 INFO     [main.py:288] Verbosity set to INFO
2024-07-28:00:21:21,832 WARNING  [main.py:303]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2024-07-28:00:21:21,833 INFO     [main.py:378] Selected Tasks: ['gsm8k_cot']
2024-07-28:00:21:21,858 INFO     [xevaluator.py:137] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2024-07-28:00:21:21,858 INFO     [xevaluator.py:184] Initializing xhf model, with arguments: {'pretrained': 'meta-llama/Meta-Llama-3-8B-Instruct', 'griffin': True, 'check': False, 'contextlength': 1500, 'kernel_size': 10, 'thr': 0.05}
2024-07-28:00:21:21,867 INFO     [xhuggingface.py:168] Using device 'cuda'
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:06<00:19,  6.44s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:12<00:12,  6.25s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:18<00:06,  6.14s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:20<00:00,  4.32s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:20<00:00,  5.03s/it]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
2024-07-28:00:22:22,786 WARNING  [task.py:322] [Task: gsm8k_cot] has_training_docs and has_validation_docs are False, using test_docs as fewshot_docs but this is not recommended.
2024-07-28:00:22:22,787 WARNING  [task.py:322] [Task: gsm8k_cot] has_training_docs and has_validation_docs are False, using test_docs as fewshot_docs but this is not recommended.
2024-07-28:00:22:22,870 INFO     [task.py:395] Building contexts for gsm8k_cot on rank 0...
  0%|          | 0/396 [00:00<?, ?it/s] 42%|████▏     | 168/396 [00:00<00:00, 1673.95it/s] 85%|████████▍ | 336/396 [00:00<00:00, 1672.82it/s]100%|██████████| 396/396 [00:00<00:00, 1671.50it/s]
2024-07-28:00:22:23,116 INFO     [xevaluator.py:395] Running generate_until requests
Running generate_until requests:   0%|          | 0/396 [00:00<?, ?it/s]Running generate_until requests:   0%|          | 1/396 [00:13<1:27:32, 13.30s/it]Running generate_until requests:   1%|          | 2/396 [00:24<1:18:35, 11.97s/it]Running generate_until requests:   1%|          | 3/396 [00:35<1:15:32, 11.53s/it]Running generate_until requests:   1%|          | 4/396 [00:46<1:14:28, 11.40s/it]Running generate_until requests:   1%|▏         | 5/396 [00:56<1:11:15, 10.93s/it]Running generate_until requests:   2%|▏         | 6/396 [01:05<1:07:19, 10.36s/it]Running generate_until requests:   2%|▏         | 7/396 [01:14<1:03:50,  9.85s/it]Running generate_until requests:   2%|▏         | 8/396 [01:23<1:01:35,  9.52s/it]Running generate_until requests:   2%|▏         | 9/396 [01:32<1:00:29,  9.38s/it]Running generate_until requests:   3%|▎         | 10/396 [01:41<59:16,  9.21s/it] Running generate_until requests:   3%|▎         | 11/396 [01:50<58:14,  9.08s/it]Running generate_until requests:   3%|▎         | 12/396 [01:59<57:42,  9.02s/it]Running generate_until requests:   3%|▎         | 13/396 [02:08<57:42,  9.04s/it]Running generate_until requests:   4%|▎         | 14/396 [02:17<57:32,  9.04s/it]Running generate_until requests:   4%|▍         | 15/396 [02:26<57:06,  8.99s/it]Running generate_until requests:   4%|▍         | 16/396 [02:34<56:31,  8.92s/it]Running generate_until requests:   4%|▍         | 17/396 [02:43<56:22,  8.92s/it]Running generate_until requests:   5%|▍         | 18/396 [02:52<56:10,  8.92s/it]Running generate_until requests:   5%|▍         | 19/396 [03:01<55:58,  8.91s/it]Running generate_until requests:   5%|▌         | 20/396 [03:10<56:00,  8.94s/it]Running generate_until requests:   5%|▌         | 21/396 [03:19<55:48,  8.93s/it]Running generate_until requests:   6%|▌         | 22/396 [03:28<55:41,  8.93s/it]Running generate_until requests:   6%|▌         | 23/396 [03:37<55:34,  8.94s/it]Running generate_until requests:   6%|▌         | 24/396 [03:46<55:24,  8.94s/it]Running generate_until requests:   6%|▋         | 25/396 [03:55<55:22,  8.96s/it]Running generate_until requests:   7%|▋         | 26/396 [04:04<55:11,  8.95s/it]Running generate_until requests:   7%|▋         | 27/396 [04:13<54:41,  8.89s/it]Running generate_until requests:   7%|▋         | 28/396 [04:21<54:33,  8.90s/it]Running generate_until requests:   7%|▋         | 29/396 [04:30<54:20,  8.88s/it]Running generate_until requests:   8%|▊         | 30/396 [04:39<53:54,  8.84s/it]Running generate_until requests:   8%|▊         | 31/396 [04:48<53:49,  8.85s/it]Running generate_until requests:   8%|▊         | 32/396 [04:59<57:20,  9.45s/it]Running generate_until requests:   8%|▊         | 33/396 [05:08<56:15,  9.30s/it]Running generate_until requests:   9%|▊         | 34/396 [05:16<55:06,  9.13s/it]Running generate_until requests:   9%|▉         | 35/396 [05:25<54:41,  9.09s/it]Running generate_until requests:   9%|▉         | 36/396 [05:34<53:59,  9.00s/it]Running generate_until requests:   9%|▉         | 37/396 [05:43<53:25,  8.93s/it]Running generate_until requests:  10%|▉         | 38/396 [05:52<53:31,  8.97s/it]Running generate_until requests:  10%|▉         | 39/396 [06:01<53:27,  8.98s/it]Running generate_until requests:  10%|█         | 40/396 [06:10<53:03,  8.94s/it]Running generate_until requests:  10%|█         | 41/396 [06:19<52:37,  8.89s/it]Running generate_until requests:  11%|█         | 42/396 [06:27<52:21,  8.87s/it]Running generate_until requests:  11%|█         | 43/396 [06:36<52:01,  8.84s/it]Running generate_until requests:  11%|█         | 44/396 [06:45<52:01,  8.87s/it]Running generate_until requests:  11%|█▏        | 45/396 [06:54<51:44,  8.84s/it]Running generate_until requests:  12%|█▏        | 46/396 [07:03<51:34,  8.84s/it]Running generate_until requests:  12%|█▏        | 47/396 [07:12<51:27,  8.85s/it]Running generate_until requests:  12%|█▏        | 48/396 [07:20<51:15,  8.84s/it]Running generate_until requests:  12%|█▏        | 49/396 [07:29<50:58,  8.81s/it]Running generate_until requests:  13%|█▎        | 50/396 [07:38<51:06,  8.86s/it]Running generate_until requests:  13%|█▎        | 51/396 [07:47<50:46,  8.83s/it]Running generate_until requests:  13%|█▎        | 52/396 [07:56<50:50,  8.87s/it]Running generate_until requests:  13%|█▎        | 53/396 [08:05<50:35,  8.85s/it]Running generate_until requests:  14%|█▎        | 54/396 [08:14<50:18,  8.83s/it]Running generate_until requests:  14%|█▍        | 55/396 [08:22<50:10,  8.83s/it]Running generate_until requests:  14%|█▍        | 56/396 [08:31<50:01,  8.83s/it]Running generate_until requests:  14%|█▍        | 57/396 [08:40<50:35,  8.96s/it]Running generate_until requests:  15%|█▍        | 58/396 [08:50<50:40,  9.00s/it]Running generate_until requests:  15%|█▍        | 59/396 [08:59<50:32,  9.00s/it]Running generate_until requests:  15%|█▌        | 60/396 [09:07<50:02,  8.94s/it]Running generate_until requests:  15%|█▌        | 61/396 [09:16<49:46,  8.91s/it]Running generate_until requests:  16%|█▌        | 62/396 [09:25<49:27,  8.88s/it]Running generate_until requests:  16%|█▌        | 63/396 [09:34<49:31,  8.92s/it]Running generate_until requests:  16%|█▌        | 64/396 [09:43<49:18,  8.91s/it]Running generate_until requests:  16%|█▋        | 65/396 [09:52<49:08,  8.91s/it]Running generate_until requests:  17%|█▋        | 66/396 [10:02<51:36,  9.38s/it]Running generate_until requests:  17%|█▋        | 67/396 [10:11<50:40,  9.24s/it]Running generate_until requests:  17%|█▋        | 68/396 [10:20<50:06,  9.17s/it]Running generate_until requests:  17%|█▋        | 69/396 [10:29<49:28,  9.08s/it]Running generate_until requests:  18%|█▊        | 70/396 [10:38<49:02,  9.03s/it]Running generate_until requests:  18%|█▊        | 71/396 [10:47<48:46,  9.00s/it]Running generate_until requests:  18%|█▊        | 72/396 [10:56<48:39,  9.01s/it]Running generate_until requests:  18%|█▊        | 73/396 [11:05<48:08,  8.94s/it]Running generate_until requests:  19%|█▊        | 74/396 [11:14<47:50,  8.92s/it]Running generate_until requests:  19%|█▉        | 75/396 [11:23<47:44,  8.92s/it]Running generate_until requests:  19%|█▉        | 76/396 [11:31<47:19,  8.87s/it]Running generate_until requests:  19%|█▉        | 77/396 [11:40<47:06,  8.86s/it]Running generate_until requests:  20%|█▉        | 78/396 [11:49<46:57,  8.86s/it]Running generate_until requests:  20%|█▉        | 79/396 [11:58<47:01,  8.90s/it]Running generate_until requests:  20%|██        | 80/396 [12:07<46:39,  8.86s/it]Running generate_until requests:  20%|██        | 81/396 [12:16<46:42,  8.90s/it]Running generate_until requests:  21%|██        | 82/396 [12:25<46:30,  8.89s/it]Running generate_until requests:  21%|██        | 83/396 [12:33<46:06,  8.84s/it]Running generate_until requests:  21%|██        | 84/396 [12:42<45:59,  8.84s/it]Running generate_until requests:  21%|██▏       | 85/396 [12:51<45:43,  8.82s/it]Running generate_until requests:  22%|██▏       | 86/396 [13:00<45:36,  8.83s/it]Running generate_until requests:  22%|██▏       | 87/396 [13:09<45:36,  8.86s/it]Running generate_until requests:  22%|██▏       | 88/396 [13:17<45:23,  8.84s/it]Running generate_until requests:  22%|██▏       | 89/396 [13:26<45:08,  8.82s/it]Running generate_until requests:  23%|██▎       | 90/396 [13:35<45:08,  8.85s/it]Running generate_until requests:  23%|██▎       | 91/396 [13:44<45:05,  8.87s/it]Running generate_until requests:  23%|██▎       | 92/396 [13:53<45:28,  8.98s/it]Running generate_until requests:  23%|██▎       | 93/396 [14:04<48:31,  9.61s/it]Running generate_until requests:  24%|██▎       | 94/396 [14:16<50:46, 10.09s/it]Running generate_until requests:  24%|██▍       | 95/396 [14:27<52:20, 10.43s/it]Running generate_until requests:  24%|██▍       | 96/396 [14:38<53:06, 10.62s/it]Running generate_until requests:  24%|██▍       | 97/396 [14:49<54:03, 10.85s/it]Running generate_until requests:  25%|██▍       | 98/396 [14:58<51:18, 10.33s/it]Running generate_until requests:  25%|██▌       | 99/396 [15:07<49:03,  9.91s/it]Running generate_until requests:  25%|██▌       | 100/396 [15:16<47:22,  9.60s/it]Running generate_until requests:  26%|██▌       | 101/396 [15:25<46:05,  9.38s/it]Running generate_until requests:  26%|██▌       | 102/396 [15:34<45:05,  9.20s/it]Running generate_until requests:  26%|██▌       | 103/396 [15:43<44:42,  9.16s/it]Running generate_until requests:  26%|██▋       | 104/396 [15:52<44:24,  9.13s/it]Running generate_until requests:  27%|██▋       | 105/396 [16:01<44:11,  9.11s/it]Running generate_until requests:  27%|██▋       | 106/396 [16:10<43:56,  9.09s/it]Running generate_until requests:  27%|██▋       | 107/396 [16:19<43:20,  9.00s/it]Running generate_until requests:  27%|██▋       | 108/396 [16:28<43:00,  8.96s/it]Running generate_until requests:  28%|██▊       | 109/396 [16:37<42:37,  8.91s/it]Running generate_until requests:  28%|██▊       | 110/396 [16:45<42:28,  8.91s/it]Running generate_until requests:  28%|██▊       | 111/396 [16:54<42:29,  8.95s/it]Running generate_until requests:  28%|██▊       | 112/396 [17:03<42:12,  8.92s/it]Running generate_until requests:  29%|██▊       | 113/396 [17:12<41:58,  8.90s/it]Running generate_until requests:  29%|██▉       | 114/396 [17:21<42:00,  8.94s/it]Running generate_until requests:  29%|██▉       | 115/396 [17:30<41:51,  8.94s/it]Running generate_until requests:  29%|██▉       | 116/396 [17:39<41:30,  8.89s/it]Running generate_until requests:  30%|██▉       | 117/396 [17:48<41:13,  8.87s/it]Running generate_until requests:  30%|██▉       | 118/396 [17:57<41:11,  8.89s/it]Running generate_until requests:  30%|███       | 119/396 [18:08<44:00,  9.53s/it]Running generate_until requests:  30%|███       | 120/396 [18:19<45:57,  9.99s/it]Running generate_until requests:  31%|███       | 121/396 [18:30<47:13, 10.30s/it]Running generate_until requests:  31%|███       | 122/396 [18:41<48:09, 10.55s/it]Running generate_until requests:  31%|███       | 123/396 [18:52<48:53, 10.74s/it]Running generate_until requests:  31%|███▏      | 124/396 [19:03<49:11, 10.85s/it]Running generate_until requests:  32%|███▏      | 125/396 [19:14<49:17, 10.91s/it]Running generate_until requests:  32%|███▏      | 126/396 [19:25<49:18, 10.96s/it]Running generate_until requests:  32%|███▏      | 127/396 [19:36<49:11, 10.97s/it]Running generate_until requests:  32%|███▏      | 128/396 [19:47<49:11, 11.01s/it]Running generate_until requests:  33%|███▎      | 129/396 [20:00<50:46, 11.41s/it]Running generate_until requests:  33%|███▎      | 130/396 [20:11<50:27, 11.38s/it]Running generate_until requests:  33%|███▎      | 131/396 [20:22<50:00, 11.32s/it]Running generate_until requests:  33%|███▎      | 132/396 [20:34<49:42, 11.30s/it]Running generate_until requests:  34%|███▎      | 133/396 [20:45<49:06, 11.20s/it]Running generate_until requests:  34%|███▍      | 134/396 [20:56<48:53, 11.20s/it]Running generate_until requests:  34%|███▍      | 135/396 [21:07<48:30, 11.15s/it]Running generate_until requests:  34%|███▍      | 136/396 [21:18<48:07, 11.10s/it]Running generate_until requests:  35%|███▍      | 137/396 [21:29<47:45, 11.07s/it]Running generate_until requests:  35%|███▍      | 138/396 [21:40<47:26, 11.03s/it]Running generate_until requests:  35%|███▌      | 139/396 [21:51<47:18, 11.04s/it]Running generate_until requests:  35%|███▌      | 140/396 [22:02<47:06, 11.04s/it]Running generate_until requests:  36%|███▌      | 141/396 [22:13<46:57, 11.05s/it]Running generate_until requests:  36%|███▌      | 142/396 [22:24<46:41, 11.03s/it]Running generate_until requests:  36%|███▌      | 143/396 [22:35<46:23, 11.00s/it]Running generate_until requests:  36%|███▋      | 144/396 [22:46<46:10, 11.00s/it]Running generate_until requests:  37%|███▋      | 145/396 [22:57<46:09, 11.03s/it]Running generate_until requests:  37%|███▋      | 146/396 [23:08<45:59, 11.04s/it]Running generate_until requests:  37%|███▋      | 147/396 [23:19<45:42, 11.01s/it]Running generate_until requests:  37%|███▋      | 148/396 [23:30<45:34, 11.03s/it]Running generate_until requests:  38%|███▊      | 149/396 [23:41<45:19, 11.01s/it]Running generate_until requests:  38%|███▊      | 150/396 [23:52<45:17, 11.05s/it]Running generate_until requests:  38%|███▊      | 151/396 [24:03<45:04, 11.04s/it]Running generate_until requests:  38%|███▊      | 152/396 [24:14<44:55, 11.05s/it]Running generate_until requests:  39%|███▊      | 153/396 [24:25<44:39, 11.03s/it]Running generate_until requests:  39%|███▉      | 154/396 [24:36<44:22, 11.00s/it]Running generate_until requests:  39%|███▉      | 155/396 [24:47<44:06, 10.98s/it]Running generate_until requests:  39%|███▉      | 156/396 [24:58<44:01, 11.01s/it]Running generate_until requests:  40%|███▉      | 157/396 [25:09<44:06, 11.07s/it]Running generate_until requests:  40%|███▉      | 158/396 [25:20<43:51, 11.06s/it]Running generate_until requests:  40%|████      | 159/396 [25:31<43:34, 11.03s/it]Running generate_until requests:  40%|████      | 160/396 [25:42<43:15, 11.00s/it]Running generate_until requests:  41%|████      | 161/396 [25:53<43:03, 10.99s/it]Running generate_until requests:  41%|████      | 162/396 [26:06<44:42, 11.47s/it]Running generate_until requests:  41%|████      | 163/396 [26:17<44:11, 11.38s/it]Running generate_until requests:  41%|████▏     | 164/396 [26:28<43:41, 11.30s/it]Running generate_until requests:  42%|████▏     | 165/396 [26:39<43:08, 11.20s/it]Running generate_until requests:  42%|████▏     | 166/396 [26:50<42:46, 11.16s/it]Running generate_until requests:  42%|████▏     | 167/396 [27:01<42:36, 11.16s/it]Running generate_until requests:  42%|████▏     | 168/396 [27:12<42:18, 11.13s/it]Running generate_until requests:  43%|████▎     | 169/396 [27:23<41:56, 11.09s/it]Running generate_until requests:  43%|████▎     | 170/396 [27:34<41:35, 11.04s/it]Running generate_until requests:  43%|████▎     | 171/396 [27:45<41:17, 11.01s/it]Running generate_until requests:  43%|████▎     | 172/396 [27:56<41:13, 11.04s/it]Running generate_until requests:  44%|████▎     | 173/396 [28:07<40:58, 11.02s/it]Running generate_until requests:  44%|████▍     | 174/396 [28:18<40:42, 11.00s/it]Running generate_until requests:  44%|████▍     | 175/396 [28:29<40:31, 11.00s/it]Running generate_until requests:  44%|████▍     | 176/396 [28:38<37:49, 10.32s/it]Running generate_until requests:  45%|████▍     | 177/396 [28:47<35:55,  9.84s/it]Running generate_until requests:  45%|████▍     | 178/396 [28:56<34:47,  9.57s/it]Running generate_until requests:  45%|████▌     | 179/396 [29:04<33:50,  9.36s/it]Running generate_until requests:  45%|████▌     | 180/396 [29:13<33:13,  9.23s/it]Running generate_until requests:  46%|████▌     | 181/396 [29:22<32:35,  9.09s/it]Running generate_until requests:  46%|████▌     | 182/396 [29:31<32:03,  8.99s/it]Running generate_until requests:  46%|████▌     | 183/396 [29:40<31:45,  8.95s/it]Running generate_until requests:  46%|████▋     | 184/396 [29:49<31:33,  8.93s/it]Running generate_until requests:  47%|████▋     | 185/396 [29:58<31:22,  8.92s/it]Running generate_until requests:  47%|████▋     | 186/396 [30:06<31:04,  8.88s/it]Running generate_until requests:  47%|████▋     | 187/396 [30:15<30:49,  8.85s/it]Running generate_until requests:  47%|████▋     | 188/396 [30:24<31:00,  8.95s/it]Running generate_until requests:  48%|████▊     | 189/396 [30:33<30:38,  8.88s/it]Running generate_until requests:  48%|████▊     | 190/396 [30:42<30:31,  8.89s/it]Running generate_until requests:  48%|████▊     | 191/396 [30:51<30:28,  8.92s/it]Running generate_until requests:  48%|████▊     | 192/396 [31:01<31:21,  9.22s/it]Running generate_until requests:  49%|████▊     | 193/396 [31:10<30:43,  9.08s/it]Running generate_until requests:  49%|████▉     | 194/396 [31:18<30:13,  8.98s/it]Running generate_until requests:  49%|████▉     | 195/396 [31:27<29:59,  8.95s/it]Running generate_until requests:  49%|████▉     | 196/396 [31:36<29:41,  8.91s/it]Running generate_until requests:  50%|████▉     | 197/396 [31:45<29:29,  8.89s/it]Running generate_until requests:  50%|█████     | 198/396 [31:54<29:16,  8.87s/it]Running generate_until requests:  50%|█████     | 199/396 [32:03<29:28,  8.98s/it]Running generate_until requests:  51%|█████     | 200/396 [32:12<29:03,  8.90s/it]Running generate_until requests:  51%|█████     | 200/396 [32:20<31:42,  9.70s/it]
