Already on 'yangexp2threee'
wandb: Currently logged in as: stevenzhou0816100. Use `wandb login --relogin` to force relogin
2024-07-28:00:41:04,056 INFO     [main.py:288] Verbosity set to INFO
2024-07-28:00:41:13,454 WARNING  [main.py:303]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2024-07-28:00:41:13,456 INFO     [main.py:378] Selected Tasks: ['gsm8k_cot']
2024-07-28:00:41:13,478 INFO     [xevaluator.py:137] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2024-07-28:00:41:13,478 INFO     [xevaluator.py:184] Initializing xhf model, with arguments: {'pretrained': 'meta-llama/Meta-Llama-3-8B-Instruct', 'griffin': True, 'check': False, 'contextlength': 1500, 'kernel_size': 16, 'thr': 0.05}
2024-07-28:00:41:13,486 INFO     [xhuggingface.py:168] Using device 'cuda'
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:06<00:18,  6.17s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:15<00:15,  7.78s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:20<00:06,  6.93s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:22<00:00,  4.80s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:22<00:00,  5.63s/it]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
2024-07-28:00:42:16,804 WARNING  [task.py:322] [Task: gsm8k_cot] has_training_docs and has_validation_docs are False, using test_docs as fewshot_docs but this is not recommended.
2024-07-28:00:42:16,804 WARNING  [task.py:322] [Task: gsm8k_cot] has_training_docs and has_validation_docs are False, using test_docs as fewshot_docs but this is not recommended.
2024-07-28:00:42:16,888 INFO     [task.py:395] Building contexts for gsm8k_cot on rank 0...
  0%|          | 0/396 [00:00<?, ?it/s] 42%|████▏     | 168/396 [00:00<00:00, 1672.27it/s] 85%|████████▍ | 336/396 [00:00<00:00, 1663.26it/s]100%|██████████| 396/396 [00:00<00:00, 1660.06it/s]
2024-07-28:00:42:17,136 INFO     [xevaluator.py:395] Running generate_until requests
Running generate_until requests:   0%|          | 0/396 [00:00<?, ?it/s]Running generate_until requests:   0%|          | 1/396 [00:12<1:22:42, 12.56s/it]Running generate_until requests:   1%|          | 2/396 [00:22<1:14:02, 11.27s/it]Running generate_until requests:   1%|          | 3/396 [00:33<1:11:20, 10.89s/it]Running generate_until requests:   1%|          | 4/396 [00:44<1:10:34, 10.80s/it]Running generate_until requests:   1%|▏         | 5/396 [00:54<1:09:21, 10.64s/it]Running generate_until requests:   2%|▏         | 6/396 [01:05<1:10:06, 10.79s/it]Running generate_until requests:   2%|▏         | 7/396 [01:15<1:09:17, 10.69s/it]Running generate_until requests:   2%|▏         | 8/396 [01:26<1:08:36, 10.61s/it]Running generate_until requests:   2%|▏         | 9/396 [01:37<1:08:32, 10.63s/it]Running generate_until requests:   3%|▎         | 10/396 [01:47<1:07:56, 10.56s/it]Running generate_until requests:   3%|▎         | 11/396 [01:57<1:07:17, 10.49s/it]Running generate_until requests:   3%|▎         | 12/396 [02:08<1:06:46, 10.43s/it]Running generate_until requests:   3%|▎         | 13/396 [02:18<1:07:26, 10.56s/it]Running generate_until requests:   4%|▎         | 14/396 [02:29<1:07:38, 10.62s/it]Running generate_until requests:   4%|▍         | 15/396 [02:40<1:06:57, 10.55s/it]Running generate_until requests:   4%|▍         | 16/396 [02:50<1:06:24, 10.48s/it]Running generate_until requests:   4%|▍         | 17/396 [03:01<1:06:28, 10.52s/it]Running generate_until requests:   5%|▍         | 18/396 [03:11<1:06:59, 10.63s/it]Running generate_until requests:   5%|▍         | 19/396 [03:22<1:06:13, 10.54s/it]Running generate_until requests:   5%|▌         | 20/396 [03:32<1:05:48, 10.50s/it]Running generate_until requests:   5%|▌         | 21/396 [03:43<1:05:48, 10.53s/it]Running generate_until requests:   6%|▌         | 22/396 [03:53<1:05:11, 10.46s/it]Running generate_until requests:   6%|▌         | 23/396 [04:04<1:05:40, 10.56s/it]Running generate_until requests:   6%|▌         | 24/396 [04:16<1:07:45, 10.93s/it]Running generate_until requests:   6%|▋         | 25/396 [04:26<1:06:24, 10.74s/it]Running generate_until requests:   7%|▋         | 26/396 [04:37<1:06:18, 10.75s/it]Running generate_until requests:   7%|▋         | 27/396 [04:47<1:05:14, 10.61s/it]Running generate_until requests:   7%|▋         | 28/396 [04:58<1:05:00, 10.60s/it]Running generate_until requests:   7%|▋         | 29/396 [05:08<1:05:20, 10.68s/it]Running generate_until requests:   8%|▊         | 30/396 [05:19<1:04:29, 10.57s/it]Running generate_until requests:   8%|▊         | 31/396 [05:29<1:04:11, 10.55s/it]Running generate_until requests:   8%|▊         | 32/396 [05:40<1:03:34, 10.48s/it]Running generate_until requests:   8%|▊         | 33/396 [05:50<1:03:47, 10.54s/it]Running generate_until requests:   9%|▊         | 34/396 [06:01<1:03:06, 10.46s/it]Running generate_until requests:   9%|▉         | 35/396 [06:11<1:03:16, 10.52s/it]Running generate_until requests:   9%|▉         | 36/396 [06:21<1:02:43, 10.45s/it]Running generate_until requests:   9%|▉         | 37/396 [06:32<1:02:56, 10.52s/it]Running generate_until requests:  10%|▉         | 38/396 [06:43<1:02:55, 10.54s/it]Running generate_until requests:  10%|▉         | 39/396 [06:53<1:02:47, 10.55s/it]Running generate_until requests:  10%|█         | 40/396 [07:04<1:02:19, 10.50s/it]Running generate_until requests:  10%|█         | 41/396 [07:14<1:01:45, 10.44s/it]Running generate_until requests:  11%|█         | 42/396 [07:23<59:52, 10.15s/it]  Running generate_until requests:  11%|█         | 43/396 [07:32<56:24,  9.59s/it]Running generate_until requests:  11%|█         | 44/396 [07:40<54:19,  9.26s/it]Running generate_until requests:  11%|█▏        | 45/396 [07:49<52:29,  8.97s/it]Running generate_until requests:  12%|█▏        | 46/396 [07:57<51:24,  8.81s/it]Running generate_until requests:  12%|█▏        | 47/396 [08:06<50:43,  8.72s/it]Running generate_until requests:  12%|█▏        | 48/396 [08:14<50:24,  8.69s/it]Running generate_until requests:  12%|█▏        | 49/396 [08:22<49:35,  8.58s/it]Running generate_until requests:  13%|█▎        | 50/396 [08:31<49:16,  8.54s/it]Running generate_until requests:  13%|█▎        | 51/396 [08:39<48:41,  8.47s/it]Running generate_until requests:  13%|█▎        | 52/396 [08:48<48:26,  8.45s/it]Running generate_until requests:  13%|█▎        | 53/396 [08:56<48:56,  8.56s/it]Running generate_until requests:  14%|█▎        | 54/396 [09:05<48:34,  8.52s/it]Running generate_until requests:  14%|█▍        | 55/396 [09:15<51:15,  9.02s/it]Running generate_until requests:  14%|█▍        | 56/396 [09:23<49:58,  8.82s/it]Running generate_until requests:  14%|█▍        | 57/396 [09:32<49:40,  8.79s/it]Running generate_until requests:  15%|█▍        | 58/396 [09:41<48:52,  8.68s/it]Running generate_until requests:  15%|█▍        | 59/396 [09:49<47:54,  8.53s/it]Running generate_until requests:  15%|█▌        | 60/396 [09:57<47:12,  8.43s/it]Running generate_until requests:  15%|█▌        | 61/396 [10:07<49:46,  8.91s/it]Running generate_until requests:  16%|█▌        | 62/396 [10:15<48:39,  8.74s/it]Running generate_until requests:  16%|█▌        | 63/396 [10:24<47:50,  8.62s/it]Running generate_until requests:  16%|█▌        | 64/396 [10:32<46:57,  8.49s/it]Running generate_until requests:  16%|█▋        | 65/396 [10:40<46:18,  8.39s/it]Running generate_until requests:  17%|█▋        | 66/396 [10:48<45:59,  8.36s/it]Running generate_until requests:  17%|█▋        | 67/396 [10:57<45:44,  8.34s/it]Running generate_until requests:  17%|█▋        | 68/396 [11:05<45:23,  8.30s/it]Running generate_until requests:  17%|█▋        | 69/396 [11:13<45:30,  8.35s/it]Running generate_until requests:  18%|█▊        | 70/396 [11:22<45:24,  8.36s/it]Running generate_until requests:  18%|█▊        | 71/396 [11:30<45:40,  8.43s/it]Running generate_until requests:  18%|█▊        | 72/396 [11:39<45:40,  8.46s/it]Running generate_until requests:  18%|█▊        | 73/396 [11:47<45:07,  8.38s/it]Running generate_until requests:  19%|█▊        | 74/396 [11:55<45:09,  8.41s/it]Running generate_until requests:  19%|█▉        | 75/396 [12:04<44:51,  8.38s/it]Running generate_until requests:  19%|█▉        | 76/396 [12:12<44:55,  8.42s/it]Running generate_until requests:  19%|█▉        | 77/396 [12:21<44:45,  8.42s/it]Running generate_until requests:  20%|█▉        | 78/396 [12:29<44:29,  8.40s/it]Running generate_until requests:  20%|█▉        | 79/396 [12:37<44:17,  8.38s/it]Running generate_until requests:  20%|██        | 80/396 [12:46<43:53,  8.33s/it]Running generate_until requests:  20%|██        | 81/396 [12:54<44:09,  8.41s/it]Running generate_until requests:  21%|██        | 82/396 [13:03<44:10,  8.44s/it]Running generate_until requests:  21%|██        | 83/396 [13:11<43:45,  8.39s/it]Running generate_until requests:  21%|██        | 84/396 [13:19<43:28,  8.36s/it]Running generate_until requests:  21%|██▏       | 85/396 [13:27<43:04,  8.31s/it]Running generate_until requests:  22%|██▏       | 86/396 [13:36<42:49,  8.29s/it]Running generate_until requests:  22%|██▏       | 87/396 [13:44<42:57,  8.34s/it]Running generate_until requests:  22%|██▏       | 88/396 [13:52<42:39,  8.31s/it]Running generate_until requests:  22%|██▏       | 89/396 [14:01<42:33,  8.32s/it]Running generate_until requests:  23%|██▎       | 90/396 [14:11<45:58,  9.01s/it]Running generate_until requests:  23%|██▎       | 91/396 [14:20<44:38,  8.78s/it]Running generate_until requests:  23%|██▎       | 92/396 [14:28<44:04,  8.70s/it]Running generate_until requests:  23%|██▎       | 93/396 [14:36<43:23,  8.59s/it]Running generate_until requests:  24%|██▎       | 94/396 [14:45<42:55,  8.53s/it]Running generate_until requests:  24%|██▍       | 95/396 [14:53<42:50,  8.54s/it]Running generate_until requests:  24%|██▍       | 96/396 [15:04<45:57,  9.19s/it]Running generate_until requests:  24%|██▍       | 97/396 [15:13<45:01,  9.03s/it]Running generate_until requests:  25%|██▍       | 98/396 [15:21<43:55,  8.85s/it]Running generate_until requests:  25%|██▌       | 99/396 [15:30<43:04,  8.70s/it]Running generate_until requests:  25%|██▌       | 100/396 [15:38<42:10,  8.55s/it]Running generate_until requests:  26%|██▌       | 101/396 [15:46<41:30,  8.44s/it]Running generate_until requests:  26%|██▌       | 102/396 [15:54<41:02,  8.38s/it]Running generate_until requests:  26%|██▌       | 103/396 [16:03<41:30,  8.50s/it]Running generate_until requests:  26%|██▋       | 104/396 [16:12<41:33,  8.54s/it]Running generate_until requests:  27%|██▋       | 105/396 [16:20<41:14,  8.50s/it]Running generate_until requests:  27%|██▋       | 106/396 [16:28<40:47,  8.44s/it]Running generate_until requests:  27%|██▋       | 107/396 [16:36<40:15,  8.36s/it]Running generate_until requests:  27%|██▋       | 108/396 [16:45<39:53,  8.31s/it]Running generate_until requests:  28%|██▊       | 109/396 [16:53<39:54,  8.34s/it]Running generate_until requests:  28%|██▊       | 110/396 [17:02<40:07,  8.42s/it]Running generate_until requests:  28%|██▊       | 111/396 [17:10<39:43,  8.36s/it]Running generate_until requests:  28%|██▊       | 112/396 [17:18<39:29,  8.34s/it]Running generate_until requests:  29%|██▊       | 113/396 [17:26<39:17,  8.33s/it]Running generate_until requests:  29%|██▉       | 114/396 [17:35<39:20,  8.37s/it]Running generate_until requests:  29%|██▉       | 115/396 [17:43<38:54,  8.31s/it]