Already on 'yangexppp'
wandb: Currently logged in as: stevenzhou0816100. Use `wandb login --relogin` to force relogin
2024-08-03:08:40:40,594 INFO     [main.py:288] Verbosity set to INFO
2024-08-03:08:40:50,610 INFO     [main.py:378] Selected Tasks: ['gsm8k_cot']
2024-08-03:08:40:50,645 INFO     [xevaluator.py:137] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2024-08-03:08:40:50,645 INFO     [xevaluator.py:184] Initializing xhf model, with arguments: {'pretrained': 'meta-llama/Meta-Llama-3-70B-Instruct', 'griffin': True, 'check': False, 'contextlength': 1500, 'kernel_size': 16, 'thr': 0.05}
2024-08-03:08:40:50,654 INFO     [xhuggingface.py:176] Using device 'cuda'
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:05<02:39,  5.52s/it]Loading checkpoint shards:   7%|▋         | 2/30 [00:11<02:35,  5.55s/it]Loading checkpoint shards:  10%|█         | 3/30 [00:16<02:33,  5.67s/it]Loading checkpoint shards:  13%|█▎        | 4/30 [00:22<02:29,  5.74s/it]Loading checkpoint shards:  17%|█▋        | 5/30 [00:28<02:22,  5.69s/it]Loading checkpoint shards:  20%|██        | 6/30 [00:33<02:14,  5.58s/it]Loading checkpoint shards:  23%|██▎       | 7/30 [00:39<02:06,  5.51s/it]Loading checkpoint shards:  27%|██▋       | 8/30 [00:44<02:03,  5.63s/it]Loading checkpoint shards:  30%|███       | 9/30 [00:50<01:59,  5.69s/it]Loading checkpoint shards:  33%|███▎      | 10/30 [00:56<01:52,  5.65s/it]Loading checkpoint shards:  37%|███▋      | 11/30 [01:01<01:46,  5.62s/it]Loading checkpoint shards:  40%|████      | 12/30 [01:07<01:40,  5.61s/it]Loading checkpoint shards:  43%|████▎     | 13/30 [01:13<01:37,  5.76s/it]Loading checkpoint shards:  47%|████▋     | 14/30 [01:19<01:32,  5.80s/it]Loading checkpoint shards:  50%|█████     | 15/30 [01:24<01:24,  5.64s/it]Loading checkpoint shards:  53%|█████▎    | 16/30 [01:30<01:17,  5.52s/it]Loading checkpoint shards:  57%|█████▋    | 17/30 [01:35<01:10,  5.42s/it]Loading checkpoint shards:  60%|██████    | 18/30 [01:40<01:05,  5.49s/it]Loading checkpoint shards:  63%|██████▎   | 19/30 [01:46<01:00,  5.53s/it]Loading checkpoint shards:  67%|██████▋   | 20/30 [01:51<00:54,  5.47s/it]Loading checkpoint shards:  70%|███████   | 21/30 [01:57<00:48,  5.39s/it]Loading checkpoint shards:  73%|███████▎  | 22/30 [02:02<00:42,  5.33s/it]Loading checkpoint shards:  77%|███████▋  | 23/30 [02:07<00:37,  5.39s/it]Loading checkpoint shards:  80%|████████  | 24/30 [02:13<00:32,  5.44s/it]Loading checkpoint shards:  83%|████████▎ | 25/30 [02:18<00:26,  5.39s/it]Loading checkpoint shards:  87%|████████▋ | 26/30 [02:23<00:21,  5.34s/it]Loading checkpoint shards:  90%|█████████ | 27/30 [02:28<00:15,  5.30s/it]Loading checkpoint shards:  93%|█████████▎| 28/30 [02:34<00:10,  5.37s/it]Loading checkpoint shards:  97%|█████████▋| 29/30 [02:40<00:05,  5.41s/it]Loading checkpoint shards: 100%|██████████| 30/30 [02:42<00:00,  4.54s/it]Loading checkpoint shards: 100%|██████████| 30/30 [02:42<00:00,  5.42s/it]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
2024-08-03:08:50:03,052 WARNING  [task.py:322] [Task: gsm8k_cot] has_training_docs and has_validation_docs are False, using test_docs as fewshot_docs but this is not recommended.
2024-08-03:08:50:03,054 WARNING  [task.py:322] [Task: gsm8k_cot] has_training_docs and has_validation_docs are False, using test_docs as fewshot_docs but this is not recommended.
2024-08-03:08:50:03,130 INFO     [task.py:395] Building contexts for gsm8k_cot on rank 0...
  0%|          | 0/1319 [00:00<?, ?it/s] 13%|█▎        | 169/1319 [00:00<00:00, 1682.63it/s] 26%|██▌       | 339/1319 [00:00<00:00, 1689.38it/s] 39%|███▊      | 509/1319 [00:00<00:00, 1691.71it/s] 51%|█████▏    | 679/1319 [00:00<00:00, 1691.82it/s] 64%|██████▍   | 849/1319 [00:00<00:00, 1619.90it/s] 77%|███████▋  | 1012/1319 [00:00<00:00, 1612.26it/s] 89%|████████▉ | 1176/1319 [00:00<00:00, 1620.80it/s]100%|██████████| 1319/1319 [00:00<00:00, 1644.65it/s]
2024-08-03:08:50:03,957 INFO     [xevaluator.py:395] Running generate_until requests
Running generate_until requests:   0%|          | 0/1319 [00:00<?, ?it/s]Running generate_until requests:   0%|          | 1/1319 [00:42<15:28:16, 42.26s/it]Running generate_until requests:   0%|          | 2/1319 [01:14<13:21:22, 36.51s/it]Running generate_until requests:   0%|          | 3/1319 [01:36<10:52:45, 29.76s/it]Running generate_until requests:   0%|          | 4/1319 [02:11<11:42:03, 32.03s/it]Running generate_until requests:   0%|          | 5/1319 [03:08<14:52:08, 40.74s/it]Running generate_until requests:   0%|          | 6/1319 [03:38<13:35:28, 37.26s/it]Running generate_until requests:   1%|          | 7/1319 [04:07<12:34:35, 34.51s/it]Running generate_until requests:   1%|          | 8/1319 [04:40<12:22:56, 34.00s/it]Running generate_until requests:   1%|          | 9/1319 [04:59<10:41:28, 29.38s/it]Running generate_until requests:   1%|          | 10/1319 [05:29<10:43:26, 29.49s/it]Running generate_until requests:   1%|          | 11/1319 [05:59<10:44:33, 29.57s/it]Running generate_until requests:   1%|          | 12/1319 [06:49<13:01:56, 35.90s/it]Running generate_until requests:   1%|          | 13/1319 [07:21<12:33:24, 34.61s/it]Running generate_until requests:   1%|          | 14/1319 [07:44<11:20:53, 31.31s/it]Running generate_until requests:   1%|          | 15/1319 [08:15<11:14:18, 31.03s/it]Running generate_until requests:   1%|          | 16/1319 [08:38<10:24:42, 28.77s/it]Running generate_until requests:   1%|▏         | 17/1319 [09:21<11:55:55, 32.99s/it]Running generate_until requests:   1%|▏         | 18/1319 [10:01<12:38:31, 34.98s/it]Running generate_until requests:   1%|▏         | 19/1319 [10:26<11:33:51, 32.02s/it]Running generate_until requests:   2%|▏         | 20/1319 [11:02<12:00:53, 33.30s/it]Running generate_until requests:   2%|▏         | 21/1319 [11:32<11:41:33, 32.43s/it]Running generate_until requests:   2%|▏         | 22/1319 [11:53<10:21:06, 28.73s/it]Running generate_until requests:   2%|▏         | 23/1319 [12:18<9:59:49, 27.77s/it] Running generate_until requests:   2%|▏         | 24/1319 [12:57<11:13:22, 31.20s/it]Running generate_until requests:   2%|▏         | 25/1319 [13:26<10:58:36, 30.54s/it]Running generate_until requests:   2%|▏         | 26/1319 [13:45<9:40:34, 26.94s/it] Running generate_until requests:   2%|▏         | 27/1319 [14:03<8:41:47, 24.23s/it]Running generate_until requests:   2%|▏         | 28/1319 [14:26<8:36:06, 23.99s/it]Running generate_until requests:   2%|▏         | 29/1319 [14:47<8:13:35, 22.96s/it]Running generate_until requests:   2%|▏         | 30/1319 [15:06<7:46:36, 21.72s/it]Running generate_until requests:   2%|▏         | 31/1319 [15:18<6:49:08, 19.06s/it]Running generate_until requests:   2%|▏         | 32/1319 [15:42<7:19:11, 20.48s/it]Running generate_until requests:   3%|▎         | 33/1319 [16:13<8:26:40, 23.64s/it]Running generate_until requests:   3%|▎         | 34/1319 [16:40<8:44:26, 24.49s/it]Running generate_until requests:   3%|▎         | 35/1319 [17:08<9:09:48, 25.69s/it]Running generate_until requests:   3%|▎         | 36/1319 [17:39<9:40:33, 27.15s/it]Running generate_until requests:   3%|▎         | 37/1319 [18:11<10:09:55, 28.55s/it]Running generate_until requests:   3%|▎         | 38/1319 [18:39<10:06:14, 28.40s/it]Running generate_until requests:   3%|▎         | 39/1319 [19:16<11:05:44, 31.21s/it]Running generate_until requests:   3%|▎         | 40/1319 [19:51<11:24:39, 32.12s/it]Running generate_until requests:   3%|▎         | 41/1319 [20:33<12:32:43, 35.34s/it]Running generate_until requests:   3%|▎         | 42/1319 [20:52<10:46:24, 30.37s/it]Running generate_until requests:   3%|▎         | 43/1319 [21:26<11:04:38, 31.25s/it]Running generate_until requests:   3%|▎         | 44/1319 [21:53<10:37:15, 29.99s/it]Running generate_until requests:   3%|▎         | 45/1319 [22:13<9:34:24, 27.05s/it] Running generate_until requests:   3%|▎         | 46/1319 [22:33<8:50:53, 25.02s/it]Running generate_until requests:   4%|▎         | 47/1319 [23:06<9:42:26, 27.47s/it]Running generate_until requests:   4%|▎         | 48/1319 [23:22<8:25:07, 23.85s/it]Running generate_until requests:   4%|▎         | 49/1319 [23:55<9:22:37, 26.58s/it]Running generate_until requests:   4%|▍         | 50/1319 [24:27<9:59:14, 28.33s/it]Running generate_until requests:   4%|▍         | 51/1319 [24:43<8:37:27, 24.49s/it]Running generate_until requests:   4%|▍         | 52/1319 [24:57<7:34:56, 21.54s/it]Running generate_until requests:   4%|▍         | 53/1319 [25:31<8:49:17, 25.08s/it]Running generate_until requests:   4%|▍         | 54/1319 [25:54<8:38:49, 24.61s/it]Running generate_until requests:   4%|▍         | 55/1319 [26:13<8:05:35, 23.05s/it]Running generate_until requests:   4%|▍         | 56/1319 [26:30<7:23:13, 21.06s/it]Running generate_until requests:   4%|▍         | 57/1319 [26:47<6:56:16, 19.79s/it]Running generate_until requests:   4%|▍         | 58/1319 [27:20<8:20:09, 23.80s/it]Running generate_until requests:   4%|▍         | 59/1319 [27:39<7:48:55, 22.33s/it]Running generate_until requests:   5%|▍         | 60/1319 [28:02<7:56:59, 22.73s/it]Running generate_until requests:   5%|▍         | 61/1319 [28:35<8:55:42, 25.55s/it]Running generate_until requests:   5%|▍         | 62/1319 [29:01<9:00:12, 25.79s/it]Running generate_until requests:   5%|▍         | 63/1319 [29:39<10:18:09, 29.53s/it]Running generate_until requests:   5%|▍         | 64/1319 [30:05<9:55:51, 28.49s/it] Running generate_until requests:   5%|▍         | 65/1319 [30:39<10:31:02, 30.19s/it]Running generate_until requests:   5%|▌         | 66/1319 [31:18<11:20:39, 32.59s/it]Running generate_until requests:   5%|▌         | 67/1319 [31:36<9:50:50, 28.32s/it] Running generate_until requests:   5%|▌         | 68/1319 [31:55<8:54:36, 25.64s/it]Running generate_until requests:   5%|▌         | 69/1319 [32:32<10:00:22, 28.82s/it]Running generate_until requests:   5%|▌         | 70/1319 [33:24<12:25:24, 35.81s/it]Running generate_until requests:   5%|▌         | 71/1319 [33:56<12:02:23, 34.73s/it]Running generate_until requests:   5%|▌         | 72/1319 [34:17<10:38:33, 30.72s/it]Running generate_until requests:   6%|▌         | 73/1319 [34:31<8:53:32, 25.69s/it] Running generate_until requests:   6%|▌         | 74/1319 [34:48<7:58:29, 23.06s/it]Running generate_until requests:   6%|▌         | 75/1319 [35:13<8:09:58, 23.63s/it]Running generate_until requests:   6%|▌         | 76/1319 [35:46<9:06:35, 26.38s/it]Running generate_until requests:   6%|▌         | 77/1319 [36:08<8:41:24, 25.19s/it]Running generate_until requests:   6%|▌         | 78/1319 [36:24<7:44:30, 22.46s/it]Running generate_until requests:   6%|▌         | 79/1319 [36:46<7:39:58, 22.26s/it]Running generate_until requests:   6%|▌         | 80/1319 [37:09<7:45:35, 22.55s/it]Running generate_until requests:   6%|▌         | 81/1319 [37:39<8:30:15, 24.73s/it]Running generate_until requests:   6%|▌         | 82/1319 [38:10<9:08:07, 26.59s/it]Running generate_until requests:   6%|▋         | 83/1319 [38:57<11:13:47, 32.71s/it]Running generate_until requests:   6%|▋         | 84/1319 [39:21<10:20:56, 30.17s/it]Running generate_until requests:   6%|▋         | 85/1319 [40:01<11:16:55, 32.91s/it]Running generate_until requests:   7%|▋         | 86/1319 [40:29<10:47:50, 31.53s/it]Running generate_until requests:   7%|▋         | 87/1319 [40:53<10:01:19, 29.28s/it]Running generate_until requests:   7%|▋         | 88/1319 [41:12<8:58:40, 26.26s/it] Running generate_until requests:   7%|▋         | 89/1319 [41:44<9:29:37, 27.79s/it]Running generate_until requests:   7%|▋         | 90/1319 [42:06<8:58:03, 26.27s/it]Running generate_until requests:   7%|▋         | 91/1319 [42:36<9:20:49, 27.40s/it]Running generate_until requests:   7%|▋         | 92/1319 [43:10<9:58:44, 29.28s/it]Running generate_until requests:   7%|▋         | 93/1319 [43:43<10:23:39, 30.52s/it]Running generate_until requests:   7%|▋         | 94/1319 [44:03<9:16:01, 27.23s/it] Running generate_until requests:   7%|▋         | 95/1319 [44:42<10:24:40, 30.62s/it]Running generate_until requests:   7%|▋         | 96/1319 [45:01<9:13:03, 27.13s/it] Running generate_until requests:   7%|▋         | 97/1319 [45:34<9:48:51, 28.91s/it]Running generate_until requests:   7%|▋         | 98/1319 [46:03<9:50:06, 29.00s/it]Running generate_until requests:   8%|▊         | 99/1319 [46:25<9:05:28, 26.83s/it]Running generate_until requests:   8%|▊         | 100/1319 [46:58<9:45:21, 28.81s/it]Running generate_until requests:   8%|▊         | 101/1319 [47:32<10:15:55, 30.34s/it]Running generate_until requests:   8%|▊         | 102/1319 [48:00<10:02:47, 29.72s/it]Running generate_until requests:   8%|▊         | 103/1319 [48:24<9:25:06, 27.88s/it] Running generate_until requests:   8%|▊         | 104/1319 [48:51<9:21:48, 27.74s/it]Running generate_until requests:   8%|▊         | 105/1319 [49:29<10:24:50, 30.88s/it]Running generate_until requests:   8%|▊         | 106/1319 [49:54<9:47:27, 29.06s/it] Running generate_until requests:   8%|▊         | 107/1319 [50:14<8:53:42, 26.42s/it]Running generate_until requests:   8%|▊         | 108/1319 [50:41<8:56:55, 26.60s/it]Running generate_until requests:   8%|▊         | 109/1319 [51:10<9:09:23, 27.24s/it]Running generate_until requests:   8%|▊         | 110/1319 [51:51<10:28:12, 31.18s/it]Running generate_until requests:   8%|▊         | 111/1319 [52:10<9:17:47, 27.70s/it] Running generate_until requests:   8%|▊         | 112/1319 [52:31<8:38:43, 25.79s/it]Running generate_until requests:   9%|▊         | 113/1319 [52:56<8:28:34, 25.30s/it]Running generate_until requests:   9%|▊         | 114/1319 [53:28<9:11:39, 27.47s/it]Running generate_until requests:   9%|▊         | 115/1319 [53:54<9:00:29, 26.94s/it]Running generate_until requests:   9%|▉         | 116/1319 [54:11<8:02:04, 24.04s/it]Running generate_until requests:   9%|▉         | 117/1319 [54:39<8:26:38, 25.29s/it]Running generate_until requests:   9%|▉         | 118/1319 [54:56<7:36:53, 22.83s/it]Running generate_until requests:   9%|▉         | 119/1319 [55:26<8:17:02, 24.85s/it]Running generate_until requests:   9%|▉         | 120/1319 [55:51<8:15:19, 24.79s/it]Running generate_until requests:   9%|▉         | 121/1319 [56:18<8:27:41, 25.43s/it]Running generate_until requests:   9%|▉         | 122/1319 [57:27<12:52:55, 38.74s/it]Running generate_until requests:   9%|▉         | 123/1319 [57:44<10:40:07, 32.11s/it]Running generate_until requests:   9%|▉         | 124/1319 [58:12<10:12:00, 30.73s/it]Running generate_until requests:   9%|▉         | 125/1319 [58:33<9:15:50, 27.93s/it] Running generate_until requests:  10%|▉         | 126/1319 [58:50<8:10:00, 24.64s/it]Running generate_until requests:  10%|▉         | 127/1319 [59:09<7:37:29, 23.03s/it]Running generate_until requests:  10%|▉         | 128/1319 [59:34<7:45:20, 23.44s/it]Running generate_until requests:  10%|▉         | 129/1319 [1:00:02<8:14:14, 24.92s/it]Running generate_until requests:  10%|▉         | 130/1319 [1:00:19<7:24:54, 22.45s/it]Running generate_until requests:  10%|▉         | 131/1319 [1:01:29<12:07:22, 36.74s/it]Running generate_until requests:  10%|█         | 132/1319 [1:02:06<12:07:35, 36.78s/it]Running generate_until requests:  10%|█         | 133/1319 [1:02:39<11:50:03, 35.92s/it]Running generate_until requests:  10%|█         | 134/1319 [1:02:56<9:52:06, 29.98s/it] Running generate_until requests:  10%|█         | 135/1319 [1:03:19<9:13:06, 28.03s/it]Running generate_until requests:  10%|█         | 136/1319 [1:03:41<8:35:35, 26.15s/it]Running generate_until requests:  10%|█         | 137/1319 [1:04:20<9:51:37, 30.03s/it]Running generate_until requests:  10%|█         | 138/1319 [1:04:38<8:38:47, 26.36s/it]Running generate_until requests:  11%|█         | 139/1319 [1:05:07<8:54:50, 27.20s/it]Running generate_until requests:  11%|█         | 140/1319 [1:05:40<9:31:52, 29.10s/it]Running generate_until requests:  11%|█         | 141/1319 [1:06:00<8:34:18, 26.20s/it]Running generate_until requests:  11%|█         | 142/1319 [1:06:36<9:31:13, 29.12s/it]Running generate_until requests:  11%|█         | 143/1319 [1:07:12<10:12:07, 31.23s/it]Running generate_until requests:  11%|█         | 144/1319 [1:08:02<11:59:22, 36.73s/it]Running generate_until requests:  11%|█         | 145/1319 [1:08:32<11:21:14, 34.82s/it]Running generate_until requests:  11%|█         | 146/1319 [1:09:01<10:47:50, 33.14s/it]Running generate_until requests:  11%|█         | 147/1319 [1:09:29<10:19:32, 31.72s/it]Running generate_until requests:  11%|█         | 148/1319 [1:09:51<9:20:08, 28.70s/it] 