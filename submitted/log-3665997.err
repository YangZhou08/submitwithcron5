Already on 'yangexppp'
wandb: Currently logged in as: stevenzhou0816100. Use `wandb login --relogin` to force relogin
2024-08-04:17:07:02,936 INFO     [main.py:288] Verbosity set to INFO
2024-08-04:17:07:13,617 INFO     [main.py:378] Selected Tasks: ['gsm8k_cot']
2024-08-04:17:07:13,652 INFO     [xevaluator.py:137] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2024-08-04:17:07:13,652 INFO     [xevaluator.py:184] Initializing xhf model, with arguments: {'pretrained': 'meta-llama/Meta-Llama-3-8B-Instruct', 'griffin': True, 'check': True, 'contextlength': 1500, 'kernel_size': 16, 'thr': 0.05}
2024-08-04:17:07:13,662 INFO     [xhuggingface.py:176] Using device 'cuda'
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:06<00:18,  6.11s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:12<00:12,  6.16s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:18<00:06,  6.20s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:20<00:00,  4.39s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:20<00:00,  5.04s/it]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
2024-08-04:17:08:18,458 WARNING  [task.py:322] [Task: gsm8k_cot] has_training_docs and has_validation_docs are False, using test_docs as fewshot_docs but this is not recommended.
2024-08-04:17:08:18,458 WARNING  [task.py:322] [Task: gsm8k_cot] has_training_docs and has_validation_docs are False, using test_docs as fewshot_docs but this is not recommended.
2024-08-04:17:08:18,554 INFO     [task.py:395] Building contexts for gsm8k_cot on rank 0...
  0%|          | 0/1319 [00:00<?, ?it/s] 13%|█▎        | 165/1319 [00:00<00:00, 1641.93it/s] 25%|██▌       | 334/1319 [00:00<00:00, 1668.94it/s] 38%|███▊      | 503/1319 [00:00<00:00, 1674.93it/s] 51%|█████     | 672/1319 [00:00<00:00, 1680.02it/s] 64%|██████▍   | 842/1319 [00:00<00:00, 1684.16it/s] 77%|███████▋  | 1011/1319 [00:00<00:00, 1685.74it/s] 90%|████████▉ | 1181/1319 [00:00<00:00, 1687.72it/s]100%|██████████| 1319/1319 [00:00<00:00, 1683.13it/s]
2024-08-04:17:08:19,368 INFO     [xevaluator.py:395] Running generate_until requests
Running generate_until requests:   0%|          | 0/1319 [00:00<?, ?it/s]Running generate_until requests:   0%|          | 1/1319 [00:34<12:28:21, 34.07s/it]Running generate_until requests:   0%|          | 2/1319 [00:54<9:35:27, 26.22s/it] Running generate_until requests:   0%|          | 3/1319 [01:17<9:02:36, 24.74s/it]Running generate_until requests:   0%|          | 4/1319 [01:41<8:57:47, 24.54s/it]Running generate_until requests:   0%|          | 5/1319 [02:29<12:01:18, 32.94s/it]Running generate_until requests:   0%|          | 6/1319 [02:54<11:02:03, 30.25s/it]Running generate_until requests:   1%|          | 7/1319 [03:17<10:04:02, 27.62s/it]Running generate_until requests:   1%|          | 8/1319 [03:39<9:26:52, 25.94s/it] Running generate_until requests:   1%|          | 9/1319 [03:59<8:44:11, 24.01s/it]Running generate_until requests:   1%|          | 10/1319 [04:24<8:55:26, 24.54s/it]Running generate_until requests:   1%|          | 11/1319 [04:47<8:42:54, 23.99s/it]Running generate_until requests:   1%|          | 12/1319 [05:16<9:15:42, 25.51s/it]Running generate_until requests:   1%|          | 13/1319 [05:32<8:08:28, 22.44s/it]Running generate_until requests:   1%|          | 14/1319 [05:50<7:42:43, 21.27s/it]Running generate_until requests:   1%|          | 15/1319 [06:20<8:41:31, 24.00s/it]Running generate_until requests:   1%|          | 16/1319 [06:41<8:18:08, 22.94s/it]Running generate_until requests:   1%|▏         | 17/1319 [07:06<8:29:05, 23.46s/it]Running generate_until requests:   1%|▏         | 18/1319 [07:33<8:56:31, 24.74s/it]Running generate_until requests:   1%|▏         | 19/1319 [08:07<9:54:42, 27.45s/it]Running generate_until requests:   2%|▏         | 20/1319 [08:33<9:42:16, 26.89s/it]Running generate_until requests:   2%|▏         | 21/1319 [08:52<8:55:37, 24.76s/it]Running generate_until requests:   2%|▏         | 22/1319 [09:16<8:44:28, 24.26s/it]Running generate_until requests:   2%|▏         | 23/1319 [09:32<7:53:51, 21.94s/it]Running generate_until requests:   2%|▏         | 24/1319 [10:10<9:35:07, 26.65s/it]Running generate_until requests:   2%|▏         | 25/1319 [10:32<9:03:30, 25.20s/it]Running generate_until requests:   2%|▏         | 26/1319 [10:56<9:01:24, 25.12s/it]Running generate_until requests:   2%|▏         | 27/1319 [11:09<7:39:40, 21.35s/it]Running generate_until requests:   2%|▏         | 28/1319 [11:34<8:00:28, 22.33s/it]Running generate_until requests:   2%|▏         | 29/1319 [12:01<8:34:39, 23.94s/it]Running generate_until requests:   2%|▏         | 30/1319 [12:21<8:05:21, 22.59s/it]Running generate_until requests:   2%|▏         | 31/1319 [12:34<7:02:36, 19.69s/it]Running generate_until requests:   2%|▏         | 32/1319 [13:01<7:53:55, 22.09s/it]Running generate_until requests:   3%|▎         | 33/1319 [13:40<9:42:34, 27.18s/it]Running generate_until requests:   3%|▎         | 34/1319 [14:10<9:57:25, 27.90s/it]Running generate_until requests:   3%|▎         | 35/1319 [14:43<10:28:36, 29.37s/it]Running generate_until requests:   3%|▎         | 36/1319 [15:12<10:28:57, 29.41s/it]Running generate_until requests:   3%|▎         | 37/1319 [15:35<9:48:06, 27.52s/it] Running generate_until requests:   3%|▎         | 38/1319 [16:11<10:41:40, 30.06s/it]Running generate_until requests:   3%|▎         | 39/1319 [16:41<10:36:42, 29.85s/it]Running generate_until requests:   3%|▎         | 40/1319 [17:10<10:33:15, 29.71s/it]Running generate_until requests:   3%|▎         | 41/1319 [17:46<11:12:43, 31.58s/it]Running generate_until requests:   3%|▎         | 42/1319 [17:59<9:12:35, 25.96s/it] Running generate_until requests:   3%|▎         | 43/1319 [18:24<9:03:50, 25.57s/it]Running generate_until requests:   3%|▎         | 44/1319 [19:03<10:34:14, 29.85s/it]Running generate_until requests:   3%|▎         | 45/1319 [19:16<8:42:49, 24.62s/it] Running generate_until requests:   3%|▎         | 46/1319 [19:46<9:19:53, 26.39s/it]Running generate_until requests:   4%|▎         | 47/1319 [20:05<8:28:53, 24.00s/it]Running generate_until requests:   4%|▎         | 48/1319 [20:20<7:34:38, 21.46s/it]Running generate_until requests:   4%|▎         | 49/1319 [20:54<8:52:28, 25.16s/it]Running generate_until requests:   4%|▍         | 50/1319 [21:19<8:47:34, 24.94s/it]Running generate_until requests:   4%|▍         | 51/1319 [21:31<7:27:19, 21.17s/it]Running generate_until requests:   4%|▍         | 52/1319 [21:52<7:28:06, 21.22s/it]Running generate_until requests:   4%|▍         | 53/1319 [22:11<7:09:30, 20.36s/it]Running generate_until requests:   4%|▍         | 54/1319 [22:38<7:53:42, 22.47s/it]Running generate_until requests:   4%|▍         | 55/1319 [22:44<6:11:01, 17.61s/it]Running generate_until requests:   4%|▍         | 56/1319 [23:18<7:52:20, 22.44s/it]Running generate_until requests:   4%|▍         | 57/1319 [23:33<7:07:43, 20.34s/it]Running generate_until requests:   4%|▍         | 58/1319 [24:01<7:53:05, 22.51s/it]Running generate_until requests:   4%|▍         | 59/1319 [24:20<7:28:12, 21.34s/it]Running generate_until requests:   5%|▍         | 60/1319 [24:38<7:09:34, 20.47s/it]Running generate_until requests:   5%|▍         | 61/1319 [24:56<6:56:23, 19.86s/it]Running generate_until requests:   5%|▍         | 62/1319 [25:15<6:47:06, 19.43s/it]Running generate_until requests:   5%|▍         | 63/1319 [25:52<8:40:38, 24.87s/it]Running generate_until requests:   5%|▍         | 64/1319 [26:19<8:47:32, 25.22s/it]Running generate_until requests:   5%|▍         | 65/1319 [27:02<10:38:59, 30.57s/it]Running generate_until requests:   5%|▌         | 66/1319 [27:29<10:20:44, 29.72s/it]Running generate_until requests:   5%|▌         | 67/1319 [27:48<9:10:22, 26.38s/it] Running generate_until requests:   5%|▌         | 68/1319 [28:01<7:44:10, 22.26s/it]Running generate_until requests:   5%|▌         | 69/1319 [28:31<8:36:21, 24.79s/it]Running generate_until requests:   5%|▌         | 70/1319 [29:11<10:09:53, 29.30s/it]Running generate_until requests:   5%|▌         | 71/1319 [29:30<9:02:49, 26.10s/it] Running generate_until requests:   5%|▌         | 72/1319 [29:57<9:12:00, 26.56s/it]Running generate_until requests:   6%|▌         | 73/1319 [30:13<8:02:45, 23.25s/it]Running generate_until requests:   6%|▌         | 74/1319 [30:36<8:00:26, 23.15s/it]Running generate_until requests:   6%|▌         | 75/1319 [31:06<8:41:37, 25.16s/it]Running generate_until requests:   6%|▌         | 76/1319 [31:36<9:11:12, 26.61s/it]Running generate_until requests:   6%|▌         | 77/1319 [32:08<9:48:59, 28.45s/it]Running generate_until requests:   6%|▌         | 78/1319 [32:22<8:14:44, 23.92s/it]Running generate_until requests:   6%|▌         | 79/1319 [32:41<7:48:03, 22.65s/it]Running generate_until requests:   6%|▌         | 80/1319 [33:04<7:50:03, 22.76s/it]Running generate_until requests:   6%|▌         | 81/1319 [33:24<7:31:12, 21.87s/it]Running generate_until requests:   6%|▌         | 82/1319 [33:44<7:17:12, 21.21s/it]Running generate_until requests:   6%|▋         | 83/1319 [34:12<7:56:44, 23.14s/it]Running generate_until requests:   6%|▋         | 84/1319 [34:24<6:51:55, 20.01s/it]Running generate_until requests:   6%|▋         | 85/1319 [35:01<8:34:33, 25.02s/it]Running generate_until requests:   7%|▋         | 86/1319 [35:23<8:14:06, 24.04s/it]Running generate_until requests:   7%|▋         | 87/1319 [35:50<8:35:14, 25.09s/it]Running generate_until requests:   7%|▋         | 88/1319 [36:09<7:54:17, 23.12s/it]Running generate_until requests:   7%|▋         | 89/1319 [36:33<8:02:20, 23.53s/it]Running generate_until requests:   7%|▋         | 90/1319 [36:55<7:49:14, 22.91s/it]Running generate_until requests:   7%|▋         | 91/1319 [37:20<8:01:14, 23.51s/it]Running generate_until requests:   7%|▋         | 92/1319 [37:41<7:48:59, 22.93s/it]Running generate_until requests:   7%|▋         | 93/1319 [38:03<7:40:35, 22.54s/it]Running generate_until requests:   7%|▋         | 94/1319 [38:22<7:16:44, 21.39s/it]Running generate_until requests:   7%|▋         | 95/1319 [38:46<7:36:48, 22.39s/it]Running generate_until requests:   7%|▋         | 96/1319 [39:23<9:04:53, 26.73s/it]Running generate_until requests:   7%|▋         | 97/1319 [39:48<8:51:53, 26.12s/it]Running generate_until requests:   7%|▋         | 98/1319 [40:12<8:42:22, 25.67s/it]Running generate_until requests:   8%|▊         | 99/1319 [40:34<8:17:28, 24.47s/it]Running generate_until requests:   8%|▊         | 100/1319 [41:06<9:01:11, 26.64s/it]Running generate_until requests:   8%|▊         | 101/1319 [41:37<9:30:40, 28.11s/it]Running generate_until requests:   8%|▊         | 102/1319 [42:03<9:15:22, 27.38s/it]Running generate_until requests:   8%|▊         | 103/1319 [42:32<9:27:22, 28.00s/it]Running generate_until requests:   8%|▊         | 104/1319 [43:01<9:32:17, 28.26s/it]Running generate_until requests:   8%|▊         | 105/1319 [43:32<9:46:22, 28.98s/it]Running generate_until requests:   8%|▊         | 106/1319 [43:47<8:24:01, 24.93s/it]Running generate_until requests:   8%|▊         | 107/1319 [44:09<8:02:46, 23.90s/it]Running generate_until requests:   8%|▊         | 108/1319 [44:43<9:01:44, 26.84s/it]Running generate_until requests:   8%|▊         | 109/1319 [45:04<8:28:41, 25.22s/it]Running generate_until requests:   8%|▊         | 110/1319 [45:32<8:42:44, 25.94s/it]Running generate_until requests:   8%|▊         | 111/1319 [45:44<7:20:16, 21.87s/it]Running generate_until requests:   8%|▊         | 112/1319 [46:02<6:58:39, 20.81s/it]Running generate_until requests:   9%|▊         | 113/1319 [46:22<6:51:59, 20.50s/it]Running generate_until requests:   9%|▊         | 114/1319 [46:52<7:45:46, 23.19s/it]Running generate_until requests:   9%|▊         | 115/1319 [47:11<7:23:08, 22.08s/it]Running generate_until requests:   9%|▉         | 116/1319 [47:30<7:01:29, 21.02s/it]Running generate_until requests:   9%|▉         | 117/1319 [47:54<7:22:43, 22.10s/it]Running generate_until requests:   9%|▉         | 118/1319 [48:10<6:42:30, 20.11s/it]Running generate_until requests:   9%|▉         | 119/1319 [48:38<7:27:55, 22.40s/it]Running generate_until requests:   9%|▉         | 120/1319 [49:05<7:59:06, 23.98s/it]Running generate_until requests:   9%|▉         | 121/1319 [49:27<7:45:10, 23.30s/it]Running generate_until requests:   9%|▉         | 122/1319 [50:17<10:26:52, 31.42s/it]Running generate_until requests:   9%|▉         | 123/1319 [50:36<9:09:25, 27.56s/it] Running generate_until requests:   9%|▉         | 124/1319 [50:54<8:15:03, 24.86s/it]Running generate_until requests:   9%|▉         | 125/1319 [51:13<7:37:20, 22.98s/it]Running generate_until requests:  10%|▉         | 126/1319 [51:25<6:34:13, 19.83s/it]Running generate_until requests:  10%|▉         | 127/1319 [51:47<6:45:06, 20.39s/it]Running generate_until requests:  10%|▉         | 128/1319 [52:00<5:58:57, 18.08s/it]Running generate_until requests:  10%|▉         | 129/1319 [52:29<7:02:09, 21.28s/it]Running generate_until requests:  10%|▉         | 130/1319 [52:44<6:26:41, 19.51s/it]Running generate_until requests:  10%|▉         | 131/1319 [53:09<6:56:31, 21.04s/it]Running generate_until requests:  10%|█         | 132/1319 [53:39<7:53:54, 23.95s/it]Running generate_until requests:  10%|█         | 133/1319 [54:07<8:15:03, 25.04s/it]Running generate_until requests:  10%|█         | 134/1319 [54:22<7:17:46, 22.17s/it]Running generate_until requests:  10%|█         | 135/1319 [54:38<6:37:35, 20.15s/it]Running generate_until requests:  10%|█         | 136/1319 [54:56<6:27:29, 19.65s/it]Running generate_until requests:  10%|█         | 137/1319 [55:21<6:56:39, 21.15s/it]Running generate_until requests:  10%|█         | 138/1319 [55:37<6:24:18, 19.52s/it]Running generate_until requests:  11%|█         | 139/1319 [56:01<6:54:43, 21.09s/it]Running generate_until requests:  11%|█         | 140/1319 [56:29<7:32:55, 23.05s/it]Running generate_until requests:  11%|█         | 141/1319 [56:44<6:47:28, 20.75s/it]Running generate_until requests:  11%|█         | 142/1319 [57:21<8:20:54, 25.53s/it]Running generate_until requests:  11%|█         | 143/1319 [57:52<8:49:40, 27.02s/it]Running generate_until requests:  11%|█         | 144/1319 [58:22<9:09:29, 28.06s/it]Running generate_until requests:  11%|█         | 145/1319 [58:53<9:25:31, 28.90s/it]Running generate_until requests:  11%|█         | 146/1319 [59:12<8:24:44, 25.82s/it]Running generate_until requests:  11%|█         | 147/1319 [59:33<8:00:14, 24.59s/it]Running generate_until requests:  11%|█         | 148/1319 [59:49<7:06:56, 21.88s/it]Running generate_until requests:  11%|█▏        | 149/1319 [1:00:11<7:06:11, 21.86s/it]Running generate_until requests:  11%|█▏        | 150/1319 [1:00:29<6:46:57, 20.89s/it]Running generate_until requests:  11%|█▏        | 151/1319 [1:00:51<6:52:31, 21.19s/it]Running generate_until requests:  12%|█▏        | 152/1319 [1:01:13<6:54:39, 21.32s/it]