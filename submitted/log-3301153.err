Already on 'addinggriffin'
wandb: Currently logged in as: stevenzhou0816100. Use `wandb login --relogin` to force relogin
The following values were not passed to `accelerate launch` and had defaults used instead:
		More than one GPU was found, enabling multi-GPU training.
		If this was unintended please pass in `--num_processes=1`.
	`--mixed_precision` was set to a value of `'no'`
	`--dynamo_backend` was set to a value of `'no'`
To avoid this warning pass in values for each of the problematic parameters or run `accelerate config`.
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [01:01<01:01, 61.20s/it]Loading checkpoint shards:  50%|█████     | 1/2 [01:03<01:03, 63.22s/it]Loading checkpoint shards:  50%|█████     | 1/2 [01:02<01:02, 62.86s/it]Loading checkpoint shards:  50%|█████     | 1/2 [01:02<01:02, 62.86s/it]Loading checkpoint shards:  50%|█████     | 1/2 [01:03<01:03, 63.68s/it]Loading checkpoint shards:  50%|█████     | 1/2 [01:02<01:02, 62.85s/it]Loading checkpoint shards:  50%|█████     | 1/2 [01:02<01:02, 62.85s/it]Loading checkpoint shards:  50%|█████     | 1/2 [01:02<01:02, 62.89s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:16<00:00, 33.78s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:16<00:00, 38.14s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [01:16<00:00, 34.00s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:16<00:00, 38.34s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [01:17<00:00, 34.16s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:17<00:00, 38.51s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [01:16<00:00, 33.99s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:16<00:00, 34.27s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:16<00:00, 38.32s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [01:16<00:00, 38.31s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [01:17<00:00, 34.35s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:17<00:00, 38.75s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [01:16<00:00, 34.00s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:16<00:00, 38.33s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [01:16<00:00, 34.03s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:16<00:00, 38.36s/it]
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:403: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:403: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:403: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:403: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:403: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:403: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:403: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:403: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
  3%|▎         | 1/32 [00:26<13:52, 26.85s/it]  3%|▎         | 1/32 [00:27<14:01, 27.13s/it]  3%|▎         | 1/32 [00:27<14:12, 27.52s/it]  3%|▎         | 1/32 [00:27<14:16, 27.62s/it]  3%|▎         | 1/32 [00:28<14:56, 28.91s/it]  3%|▎         | 1/32 [00:28<14:56, 28.93s/it]  3%|▎         | 1/32 [00:42<22:02, 42.66s/it]  3%|▎         | 1/32 [00:45<23:45, 46.00s/it]  6%|▋         | 2/32 [00:52<13:06, 26.20s/it]  6%|▋         | 2/32 [00:53<13:22, 26.74s/it]  6%|▋         | 2/32 [00:54<13:36, 27.21s/it]  6%|▋         | 2/32 [00:54<13:39, 27.32s/it]  6%|▋         | 2/32 [00:54<13:33, 27.11s/it]  6%|▋         | 2/32 [00:56<13:59, 27.97s/it]  9%|▉         | 3/32 [01:20<13:02, 26.99s/it]  9%|▉         | 3/32 [01:22<13:14, 27.39s/it]  9%|▉         | 3/32 [01:22<13:08, 27.18s/it]  9%|▉         | 3/32 [01:22<13:11, 27.30s/it]  9%|▉         | 3/32 [01:22<13:24, 27.75s/it]  9%|▉         | 3/32 [01:24<13:50, 28.65s/it]  6%|▋         | 2/32 [01:29<22:26, 44.89s/it]  6%|▋         | 2/32 [01:34<23:52, 47.74s/it] 12%|█▎        | 4/32 [01:49<12:42, 27.23s/it] 12%|█▎        | 4/32 [01:50<12:52, 27.59s/it] 12%|█▎        | 4/32 [01:51<13:05, 28.06s/it] 12%|█▎        | 4/32 [01:50<13:02, 27.95s/it] 12%|█▎        | 4/32 [01:52<13:32, 29.02s/it] 12%|█▎        | 4/32 [01:53<13:24, 28.75s/it] 16%|█▌        | 5/32 [02:15<12:01, 26.71s/it] 16%|█▌        | 5/32 [02:16<12:08, 26.97s/it] 16%|█▌        | 5/32 [02:17<12:14, 27.21s/it]  9%|▉         | 3/32 [02:17<22:01, 45.57s/it] 16%|█▌        | 5/32 [02:18<12:31, 27.82s/it] 16%|█▌        | 5/32 [02:19<12:28, 27.74s/it]  9%|▉         | 3/32 [02:19<22:52, 47.31s/it] 16%|█▌        | 5/32 [02:28<14:05, 31.31s/it] 19%|█▉        | 6/32 [02:40<11:20, 26.16s/it] 19%|█▉        | 6/32 [02:42<11:32, 26.65s/it] 19%|█▉        | 6/32 [02:45<11:56, 27.56s/it] 19%|█▉        | 6/32 [02:46<12:01, 27.73s/it] 19%|█▉        | 6/32 [02:46<11:52, 27.38s/it] 19%|█▉        | 6/32 [02:59<13:37, 31.43s/it] 12%|█▎        | 4/32 [03:02<21:17, 45.63s/it] 12%|█▎        | 4/32 [03:07<21:55, 46.97s/it] 22%|██▏       | 7/32 [03:06<10:48, 25.92s/it] 22%|██▏       | 7/32 [03:07<11:03, 26.55s/it] 22%|██▏       | 7/32 [03:13<11:32, 27.69s/it] 22%|██▏       | 7/32 [03:13<11:34, 27.79s/it] 22%|██▏       | 7/32 [03:14<11:32, 27.69s/it] 25%|██▌       | 8/32 [03:31<10:16, 25.69s/it] 22%|██▏       | 7/32 [03:34<13:30, 32.44s/it] 25%|██▌       | 8/32 [03:37<11:00, 27.50s/it] 25%|██▌       | 8/32 [03:40<10:58, 27.42s/it] 25%|██▌       | 8/32 [03:40<10:58, 27.45s/it] 25%|██▌       | 8/32 [03:41<10:57, 27.38s/it] 16%|█▌        | 5/32 [03:45<20:06, 44.69s/it] 16%|█▌        | 5/32 [03:52<20:53, 46.44s/it] 28%|██▊       | 9/32 [03:59<10:08, 26.43s/it] 28%|██▊       | 9/32 [04:04<10:31, 27.47s/it] 28%|██▊       | 9/32 [04:07<10:26, 27.22s/it] 28%|██▊       | 9/32 [04:07<10:26, 27.22s/it] 25%|██▌       | 8/32 [04:08<13:08, 32.85s/it] 28%|██▊       | 9/32 [04:08<10:30, 27.40s/it] 19%|█▉        | 6/32 [04:28<19:06, 44.08s/it] 31%|███▏      | 10/32 [04:30<10:06, 27.59s/it] 31%|███▏      | 10/32 [04:32<09:37, 26.26s/it] 31%|███▏      | 10/32 [04:33<10:17, 28.08s/it] 31%|███▏      | 10/32 [04:34<10:00, 27.28s/it] 31%|███▏      | 10/32 [04:35<10:05, 27.51s/it] 19%|█▉        | 6/32 [04:37<19:58, 46.10s/it] 28%|██▊       | 9/32 [04:42<12:48, 33.39s/it] 34%|███▍      | 11/32 [04:57<09:37, 27.49s/it] 34%|███▍      | 11/32 [04:59<09:31, 27.19s/it] 34%|███▍      | 11/32 [05:01<09:29, 27.14s/it] 34%|███▍      | 11/32 [05:02<09:33, 27.33s/it] 34%|███▍      | 11/32 [05:02<09:37, 27.51s/it] 22%|██▏       | 7/32 [05:10<18:02, 43.32s/it] 31%|███▏      | 10/32 [05:16<12:15, 33.45s/it] 38%|███▊      | 12/32 [05:21<08:50, 26.52s/it] 38%|███▊      | 12/32 [05:24<08:50, 26.55s/it] 22%|██▏       | 7/32 [05:24<19:16, 46.27s/it] 38%|███▊      | 12/32 [05:28<08:59, 27.00s/it] 38%|███▊      | 12/32 [05:29<09:05, 27.29s/it] 38%|███▊      | 12/32 [05:30<09:10, 27.55s/it] 41%|████      | 13/32 [05:48<08:12, 25.91s/it] 41%|████      | 13/32 [05:48<08:28, 26.77s/it] 34%|███▍      | 11/32 [05:49<11:43, 33.50s/it] 25%|██▌       | 8/32 [05:51<17:07, 42.82s/it] 41%|████      | 13/32 [05:54<08:27, 26.70s/it] 41%|████      | 13/32 [05:55<08:30, 26.85s/it] 41%|████      | 13/32 [06:00<09:01, 28.50s/it] 25%|██▌       | 8/32 [06:06<17:56, 44.83s/it] 44%|████▍     | 14/32 [06:14<07:57, 26.51s/it] 44%|████▍     | 14/32 [06:15<07:50, 26.12s/it] 44%|████▍     | 14/32 [06:21<08:00, 26.72s/it] 44%|████▍     | 14/32 [06:22<08:02, 26.81s/it] 38%|███▊      | 12/32 [06:22<11:04, 33.25s/it] 44%|████▍     | 14/32 [06:27<08:23, 27.96s/it] 47%|████▋     | 15/32 [06:38<07:10, 25.33s/it] 28%|██▊       | 9/32 [06:39<17:00, 44.37s/it] 47%|████▋     | 15/32 [06:42<07:34, 26.74s/it] 47%|████▋     | 15/32 [06:48<07:38, 26.97s/it] 28%|██▊       | 9/32 [06:49<16:58, 44.27s/it] 47%|████▋     | 15/32 [06:51<07:47, 27.47s/it] 47%|████▋     | 15/32 [06:56<08:00, 28.29s/it] 41%|████      | 13/32 [06:58<10:44, 33.92s/it] 50%|█████     | 16/32 [07:06<06:58, 26.16s/it] 50%|█████     | 16/32 [07:08<07:06, 26.68s/it] 50%|█████     | 16/32 [07:13<07:03, 26.47s/it] 50%|█████     | 16/32 [07:17<07:12, 27.02s/it] 50%|█████     | 16/32 [07:28<07:47, 29.19s/it] 31%|███▏      | 10/32 [07:28<16:48, 45.83s/it] 44%|████▍     | 14/32 [07:29<09:58, 33.27s/it] 31%|███▏      | 10/32 [07:33<16:13, 44.24s/it] 53%|█████▎    | 17/32 [07:34<06:37, 26.51s/it] 53%|█████▎    | 17/32 [07:36<06:43, 26.90s/it] 53%|█████▎    | 17/32 [07:39<06:31, 26.10s/it] 53%|█████▎    | 17/32 [07:42<06:37, 26.50s/it] 53%|█████▎    | 17/32 [07:57<07:20, 29.37s/it] 56%|█████▋    | 18/32 [08:02<06:20, 27.19s/it] 56%|█████▋    | 18/32 [08:02<06:15, 26.82s/it] 47%|████▋     | 15/32 [08:03<09:27, 33.37s/it] 56%|█████▋    | 18/32 [08:08<06:08, 26.34s/it] 56%|█████▋    | 18/32 [08:09<06:24, 27.47s/it] 34%|███▍      | 11/32 [08:10<15:35, 44.55s/it] 34%|███▍      | 11/32 [08:15<15:13, 43.48s/it] 56%|█████▋    | 18/32 [08:25<06:43, 28.79s/it] 59%|█████▉    | 19/32 [08:27<05:39, 26.08s/it] 59%|█████▉    | 19/32 [08:30<05:53, 27.22s/it] 59%|█████▉    | 19/32 [08:35<05:51, 27.01s/it] 50%|█████     | 16/32 [08:36<08:54, 33.42s/it] 59%|█████▉    | 19/32 [08:41<06:07, 28.23s/it] 59%|█████▉    | 19/32 [08:51<06:03, 27.95s/it] 38%|███▊      | 12/32 [08:54<14:48, 44.41s/it] 62%|██████▎   | 20/32 [08:54<05:17, 26.48s/it] 38%|███▊      | 12/32 [08:58<14:26, 43.31s/it] 62%|██████▎   | 20/32 [08:59<05:35, 27.94s/it] 62%|██████▎   | 20/32 [09:04<05:29, 27.42s/it] 62%|██████▎   | 20/32 [09:09<05:41, 28.43s/it] 53%|█████▎    | 17/32 [09:10<08:22, 33.50s/it] 62%|██████▎   | 20/32 [09:21<05:44, 28.71s/it] 66%|██████▌   | 21/32 [09:23<04:58, 27.18s/it] 66%|██████▌   | 21/32 [09:27<05:07, 27.99s/it] 66%|██████▌   | 21/32 [09:32<05:04, 27.68s/it] 66%|██████▌   | 21/32 [09:36<05:06, 27.90s/it] 41%|████      | 13/32 [09:37<13:54, 43.94s/it] 56%|█████▋    | 18/32 [09:42<07:41, 32.96s/it] 41%|████      | 13/32 [09:46<14:09, 44.71s/it] 66%|██████▌   | 21/32 [09:50<05:14, 28.60s/it] 69%|██████▉   | 22/32 [09:54<04:43, 28.33s/it] 69%|██████▉   | 22/32 [09:57<04:44, 28.48s/it] 69%|██████▉   | 22/32 [10:00<04:36, 27.68s/it] 69%|██████▉   | 22/32 [10:08<04:51, 29.12s/it] 59%|█████▉    | 19/32 [10:15<07:10, 33.15s/it] 69%|██████▉   | 22/32 [10:16<04:38, 27.82s/it] 44%|████▍     | 14/32 [10:21<13:12, 44.03s/it] 72%|███████▏  | 23/32 [10:23<04:16, 28.47s/it] 72%|███████▏  | 23/32 [10:24<04:11, 27.92s/it] 72%|███████▏  | 23/32 [10:26<04:06, 27.40s/it] 44%|████▍     | 14/32 [10:33<13:41, 45.62s/it] 72%|███████▏  | 23/32 [10:36<04:19, 28.82s/it] 72%|███████▏  | 23/32 [10:41<04:03, 27.03s/it] 75%|███████▌  | 24/32 [10:47<03:38, 27.29s/it] 78%|███████▊  | 25/32 [10:50<02:27, 21.02s/it] 62%|██████▎   | 20/32 [10:52<06:49, 34.12s/it] 75%|███████▌  | 24/32 [10:53<03:37, 27.24s/it] 75%|███████▌  | 24/32 [11:04<03:49, 28.63s/it] 75%|███████▌  | 24/32 [11:08<03:37, 27.15s/it] 47%|████▋     | 15/32 [11:11<12:59, 45.87s/it] 78%|███████▊  | 25/32 [11:13<03:08, 26.87s/it] 81%|████████▏ | 26/32 [11:15<02:12, 22.03s/it] 47%|████▋     | 15/32 [11:20<13:00, 45.93s/it] 78%|███████▊  | 25/32 [11:21<03:12, 27.55s/it] 78%|███████▊  | 25/32 [11:35<03:24, 29.17s/it] 66%|██████▌   | 21/32 [11:35<06:44, 36.73s/it] 78%|███████▊  | 25/32 [11:36<03:10, 27.24s/it] 84%|████████▍ | 27/32 [11:40<01:54, 22.82s/it] 81%|████████▏ | 26/32 [11:42<02:44, 27.47s/it] 81%|████████▏ | 26/32 [11:47<02:42, 27.10s/it] 50%|█████     | 16/32 [11:54<11:59, 44.99s/it] 81%|████████▏ | 26/32 [12:00<02:47, 27.99s/it] 50%|█████     | 16/32 [12:06<12:12, 45.78s/it] 81%|████████▏ | 26/32 [12:07<02:50, 28.46s/it] 84%|████████▍ | 27/32 [12:07<02:13, 26.77s/it] 69%|██████▉   | 22/32 [12:07<05:55, 35.50s/it] 88%|████████▊ | 28/32 [12:09<01:37, 24.43s/it] 84%|████████▍ | 27/32 [12:17<02:19, 27.87s/it] 84%|████████▍ | 27/32 [12:28<02:19, 27.83s/it] 88%|████████▊ | 28/32 [12:33<01:45, 26.49s/it] 84%|████████▍ | 27/32 [12:34<02:20, 28.18s/it] 91%|█████████ | 29/32 [12:37<01:17, 25.67s/it] 53%|█████▎    | 17/32 [12:42<11:27, 45.82s/it] 72%|███████▏  | 23/32 [12:42<05:17, 35.24s/it] 88%|████████▊ | 28/32 [12:45<01:50, 27.73s/it] 53%|█████▎    | 17/32 [12:50<11:20, 45.33s/it] 88%|████████▊ | 28/32 [12:55<01:51, 27.75s/it] 94%|█████████▍| 30/32 [12:59<00:40, 20.40s/it] 94%|█████████▍| 30/32 [13:02<00:50, 25.34s/it] 88%|████████▊ | 28/32 [13:03<01:52, 28.21s/it] 91%|█████████ | 29/32 [13:11<01:21, 27.21s/it] 75%|███████▌  | 24/32 [13:21<04:51, 36.45s/it] 91%|█████████ | 29/32 [13:23<01:23, 27.89s/it] 97%|█████████▋| 31/32 [13:28<00:22, 22.29s/it] 97%|█████████▋| 31/32 [13:29<00:25, 25.91s/it] 56%|█████▋    | 18/32 [13:29<10:49, 46.37s/it] 91%|█████████ | 29/32 [13:30<01:23, 27.97s/it] 56%|█████▋    | 18/32 [13:35<10:34, 45.33s/it] 94%|█████████▍| 30/32 [13:40<00:55, 27.76s/it] 94%|█████████▍| 30/32 [13:52<00:56, 28.24s/it]100%|██████████| 32/32 [13:53<00:00, 23.05s/it]100%|██████████| 32/32 [13:53<00:00, 26.04s/it]
 78%|███████▊  | 25/32 [13:58<04:15, 36.43s/it]100%|██████████| 32/32 [13:58<00:00, 26.78s/it]100%|██████████| 32/32 [13:58<00:00, 26.21s/it]
 94%|█████████▍| 30/32 [13:59<00:56, 28.09s/it] 97%|█████████▋| 31/32 [14:07<00:27, 27.69s/it] 59%|█████▉    | 19/32 [14:20<10:17, 47.53s/it] 59%|█████▉    | 19/32 [14:21<09:49, 45.35s/it] 97%|█████████▋| 31/32 [14:21<00:28, 28.43s/it] 97%|█████████▋| 31/32 [14:24<00:27, 27.42s/it] 81%|████████▏ | 26/32 [14:35<03:39, 36.63s/it]100%|██████████| 32/32 [14:35<00:00, 27.85s/it]100%|██████████| 32/32 [14:35<00:00, 27.37s/it]
100%|██████████| 32/32 [14:51<00:00, 27.18s/it]100%|██████████| 32/32 [14:51<00:00, 27.86s/it]
100%|██████████| 32/32 [14:52<00:00, 29.03s/it]100%|██████████| 32/32 [14:52<00:00, 27.88s/it]
 62%|██████▎   | 20/32 [15:09<09:35, 47.95s/it] 84%|████████▍ | 27/32 [15:09<02:59, 35.96s/it] 62%|██████▎   | 20/32 [15:10<09:17, 46.46s/it] 88%|████████▊ | 28/32 [15:42<02:19, 34.92s/it] 66%|██████▌   | 21/32 [15:55<08:27, 46.14s/it] 66%|██████▌   | 21/32 [15:56<08:46, 47.88s/it] 91%|█████████ | 29/32 [16:14<01:42, 34.18s/it] 69%|██████▉   | 22/32 [16:40<07:47, 46.74s/it] 69%|██████▉   | 22/32 [16:43<07:46, 46.63s/it] 94%|█████████▍| 30/32 [16:53<01:11, 35.61s/it] 72%|███████▏  | 23/32 [17:23<06:49, 45.56s/it] 72%|███████▏  | 23/32 [17:24<06:46, 45.13s/it] 97%|█████████▋| 31/32 [17:24<00:34, 34.38s/it]100%|██████████| 32/32 [17:56<00:00, 33.55s/it]100%|██████████| 32/32 [17:56<00:00, 33.64s/it]
 75%|███████▌  | 24/32 [18:10<06:06, 45.82s/it] 75%|███████▌  | 24/32 [18:13<06:10, 46.29s/it] 78%|███████▊  | 25/32 [18:55<05:19, 45.70s/it] 78%|███████▊  | 25/32 [18:59<05:21, 45.98s/it] 81%|████████▏ | 26/32 [19:38<04:28, 44.83s/it] 81%|████████▏ | 26/32 [19:43<04:32, 45.43s/it] 84%|████████▍ | 27/32 [20:23<03:44, 44.99s/it] 84%|████████▍ | 27/32 [20:26<03:43, 44.63s/it] 88%|████████▊ | 28/32 [21:10<02:57, 44.48s/it] 88%|████████▊ | 28/32 [21:10<03:01, 45.47s/it] 91%|█████████ | 29/32 [21:50<02:09, 43.27s/it] 91%|█████████ | 29/32 [21:59<02:19, 46.54s/it] 94%|█████████▍| 30/32 [22:38<01:29, 44.61s/it] 94%|█████████▍| 30/32 [22:46<01:33, 46.57s/it] 97%|█████████▋| 31/32 [23:17<00:43, 43.00s/it] 97%|█████████▋| 31/32 [23:31<00:46, 46.17s/it][rank5]:[E ProcessGroupNCCL.cpp:523] [Rank 5] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=48, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600175 milliseconds before timing out.
[rank5]:[E ProcessGroupNCCL.cpp:537] Some NCCL operations have failed or timed out. Due to the asynchronous nature of CUDA kernels, subsequent GPU operations might run on corrupted/incomplete data.
[rank5]:[E ProcessGroupNCCL.cpp:543] To avoid data inconsistency, we are taking the entire process down.
[rank5]:[E ProcessGroupNCCL.cpp:1182] [Rank 5] NCCL watchdog thread terminated with exception: [Rank 5] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=48, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600175 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:525 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7fcced30fd87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x1e6 (0x7fccee4b76e6 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::workCleanupLoop() + 0x19d (0x7fccee4bac3d in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x119 (0x7fccee4bb839 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd6df4 (0x7fcd381cedf4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #5: <unknown function> + 0x8609 (0x7fcd395bd609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #6: clone + 0x43 (0x7fcd39388353 in /lib/x86_64-linux-gnu/libc.so.6)

terminate called after throwing an instance of 'c10::DistBackendError'
  what():  [Rank 5] NCCL watchdog thread terminated with exception: [Rank 5] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=48, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600175 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:525 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7fcced30fd87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x1e6 (0x7fccee4b76e6 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::workCleanupLoop() + 0x19d (0x7fccee4bac3d in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x119 (0x7fccee4bb839 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd6df4 (0x7fcd381cedf4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #5: <unknown function> + 0x8609 (0x7fcd395bd609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #6: clone + 0x43 (0x7fcd39388353 in /lib/x86_64-linux-gnu/libc.so.6)

Exception raised from ncclCommWatchdog at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:1186 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7fcced30fd87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0xdf6b11 (0x7fccee211b11 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: <unknown function> + 0xd6df4 (0x7fcd381cedf4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #3: <unknown function> + 0x8609 (0x7fcd395bd609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #4: clone + 0x43 (0x7fcd39388353 in /lib/x86_64-linux-gnu/libc.so.6)

100%|██████████| 32/32 [24:04<00:00, 44.08s/it]100%|██████████| 32/32 [24:04<00:00, 45.13s/it]
100%|██████████| 32/32 [24:16<00:00, 45.97s/it]100%|██████████| 32/32 [24:16<00:00, 45.52s/it]
[2024-07-09 19:44:00,846] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 3994479 closing signal SIGTERM
[2024-07-09 19:44:00,847] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 3994480 closing signal SIGTERM
[2024-07-09 19:44:00,847] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 3994481 closing signal SIGTERM
[2024-07-09 19:44:00,847] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 3994482 closing signal SIGTERM
[2024-07-09 19:44:00,847] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 3994483 closing signal SIGTERM
[2024-07-09 19:44:00,848] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 3994485 closing signal SIGTERM
[2024-07-09 19:44:00,848] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 3994486 closing signal SIGTERM
[2024-07-09 19:44:02,378] torch.distributed.elastic.multiprocessing.api: [ERROR] failed (exitcode: -6) local_rank: 5 (pid: 3994484) of binary: /fsx-storygen/beidic/anaconda3/envs/griffin/bin/python3.9
Traceback (most recent call last):
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/bin/accelerate", line 8, in <module>
    sys.exit(main())
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/accelerate/commands/accelerate_cli.py", line 47, in main
    args.func(args)
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/accelerate/commands/launch.py", line 985, in launch_command
    multi_gpu_launcher(args)
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/accelerate/commands/launch.py", line 654, in multi_gpu_launcher
    distrib_run.run(args)
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/distributed/run.py", line 803, in run
    elastic_launch(
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 135, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 268, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
========================================================
main.py FAILED
--------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
--------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-09_19:44:00
  host      : a100-st-p4de24xlarge-119.fair-a100.hpcaas
  rank      : 5 (local_rank: 5)
  exitcode  : -6 (pid: 3994484)
  error_file: <N/A>
  traceback : Signal 6 (SIGABRT) received by PID 3994484
========================================================
