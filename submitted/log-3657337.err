fatal: Unable to create '/fsx-storygen/beidic/yang/GRIFFIN2/.git/index.lock': File exists.

Another git process seems to be running in this repository, e.g.
an editor opened by 'git commit'. Please make sure all processes
are terminated then try again. If it still fails, a git process
may have crashed in this repository earlier:
remove the file manually to continue.
fatal: Unable to create '/fsx-storygen/beidic/yang/GRIFFIN2/.git/index.lock': File exists.

Another git process seems to be running in this repository, e.g.
an editor opened by 'git commit'. Please make sure all processes
are terminated then try again. If it still fails, a git process
may have crashed in this repository earlier:
remove the file manually to continue.
wandb: Currently logged in as: stevenzhou0816100. Use `wandb login --relogin` to force relogin
2024-08-03:08:40:40,610 INFO     [main.py:288] Verbosity set to INFO
2024-08-03:08:40:50,610 INFO     [main.py:378] Selected Tasks: ['gsm8k_cot']
2024-08-03:08:40:50,646 INFO     [xevaluator.py:137] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2024-08-03:08:40:50,646 INFO     [xevaluator.py:184] Initializing xhf model, with arguments: {'pretrained': 'meta-llama/Meta-Llama-3-70B-Instruct', 'griffin': False, 'check': False, 'contextlength': 1500, 'kernel_size': 16, 'thr': 0.05}
2024-08-03:08:40:50,656 INFO     [xhuggingface.py:176] Using device 'cuda'
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:05<02:42,  5.60s/it]Loading checkpoint shards:   7%|▋         | 2/30 [00:11<02:36,  5.58s/it]Loading checkpoint shards:  10%|█         | 3/30 [00:17<02:36,  5.81s/it]Loading checkpoint shards:  13%|█▎        | 4/30 [00:23<02:33,  5.92s/it]Loading checkpoint shards:  17%|█▋        | 5/30 [00:28<02:24,  5.77s/it]Loading checkpoint shards:  20%|██        | 6/30 [00:34<02:16,  5.70s/it]Loading checkpoint shards:  23%|██▎       | 7/30 [00:39<02:08,  5.59s/it]Loading checkpoint shards:  27%|██▋       | 8/30 [00:45<02:04,  5.64s/it]Loading checkpoint shards:  30%|███       | 9/30 [00:51<01:58,  5.63s/it]Loading checkpoint shards:  33%|███▎      | 10/30 [00:56<01:50,  5.53s/it]Loading checkpoint shards:  37%|███▋      | 11/30 [01:01<01:43,  5.46s/it]Loading checkpoint shards:  40%|████      | 12/30 [01:07<01:38,  5.45s/it]Loading checkpoint shards:  43%|████▎     | 13/30 [01:12<01:33,  5.50s/it]Loading checkpoint shards:  47%|████▋     | 14/30 [01:18<01:28,  5.51s/it]Loading checkpoint shards:  50%|█████     | 15/30 [01:23<01:21,  5.44s/it]Loading checkpoint shards:  53%|█████▎    | 16/30 [01:28<01:15,  5.38s/it]Loading checkpoint shards:  57%|█████▋    | 17/30 [01:34<01:09,  5.34s/it]Loading checkpoint shards:  60%|██████    | 18/30 [01:39<01:05,  5.45s/it]Loading checkpoint shards:  63%|██████▎   | 19/30 [01:45<01:00,  5.49s/it]Loading checkpoint shards:  67%|██████▋   | 20/30 [01:50<00:54,  5.41s/it]Loading checkpoint shards:  70%|███████   | 21/30 [01:55<00:48,  5.34s/it]Loading checkpoint shards:  73%|███████▎  | 22/30 [02:00<00:42,  5.29s/it]Loading checkpoint shards:  77%|███████▋  | 23/30 [02:06<00:37,  5.40s/it]Loading checkpoint shards:  80%|████████  | 24/30 [02:12<00:32,  5.45s/it]Loading checkpoint shards:  83%|████████▎ | 25/30 [02:17<00:26,  5.38s/it]Loading checkpoint shards:  87%|████████▋ | 26/30 [02:22<00:21,  5.40s/it]Loading checkpoint shards:  90%|█████████ | 27/30 [02:28<00:16,  5.35s/it]Loading checkpoint shards:  93%|█████████▎| 28/30 [02:33<00:10,  5.44s/it]Loading checkpoint shards:  97%|█████████▋| 29/30 [02:39<00:05,  5.49s/it]Loading checkpoint shards: 100%|██████████| 30/30 [02:41<00:00,  4.59s/it]Loading checkpoint shards: 100%|██████████| 30/30 [02:41<00:00,  5.39s/it]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
2024-08-03:08:43:39,874 WARNING  [task.py:322] [Task: gsm8k_cot] has_training_docs and has_validation_docs are False, using test_docs as fewshot_docs but this is not recommended.
2024-08-03:08:43:39,874 WARNING  [task.py:322] [Task: gsm8k_cot] has_training_docs and has_validation_docs are False, using test_docs as fewshot_docs but this is not recommended.
2024-08-03:08:43:39,958 INFO     [task.py:395] Building contexts for gsm8k_cot on rank 0...
  0%|          | 0/1319 [00:00<?, ?it/s] 13%|█▎        | 170/1319 [00:00<00:00, 1693.66it/s] 26%|██▌       | 341/1319 [00:00<00:00, 1697.71it/s] 39%|███▉      | 512/1319 [00:00<00:00, 1699.65it/s] 52%|█████▏    | 682/1319 [00:00<00:00, 1698.66it/s] 65%|██████▍   | 852/1319 [00:00<00:00, 1698.88it/s] 77%|███████▋  | 1022/1319 [00:00<00:00, 1698.93it/s] 90%|█████████ | 1193/1319 [00:00<00:00, 1702.47it/s]100%|██████████| 1319/1319 [00:00<00:00, 1701.07it/s]
2024-08-03:08:43:40,757 INFO     [xevaluator.py:395] Running generate_until requests
Running generate_until requests:   0%|          | 0/1319 [00:00<?, ?it/s]Running generate_until requests:   0%|          | 1/1319 [00:54<20:00:01, 54.63s/it]Running generate_until requests:   0%|          | 2/1319 [01:31<16:16:05, 44.47s/it]Running generate_until requests:   0%|          | 3/1319 [02:08<14:53:50, 40.75s/it]Running generate_until requests:   0%|          | 4/1319 [02:52<15:22:52, 42.11s/it]Running generate_until requests:   0%|          | 5/1319 [03:48<17:09:21, 47.00s/it]Running generate_until requests:   0%|          | 6/1319 [04:36<17:21:23, 47.59s/it]Running generate_until requests:   1%|          | 7/1319 [05:13<16:01:49, 43.99s/it]Running generate_until requests:   1%|          | 8/1319 [05:56<15:52:43, 43.60s/it]Running generate_until requests:   1%|          | 9/1319 [06:27<14:28:02, 39.76s/it]Running generate_until requests:   1%|          | 10/1319 [07:10<14:45:32, 40.59s/it]Running generate_until requests:   1%|          | 11/1319 [07:46<14:19:34, 39.43s/it]Running generate_until requests:   1%|          | 12/1319 [08:45<16:29:25, 45.42s/it]Running generate_until requests:   1%|          | 13/1319 [09:22<15:28:00, 42.63s/it]Running generate_until requests:   1%|          | 14/1319 [09:48<13:38:10, 37.62s/it]Running generate_until requests:   1%|          | 15/1319 [10:30<14:08:38, 39.05s/it]Running generate_until requests:   1%|          | 16/1319 [10:59<12:59:53, 35.91s/it]Running generate_until requests:   1%|▏         | 17/1319 [11:43<13:51:01, 38.30s/it]Running generate_until requests:   1%|▏         | 18/1319 [12:32<15:03:54, 41.69s/it]Running generate_until requests:   1%|▏         | 19/1319 [13:01<13:40:50, 37.88s/it]Running generate_until requests:   2%|▏         | 20/1319 [13:42<14:01:02, 38.85s/it]Running generate_until requests:   2%|▏         | 21/1319 [14:05<12:19:03, 34.16s/it]Running generate_until requests:   2%|▏         | 22/1319 [14:37<11:59:31, 33.29s/it]Running generate_until requests:   2%|▏         | 23/1319 [15:02<11:06:08, 30.84s/it]Running generate_until requests:   2%|▏         | 24/1319 [15:53<13:14:24, 36.81s/it]Running generate_until requests:   2%|▏         | 25/1319 [16:30<13:18:06, 37.01s/it]Running generate_until requests:   2%|▏         | 26/1319 [16:52<11:43:14, 32.63s/it]Running generate_until requests:   2%|▏         | 27/1319 [17:16<10:41:29, 29.79s/it]Running generate_until requests:   2%|▏         | 28/1319 [17:47<10:52:22, 30.32s/it]Running generate_until requests:   2%|▏         | 29/1319 [18:11<10:08:06, 28.28s/it]Running generate_until requests:   2%|▏         | 30/1319 [18:28<8:56:21, 24.97s/it] Running generate_until requests:   2%|▏         | 31/1319 [18:45<8:01:51, 22.45s/it]Running generate_until requests:   2%|▏         | 32/1319 [19:27<10:11:56, 28.53s/it]Running generate_until requests:   3%|▎         | 33/1319 [20:03<10:57:11, 30.66s/it]Running generate_until requests:   3%|▎         | 34/1319 [20:39<11:30:52, 32.26s/it]Running generate_until requests:   3%|▎         | 35/1319 [21:35<14:04:36, 39.47s/it]Running generate_until requests:   3%|▎         | 36/1319 [22:14<13:57:25, 39.16s/it]Running generate_until requests:   3%|▎         | 37/1319 [23:26<17:31:00, 49.19s/it]Running generate_until requests:   3%|▎         | 38/1319 [24:03<16:12:24, 45.55s/it]Running generate_until requests:   3%|▎         | 39/1319 [24:54<16:44:53, 47.10s/it]Running generate_until requests:   3%|▎         | 40/1319 [25:42<16:51:39, 47.46s/it]Running generate_until requests:   3%|▎         | 41/1319 [26:41<18:04:36, 50.92s/it]Running generate_until requests:   3%|▎         | 42/1319 [27:02<14:50:19, 41.83s/it]Running generate_until requests:   3%|▎         | 43/1319 [27:32<13:32:36, 38.21s/it]Running generate_until requests:   3%|▎         | 44/1319 [28:01<12:36:38, 35.61s/it]Running generate_until requests:   3%|▎         | 45/1319 [28:26<11:25:51, 32.30s/it]Running generate_until requests:   3%|▎         | 46/1319 [28:48<10:24:21, 29.43s/it]Running generate_until requests:   4%|▎         | 47/1319 [29:20<10:37:51, 30.09s/it]Running generate_until requests:   4%|▎         | 48/1319 [29:40<9:34:02, 27.10s/it] Running generate_until requests:   4%|▎         | 49/1319 [30:24<11:21:06, 32.18s/it]Running generate_until requests:   4%|▍         | 50/1319 [31:02<11:56:29, 33.88s/it]Running generate_until requests:   4%|▍         | 51/1319 [31:28<11:07:09, 31.57s/it]Running generate_until requests:   4%|▍         | 52/1319 [31:49<9:56:26, 28.24s/it] Running generate_until requests:   4%|▍         | 53/1319 [32:25<10:48:08, 30.72s/it]Running generate_until requests:   4%|▍         | 54/1319 [33:04<11:36:14, 33.02s/it]Running generate_until requests:   4%|▍         | 55/1319 [33:27<10:37:29, 30.26s/it]Running generate_until requests:   4%|▍         | 56/1319 [33:53<10:08:02, 28.89s/it]Running generate_until requests:   4%|▍         | 57/1319 [34:16<9:27:37, 26.99s/it] Running generate_until requests:   4%|▍         | 58/1319 [34:52<10:25:15, 29.75s/it]Running generate_until requests:   4%|▍         | 59/1319 [35:15<9:41:28, 27.69s/it] Running generate_until requests:   5%|▍         | 60/1319 [35:47<10:08:53, 29.02s/it]Running generate_until requests:   5%|▍         | 61/1319 [36:17<10:12:05, 29.19s/it]Running generate_until requests:   5%|▍         | 62/1319 [36:49<10:31:09, 30.13s/it]Running generate_until requests:   5%|▍         | 63/1319 [37:36<12:15:35, 35.14s/it]Running generate_until requests:   5%|▍         | 64/1319 [38:06<11:47:34, 33.83s/it]Running generate_until requests:   5%|▍         | 65/1319 [38:48<12:34:31, 36.10s/it]Running generate_until requests:   5%|▌         | 66/1319 [39:36<13:48:32, 39.67s/it]Running generate_until requests:   5%|▌         | 67/1319 [40:05<12:42:28, 36.54s/it]Running generate_until requests:   5%|▌         | 68/1319 [40:29<11:25:43, 32.89s/it]Running generate_until requests:   5%|▌         | 69/1319 [41:07<11:56:07, 34.37s/it]Running generate_until requests:   5%|▌         | 70/1319 [41:57<13:29:26, 38.88s/it]Running generate_until requests:   5%|▌         | 71/1319 [42:33<13:14:41, 38.21s/it]Running generate_until requests:   5%|▌         | 72/1319 [43:00<12:03:36, 34.82s/it]Running generate_until requests:   6%|▌         | 73/1319 [43:18<10:18:31, 29.78s/it]Running generate_until requests:   6%|▌         | 74/1319 [43:34<8:51:42, 25.62s/it] Running generate_until requests:   6%|▌         | 75/1319 [43:59<8:47:03, 25.42s/it]Running generate_until requests:   6%|▌         | 76/1319 [44:42<10:32:45, 30.54s/it]Running generate_until requests:   6%|▌         | 77/1319 [45:12<10:32:51, 30.57s/it]Running generate_until requests:   6%|▌         | 78/1319 [45:32<9:25:48, 27.36s/it] Running generate_until requests:   6%|▌         | 79/1319 [46:01<9:32:12, 27.69s/it]Running generate_until requests:   6%|▌         | 80/1319 [46:13<7:55:06, 23.01s/it]Running generate_until requests:   6%|▌         | 81/1319 [46:46<9:00:46, 26.21s/it]Running generate_until requests:   6%|▌         | 82/1319 [47:20<9:45:00, 28.38s/it]Running generate_until requests:   6%|▋         | 83/1319 [48:03<11:13:37, 32.70s/it]Running generate_until requests:   6%|▋         | 84/1319 [48:30<10:37:44, 30.98s/it]Running generate_until requests:   6%|▋         | 85/1319 [49:13<11:52:57, 34.67s/it]Running generate_until requests:   7%|▋         | 86/1319 [49:44<11:28:06, 33.48s/it]Running generate_until requests:   7%|▋         | 87/1319 [50:15<11:13:24, 32.80s/it]Running generate_until requests:   7%|▋         | 88/1319 [50:38<10:17:01, 30.07s/it]Running generate_until requests:   7%|▋         | 89/1319 [51:14<10:47:23, 31.58s/it]Running generate_until requests:   7%|▋         | 90/1319 [51:47<10:59:31, 32.20s/it]Running generate_until requests:   7%|▋         | 91/1319 [52:24<11:29:47, 33.70s/it]Running generate_until requests:   7%|▋         | 92/1319 [53:15<13:14:40, 38.86s/it]Running generate_until requests:   7%|▋         | 93/1319 [53:54<13:10:14, 38.67s/it]Running generate_until requests:   7%|▋         | 94/1319 [54:16<11:29:28, 33.77s/it]Running generate_until requests:   7%|▋         | 95/1319 [55:07<13:18:20, 39.13s/it]Running generate_until requests:   7%|▋         | 96/1319 [55:38<12:25:23, 36.57s/it]Running generate_until requests:   7%|▋         | 97/1319 [56:15<12:26:58, 36.68s/it]Running generate_until requests:   7%|▋         | 98/1319 [57:09<14:11:00, 41.82s/it]Running generate_until requests:   8%|▊         | 99/1319 [57:33<12:24:07, 36.60s/it]Running generate_until requests:   8%|▊         | 100/1319 [58:01<11:29:08, 33.92s/it]Running generate_until requests:   8%|▊         | 101/1319 [58:37<11:40:39, 34.52s/it]Running generate_until requests:   8%|▊         | 102/1319 [59:15<12:00:27, 35.52s/it]Running generate_until requests:   8%|▊         | 103/1319 [59:54<12:21:20, 36.58s/it]Running generate_until requests:   8%|▊         | 104/1319 [1:00:34<12:45:52, 37.82s/it]Running generate_until requests:   8%|▊         | 105/1319 [1:01:23<13:47:26, 40.90s/it]Running generate_until requests:   8%|▊         | 106/1319 [1:01:47<12:06:42, 35.95s/it]Running generate_until requests:   8%|▊         | 107/1319 [1:02:16<11:26:06, 33.97s/it]Running generate_until requests:   8%|▊         | 108/1319 [1:02:57<12:05:48, 35.96s/it]Running generate_until requests:   8%|▊         | 109/1319 [1:03:22<10:57:46, 32.62s/it]Running generate_until requests:   8%|▊         | 110/1319 [1:04:18<13:22:23, 39.82s/it]Running generate_until requests:   8%|▊         | 111/1319 [1:04:39<11:24:28, 34.00s/it]Running generate_until requests:   8%|▊         | 112/1319 [1:05:08<10:55:39, 32.59s/it]Running generate_until requests:   9%|▊         | 113/1319 [1:05:36<10:26:51, 31.19s/it]Running generate_until requests:   9%|▊         | 114/1319 [1:06:12<10:57:34, 32.74s/it]Running generate_until requests:   9%|▊         | 115/1319 [1:06:38<10:13:08, 30.56s/it]Running generate_until requests:   9%|▉         | 116/1319 [1:07:02<9:34:36, 28.66s/it] Running generate_until requests:   9%|▉         | 117/1319 [1:07:37<10:11:03, 30.50s/it]Running generate_until requests:   9%|▉         | 118/1319 [1:08:05<9:55:24, 29.75s/it] Running generate_until requests:   9%|▉         | 119/1319 [1:08:40<10:25:24, 31.27s/it]Running generate_until requests:   9%|▉         | 120/1319 [1:09:17<10:59:44, 33.01s/it]Running generate_until requests:   9%|▉         | 121/1319 [1:09:45<10:32:30, 31.68s/it]Running generate_until requests:   9%|▉         | 122/1319 [1:10:23<11:06:21, 33.40s/it]Running generate_until requests:   9%|▉         | 123/1319 [1:10:51<10:32:56, 31.75s/it]Running generate_until requests:   9%|▉         | 124/1319 [1:11:24<10:40:13, 32.15s/it]Running generate_until requests:   9%|▉         | 125/1319 [1:11:53<10:22:15, 31.27s/it]Running generate_until requests:  10%|▉         | 126/1319 [1:12:18<9:47:38, 29.55s/it] Running generate_until requests:  10%|▉         | 127/1319 [1:12:43<9:15:57, 27.98s/it]Running generate_until requests:  10%|▉         | 128/1319 [1:13:09<9:02:48, 27.35s/it]Running generate_until requests:  10%|▉         | 129/1319 [1:13:45<9:53:38, 29.93s/it]Running generate_until requests:  10%|▉         | 130/1319 [1:14:02<8:39:23, 26.21s/it]Running generate_until requests:  10%|▉         | 131/1319 [1:14:38<9:38:54, 29.24s/it]Running generate_until requests:  10%|█         | 132/1319 [1:15:30<11:50:00, 35.89s/it]Running generate_until requests:  10%|█         | 133/1319 [1:16:11<12:22:43, 37.57s/it]Running generate_until requests:  10%|█         | 134/1319 [1:16:34<10:53:17, 33.08s/it]Running generate_until requests:  10%|█         | 135/1319 [1:17:07<10:54:58, 33.19s/it]Running generate_until requests:  10%|█         | 136/1319 [1:17:39<10:44:17, 32.68s/it]Running generate_until requests:  10%|█         | 137/1319 [1:18:20<11:36:30, 35.36s/it]Running generate_until requests:  10%|█         | 138/1319 [1:18:45<10:32:04, 32.11s/it]Running generate_until requests:  11%|█         | 139/1319 [1:19:21<10:56:45, 33.39s/it]Running generate_until requests:  11%|█         | 140/1319 [1:20:03<11:44:59, 35.88s/it]Running generate_until requests:  11%|█         | 141/1319 [1:20:27<10:32:47, 32.23s/it]Running generate_until requests:  11%|█         | 142/1319 [1:21:10<11:36:32, 35.51s/it]Running generate_until requests:  11%|█         | 143/1319 [1:21:56<12:36:36, 38.60s/it]Running generate_until requests:  11%|█         | 144/1319 [1:23:07<15:48:39, 48.44s/it]Running generate_until requests:  11%|█         | 145/1319 [1:23:50<15:16:50, 46.86s/it]Running generate_until requests:  11%|█         | 146/1319 [1:24:27<14:14:02, 43.69s/it]Running generate_until requests:  11%|█         | 147/1319 [1:24:56<12:47:16, 39.28s/it]Running generate_until requests:  11%|█         | 148/1319 [1:25:18<11:10:41, 34.37s/it]Running generate_until requests:  11%|█▏        | 149/1319 [1:26:01<11:56:27, 36.74s/it]Running generate_until requests:  11%|█▏        | 150/1319 [1:26:12<9:24:52, 28.99s/it] Running generate_until requests:  11%|█▏        | 151/1319 [1:26:44<9:43:46, 29.99s/it]Running generate_until requests:  12%|█▏        | 152/1319 [1:27:12<9:30:25, 29.33s/it]Running generate_until requests:  12%|█▏        | 153/1319 [1:27:44<9:46:15, 30.17s/it]Running generate_until requests:  12%|█▏        | 154/1319 [1:28:05<8:51:37, 27.38s/it]Running generate_until requests:  12%|█▏        | 155/1319 [1:28:50<10:37:44, 32.87s/it]Running generate_until requests:  12%|█▏        | 156/1319 [1:29:16<9:53:22, 30.61s/it] Running generate_until requests:  12%|█▏        | 157/1319 [1:29:46<9:52:40, 30.60s/it]Running generate_until requests:  12%|█▏        | 158/1319 [1:30:13<9:31:21, 29.53s/it]Running generate_until requests:  12%|█▏        | 159/1319 [1:31:04<11:30:52, 35.73s/it]