Already on 'yangexppp'
wandb: Currently logged in as: stevenzhou0816100. Use `wandb login --relogin` to force relogin
2024-08-04:18:19:22,977 INFO     [main.py:288] Verbosity set to INFO
2024-08-04:18:19:33,243 INFO     [main.py:378] Selected Tasks: ['gsm8k_cot']
2024-08-04:18:19:33,278 INFO     [xevaluator.py:137] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2024-08-04:18:19:33,278 INFO     [xevaluator.py:184] Initializing xhf model, with arguments: {'pretrained': 'meta-llama/Meta-Llama-3-70B-Instruct', 'griffin': True, 'check': True, 'contextlength': 1500, 'kernel_size': 16, 'thr': 0.05}
2024-08-04:18:19:33,288 INFO     [xhuggingface.py:176] Using device 'cuda'
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:05<02:39,  5.49s/it]Loading checkpoint shards:   7%|▋         | 2/30 [00:11<02:38,  5.65s/it]Loading checkpoint shards:  10%|█         | 3/30 [00:17<02:36,  5.80s/it]Loading checkpoint shards:  13%|█▎        | 4/30 [00:23<02:32,  5.88s/it]Loading checkpoint shards:  17%|█▋        | 5/30 [00:28<02:22,  5.71s/it]Loading checkpoint shards:  20%|██        | 6/30 [00:33<02:14,  5.58s/it]Loading checkpoint shards:  23%|██▎       | 7/30 [00:39<02:05,  5.48s/it]Loading checkpoint shards:  27%|██▋       | 8/30 [00:44<02:01,  5.53s/it]Loading checkpoint shards:  30%|███       | 9/30 [00:50<01:56,  5.55s/it]Loading checkpoint shards:  33%|███▎      | 10/30 [00:55<01:49,  5.49s/it]Loading checkpoint shards:  37%|███▋      | 11/30 [01:01<01:43,  5.47s/it]Loading checkpoint shards:  40%|████      | 12/30 [01:06<01:37,  5.41s/it]Loading checkpoint shards:  43%|████▎     | 13/30 [01:12<01:32,  5.47s/it]Loading checkpoint shards:  47%|████▋     | 14/30 [01:17<01:27,  5.50s/it]Loading checkpoint shards:  50%|█████     | 15/30 [01:22<01:21,  5.42s/it]Loading checkpoint shards:  53%|█████▎    | 16/30 [01:28<01:15,  5.38s/it]Loading checkpoint shards:  57%|█████▋    | 17/30 [01:33<01:09,  5.35s/it]Loading checkpoint shards:  60%|██████    | 18/30 [01:39<01:04,  5.40s/it]Loading checkpoint shards:  63%|██████▎   | 19/30 [01:44<00:59,  5.45s/it]Loading checkpoint shards:  67%|██████▋   | 20/30 [01:49<00:53,  5.36s/it]Loading checkpoint shards:  70%|███████   | 21/30 [01:54<00:47,  5.31s/it]Loading checkpoint shards:  73%|███████▎  | 22/30 [02:00<00:42,  5.32s/it]Loading checkpoint shards:  77%|███████▋  | 23/30 [02:05<00:37,  5.42s/it]Loading checkpoint shards:  80%|████████  | 24/30 [02:11<00:32,  5.47s/it]Loading checkpoint shards:  83%|████████▎ | 25/30 [02:16<00:27,  5.43s/it]Loading checkpoint shards:  87%|████████▋ | 26/30 [02:22<00:21,  5.38s/it]Loading checkpoint shards:  90%|█████████ | 27/30 [02:27<00:16,  5.34s/it]Loading checkpoint shards:  93%|█████████▎| 28/30 [02:33<00:10,  5.45s/it]Loading checkpoint shards:  97%|█████████▋| 29/30 [02:38<00:05,  5.52s/it]Loading checkpoint shards: 100%|██████████| 30/30 [02:41<00:00,  4.61s/it]Loading checkpoint shards: 100%|██████████| 30/30 [02:41<00:00,  5.37s/it]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
2024-08-04:18:28:46,377 WARNING  [task.py:322] [Task: gsm8k_cot] has_training_docs and has_validation_docs are False, using test_docs as fewshot_docs but this is not recommended.
2024-08-04:18:28:46,378 WARNING  [task.py:322] [Task: gsm8k_cot] has_training_docs and has_validation_docs are False, using test_docs as fewshot_docs but this is not recommended.
2024-08-04:18:28:46,456 INFO     [task.py:395] Building contexts for gsm8k_cot on rank 0...
  0%|          | 0/1319 [00:00<?, ?it/s] 13%|█▎        | 168/1319 [00:00<00:00, 1678.22it/s] 26%|██▌       | 338/1319 [00:00<00:00, 1686.17it/s] 39%|███▊      | 508/1319 [00:00<00:00, 1688.39it/s] 51%|█████▏    | 677/1319 [00:00<00:00, 1688.46it/s] 64%|██████▍   | 847/1319 [00:00<00:00, 1690.20it/s] 77%|███████▋  | 1017/1319 [00:00<00:00, 1690.54it/s] 90%|█████████ | 1188/1319 [00:00<00:00, 1694.22it/s]100%|██████████| 1319/1319 [00:00<00:00, 1692.02it/s]
2024-08-04:18:28:47,261 INFO     [xevaluator.py:395] Running generate_until requests
Running generate_until requests:   0%|          | 0/1319 [00:00<?, ?it/s]Running generate_until requests:   0%|          | 1/1319 [00:55<20:26:55, 55.85s/it]Running generate_until requests:   0%|          | 2/1319 [01:29<15:39:03, 42.78s/it]Running generate_until requests:   0%|          | 3/1319 [01:58<13:20:56, 36.52s/it]Running generate_until requests:   0%|          | 4/1319 [02:42<14:22:29, 39.35s/it]Running generate_until requests:   0%|          | 5/1319 [03:54<18:39:58, 51.14s/it]Running generate_until requests:   0%|          | 6/1319 [04:27<16:27:33, 45.13s/it]Running generate_until requests:   1%|          | 7/1319 [05:05<15:37:21, 42.87s/it]Running generate_until requests:   1%|          | 8/1319 [05:53<16:09:07, 44.35s/it]Running generate_until requests:   1%|          | 9/1319 [06:27<14:55:37, 41.02s/it]Running generate_until requests:   1%|          | 10/1319 [07:00<14:05:05, 38.74s/it]Running generate_until requests:   1%|          | 11/1319 [07:34<13:28:53, 37.11s/it]Running generate_until requests:   1%|          | 12/1319 [08:31<15:38:56, 43.10s/it]Running generate_until requests:   1%|          | 13/1319 [09:04<14:34:27, 40.17s/it]Running generate_until requests:   1%|          | 14/1319 [09:33<13:19:06, 36.74s/it]Running generate_until requests:   1%|          | 15/1319 [10:25<15:01:14, 41.47s/it]Running generate_until requests:   1%|          | 16/1319 [10:54<13:39:53, 37.75s/it]Running generate_until requests:   1%|▏         | 17/1319 [11:46<15:11:54, 42.02s/it]Running generate_until requests:   1%|▏         | 18/1319 [12:29<15:18:38, 42.37s/it]Running generate_until requests:   1%|▏         | 19/1319 [13:36<17:53:09, 49.53s/it]Running generate_until requests:   2%|▏         | 20/1319 [14:09<16:09:08, 44.76s/it]Running generate_until requests:   2%|▏         | 21/1319 [14:48<15:26:01, 42.81s/it]Running generate_until requests:   2%|▏         | 22/1319 [15:17<13:56:16, 38.69s/it]Running generate_until requests:   2%|▏         | 23/1319 [15:46<12:52:32, 35.77s/it]Running generate_until requests:   2%|▏         | 24/1319 [16:38<14:38:24, 40.70s/it]Running generate_until requests:   2%|▏         | 25/1319 [17:11<13:51:51, 38.57s/it]Running generate_until requests:   2%|▏         | 26/1319 [17:31<11:49:26, 32.92s/it]Running generate_until requests:   2%|▏         | 27/1319 [17:55<10:53:24, 30.34s/it]Running generate_until requests:   2%|▏         | 28/1319 [18:24<10:43:51, 29.92s/it]Running generate_until requests:   2%|▏         | 29/1319 [18:49<10:06:40, 28.22s/it]Running generate_until requests:   2%|▏         | 30/1319 [19:13<9:40:53, 27.04s/it] Running generate_until requests:   2%|▏         | 31/1319 [19:33<8:52:46, 24.82s/it]Running generate_until requests:   2%|▏         | 32/1319 [20:11<10:18:34, 28.84s/it]Running generate_until requests:   3%|▎         | 33/1319 [20:50<11:22:22, 31.84s/it]Running generate_until requests:   3%|▎         | 34/1319 [21:28<12:04:15, 33.82s/it]Running generate_until requests:   3%|▎         | 35/1319 [22:11<13:01:02, 36.50s/it]Running generate_until requests:   3%|▎         | 36/1319 [22:49<13:09:50, 36.94s/it]Running generate_until requests:   3%|▎         | 37/1319 [23:31<13:45:38, 38.64s/it]Running generate_until requests:   3%|▎         | 38/1319 [24:05<13:11:12, 37.06s/it]Running generate_until requests:   3%|▎         | 39/1319 [24:47<13:45:28, 38.69s/it]Running generate_until requests:   3%|▎         | 40/1319 [25:39<15:09:06, 42.65s/it]Running generate_until requests:   3%|▎         | 41/1319 [26:36<16:38:21, 46.87s/it]Running generate_until requests:   3%|▎         | 42/1319 [27:00<14:13:24, 40.10s/it]Running generate_until requests:   3%|▎         | 43/1319 [27:38<13:58:12, 39.41s/it]Running generate_until requests:   3%|▎         | 44/1319 [28:11<13:18:07, 37.56s/it]Running generate_until requests:   3%|▎         | 45/1319 [28:35<11:52:13, 33.54s/it]Running generate_until requests:   3%|▎         | 46/1319 [29:00<10:51:42, 30.72s/it]Running generate_until requests:   4%|▎         | 47/1319 [29:33<11:07:04, 31.47s/it]Running generate_until requests:   4%|▎         | 48/1319 [29:52<9:50:50, 27.89s/it] Running generate_until requests:   4%|▎         | 49/1319 [30:35<11:23:26, 32.29s/it]Running generate_until requests:   4%|▍         | 50/1319 [31:13<12:00:39, 34.07s/it]Running generate_until requests:   4%|▍         | 51/1319 [31:42<11:26:48, 32.50s/it]Running generate_until requests:   4%|▍         | 52/1319 [32:11<11:02:33, 31.38s/it]Running generate_until requests:   4%|▍         | 53/1319 [32:53<12:12:21, 34.71s/it]Running generate_until requests:   4%|▍         | 54/1319 [33:17<11:03:51, 31.49s/it]Running generate_until requests:   4%|▍         | 55/1319 [33:42<10:18:34, 29.36s/it]Running generate_until requests:   4%|▍         | 56/1319 [34:01<9:17:53, 26.50s/it] Running generate_until requests:   4%|▍         | 57/1319 [34:21<8:32:33, 24.37s/it]Running generate_until requests:   4%|▍         | 58/1319 [34:59<10:00:37, 28.58s/it]Running generate_until requests:   4%|▍         | 59/1319 [35:23<9:33:01, 27.29s/it] Running generate_until requests:   5%|▍         | 60/1319 [35:48<9:12:47, 26.34s/it]Running generate_until requests:   5%|▍         | 61/1319 [36:21<9:57:32, 28.50s/it]Running generate_until requests:   5%|▍         | 62/1319 [36:55<10:28:36, 30.00s/it]Running generate_until requests:   5%|▍         | 63/1319 [37:47<12:46:15, 36.60s/it]Running generate_until requests:   5%|▍         | 64/1319 [38:15<11:56:31, 34.26s/it]Running generate_until requests:   5%|▍         | 65/1319 [38:55<12:28:37, 35.82s/it]Running generate_until requests:   5%|▌         | 66/1319 [39:54<14:54:31, 42.83s/it]Running generate_until requests:   5%|▌         | 67/1319 [40:15<12:34:33, 36.16s/it]Running generate_until requests:   5%|▌         | 68/1319 [40:44<11:52:16, 34.16s/it]Running generate_until requests:   5%|▌         | 69/1319 [41:27<12:47:21, 36.83s/it]Running generate_until requests:   5%|▌         | 70/1319 [42:14<13:51:04, 39.92s/it]Running generate_until requests:   5%|▌         | 71/1319 [42:52<13:38:40, 39.36s/it]Running generate_until requests:   5%|▌         | 72/1319 [43:16<12:02:20, 34.76s/it]Running generate_until requests:   6%|▌         | 73/1319 [43:36<10:27:48, 30.23s/it]Running generate_until requests:   6%|▌         | 74/1319 [43:56<9:25:02, 27.23s/it] Running generate_until requests:   6%|▌         | 75/1319 [44:30<10:04:31, 29.16s/it]Running generate_until requests:   6%|▌         | 76/1319 [45:19<12:05:21, 35.01s/it]Running generate_until requests:   6%|▌         | 77/1319 [45:49<11:36:37, 33.65s/it]Running generate_until requests:   6%|▌         | 78/1319 [46:15<10:45:44, 31.22s/it]Running generate_until requests:   6%|▌         | 79/1319 [46:44<10:33:23, 30.65s/it]Running generate_until requests:   6%|▌         | 80/1319 [46:59<8:55:41, 25.94s/it] Running generate_until requests:   6%|▌         | 81/1319 [47:37<10:11:24, 29.63s/it]Running generate_until requests:   6%|▌         | 82/1319 [48:15<11:02:27, 32.13s/it]Running generate_until requests:   6%|▋         | 83/1319 [49:07<13:04:05, 38.06s/it]Running generate_until requests:   6%|▋         | 84/1319 [49:40<12:34:08, 36.64s/it]Running generate_until requests:   6%|▋         | 85/1319 [50:23<13:11:05, 38.46s/it]Running generate_until requests:   7%|▋         | 86/1319 [50:56<12:39:14, 36.95s/it]Running generate_until requests:   7%|▋         | 87/1319 [51:25<11:48:58, 34.53s/it]Running generate_until requests:   7%|▋         | 88/1319 [51:50<10:44:37, 31.42s/it]Running generate_until requests:   7%|▋         | 89/1319 [52:23<10:57:41, 32.08s/it]Running generate_until requests:   7%|▋         | 90/1319 [52:47<10:09:11, 29.74s/it]Running generate_until requests:   7%|▋         | 91/1319 [53:21<10:33:15, 30.94s/it]Running generate_until requests:   7%|▋         | 92/1319 [54:09<12:14:16, 35.91s/it]Running generate_until requests:   7%|▋         | 93/1319 [54:42<11:59:25, 35.21s/it]Running generate_until requests:   7%|▋         | 94/1319 [55:06<10:50:37, 31.87s/it]Running generate_until requests:   7%|▋         | 95/1319 [55:49<11:56:11, 35.11s/it]Running generate_until requests:   7%|▋         | 96/1319 [56:10<10:27:06, 30.77s/it]Running generate_until requests:   7%|▋         | 97/1319 [56:53<11:41:39, 34.45s/it]Running generate_until requests:   7%|▋         | 98/1319 [57:26<11:34:49, 34.14s/it]Running generate_until requests:   8%|▊         | 99/1319 [57:50<10:32:38, 31.11s/it]Running generate_until requests:   8%|▊         | 100/1319 [58:28<11:13:29, 33.15s/it]Running generate_until requests:   8%|▊         | 101/1319 [59:06<11:41:55, 34.58s/it]Running generate_until requests:   8%|▊         | 102/1319 [59:39<11:33:31, 34.19s/it]Running generate_until requests:   8%|▊         | 103/1319 [1:00:08<11:01:00, 32.62s/it]Running generate_until requests:   8%|▊         | 104/1319 [1:00:42<11:04:51, 32.83s/it]Running generate_until requests:   8%|▊         | 105/1319 [1:01:34<13:02:12, 38.66s/it]Running generate_until requests:   8%|▊         | 106/1319 [1:02:03<12:03:12, 35.77s/it]Running generate_until requests:   8%|▊         | 107/1319 [1:02:27<10:52:10, 32.29s/it]Running generate_until requests:   8%|▊         | 108/1319 [1:02:56<10:29:05, 31.17s/it]Running generate_until requests:   8%|▊         | 109/1319 [1:03:29<10:41:05, 31.79s/it]Running generate_until requests:   8%|▊         | 110/1319 [1:04:07<11:17:34, 33.63s/it]Running generate_until requests:   8%|▊         | 111/1319 [1:04:31<10:19:48, 30.78s/it]Running generate_until requests:   8%|▊         | 112/1319 [1:05:00<10:11:06, 30.38s/it]Running generate_until requests:   9%|▊         | 113/1319 [1:05:39<10:58:09, 32.74s/it]Running generate_until requests:   9%|▊         | 114/1319 [1:06:12<11:02:25, 32.98s/it]Running generate_until requests:   9%|▊         | 115/1319 [1:06:45<11:03:28, 33.06s/it]Running generate_until requests:   9%|▉         | 116/1319 [1:07:14<10:37:40, 31.80s/it]Running generate_until requests:   9%|▉         | 117/1319 [1:07:48<10:47:07, 32.30s/it]Running generate_until requests:   9%|▉         | 118/1319 [1:08:16<10:23:58, 31.17s/it]Running generate_until requests:   9%|▉         | 119/1319 [1:08:54<11:04:41, 33.23s/it]Running generate_until requests:   9%|▉         | 120/1319 [1:09:23<10:37:05, 31.88s/it]Running generate_until requests:   9%|▉         | 121/1319 [1:09:56<10:45:20, 32.32s/it]Running generate_until requests:   9%|▉         | 122/1319 [1:10:34<11:18:33, 34.01s/it]Running generate_until requests:   9%|▉         | 123/1319 [1:11:08<11:14:46, 33.85s/it]Running generate_until requests:   9%|▉         | 124/1319 [1:11:32<10:16:16, 30.94s/it]Running generate_until requests:   9%|▉         | 125/1319 [1:12:01<10:02:00, 30.25s/it]Running generate_until requests:  10%|▉         | 126/1319 [1:12:20<8:57:14, 27.02s/it] Running generate_until requests:  10%|▉         | 127/1319 [1:12:44<8:38:51, 26.12s/it]Running generate_until requests:  10%|▉         | 128/1319 [1:13:13<8:54:03, 26.91s/it]Running generate_until requests:  10%|▉         | 129/1319 [1:13:46<9:32:12, 28.85s/it]Running generate_until requests:  10%|▉         | 130/1319 [1:14:06<8:37:51, 26.13s/it]Running generate_until requests:  10%|▉         | 131/1319 [1:14:44<9:48:02, 29.70s/it]Running generate_until requests:  10%|█         | 132/1319 [1:15:32<11:34:02, 35.08s/it]Running generate_until requests:  10%|█         | 133/1319 [1:16:10<11:52:14, 36.03s/it]Running generate_until requests:  10%|█         | 134/1319 [1:16:29<10:14:30, 31.11s/it]Running generate_until requests:  10%|█         | 135/1319 [1:17:08<10:55:09, 33.20s/it]Running generate_until requests:  10%|█         | 136/1319 [1:17:32<10:00:50, 30.47s/it]Running generate_until requests:  10%|█         | 137/1319 [1:18:10<10:45:55, 32.79s/it]Running generate_until requests:  10%|█         | 138/1319 [1:18:29<9:26:59, 28.81s/it] Running generate_until requests:  11%|█         | 139/1319 [1:19:07<10:20:29, 31.55s/it]Running generate_until requests:  11%|█         | 140/1319 [1:19:50<11:27:21, 34.98s/it]Running generate_until requests:  11%|█         | 141/1319 [1:20:14<10:21:19, 31.65s/it]Running generate_until requests:  11%|█         | 142/1319 [1:21:01<11:52:33, 36.32s/it]Running generate_until requests:  11%|█         | 143/1319 [1:21:44<12:27:49, 38.15s/it]Running generate_until requests:  11%|█         | 144/1319 [1:22:26<12:52:37, 39.45s/it]Running generate_until requests:  11%|█         | 145/1319 [1:23:00<12:15:46, 37.60s/it]Running generate_until requests:  11%|█         | 146/1319 [1:23:38<12:17:25, 37.72s/it]Running generate_until requests:  11%|█         | 147/1319 [1:24:16<12:18:58, 37.83s/it]Running generate_until requests:  11%|█         | 148/1319 [1:24:40<10:57:56, 33.71s/it]Running generate_until requests:  11%|█▏        | 149/1319 [1:25:36<13:10:06, 40.52s/it]