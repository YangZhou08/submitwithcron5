Already on 'yangexppp'
wandb: Currently logged in as: stevenzhou0816100. Use `wandb login --relogin` to force relogin
2024-08-06:13:25:34,023 INFO     [main.py:288] Verbosity set to INFO
2024-08-06:13:25:43,639 WARNING  [main.py:303]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2024-08-06:13:25:43,640 INFO     [main.py:378] Selected Tasks: ['mmlu_flan_cot_fewshot']
2024-08-06:13:25:43,674 INFO     [xevaluator.py:137] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2024-08-06:13:25:43,674 INFO     [xevaluator.py:184] Initializing xhf model, with arguments: {'pretrained': 'meta-llama/Meta-Llama-3-70B-Instruct', 'cats': True, 'check': False, 'contextlength': 1500, 'kernel_size': 16, 'thr': 0.05}
2024-08-06:13:25:43,684 INFO     [xhuggingface.py:177] Using device 'cuda'
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:05<02:45,  5.70s/it]Loading checkpoint shards:   7%|▋         | 2/30 [00:11<02:40,  5.75s/it]Loading checkpoint shards:  10%|█         | 3/30 [00:17<02:39,  5.91s/it]Loading checkpoint shards:  13%|█▎        | 4/30 [00:23<02:32,  5.87s/it]Loading checkpoint shards:  17%|█▋        | 5/30 [00:28<02:22,  5.69s/it]Loading checkpoint shards:  20%|██        | 6/30 [00:34<02:14,  5.61s/it]Loading checkpoint shards:  23%|██▎       | 7/30 [00:39<02:06,  5.51s/it]Loading checkpoint shards:  27%|██▋       | 8/30 [00:45<02:04,  5.64s/it]Loading checkpoint shards:  30%|███       | 9/30 [00:51<01:59,  5.70s/it]Loading checkpoint shards:  33%|███▎      | 10/30 [00:56<01:51,  5.59s/it]Loading checkpoint shards:  37%|███▋      | 11/30 [01:02<01:45,  5.56s/it]Loading checkpoint shards:  40%|████      | 12/30 [01:07<01:38,  5.49s/it]Loading checkpoint shards:  43%|████▎     | 13/30 [01:14<01:40,  5.93s/it]Loading checkpoint shards:  47%|████▋     | 14/30 [01:20<01:35,  6.00s/it]Loading checkpoint shards:  50%|█████     | 15/30 [01:26<01:31,  6.11s/it]Loading checkpoint shards:  53%|█████▎    | 16/30 [01:33<01:27,  6.23s/it]Loading checkpoint shards:  57%|█████▋    | 17/30 [01:38<01:17,  5.99s/it]Loading checkpoint shards:  60%|██████    | 18/30 [01:45<01:12,  6.07s/it]Loading checkpoint shards:  63%|██████▎   | 19/30 [01:51<01:08,  6.26s/it]Loading checkpoint shards:  67%|██████▋   | 20/30 [01:57<01:00,  6.02s/it]Loading checkpoint shards:  70%|███████   | 21/30 [02:02<00:52,  5.83s/it]Loading checkpoint shards:  73%|███████▎  | 22/30 [02:08<00:45,  5.72s/it]Loading checkpoint shards:  77%|███████▋  | 23/30 [02:14<00:41,  5.93s/it]Loading checkpoint shards:  80%|████████  | 24/30 [02:20<00:34,  5.83s/it]Loading checkpoint shards:  83%|████████▎ | 25/30 [02:26<00:29,  5.85s/it]Loading checkpoint shards:  87%|████████▋ | 26/30 [02:31<00:22,  5.74s/it]Loading checkpoint shards:  90%|█████████ | 27/30 [02:37<00:17,  5.72s/it]Loading checkpoint shards:  93%|█████████▎| 28/30 [02:43<00:11,  5.87s/it]Loading checkpoint shards:  97%|█████████▋| 29/30 [02:49<00:05,  5.90s/it]Loading checkpoint shards: 100%|██████████| 30/30 [02:52<00:00,  4.97s/it]Loading checkpoint shards: 100%|██████████| 30/30 [02:52<00:00,  5.74s/it]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
2024-08-06:13:35:33,490 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_prehistory on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 589.29it/s]
2024-08-06:13:35:33,507 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_logical_fallacies on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 517.08it/s]
2024-08-06:13:35:33,515 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_us_history on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 377.24it/s]
2024-08-06:13:35:33,527 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_international_law on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 566.59it/s]
2024-08-06:13:35:33,535 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_professional_law on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 466.67it/s]
2024-08-06:13:35:33,545 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_moral_disputes on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 573.21it/s]
2024-08-06:13:35:33,552 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_jurisprudence on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 539.10it/s]
2024-08-06:13:35:33,560 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_world_history on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 476.68it/s]
2024-08-06:13:35:33,570 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_moral_scenarios on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 593.74it/s]
2024-08-06:13:35:33,577 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_philosophy on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 612.20it/s]
2024-08-06:13:35:33,584 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_formal_logic on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 529.97it/s]
2024-08-06:13:35:33,592 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_world_religions on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 640.87it/s]
2024-08-06:13:35:33,599 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_european_history on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 344.08it/s]
2024-08-06:13:35:33,613 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_human_sexuality on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 626.23it/s]
2024-08-06:13:35:33,620 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_econometrics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 516.92it/s]
2024-08-06:13:35:33,628 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_macroeconomics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 605.48it/s]
2024-08-06:13:35:33,636 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_geography on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 614.28it/s]
2024-08-06:13:35:33,643 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_security_studies on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 503.85it/s]
2024-08-06:13:35:33,652 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_psychology on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 583.82it/s]
2024-08-06:13:35:33,659 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_microeconomics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 594.66it/s]
2024-08-06:13:35:33,666 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_government_and_politics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 587.38it/s]
2024-08-06:13:35:33,674 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_professional_psychology on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 557.79it/s]
2024-08-06:13:35:33,682 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_public_relations on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 599.38it/s]
2024-08-06:13:35:33,689 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_us_foreign_policy on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 604.13it/s]
2024-08-06:13:35:33,696 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_sociology on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 593.53it/s]
2024-08-06:13:35:33,704 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_global_facts on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 485.55it/s]
2024-08-06:13:35:33,713 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_professional_medicine on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 515.16it/s]
2024-08-06:13:35:33,721 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_business_ethics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 529.33it/s]
2024-08-06:13:35:33,729 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_medicine on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 536.27it/s]
2024-08-06:13:35:33,738 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_management on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 621.36it/s]
2024-08-06:13:35:33,745 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_human_aging on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 609.37it/s]
2024-08-06:13:35:33,752 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_marketing on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 585.02it/s]
2024-08-06:13:35:33,759 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_nutrition on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 544.87it/s]
2024-08-06:13:35:33,767 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_virology on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 565.27it/s]
2024-08-06:13:35:33,775 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_professional_accounting on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 555.39it/s]
2024-08-06:13:35:33,783 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_miscellaneous on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 545.53it/s]
2024-08-06:13:35:33,791 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_medical_genetics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 578.17it/s]
2024-08-06:13:35:33,798 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_clinical_knowledge on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 584.27it/s]
2024-08-06:13:35:33,806 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_mathematics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 504.55it/s]
2024-08-06:13:35:33,814 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_elementary_mathematics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 503.99it/s]
2024-08-06:13:35:33,823 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_statistics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 492.68it/s]
2024-08-06:13:35:33,832 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_astronomy on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 493.26it/s]
2024-08-06:13:35:33,841 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_electrical_engineering on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 378.55it/s]
2024-08-06:13:35:33,852 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_abstract_algebra on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 605.33it/s]
2024-08-06:13:35:33,860 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_machine_learning on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 501.86it/s]
2024-08-06:13:35:33,868 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_computer_science on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 502.96it/s]
2024-08-06:13:35:33,877 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_biology on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 546.04it/s]
2024-08-06:13:35:33,885 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_anatomy on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 535.76it/s]
2024-08-06:13:35:33,893 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_physics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 543.16it/s]
2024-08-06:13:35:33,901 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_computer_science on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 502.03it/s]
2024-08-06:13:35:33,909 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_conceptual_physics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 596.46it/s]
2024-08-06:13:35:33,917 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_mathematics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 603.58it/s]
2024-08-06:13:35:33,924 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_computer_security on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 602.52it/s]
2024-08-06:13:35:33,931 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_chemistry on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 584.47it/s]
2024-08-06:13:35:33,939 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_physics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 598.03it/s]
2024-08-06:13:35:33,946 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_chemistry on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 584.90it/s]
2024-08-06:13:35:33,953 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_biology on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 535.09it/s]
2024-08-06:13:35:33,961 INFO     [xevaluator.py:395] Running generate_until requests
Running generate_until requests:   0%|          | 0/228 [00:00<?, ?it/s]Running generate_until requests:   0%|          | 1/228 [01:31<5:47:32, 91.86s/it]Running generate_until requests:   1%|          | 2/228 [02:59<5:36:45, 89.41s/it]Running generate_until requests:   1%|▏         | 3/228 [04:26<5:31:45, 88.47s/it]Running generate_until requests:   2%|▏         | 4/228 [05:29<4:51:59, 78.21s/it]Running generate_until requests:   2%|▏         | 5/228 [06:55<5:01:40, 81.17s/it]Running generate_until requests:   3%|▎         | 6/228 [08:22<5:07:00, 82.98s/it]