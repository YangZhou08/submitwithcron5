Already on 'addinggriffin'
wandb: Currently logged in as: stevenzhou0816100. Use `wandb login --relogin` to force relogin
The following values were not passed to `accelerate launch` and had defaults used instead:
		More than one GPU was found, enabling multi-GPU training.
		If this was unintended please pass in `--num_processes=1`.
	`--mixed_precision` was set to a value of `'no'`
	`--dynamo_backend` was set to a value of `'no'`
To avoid this warning pass in values for each of the problematic parameters or run `accelerate config`.
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:14<00:44, 14.84s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:15<00:46, 15.63s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:16<00:48, 16.25s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:15<00:46, 15.58s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:15<00:46, 15.61s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:15<00:46, 15.61s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:15<00:46, 15.45s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:15<00:46, 15.59s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:30<00:30, 15.08s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:31<00:31, 15.85s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:31<00:31, 15.66s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:31<00:31, 15.81s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:31<00:31, 15.66s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:31<00:31, 15.59s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:31<00:31, 15.65s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:31<00:31, 15.67s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:45<00:15, 15.10s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:46<00:15, 15.74s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:46<00:15, 15.80s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:46<00:15, 15.66s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:47<00:15, 15.86s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:47<00:15, 15.70s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:47<00:15, 15.69s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:47<00:15, 15.77s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:47<00:00,  9.99s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:47<00:00, 11.97s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:48<00:00, 10.07s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:48<00:00, 12.10s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:48<00:00, 10.10s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:48<00:00, 12.14s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:49<00:00, 10.21s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:49<00:00, 12.31s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:48<00:00, 10.11s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:48<00:00, 12.14s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:48<00:00, 10.21s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:48<00:00, 12.15s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:48<00:00, 10.18s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:48<00:00, 12.16s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:48<00:00, 10.24s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:48<00:00, 12.24s/it]
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:403: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:403: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:403: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:403: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:403: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:403: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:403: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:403: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
  3%|▎         | 1/32 [00:34<17:59, 34.84s/it]  3%|▎         | 1/32 [00:38<19:49, 38.36s/it]  3%|▎         | 1/32 [00:38<20:05, 38.90s/it]  3%|▎         | 1/32 [00:41<21:26, 41.49s/it]  3%|▎         | 1/32 [00:44<22:58, 44.47s/it]  3%|▎         | 1/32 [00:46<24:05, 46.62s/it]  3%|▎         | 1/32 [00:56<29:23, 56.89s/it]  3%|▎         | 1/32 [00:58<30:23, 58.84s/it]  6%|▋         | 2/32 [01:09<17:19, 34.64s/it]  6%|▋         | 2/32 [01:12<17:47, 35.59s/it]  6%|▋         | 2/32 [01:16<19:03, 38.12s/it]  6%|▋         | 2/32 [01:18<19:33, 39.11s/it]  6%|▋         | 2/32 [01:30<22:22, 44.75s/it]  6%|▋         | 2/32 [01:32<23:16, 46.55s/it]  9%|▉         | 3/32 [01:43<16:37, 34.38s/it]  9%|▉         | 3/32 [01:48<17:25, 36.07s/it]  9%|▉         | 3/32 [01:51<17:48, 36.86s/it]  9%|▉         | 3/32 [01:53<17:51, 36.94s/it]  6%|▋         | 2/32 [02:04<31:25, 62.86s/it]  6%|▋         | 2/32 [02:07<32:32, 65.09s/it]  9%|▉         | 3/32 [02:11<20:43, 42.89s/it]  9%|▉         | 3/32 [02:14<21:39, 44.83s/it] 12%|█▎        | 4/32 [02:18<16:09, 34.62s/it] 12%|█▎        | 4/32 [02:26<17:08, 36.74s/it] 12%|█▎        | 4/32 [02:28<17:09, 36.76s/it] 12%|█▎        | 4/32 [02:30<17:20, 37.17s/it] 12%|█▎        | 4/32 [02:44<18:16, 39.15s/it] 16%|█▌        | 5/32 [02:51<15:19, 34.05s/it] 16%|█▌        | 5/32 [02:59<16:00, 35.56s/it] 12%|█▎        | 4/32 [03:01<21:09, 45.33s/it] 16%|█▌        | 5/32 [03:01<15:52, 35.26s/it]  9%|▉         | 3/32 [03:03<29:27, 60.95s/it] 16%|█▌        | 5/32 [03:08<16:47, 37.30s/it] 16%|█▌        | 5/32 [03:17<16:40, 37.05s/it]  9%|▉         | 3/32 [03:18<32:44, 67.75s/it] 19%|█▉        | 6/32 [03:26<14:55, 34.43s/it] 19%|█▉        | 6/32 [03:33<14:51, 34.29s/it] 19%|█▉        | 6/32 [03:34<15:17, 35.28s/it] 16%|█▌        | 5/32 [03:45<20:17, 45.10s/it] 19%|█▉        | 6/32 [03:45<16:11, 37.35s/it] 19%|█▉        | 6/32 [03:55<16:08, 37.24s/it] 12%|█▎        | 4/32 [03:58<27:25, 58.77s/it] 22%|██▏       | 7/32 [03:59<14:08, 33.94s/it] 22%|██▏       | 7/32 [04:05<14:02, 33.70s/it] 22%|██▏       | 7/32 [04:09<14:37, 35.11s/it] 12%|█▎        | 4/32 [04:14<29:21, 62.90s/it] 22%|██▏       | 7/32 [04:21<15:17, 36.70s/it] 22%|██▏       | 7/32 [04:30<15:17, 36.69s/it] 25%|██▌       | 8/32 [04:32<13:29, 33.72s/it] 19%|█▉        | 6/32 [04:33<19:55, 45.97s/it] 25%|██▌       | 8/32 [04:44<14:06, 35.28s/it] 25%|██▌       | 8/32 [04:45<14:07, 35.29s/it] 16%|█▌        | 5/32 [04:57<26:24, 58.70s/it] 25%|██▌       | 8/32 [05:04<15:28, 38.68s/it] 28%|██▊       | 9/32 [05:09<13:13, 34.51s/it] 25%|██▌       | 8/32 [05:10<15:04, 37.70s/it] 16%|█▌        | 5/32 [05:11<27:23, 60.87s/it] 22%|██▏       | 7/32 [05:15<18:39, 44.77s/it] 28%|██▊       | 9/32 [05:19<13:26, 35.07s/it] 28%|██▊       | 9/32 [05:22<13:50, 36.10s/it] 31%|███▏      | 10/32 [05:43<12:36, 34.37s/it] 28%|██▊       | 9/32 [05:44<15:03, 39.28s/it] 28%|██▊       | 9/32 [05:50<14:41, 38.33s/it] 31%|███▏      | 10/32 [05:53<12:47, 34.88s/it] 19%|█▉        | 6/32 [05:55<25:26, 58.69s/it] 31%|███▏      | 10/32 [05:56<12:56, 35.27s/it] 25%|██▌       | 8/32 [05:57<17:33, 43.90s/it] 19%|█▉        | 6/32 [06:17<27:06, 62.56s/it] 34%|███▍      | 11/32 [06:17<11:59, 34.27s/it] 31%|███▏      | 10/32 [06:18<13:50, 37.75s/it] 34%|███▍      | 11/32 [06:27<12:04, 34.48s/it] 34%|███▍      | 11/32 [06:31<12:22, 35.34s/it] 31%|███▏      | 10/32 [06:32<14:26, 39.37s/it] 28%|██▊       | 9/32 [06:49<17:43, 46.25s/it] 22%|██▏       | 7/32 [06:54<24:27, 58.72s/it] 34%|███▍      | 11/32 [06:57<13:17, 37.96s/it] 38%|███▊      | 12/32 [07:00<11:24, 34.23s/it] 38%|███▊      | 12/32 [07:01<12:26, 37.32s/it] 38%|███▊      | 12/32 [07:07<11:47, 35.35s/it] 34%|███▍      | 11/32 [07:07<13:19, 38.07s/it] 22%|██▏       | 7/32 [07:12<25:04, 60.17s/it] 38%|███▊      | 12/32 [07:30<12:10, 36.54s/it] 31%|███▏      | 10/32 [07:32<16:38, 45.37s/it] 41%|████      | 13/32 [07:35<11:30, 36.37s/it] 41%|████      | 13/32 [07:36<10:56, 34.58s/it] 41%|████      | 13/32 [07:41<11:02, 34.89s/it] 38%|███▊      | 12/32 [07:49<13:03, 39.18s/it] 25%|██▌       | 8/32 [07:55<23:43, 59.30s/it] 41%|████      | 13/32 [08:05<11:21, 35.89s/it] 44%|████▍     | 14/32 [08:10<10:46, 35.90s/it] 44%|████▍     | 14/32 [08:13<10:39, 35.51s/it] 25%|██▌       | 8/32 [08:15<24:23, 60.99s/it] 34%|███▍      | 11/32 [08:16<15:42, 44.89s/it] 44%|████▍     | 14/32 [08:16<10:33, 35.20s/it] 41%|████      | 13/32 [08:24<12:04, 38.12s/it] 44%|████▍     | 14/32 [08:43<11:00, 36.69s/it] 47%|████▋     | 15/32 [08:45<10:06, 35.68s/it] 47%|████▋     | 15/32 [08:47<09:52, 34.88s/it] 28%|██▊       | 9/32 [08:55<22:52, 59.69s/it] 47%|████▋     | 15/32 [08:56<10:20, 36.49s/it] 44%|████▍     | 14/32 [09:00<11:11, 37.31s/it] 38%|███▊      | 12/32 [09:08<15:44, 47.23s/it] 28%|██▊       | 9/32 [09:10<22:42, 59.24s/it] 47%|████▋     | 15/32 [09:18<10:12, 36.02s/it] 50%|█████     | 16/32 [09:22<09:17, 34.81s/it] 50%|█████     | 16/32 [09:25<09:49, 36.83s/it] 50%|█████     | 16/32 [09:30<09:30, 35.64s/it] 47%|████▋     | 15/32 [09:37<10:36, 37.43s/it] 31%|███▏      | 10/32 [09:52<21:35, 58.87s/it] 41%|████      | 13/32 [09:53<14:42, 46.45s/it] 50%|█████     | 16/32 [09:55<09:43, 36.48s/it] 53%|█████▎    | 17/32 [09:55<08:35, 34.40s/it] 53%|█████▎    | 17/32 [10:03<08:45, 35.03s/it] 53%|█████▎    | 17/32 [10:04<09:24, 37.62s/it] 31%|███▏      | 10/32 [10:11<21:53, 59.70s/it] 50%|█████     | 16/32 [10:11<09:40, 36.25s/it] 56%|█████▋    | 18/32 [10:31<08:08, 34.89s/it] 53%|█████▎    | 17/32 [10:35<09:21, 37.45s/it] 44%|████▍     | 14/32 [10:41<14:02, 46.80s/it] 56%|█████▋    | 18/32 [10:42<08:46, 37.60s/it] 56%|█████▋    | 18/32 [10:42<08:26, 36.16s/it] 53%|█████▎    | 17/32 [10:46<09:00, 36.00s/it] 34%|███▍      | 11/32 [10:55<20:58, 59.94s/it] 59%|█████▉    | 19/32 [11:10<07:49, 36.09s/it] 56%|█████▋    | 18/32 [11:11<08:39, 37.14s/it] 34%|███▍      | 11/32 [11:11<20:59, 59.99s/it] 59%|█████▉    | 19/32 [11:16<07:56, 36.62s/it] 59%|█████▉    | 19/32 [11:21<08:00, 36.96s/it] 56%|█████▋    | 18/32 [11:22<08:21, 35.79s/it] 47%|████▋     | 15/32 [11:24<12:58, 45.80s/it] 59%|█████▉    | 19/32 [11:46<07:51, 36.30s/it] 62%|██████▎   | 20/32 [11:46<07:11, 35.95s/it] 38%|███▊      | 12/32 [11:50<19:28, 58.44s/it] 62%|██████▎   | 20/32 [11:54<07:10, 35.88s/it] 62%|██████▎   | 20/32 [11:54<07:25, 37.17s/it] 59%|█████▉    | 19/32 [11:55<07:34, 34.97s/it] 38%|███▊      | 12/32 [12:12<20:03, 60.16s/it] 62%|██████▎   | 20/32 [12:19<07:05, 35.43s/it] 50%|█████     | 16/32 [12:23<13:17, 49.83s/it] 66%|██████▌   | 21/32 [12:24<06:44, 36.79s/it] 66%|██████▌   | 21/32 [12:28<06:36, 36.01s/it] 62%|██████▎   | 20/32 [12:29<06:56, 34.74s/it] 66%|██████▌   | 21/32 [12:34<06:47, 37.06s/it] 41%|████      | 13/32 [12:48<18:32, 58.54s/it] 66%|██████▌   | 21/32 [12:54<06:29, 35.40s/it] 69%|██████▉   | 22/32 [13:00<06:04, 36.46s/it] 69%|██████▉   | 22/32 [13:04<06:01, 36.10s/it] 66%|██████▌   | 21/32 [13:08<06:38, 36.19s/it] 69%|██████▉   | 22/32 [13:13<06:15, 37.54s/it] 41%|████      | 13/32 [13:14<19:15, 60.81s/it] 53%|█████▎    | 17/32 [13:21<13:04, 52.27s/it] 69%|██████▉   | 22/32 [13:34<06:06, 36.66s/it] 72%|███████▏  | 23/32 [13:36<05:26, 36.26s/it] 72%|███████▏  | 23/32 [13:39<05:22, 35.88s/it] 44%|████▍     | 14/32 [13:44<17:16, 57.56s/it] 72%|███████▏  | 23/32 [13:47<05:29, 36.65s/it] 69%|██████▉   | 22/32 [13:51<06:21, 38.17s/it] 72%|███████▏  | 23/32 [14:08<05:23, 35.94s/it] 44%|████▍     | 14/32 [14:10<17:44, 59.15s/it] 75%|███████▌  | 24/32 [14:13<04:40, 35.07s/it] 75%|███████▌  | 24/32 [14:13<04:53, 36.70s/it] 56%|█████▋    | 18/32 [14:17<12:24, 53.20s/it] 75%|███████▌  | 24/32 [14:22<04:47, 36.00s/it] 72%|███████▏  | 23/32 [14:30<05:45, 38.37s/it] 75%|███████▌  | 24/32 [14:42<04:41, 35.18s/it] 47%|████▋     | 15/32 [14:42<16:24, 57.90s/it] 78%|███████▊  | 25/32 [14:46<04:08, 35.46s/it] 78%|███████▊  | 25/32 [14:48<04:06, 35.17s/it] 78%|███████▊  | 25/32 [14:57<04:11, 35.90s/it] 47%|████▋     | 15/32 [15:05<16:26, 58.01s/it] 59%|█████▉    | 19/32 [15:07<11:19, 52.29s/it] 75%|███████▌  | 24/32 [15:08<05:05, 38.13s/it] 81%|████████▏ | 26/32 [15:25<03:38, 36.40s/it] 78%|███████▊  | 25/32 [15:27<04:28, 38.35s/it] 81%|████████▏ | 26/32 [15:31<03:44, 37.41s/it] 81%|████████▏ | 26/32 [15:34<03:36, 36.16s/it] 50%|█████     | 16/32 [15:38<15:14, 57.16s/it] 78%|███████▊  | 25/32 [15:46<04:28, 38.31s/it] 62%|██████▎   | 20/32 [15:54<10:09, 50.80s/it] 81%|████████▏ | 26/32 [16:00<03:40, 36.76s/it] 50%|█████     | 16/32 [16:01<15:16, 57.30s/it] 84%|████████▍ | 27/32 [16:01<03:02, 36.46s/it] 84%|████████▍ | 27/32 [16:06<03:03, 36.79s/it] 84%|████████▍ | 27/32 [16:09<02:58, 35.69s/it] 81%|████████▏ | 26/32 [16:27<03:54, 39.06s/it] 53%|█████▎    | 17/32 [16:33<14:09, 56.61s/it] 84%|████████▍ | 27/32 [16:36<03:01, 36.36s/it] 88%|████████▊ | 28/32 [16:36<02:23, 35.88s/it] 66%|██████▌   | 21/32 [16:40<09:03, 49.45s/it] 88%|████████▊ | 28/32 [16:41<02:25, 36.40s/it] 88%|████████▊ | 28/32 [16:44<02:22, 35.63s/it] 53%|█████▎    | 17/32 [17:03<14:42, 58.84s/it] 84%|████████▍ | 27/32 [17:05<03:13, 38.61s/it] 88%|████████▊ | 28/32 [17:13<02:26, 36.68s/it] 91%|█████████ | 29/32 [17:18<01:49, 36.37s/it] 91%|█████████ | 29/32 [17:19<01:46, 35.35s/it] 69%|██████▉   | 22/32 [17:29<08:12, 49.23s/it] 91%|█████████ | 29/32 [17:35<02:08, 42.87s/it] 56%|█████▋    | 18/32 [17:37<13:43, 58.83s/it] 88%|████████▊ | 28/32 [17:44<02:34, 38.68s/it] 91%|█████████ | 29/32 [17:49<01:48, 36.32s/it] 94%|█████████▍| 30/32 [17:53<01:12, 36.06s/it] 56%|█████▋    | 18/32 [17:59<13:29, 57.83s/it] 94%|█████████▍| 30/32 [18:02<01:15, 37.58s/it] 94%|█████████▍| 30/32 [18:09<01:20, 40.14s/it] 72%|███████▏  | 23/32 [18:11<07:03, 47.08s/it] 91%|█████████ | 29/32 [18:21<01:54, 38.16s/it] 94%|█████████▍| 30/32 [18:27<01:13, 37.00s/it] 97%|█████████▋| 31/32 [18:31<00:36, 36.53s/it] 59%|█████▉    | 19/32 [18:33<12:31, 57.84s/it] 97%|█████████▋| 31/32 [18:36<00:36, 36.68s/it] 97%|█████████▋| 31/32 [18:48<00:40, 40.01s/it] 94%|█████████▍| 30/32 [18:54<01:13, 36.80s/it] 59%|█████▉    | 19/32 [18:58<12:36, 58.18s/it] 78%|███████▊  | 25/32 [19:00<04:16, 36.59s/it] 97%|█████████▋| 31/32 [19:03<00:36, 36.49s/it]100%|██████████| 32/32 [19:06<00:00, 36.16s/it]100%|██████████| 32/32 [19:06<00:00, 35.83s/it]
100%|██████████| 32/32 [19:16<00:00, 37.57s/it]100%|██████████| 32/32 [19:16<00:00, 36.14s/it]
 62%|██████▎   | 20/32 [19:28<11:25, 57.12s/it] 97%|█████████▋| 31/32 [19:31<00:36, 36.69s/it]100%|██████████| 32/32 [19:33<00:00, 41.36s/it]100%|██████████| 32/32 [19:33<00:00, 36.67s/it]
100%|██████████| 32/32 [19:37<00:00, 35.84s/it]100%|██████████| 32/32 [19:37<00:00, 36.80s/it]
 81%|████████▏ | 26/32 [19:42<03:47, 37.93s/it] 62%|██████▎   | 20/32 [20:02<12:00, 60.01s/it]100%|██████████| 32/32 [20:06<00:00, 36.26s/it]100%|██████████| 32/32 [20:06<00:00, 37.70s/it]
 84%|████████▍ | 27/32 [20:25<03:16, 39.27s/it] 66%|██████▌   | 21/32 [20:30<10:45, 58.66s/it] 66%|██████▌   | 21/32 [20:57<10:44, 58.58s/it] 88%|████████▊ | 28/32 [21:10<02:42, 40.69s/it] 69%|██████▉   | 22/32 [21:28<09:42, 58.21s/it] 91%|█████████ | 29/32 [21:57<02:07, 42.48s/it] 69%|██████▉   | 22/32 [22:00<09:57, 59.77s/it] 72%|███████▏  | 23/32 [22:23<08:36, 57.40s/it] 94%|█████████▍| 30/32 [22:45<01:28, 44.10s/it] 72%|███████▏  | 23/32 [23:04<09:09, 61.06s/it] 75%|███████▌  | 24/32 [23:27<07:55, 59.42s/it] 97%|█████████▋| 31/32 [23:29<00:44, 44.19s/it] 75%|███████▌  | 24/32 [24:05<08:08, 61.01s/it]100%|██████████| 32/32 [24:12<00:00, 43.88s/it]100%|██████████| 32/32 [24:12<00:00, 45.40s/it]
 78%|███████▊  | 25/32 [24:26<06:54, 59.25s/it] 78%|███████▊  | 25/32 [25:05<07:06, 60.90s/it] 81%|████████▏ | 26/32 [25:25<05:54, 59.10s/it] 81%|████████▏ | 26/32 [26:18<06:27, 64.50s/it] 84%|████████▍ | 27/32 [26:23<04:54, 58.96s/it] 88%|████████▊ | 28/32 [27:19<03:51, 57.83s/it] 84%|████████▍ | 27/32 [27:19<05:16, 63.40s/it] 88%|████████▊ | 28/32 [28:16<04:05, 61.49s/it] 91%|█████████ | 29/32 [28:19<02:56, 58.68s/it][rank1]:[E ProcessGroupNCCL.cpp:523] [Rank 1] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=53, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600954 milliseconds before timing out.
[rank1]:[E ProcessGroupNCCL.cpp:537] Some NCCL operations have failed or timed out. Due to the asynchronous nature of CUDA kernels, subsequent GPU operations might run on corrupted/incomplete data.
[rank1]:[E ProcessGroupNCCL.cpp:543] To avoid data inconsistency, we are taking the entire process down.
[rank1]:[E ProcessGroupNCCL.cpp:1182] [Rank 1] NCCL watchdog thread terminated with exception: [Rank 1] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=53, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600954 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:525 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7fcd9a72dd87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x1e6 (0x7fcd9b8d56e6 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::workCleanupLoop() + 0x19d (0x7fcd9b8d8c3d in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x119 (0x7fcd9b8d9839 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd6df4 (0x7fcde55ecdf4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #5: <unknown function> + 0x8609 (0x7fcde69db609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #6: clone + 0x43 (0x7fcde67a6353 in /lib/x86_64-linux-gnu/libc.so.6)

terminate called after throwing an instance of 'c10::DistBackendError'
  what():  [Rank 1] NCCL watchdog thread terminated with exception: [Rank 1] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=53, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600954 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:525 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7fcd9a72dd87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x1e6 (0x7fcd9b8d56e6 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::workCleanupLoop() + 0x19d (0x7fcd9b8d8c3d in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x119 (0x7fcd9b8d9839 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd6df4 (0x7fcde55ecdf4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #5: <unknown function> + 0x8609 (0x7fcde69db609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #6: clone + 0x43 (0x7fcde67a6353 in /lib/x86_64-linux-gnu/libc.so.6)

Exception raised from ncclCommWatchdog at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:1186 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7fcd9a72dd87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0xdf6b11 (0x7fcd9b62fb11 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: <unknown function> + 0xd6df4 (0x7fcde55ecdf4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #3: <unknown function> + 0x8609 (0x7fcde69db609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #4: clone + 0x43 (0x7fcde67a6353 in /lib/x86_64-linux-gnu/libc.so.6)

 94%|█████████▍| 30/32 [29:16<01:56, 58.19s/it] 94%|█████████▍| 30/32 [29:17<01:34, 47.13s/it][rank4]:[E ProcessGroupNCCL.cpp:523] [Rank 4] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=53, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600979 milliseconds before timing out.
[rank2]:[E ProcessGroupNCCL.cpp:523] [Rank 2] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=54, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 618327 milliseconds before timing out.
[rank0]:[E ProcessGroupNCCL.cpp:523] [Rank 0] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=53, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600281 milliseconds before timing out.
[rank4]:[E ProcessGroupNCCL.cpp:537] Some NCCL operations have failed or timed out. Due to the asynchronous nature of CUDA kernels, subsequent GPU operations might run on corrupted/incomplete data.
[rank4]:[E ProcessGroupNCCL.cpp:543] To avoid data inconsistency, we are taking the entire process down.
[rank4]:[E ProcessGroupNCCL.cpp:1182] [Rank 4] NCCL watchdog thread terminated with exception: [Rank 4] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=53, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600979 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:525 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7fafc7382d87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x1e6 (0x7fafc852a6e6 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::workCleanupLoop() + 0x19d (0x7fafc852dc3d in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x119 (0x7fafc852e839 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd6df4 (0x7fb012241df4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #5: <unknown function> + 0x8609 (0x7fb013630609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #6: clone + 0x43 (0x7fb0133fb353 in /lib/x86_64-linux-gnu/libc.so.6)

terminate called after throwing an instance of 'c10::DistBackendError'
  what():  [Rank 4] NCCL watchdog thread terminated with exception: [Rank 4] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=53, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600979 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:525 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7fafc7382d87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x1e6 (0x7fafc852a6e6 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::workCleanupLoop() + 0x19d (0x7fafc852dc3d in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x119 (0x7fafc852e839 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd6df4 (0x7fb012241df4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #5: <unknown function> + 0x8609 (0x7fb013630609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #6: clone + 0x43 (0x7fb0133fb353 in /lib/x86_64-linux-gnu/libc.so.6)

Exception raised from ncclCommWatchdog at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:1186 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7fafc7382d87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0xdf6b11 (0x7fafc8284b11 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: <unknown function> + 0xd6df4 (0x7fb012241df4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #3: <unknown function> + 0x8609 (0x7fb013630609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #4: clone + 0x43 (0x7fb0133fb353 in /lib/x86_64-linux-gnu/libc.so.6)

[rank2]:[E ProcessGroupNCCL.cpp:537] Some NCCL operations have failed or timed out. Due to the asynchronous nature of CUDA kernels, subsequent GPU operations might run on corrupted/incomplete data.
[rank2]:[E ProcessGroupNCCL.cpp:543] To avoid data inconsistency, we are taking the entire process down.
[rank2]:[E ProcessGroupNCCL.cpp:1182] [Rank 2] NCCL watchdog thread terminated with exception: [Rank 2] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=54, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 618327 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:525 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7fe1405f7d87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x1e6 (0x7fe14179f6e6 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::workCleanupLoop() + 0x19d (0x7fe1417a2c3d in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x119 (0x7fe1417a3839 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd6df4 (0x7fe18b4b6df4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #5: <unknown function> + 0x8609 (0x7fe18c8a5609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #6: clone + 0x43 (0x7fe18c670353 in /lib/x86_64-linux-gnu/libc.so.6)

terminate called after throwing an instance of 'c10::DistBackendError'
  what():  [Rank 2] NCCL watchdog thread terminated with exception: [Rank 2] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=54, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 618327 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:525 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7fe1405f7d87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x1e6 (0x7fe14179f6e6 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::workCleanupLoop() + 0x19d (0x7fe1417a2c3d in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x119 (0x7fe1417a3839 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd6df4 (0x7fe18b4b6df4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #5: <unknown function> + 0x8609 (0x7fe18c8a5609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #6: clone + 0x43 (0x7fe18c670353 in /lib/x86_64-linux-gnu/libc.so.6)

Exception raised from ncclCommWatchdog at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:1186 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7fe1405f7d87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0xdf6b11 (0x7fe1414f9b11 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: <unknown function> + 0xd6df4 (0x7fe18b4b6df4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #3: <unknown function> + 0x8609 (0x7fe18c8a5609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #4: clone + 0x43 (0x7fe18c670353 in /lib/x86_64-linux-gnu/libc.so.6)

[rank0]:[E ProcessGroupNCCL.cpp:537] Some NCCL operations have failed or timed out. Due to the asynchronous nature of CUDA kernels, subsequent GPU operations might run on corrupted/incomplete data.
[rank0]:[E ProcessGroupNCCL.cpp:543] To avoid data inconsistency, we are taking the entire process down.
[rank0]:[E ProcessGroupNCCL.cpp:1182] [Rank 0] NCCL watchdog thread terminated with exception: [Rank 0] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=53, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600281 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:525 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7f029d2f7d87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x1e6 (0x7f029e49f6e6 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::workCleanupLoop() + 0x19d (0x7f029e4a2c3d in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x119 (0x7f029e4a3839 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd6df4 (0x7f02e81b6df4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #5: <unknown function> + 0x8609 (0x7f02e95a5609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #6: clone + 0x43 (0x7f02e9370353 in /lib/x86_64-linux-gnu/libc.so.6)

terminate called after throwing an instance of 'c10::DistBackendError'
  what():  [Rank 0] NCCL watchdog thread terminated with exception: [Rank 0] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=53, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600281 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:525 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7f029d2f7d87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x1e6 (0x7f029e49f6e6 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::workCleanupLoop() + 0x19d (0x7f029e4a2c3d in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x119 (0x7f029e4a3839 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd6df4 (0x7f02e81b6df4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #5: <unknown function> + 0x8609 (0x7f02e95a5609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #6: clone + 0x43 (0x7f02e9370353 in /lib/x86_64-linux-gnu/libc.so.6)

Exception raised from ncclCommWatchdog at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:1186 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7f029d2f7d87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0xdf6b11 (0x7f029e1f9b11 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: <unknown function> + 0xd6df4 (0x7f02e81b6df4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #3: <unknown function> + 0x8609 (0x7f02e95a5609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #4: clone + 0x43 (0x7f02e9370353 in /lib/x86_64-linux-gnu/libc.so.6)

[2024-07-09 16:26:34,408] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 3136925 closing signal SIGTERM
[2024-07-09 16:26:34,410] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 3136926 closing signal SIGTERM
[2024-07-09 16:26:34,411] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 3136928 closing signal SIGTERM
[2024-07-09 16:26:34,411] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 3136930 closing signal SIGTERM
[2024-07-09 16:26:34,411] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 3136931 closing signal SIGTERM
[2024-07-09 16:26:34,411] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 3136932 closing signal SIGTERM
[2024-07-09 16:26:35,741] torch.distributed.elastic.multiprocessing.api: [ERROR] failed (exitcode: -6) local_rank: 2 (pid: 3136927) of binary: /fsx-storygen/beidic/anaconda3/envs/griffin/bin/python3.9
Traceback (most recent call last):
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/bin/accelerate", line 8, in <module>
    sys.exit(main())
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/accelerate/commands/accelerate_cli.py", line 47, in main
    args.func(args)
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/accelerate/commands/launch.py", line 985, in launch_command
    multi_gpu_launcher(args)
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/accelerate/commands/launch.py", line 654, in multi_gpu_launcher
    distrib_run.run(args)
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/distributed/run.py", line 803, in run
    elastic_launch(
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 135, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 268, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
========================================================
main.py FAILED
--------------------------------------------------------
Failures:
[1]:
  time      : 2024-07-09_16:26:34
  host      : a100-st-p4de24xlarge-44.fair-a100.hpcaas
  rank      : 4 (local_rank: 4)
  exitcode  : -6 (pid: 3136929)
  error_file: <N/A>
  traceback : Signal 6 (SIGABRT) received by PID 3136929
--------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-09_16:26:34
  host      : a100-st-p4de24xlarge-44.fair-a100.hpcaas
  rank      : 2 (local_rank: 2)
  exitcode  : -6 (pid: 3136927)
  error_file: <N/A>
  traceback : Signal 6 (SIGABRT) received by PID 3136927
========================================================
