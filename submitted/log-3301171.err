Already on 'addinggriffin'
wandb: Currently logged in as: stevenzhou0816100. Use `wandb login --relogin` to force relogin
The following values were not passed to `accelerate launch` and had defaults used instead:
		More than one GPU was found, enabling multi-GPU training.
		If this was unintended please pass in `--num_processes=1`.
	`--mixed_precision` was set to a value of `'no'`
	`--dynamo_backend` was set to a value of `'no'`
To avoid this warning pass in values for each of the problematic parameters or run `accelerate config`.
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:57<00:57, 57.79s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:58<00:58, 58.45s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:58<00:58, 58.35s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:58<00:58, 58.80s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:58<00:58, 58.40s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:58<00:58, 58.32s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:58<00:58, 58.35s/it]Loading checkpoint shards:  50%|█████     | 1/2 [00:58<00:58, 58.40s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:15<00:00, 33.93s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:15<00:00, 37.51s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [01:15<00:00, 33.95s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:15<00:00, 37.62s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [01:15<00:00, 33.93s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:15<00:00, 37.59s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [01:15<00:00, 33.96s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:15<00:00, 37.62s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [01:15<00:00, 33.94s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:15<00:00, 37.60s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [01:15<00:00, 34.15s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:15<00:00, 37.84s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [01:15<00:00, 34.01s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:15<00:00, 37.67s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [01:15<00:00, 33.97s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:15<00:00, 37.64s/it]
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:403: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:403: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:403: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:403: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:403: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:403: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:403: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:403: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
  3%|▎         | 1/32 [00:43<22:18, 43.19s/it]  3%|▎         | 1/32 [00:43<22:27, 43.47s/it]  3%|▎         | 1/32 [00:43<22:38, 43.81s/it]  3%|▎         | 1/32 [00:44<22:59, 44.50s/it]  3%|▎         | 1/32 [00:46<23:50, 46.14s/it]  3%|▎         | 1/32 [00:59<30:51, 59.73s/it]  3%|▎         | 1/32 [01:05<33:49, 65.48s/it]  3%|▎         | 1/32 [01:06<34:08, 66.09s/it]  6%|▋         | 2/32 [01:24<20:58, 41.94s/it]  6%|▋         | 2/32 [01:27<21:41, 43.39s/it]  6%|▋         | 2/32 [01:27<22:01, 44.04s/it]  6%|▋         | 2/32 [01:29<22:20, 44.68s/it]  6%|▋         | 2/32 [01:32<23:14, 46.48s/it]  6%|▋         | 2/32 [01:55<28:40, 57.35s/it]  6%|▋         | 2/32 [02:09<32:19, 64.65s/it]  9%|▉         | 3/32 [02:11<21:20, 44.15s/it]  9%|▉         | 3/32 [02:11<21:07, 43.70s/it]  6%|▋         | 2/32 [02:11<32:52, 65.75s/it]  9%|▉         | 3/32 [02:11<21:17, 44.04s/it]  9%|▉         | 3/32 [02:12<21:28, 44.44s/it]  9%|▉         | 3/32 [02:13<21:10, 43.82s/it]  9%|▉         | 3/32 [02:40<25:05, 51.91s/it] 12%|█▎        | 4/32 [02:54<20:12, 43.30s/it] 12%|█▎        | 4/32 [02:55<20:11, 43.26s/it] 12%|█▎        | 4/32 [02:56<20:46, 44.54s/it] 12%|█▎        | 4/32 [02:56<20:35, 44.12s/it] 12%|█▎        | 4/32 [02:56<20:43, 44.40s/it]  9%|▉         | 3/32 [03:10<30:17, 62.66s/it]  9%|▉         | 3/32 [03:18<32:00, 66.21s/it] 12%|█▎        | 4/32 [03:23<22:29, 48.20s/it] 16%|█▌        | 5/32 [03:37<19:09, 42.58s/it] 16%|█▌        | 5/32 [03:38<19:36, 43.57s/it] 16%|█▌        | 5/32 [03:40<19:51, 44.11s/it] 16%|█▌        | 5/32 [03:40<20:04, 44.60s/it] 16%|█▌        | 5/32 [03:41<20:04, 44.61s/it] 16%|█▌        | 5/32 [04:06<20:50, 46.33s/it] 12%|█▎        | 4/32 [04:13<29:25, 63.04s/it] 12%|█▎        | 4/32 [04:21<30:17, 64.91s/it] 19%|█▉        | 6/32 [04:22<18:53, 43.58s/it] 19%|█▉        | 6/32 [04:23<18:53, 43.59s/it] 19%|█▉        | 6/32 [04:24<19:18, 44.56s/it] 19%|█▉        | 6/32 [04:25<19:12, 44.31s/it] 19%|█▉        | 6/32 [04:25<19:23, 44.76s/it] 19%|█▉        | 6/32 [04:50<19:42, 45.47s/it] 22%|██▏       | 7/32 [05:04<17:56, 43.04s/it] 22%|██▏       | 7/32 [05:05<17:58, 43.16s/it] 22%|██▏       | 7/32 [05:08<18:20, 44.03s/it] 22%|██▏       | 7/32 [05:09<18:23, 44.16s/it] 22%|██▏       | 7/32 [05:13<19:03, 45.74s/it] 16%|█▌        | 5/32 [05:15<28:11, 62.65s/it] 16%|█▌        | 5/32 [05:25<29:08, 64.75s/it] 22%|██▏       | 7/32 [05:36<19:07, 45.88s/it] 25%|██▌       | 8/32 [05:46<17:02, 42.59s/it] 25%|██▌       | 8/32 [05:49<17:13, 43.08s/it] 25%|██▌       | 8/32 [05:51<17:44, 44.35s/it] 25%|██▌       | 8/32 [05:53<17:40, 44.17s/it] 25%|██▌       | 8/32 [06:05<19:08, 47.85s/it] 19%|█▉        | 6/32 [06:15<26:47, 61.83s/it] 25%|██▌       | 8/32 [06:26<18:53, 47.22s/it] 28%|██▊       | 9/32 [06:30<16:27, 42.93s/it] 19%|█▉        | 6/32 [06:31<28:17, 65.30s/it] 28%|██▊       | 9/32 [06:35<16:53, 44.06s/it] 28%|██▊       | 9/32 [06:37<17:05, 44.59s/it] 28%|██▊       | 9/32 [06:37<16:53, 44.08s/it] 28%|██▊       | 9/32 [07:04<19:39, 51.28s/it] 28%|██▊       | 9/32 [07:11<17:50, 46.52s/it] 31%|███▏      | 10/32 [07:12<15:40, 42.75s/it] 31%|███▏      | 10/32 [07:16<15:47, 43.06s/it] 22%|██▏       | 7/32 [07:17<25:45, 61.80s/it] 31%|███▏      | 10/32 [07:20<16:14, 44.31s/it] 31%|███▏      | 10/32 [07:21<16:11, 44.15s/it] 22%|██▏       | 7/32 [07:32<26:34, 63.79s/it] 31%|███▏      | 10/32 [07:54<16:38, 45.38s/it] 34%|███▍      | 11/32 [07:55<14:55, 42.66s/it] 34%|███▍      | 11/32 [08:00<15:10, 43.36s/it] 31%|███▏      | 10/32 [08:01<19:28, 53.11s/it] 34%|███▍      | 11/32 [08:02<15:06, 43.15s/it] 34%|███▍      | 11/32 [08:03<15:18, 43.75s/it] 25%|██▌       | 8/32 [08:21<24:58, 62.42s/it] 25%|██▌       | 8/32 [08:34<25:18, 63.28s/it] 34%|███▍      | 11/32 [08:37<15:37, 44.62s/it] 38%|███▊      | 12/32 [08:39<14:23, 43.17s/it] 38%|███▊      | 12/32 [08:41<14:13, 42.68s/it] 38%|███▊      | 12/32 [08:44<14:20, 43.00s/it] 38%|███▊      | 12/32 [08:44<14:17, 42.89s/it] 34%|███▍      | 11/32 [08:54<18:33, 53.01s/it] 38%|███▊      | 12/32 [09:21<14:45, 44.30s/it] 41%|████      | 13/32 [09:22<13:37, 43.03s/it] 28%|██▊       | 9/32 [09:25<24:05, 62.85s/it] 41%|████      | 13/32 [09:27<13:46, 43.48s/it] 41%|████      | 13/32 [09:27<13:30, 42.65s/it] 41%|████      | 13/32 [09:29<13:47, 43.58s/it] 28%|██▊       | 9/32 [09:43<24:52, 64.89s/it] 38%|███▊      | 12/32 [09:46<17:36, 52.85s/it] 41%|████      | 13/32 [10:02<13:45, 43.46s/it] 44%|████▍     | 14/32 [10:09<13:17, 44.29s/it] 44%|████▍     | 14/32 [10:10<12:52, 42.90s/it] 44%|████▍     | 14/32 [10:12<13:14, 44.16s/it] 44%|████▍     | 14/32 [10:13<13:07, 43.74s/it] 31%|███▏      | 10/32 [10:26<22:54, 62.46s/it] 41%|████      | 13/32 [10:38<16:38, 52.57s/it] 31%|███▏      | 10/32 [10:43<23:18, 63.57s/it] 44%|████▍     | 14/32 [10:50<13:25, 44.75s/it] 47%|████▋     | 15/32 [10:53<12:06, 42.72s/it] 47%|████▋     | 15/32 [10:54<12:08, 42.85s/it] 47%|████▋     | 15/32 [10:54<12:18, 43.43s/it] 47%|████▋     | 15/32 [10:54<12:38, 44.61s/it] 44%|████▍     | 14/32 [11:29<15:39, 52.19s/it] 34%|███▍      | 11/32 [11:29<21:56, 62.70s/it] 50%|█████     | 16/32 [11:35<11:17, 42.35s/it] 50%|█████     | 16/32 [11:36<11:38, 43.67s/it] 50%|█████     | 16/32 [11:37<11:29, 43.12s/it] 47%|████▋     | 15/32 [11:37<12:50, 45.33s/it] 50%|█████     | 16/32 [11:38<11:36, 43.54s/it] 34%|███▍      | 11/32 [11:43<21:52, 62.51s/it] 53%|█████▎    | 17/32 [12:17<10:42, 42.87s/it] 53%|█████▎    | 17/32 [12:18<10:38, 42.55s/it] 53%|█████▎    | 17/32 [12:19<10:42, 42.81s/it] 53%|█████▎    | 17/32 [12:20<10:48, 43.23s/it] 47%|████▋     | 15/32 [12:22<14:49, 52.31s/it] 50%|█████     | 16/32 [12:25<12:19, 46.25s/it] 38%|███▊      | 12/32 [12:39<21:33, 64.69s/it] 38%|███▊      | 12/32 [12:46<20:48, 62.45s/it] 56%|█████▋    | 18/32 [13:00<09:55, 42.56s/it] 56%|█████▋    | 18/32 [13:01<09:56, 42.57s/it] 56%|█████▋    | 18/32 [13:02<09:59, 42.84s/it] 56%|█████▋    | 18/32 [13:02<10:10, 43.59s/it] 53%|█████▎    | 17/32 [13:13<11:41, 46.80s/it] 50%|█████     | 16/32 [13:15<13:59, 52.49s/it] 41%|████      | 13/32 [13:41<20:15, 63.95s/it] 59%|█████▉    | 19/32 [13:44<09:14, 42.65s/it] 59%|█████▉    | 19/32 [13:44<09:21, 43.17s/it] 59%|█████▉    | 19/32 [13:45<09:18, 42.93s/it] 59%|█████▉    | 19/32 [13:47<09:27, 43.68s/it] 41%|████      | 13/32 [13:54<20:18, 64.13s/it] 56%|█████▋    | 18/32 [13:58<10:45, 46.09s/it] 53%|█████▎    | 17/32 [14:09<13:15, 53.01s/it] 62%|██████▎   | 20/32 [14:26<08:31, 42.64s/it] 62%|██████▎   | 20/32 [14:26<08:29, 42.50s/it] 62%|██████▎   | 20/32 [14:29<08:38, 43.22s/it] 62%|██████▎   | 20/32 [14:30<08:43, 43.66s/it] 44%|████▍     | 14/32 [14:43<18:58, 63.26s/it] 59%|█████▉    | 19/32 [14:43<09:55, 45.83s/it] 44%|████▍     | 14/32 [14:58<19:15, 64.22s/it] 56%|█████▋    | 18/32 [15:01<12:19, 52.81s/it] 66%|██████▌   | 21/32 [15:09<07:50, 42.76s/it] 66%|██████▌   | 21/32 [15:09<07:47, 42.48s/it] 66%|██████▌   | 21/32 [15:13<07:56, 43.32s/it] 66%|██████▌   | 21/32 [15:14<08:01, 43.76s/it] 62%|██████▎   | 20/32 [15:26<09:01, 45.11s/it] 47%|████▋     | 15/32 [15:45<17:49, 62.91s/it] 69%|██████▉   | 22/32 [15:50<07:03, 42.32s/it] 69%|██████▉   | 22/32 [15:51<07:04, 42.43s/it] 69%|██████▉   | 22/32 [15:55<07:10, 43.03s/it] 59%|█████▉    | 19/32 [15:56<11:32, 53.28s/it] 69%|██████▉   | 22/32 [15:58<07:17, 43.77s/it] 47%|████▋     | 15/32 [15:59<17:52, 63.11s/it] 66%|██████▌   | 21/32 [16:12<08:16, 45.17s/it] 72%|███████▏  | 23/32 [16:31<06:17, 41.98s/it] 72%|███████▏  | 23/32 [16:33<06:20, 42.30s/it] 72%|███████▏  | 23/32 [16:41<06:33, 43.74s/it] 72%|███████▏  | 23/32 [16:42<06:37, 44.17s/it] 50%|█████     | 16/32 [16:46<16:40, 62.54s/it] 62%|██████▎   | 20/32 [16:50<10:41, 53.48s/it] 69%|██████▉   | 22/32 [16:53<07:20, 44.08s/it] 50%|█████     | 16/32 [17:07<17:15, 64.70s/it] 78%|███████▊  | 25/32 [17:15<03:47, 32.49s/it] 75%|███████▌  | 24/32 [17:15<05:40, 42.61s/it] 75%|███████▌  | 24/32 [17:25<05:51, 43.92s/it] 75%|███████▌  | 24/32 [17:27<05:54, 44.30s/it] 72%|███████▏  | 23/32 [17:35<06:29, 43.29s/it] 66%|██████▌   | 21/32 [17:39<09:33, 52.11s/it] 53%|█████▎    | 17/32 [17:49<15:36, 62.44s/it] 81%|████████▏ | 26/32 [17:56<03:28, 34.70s/it] 78%|███████▊  | 25/32 [17:58<04:59, 42.76s/it] 78%|███████▊  | 25/32 [18:09<05:06, 43.74s/it] 53%|█████▎    | 17/32 [18:10<16:01, 64.10s/it] 78%|███████▊  | 25/32 [18:12<05:11, 44.44s/it] 75%|███████▌  | 24/32 [18:17<05:44, 43.02s/it] 69%|██████▉   | 22/32 [18:20<08:08, 48.81s/it] 84%|████████▍ | 27/32 [18:40<03:04, 36.96s/it] 81%|████████▏ | 26/32 [18:41<04:16, 42.79s/it] 56%|█████▋    | 18/32 [18:51<14:32, 62.31s/it] 81%|████████▏ | 26/32 [18:52<04:20, 43.36s/it] 81%|████████▏ | 26/32 [18:53<04:23, 43.96s/it] 78%|███████▊  | 25/32 [19:01<05:03, 43.32s/it] 72%|███████▏  | 23/32 [19:02<07:01, 46.86s/it] 56%|█████▋    | 18/32 [19:12<14:51, 63.66s/it] 84%|████████▍ | 27/32 [19:24<03:33, 42.70s/it] 88%|████████▊ | 28/32 [19:24<02:35, 38.87s/it] 84%|████████▍ | 27/32 [19:38<03:39, 43.97s/it] 84%|████████▍ | 27/32 [19:38<03:41, 44.35s/it] 75%|███████▌  | 24/32 [19:43<06:00, 45.05s/it] 81%|████████▏ | 26/32 [19:45<04:20, 43.50s/it] 59%|█████▉    | 19/32 [19:56<13:43, 63.35s/it] 88%|████████▊ | 28/32 [20:05<02:49, 42.38s/it] 91%|█████████ | 29/32 [20:07<01:59, 39.98s/it] 59%|█████▉    | 19/32 [20:17<13:51, 63.93s/it] 88%|████████▊ | 28/32 [20:19<02:51, 42.99s/it] 88%|████████▊ | 28/32 [20:19<02:53, 43.30s/it] 78%|███████▊  | 25/32 [20:30<05:18, 45.52s/it] 84%|████████▍ | 27/32 [20:31<03:42, 44.42s/it] 91%|█████████ | 29/32 [20:46<02:05, 41.95s/it] 94%|█████████▍| 30/32 [20:50<01:21, 40.99s/it] 62%|██████▎   | 20/32 [21:00<12:40, 63.41s/it] 94%|█████████▍| 30/32 [21:01<01:06, 33.03s/it] 91%|█████████ | 29/32 [21:02<02:09, 43.08s/it] 81%|████████▏ | 26/32 [21:15<04:32, 45.45s/it] 88%|████████▊ | 28/32 [21:17<02:58, 44.70s/it] 62%|██████▎   | 20/32 [21:25<13:02, 65.19s/it] 94%|█████████▍| 30/32 [21:30<01:25, 42.55s/it] 97%|█████████▋| 31/32 [21:31<00:40, 40.98s/it] 97%|█████████▋| 31/32 [21:46<00:35, 35.97s/it] 94%|█████████▍| 30/32 [21:48<01:27, 43.96s/it] 84%|████████▍ | 27/32 [21:58<03:44, 44.82s/it] 91%|█████████ | 29/32 [22:02<02:14, 44.90s/it] 66%|██████▌   | 21/32 [22:08<11:51, 64.70s/it] 97%|█████████▋| 31/32 [22:13<00:42, 42.62s/it]100%|██████████| 32/32 [22:13<00:00, 41.34s/it]100%|██████████| 32/32 [22:13<00:00, 41.68s/it]
100%|██████████| 32/32 [22:29<00:00, 37.68s/it]100%|██████████| 32/32 [22:29<00:00, 42.16s/it]
 97%|█████████▋| 31/32 [22:31<00:43, 43.76s/it] 66%|██████▌   | 21/32 [22:31<12:00, 65.53s/it] 88%|████████▊ | 28/32 [22:40<02:55, 43.78s/it] 94%|█████████▍| 30/32 [22:46<01:29, 44.64s/it]100%|██████████| 32/32 [22:56<00:00, 42.83s/it]100%|██████████| 32/32 [22:56<00:00, 43.03s/it]
100%|██████████| 32/32 [23:12<00:00, 42.85s/it]100%|██████████| 32/32 [23:12<00:00, 43.51s/it]
 69%|██████▉   | 22/32 [23:13<10:49, 64.96s/it] 91%|█████████ | 29/32 [23:23<02:11, 43.70s/it] 97%|█████████▋| 31/32 [23:30<00:44, 44.40s/it] 69%|██████▉   | 22/32 [23:37<10:54, 65.42s/it] 94%|█████████▍| 30/32 [24:09<01:28, 44.37s/it]100%|██████████| 32/32 [24:14<00:00, 44.31s/it]100%|██████████| 32/32 [24:14<00:00, 45.46s/it]
 72%|███████▏  | 23/32 [24:20<09:49, 65.51s/it] 72%|███████▏  | 23/32 [24:42<09:49, 65.52s/it] 97%|█████████▋| 31/32 [24:56<00:45, 45.14s/it] 75%|███████▌  | 24/32 [25:23<08:39, 64.90s/it]100%|██████████| 32/32 [25:40<00:00, 44.94s/it]100%|██████████| 32/32 [25:40<00:00, 48.15s/it]
 75%|███████▌  | 24/32 [25:43<08:32, 64.01s/it] 78%|███████▊  | 25/32 [26:31<07:39, 65.61s/it] 78%|███████▊  | 25/32 [26:47<07:28, 64.14s/it] 81%|████████▏ | 26/32 [27:33<06:26, 64.48s/it] 81%|████████▏ | 26/32 [27:53<06:27, 64.66s/it] 84%|████████▍ | 27/32 [28:36<05:21, 64.28s/it] 84%|████████▍ | 27/32 [28:57<05:22, 64.53s/it] 88%|████████▊ | 28/32 [29:39<04:14, 63.67s/it] 88%|████████▊ | 28/32 [30:07<04:23, 65.98s/it] 91%|█████████ | 29/32 [30:43<03:11, 63.81s/it] 91%|█████████ | 29/32 [31:11<03:16, 65.40s/it] 94%|█████████▍| 30/32 [31:45<02:06, 63.33s/it][rank6]:[E ProcessGroupNCCL.cpp:523] [Rank 6] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=48, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600592 milliseconds before timing out.
 94%|█████████▍| 30/32 [32:15<02:10, 65.06s/it][rank6]:[E ProcessGroupNCCL.cpp:537] Some NCCL operations have failed or timed out. Due to the asynchronous nature of CUDA kernels, subsequent GPU operations might run on corrupted/incomplete data.
[rank6]:[E ProcessGroupNCCL.cpp:543] To avoid data inconsistency, we are taking the entire process down.
[rank6]:[E ProcessGroupNCCL.cpp:1182] [Rank 6] NCCL watchdog thread terminated with exception: [Rank 6] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=48, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600592 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:525 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7f966fba8d87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x1e6 (0x7f9670d506e6 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::workCleanupLoop() + 0x19d (0x7f9670d53c3d in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x119 (0x7f9670d54839 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd6df4 (0x7f96baa67df4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #5: <unknown function> + 0x8609 (0x7f96bbe56609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #6: clone + 0x43 (0x7f96bbc21353 in /lib/x86_64-linux-gnu/libc.so.6)

terminate called after throwing an instance of 'c10::DistBackendError'
  what():  [Rank 6] NCCL watchdog thread terminated with exception: [Rank 6] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=48, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600592 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:525 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7f966fba8d87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x1e6 (0x7f9670d506e6 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::workCleanupLoop() + 0x19d (0x7f9670d53c3d in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x119 (0x7f9670d54839 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd6df4 (0x7f96baa67df4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #5: <unknown function> + 0x8609 (0x7f96bbe56609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #6: clone + 0x43 (0x7f96bbc21353 in /lib/x86_64-linux-gnu/libc.so.6)

Exception raised from ncclCommWatchdog at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:1186 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7f966fba8d87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0xdf6b11 (0x7f9670aaab11 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: <unknown function> + 0xd6df4 (0x7f96baa67df4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #3: <unknown function> + 0x8609 (0x7f96bbe56609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #4: clone + 0x43 (0x7f96bbc21353 in /lib/x86_64-linux-gnu/libc.so.6)

[2024-07-09 20:39:46,181] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 3245098 closing signal SIGTERM
[2024-07-09 20:39:46,183] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 3245099 closing signal SIGTERM
[2024-07-09 20:39:46,183] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 3245100 closing signal SIGTERM
[2024-07-09 20:39:46,183] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 3245101 closing signal SIGTERM
[2024-07-09 20:39:46,183] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 3245102 closing signal SIGTERM
[2024-07-09 20:39:46,183] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 3245103 closing signal SIGTERM
[2024-07-09 20:39:46,184] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 3245105 closing signal SIGTERM
[2024-07-09 20:39:47,964] torch.distributed.elastic.multiprocessing.api: [ERROR] failed (exitcode: -6) local_rank: 6 (pid: 3245104) of binary: /fsx-storygen/beidic/anaconda3/envs/griffin/bin/python3.9
Traceback (most recent call last):
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/bin/accelerate", line 8, in <module>
    sys.exit(main())
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/accelerate/commands/accelerate_cli.py", line 47, in main
    args.func(args)
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/accelerate/commands/launch.py", line 985, in launch_command
    multi_gpu_launcher(args)
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/accelerate/commands/launch.py", line 654, in multi_gpu_launcher
    distrib_run.run(args)
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/distributed/run.py", line 803, in run
    elastic_launch(
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 135, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 268, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
========================================================
main.py FAILED
--------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
--------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-09_20:39:46
  host      : a100-st-p4de24xlarge-32.fair-a100.hpcaas
  rank      : 6 (local_rank: 6)
  exitcode  : -6 (pid: 3245104)
  error_file: <N/A>
  traceback : Signal 6 (SIGABRT) received by PID 3245104
========================================================
