fatal: Unable to create '/fsx-storygen/beidic/yang/GRIFFIN2/.git/index.lock': File exists.

Another git process seems to be running in this repository, e.g.
an editor opened by 'git commit'. Please make sure all processes
are terminated then try again. If it still fails, a git process
may have crashed in this repository earlier:
remove the file manually to continue.
warning: fetch updated the current branch head.
fast-forwarding your working tree from
commit a216c7a67cc1c51b849479add86bb8ff3c71d62a.
error: Your local changes to the following files would be overwritten by merge:
	debugging1.sh
Please commit your changes or stash them before you merge.
Aborting
fatal: Cannot fast-forward your working tree.
After making sure that you saved anything precious from
$ git diff a216c7a67cc1c51b849479add86bb8ff3c71d62a
output, run
$ git reset --hard
to recover.
wandb: Currently logged in as: stevenzhou0816100. Use `wandb login --relogin` to force relogin
The following values were not passed to `accelerate launch` and had defaults used instead:
		More than one GPU was found, enabling multi-GPU training.
		If this was unintended please pass in `--num_processes=1`.
	`--mixed_precision` was set to a value of `'no'`
	`--dynamo_backend` was set to a value of `'no'`
To avoid this warning pass in values for each of the problematic parameters or run `accelerate config`.
2024-07-06:21:00:46,233 INFO     [main.py:288] Verbosity set to INFO
2024-07-06:21:00:46,233 INFO     [main.py:288] Verbosity set to INFO
2024-07-06:21:00:46,234 INFO     [main.py:288] Verbosity set to INFO
2024-07-06:21:00:46,237 INFO     [main.py:288] Verbosity set to INFO
2024-07-06:21:00:46,240 INFO     [main.py:288] Verbosity set to INFO
2024-07-06:21:00:46,254 INFO     [main.py:288] Verbosity set to INFO
2024-07-06:21:00:46,259 INFO     [main.py:288] Verbosity set to INFO
2024-07-06:21:00:46,272 INFO     [main.py:288] Verbosity set to INFO
2024-07-06:21:00:55,453 INFO     [main.py:378] Selected Tasks: ['gsm8k']
2024-07-06:21:00:55,453 INFO     [main.py:378] Selected Tasks: ['gsm8k']
2024-07-06:21:00:55,454 INFO     [main.py:378] Selected Tasks: ['gsm8k']
2024-07-06:21:00:55,454 INFO     [main.py:378] Selected Tasks: ['gsm8k']
2024-07-06:21:00:55,454 INFO     [main.py:378] Selected Tasks: ['gsm8k']
2024-07-06:21:00:55,454 INFO     [main.py:378] Selected Tasks: ['gsm8k']
2024-07-06:21:00:55,454 INFO     [main.py:378] Selected Tasks: ['gsm8k']
2024-07-06:21:00:55,454 INFO     [main.py:378] Selected Tasks: ['gsm8k']
2024-07-06:21:00:55,478 INFO     [xevaluator.py:137] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2024-07-06:21:00:55,478 INFO     [xevaluator.py:137] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2024-07-06:21:00:55,478 INFO     [xevaluator.py:137] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2024-07-06:21:00:55,478 INFO     [xevaluator.py:137] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2024-07-06:21:00:55,478 INFO     [xevaluator.py:137] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2024-07-06:21:00:55,478 INFO     [xevaluator.py:137] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2024-07-06:21:00:55,478 INFO     [xevaluator.py:184] Initializing xhf model, with arguments: {'pretrained': 'meta-llama/Llama-2-13b-chat-hf', 'widthtree': 6, 'cats': True, 'check': True, 'kernel_size': 16, 'spr': 0.5, 'thr': 0.1, 'patternstrict': True}
2024-07-06:21:00:55,478 INFO     [xevaluator.py:137] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2024-07-06:21:00:55,478 INFO     [xevaluator.py:137] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2024-07-06:21:00:55,478 INFO     [xevaluator.py:184] Initializing xhf model, with arguments: {'pretrained': 'meta-llama/Llama-2-13b-chat-hf', 'widthtree': 6, 'cats': True, 'check': True, 'kernel_size': 16, 'spr': 0.5, 'thr': 0.1, 'patternstrict': True}
2024-07-06:21:00:55,478 INFO     [xevaluator.py:184] Initializing xhf model, with arguments: {'pretrained': 'meta-llama/Llama-2-13b-chat-hf', 'widthtree': 6, 'cats': True, 'check': True, 'kernel_size': 16, 'spr': 0.5, 'thr': 0.1, 'patternstrict': True}
2024-07-06:21:00:55,478 INFO     [xevaluator.py:184] Initializing xhf model, with arguments: {'pretrained': 'meta-llama/Llama-2-13b-chat-hf', 'widthtree': 6, 'cats': True, 'check': True, 'kernel_size': 16, 'spr': 0.5, 'thr': 0.1, 'patternstrict': True}
2024-07-06:21:00:55,478 INFO     [xevaluator.py:184] Initializing xhf model, with arguments: {'pretrained': 'meta-llama/Llama-2-13b-chat-hf', 'widthtree': 6, 'cats': True, 'check': True, 'kernel_size': 16, 'spr': 0.5, 'thr': 0.1, 'patternstrict': True}
2024-07-06:21:00:55,478 INFO     [xevaluator.py:184] Initializing xhf model, with arguments: {'pretrained': 'meta-llama/Llama-2-13b-chat-hf', 'widthtree': 6, 'cats': True, 'check': True, 'kernel_size': 16, 'spr': 0.5, 'thr': 0.1, 'patternstrict': True}
2024-07-06:21:00:55,478 INFO     [xevaluator.py:184] Initializing xhf model, with arguments: {'pretrained': 'meta-llama/Llama-2-13b-chat-hf', 'widthtree': 6, 'cats': True, 'check': True, 'kernel_size': 16, 'spr': 0.5, 'thr': 0.1, 'patternstrict': True}
2024-07-06:21:00:55,478 INFO     [xevaluator.py:184] Initializing xhf model, with arguments: {'pretrained': 'meta-llama/Llama-2-13b-chat-hf', 'widthtree': 6, 'cats': True, 'check': True, 'kernel_size': 16, 'spr': 0.5, 'thr': 0.1, 'patternstrict': True}
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:26<00:52, 26.13s/it]Loading checkpoint shards:  33%|███▎      | 1/3 [00:28<00:56, 28.22s/it]Loading checkpoint shards:  33%|███▎      | 1/3 [00:28<00:56, 28.05s/it]Loading checkpoint shards:  33%|███▎      | 1/3 [00:27<00:55, 27.96s/it]Loading checkpoint shards:  33%|███▎      | 1/3 [00:27<00:55, 27.91s/it]Loading checkpoint shards:  33%|███▎      | 1/3 [00:28<00:56, 28.04s/it]Loading checkpoint shards:  33%|███▎      | 1/3 [00:28<00:56, 28.15s/it]Loading checkpoint shards:  33%|███▎      | 1/3 [00:28<00:56, 28.19s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:52<00:26, 26.24s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:55<00:27, 27.80s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:55<00:27, 27.91s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:55<00:27, 27.84s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:55<00:27, 27.82s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:55<00:27, 27.85s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:56<00:28, 28.55s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:55<00:27, 27.89s/it]Loading checkpoint shards: 100%|██████████| 3/3 [01:08<00:00, 20.96s/it]Loading checkpoint shards: 100%|██████████| 3/3 [01:08<00:00, 22.82s/it]
Loading checkpoint shards: 100%|██████████| 3/3 [01:10<00:00, 21.86s/it]Loading checkpoint shards: 100%|██████████| 3/3 [01:10<00:00, 23.50s/it]
Loading checkpoint shards: 100%|██████████| 3/3 [01:10<00:00, 22.20s/it]Loading checkpoint shards: 100%|██████████| 3/3 [01:10<00:00, 23.46s/it]
Loading checkpoint shards: 100%|██████████| 3/3 [01:11<00:00, 22.24s/it]Loading checkpoint shards: 100%|██████████| 3/3 [01:10<00:00, 21.87s/it]Loading checkpoint shards: 100%|██████████| 3/3 [01:11<00:00, 23.70s/it]
Loading checkpoint shards: 100%|██████████| 3/3 [01:10<00:00, 23.50s/it]
Loading checkpoint shards: 100%|██████████| 3/3 [01:10<00:00, 21.91s/it]Loading checkpoint shards: 100%|██████████| 3/3 [01:10<00:00, 23.56s/it]
Loading checkpoint shards: 100%|██████████| 3/3 [01:10<00:00, 21.85s/it]Loading checkpoint shards: 100%|██████████| 3/3 [01:10<00:00, 23.51s/it]
Loading checkpoint shards: 100%|██████████| 3/3 [01:10<00:00, 21.95s/it]Loading checkpoint shards: 100%|██████████| 3/3 [01:10<00:00, 23.57s/it]
2024-07-06:21:03:17,086 INFO     [task.py:395] Building contexts for gsm8k on rank 1...
  0%|          | 0/165 [00:00<?, ?it/s] 12%|█▏        | 19/165 [00:00<00:00, 187.74it/s] 24%|██▎       | 39/165 [00:00<00:00, 189.50it/s] 36%|███▌      | 59/165 [00:00<00:00, 190.19it/s]2024-07-06:21:03:17,503 INFO     [xhuggingface.py:323] Using 8 devices with data parallelism
 48%|████▊     | 79/165 [00:00<00:00, 191.19it/s] 60%|██████    | 99/165 [00:00<00:00, 191.99it/s] 72%|███████▏  | 119/165 [00:00<00:00, 192.53it/s] 84%|████████▍ | 139/165 [00:00<00:00, 192.87it/s] 96%|█████████▋| 159/165 [00:00<00:00, 193.08it/s]100%|██████████| 165/165 [00:00<00:00, 192.06it/s]
2024-07-06:21:03:18,537 INFO     [task.py:395] Building contexts for gsm8k on rank 2...
  0%|          | 0/165 [00:00<?, ?it/s] 12%|█▏        | 19/165 [00:00<00:00, 189.94it/s]2024-07-06:21:03:18,676 INFO     [task.py:395] Building contexts for gsm8k on rank 5...
  0%|          | 0/165 [00:00<?, ?it/s]2024-07-06:21:03:18,761 INFO     [task.py:395] Building contexts for gsm8k on rank 0...
 24%|██▎       | 39/165 [00:00<00:00, 191.63it/s]  0%|          | 0/165 [00:00<?, ?it/s] 12%|█▏        | 19/165 [00:00<00:00, 189.47it/s] 12%|█▏        | 19/165 [00:00<00:00, 180.74it/s] 36%|███▌      | 59/165 [00:00<00:00, 172.65it/s] 24%|██▎       | 39/165 [00:00<00:00, 190.62it/s] 23%|██▎       | 38/165 [00:00<00:00, 181.98it/s] 47%|████▋     | 77/165 [00:00<00:00, 167.87it/s]2024-07-06:21:03:19,008 INFO     [task.py:395] Building contexts for gsm8k on rank 6...
 36%|███▌      | 59/165 [00:00<00:00, 189.66it/s]  0%|          | 0/165 [00:00<?, ?it/s]2024-07-06:21:03:19,100 INFO     [task.py:395] Building contexts for gsm8k on rank 7...
 57%|█████▋    | 94/165 [00:00<00:00, 166.77it/s] 35%|███▍      | 57/165 [00:00<00:00, 172.20it/s] 47%|████▋     | 78/165 [00:00<00:00, 180.53it/s]  0%|          | 0/164 [00:00<?, ?it/s]  8%|▊         | 14/165 [00:00<00:01, 139.19it/s] 46%|████▌     | 76/165 [00:00<00:00, 178.40it/s] 69%|██████▉   | 114/165 [00:00<00:00, 175.38it/s] 59%|█████▉    | 98/165 [00:00<00:00, 184.81it/s] 12%|█▏        | 19/164 [00:00<00:00, 186.80it/s] 20%|██        | 33/165 [00:00<00:00, 167.98it/s] 81%|████████  | 134/165 [00:00<00:00, 181.36it/s] 58%|█████▊    | 96/165 [00:00<00:00, 182.83it/s] 72%|███████▏  | 118/165 [00:00<00:00, 187.97it/s] 24%|██▍       | 39/164 [00:00<00:00, 189.93it/s] 32%|███▏      | 52/165 [00:00<00:00, 177.82it/s] 93%|█████████▎| 154/165 [00:00<00:00, 185.19it/s] 70%|███████   | 116/165 [00:00<00:00, 185.51it/s] 84%|████████▎ | 138/165 [00:00<00:00, 190.13it/s] 36%|███▌      | 59/164 [00:00<00:00, 190.73it/s] 44%|████▎     | 72/165 [00:00<00:00, 183.49it/s]100%|██████████| 165/165 [00:00<00:00, 180.28it/s]
 82%|████████▏ | 135/165 [00:00<00:00, 186.79it/s] 96%|█████████▌| 158/165 [00:00<00:00, 191.22it/s] 48%|████▊     | 79/164 [00:00<00:00, 191.57it/s] 56%|█████▌    | 92/165 [00:00<00:00, 186.17it/s]100%|██████████| 165/165 [00:00<00:00, 188.77it/s]
 93%|█████████▎| 154/165 [00:00<00:00, 186.92it/s] 60%|██████    | 99/164 [00:00<00:00, 191.58it/s] 67%|██████▋   | 111/165 [00:00<00:00, 187.40it/s]100%|██████████| 165/165 [00:00<00:00, 184.02it/s]
 73%|███████▎  | 119/164 [00:00<00:00, 192.16it/s] 79%|███████▉  | 131/165 [00:00<00:00, 188.79it/s] 85%|████████▍ | 139/164 [00:00<00:00, 192.42it/s] 92%|█████████▏| 151/165 [00:00<00:00, 189.40it/s]100%|██████████| 165/165 [00:00<00:00, 184.52it/s]
 97%|█████████▋| 159/164 [00:00<00:00, 192.76it/s]100%|██████████| 164/164 [00:00<00:00, 191.79it/s]
2024-07-06:21:04:04,478 INFO     [task.py:395] Building contexts for gsm8k on rank 3...
  0%|          | 0/165 [00:00<?, ?it/s]2024-07-06:21:04:04,521 INFO     [task.py:395] Building contexts for gsm8k on rank 4...
  0%|          | 0/165 [00:00<?, ?it/s] 12%|█▏        | 19/165 [00:00<00:00, 184.99it/s] 12%|█▏        | 19/165 [00:00<00:00, 186.85it/s] 24%|██▎       | 39/165 [00:00<00:00, 188.28it/s] 23%|██▎       | 38/165 [00:00<00:00, 179.83it/s] 35%|███▌      | 58/165 [00:00<00:00, 156.54it/s] 35%|███▍      | 57/165 [00:00<00:00, 144.58it/s] 45%|████▌     | 75/165 [00:00<00:00, 139.88it/s] 44%|████▍     | 73/165 [00:00<00:00, 133.76it/s] 55%|█████▍    | 90/165 [00:00<00:00, 132.18it/s] 53%|█████▎    | 87/165 [00:00<00:00, 128.55it/s] 63%|██████▎   | 104/165 [00:00<00:00, 125.96it/s] 61%|██████    | 101/165 [00:00<00:00, 125.29it/s] 71%|███████   | 117/165 [00:00<00:00, 123.41it/s] 69%|██████▉   | 114/165 [00:00<00:00, 123.08it/s] 79%|███████▉  | 130/165 [00:00<00:00, 121.61it/s] 77%|███████▋  | 127/165 [00:00<00:00, 121.73it/s] 87%|████████▋ | 143/165 [00:01<00:00, 119.84it/s] 85%|████████▍ | 140/165 [00:01<00:00, 120.70it/s] 95%|█████████▍| 156/165 [00:01<00:00, 117.64it/s] 93%|█████████▎| 153/165 [00:01<00:00, 120.01it/s]100%|██████████| 165/165 [00:01<00:00, 129.43it/s]
100%|██████████| 165/165 [00:01<00:00, 127.44it/s]
2024-07-06:21:04:19,883 INFO     [xevaluator.py:395] Running generate_until requests
2024-07-06:21:04:19,883 INFO     [xevaluator.py:395] Running generate_until requests
2024-07-06:21:04:19,883 INFO     [xevaluator.py:395] Running generate_until requests
2024-07-06:21:04:19,883 INFO     [xevaluator.py:395] Running generate_until requests
2024-07-06:21:04:19,884 INFO     [xevaluator.py:395] Running generate_until requests
2024-07-06:21:04:19,884 INFO     [xevaluator.py:395] Running generate_until requests
2024-07-06:21:04:19,884 INFO     [xevaluator.py:395] Running generate_until requests
2024-07-06:21:04:19,884 INFO     [xevaluator.py:395] Running generate_until requests
Running generate_until requests:   0%|          | 0/165 [00:00<?, ?it/s]Running generate_until requests:   1%|          | 1/165 [00:32<1:29:07, 32.61s/it]Running generate_until requests:   1%|          | 2/165 [00:50<1:04:59, 23.92s/it]Running generate_until requests:   2%|▏         | 3/165 [01:06<54:51, 20.32s/it]  Running generate_until requests:   2%|▏         | 4/165 [01:27<54:54, 20.46s/it]Running generate_until requests:   3%|▎         | 5/165 [01:51<58:02, 21.77s/it]Running generate_until requests:   4%|▎         | 6/165 [02:13<58:04, 21.92s/it]Running generate_until requests:   4%|▍         | 7/165 [02:19<44:18, 16.83s/it]Running generate_until requests:   5%|▍         | 8/165 [02:32<40:14, 15.38s/it]Running generate_until requests:   5%|▌         | 9/165 [02:47<39:59, 15.38s/it]Running generate_until requests:   6%|▌         | 10/165 [02:59<37:08, 14.38s/it]Running generate_until requests:   7%|▋         | 11/165 [03:16<38:41, 15.07s/it]Running generate_until requests:   7%|▋         | 12/165 [03:19<29:12, 11.45s/it]Running generate_until requests:   8%|▊         | 13/165 [03:29<28:17, 11.17s/it]Running generate_until requests:   8%|▊         | 14/165 [03:45<31:06, 12.36s/it]Running generate_until requests:   9%|▉         | 15/165 [04:06<37:26, 14.98s/it]Running generate_until requests:  10%|▉         | 16/165 [04:16<33:48, 13.61s/it]Running generate_until requests:  10%|█         | 17/165 [04:34<36:52, 14.95s/it]Running generate_until requests:  11%|█         | 18/165 [04:49<36:35, 14.93s/it]Running generate_until requests:  12%|█▏        | 19/165 [04:59<33:03, 13.58s/it]Running generate_until requests:  12%|█▏        | 20/165 [05:16<34:53, 14.44s/it]Running generate_until requests:  13%|█▎        | 21/165 [05:28<32:47, 13.66s/it]Running generate_until requests:  13%|█▎        | 22/165 [05:37<29:07, 12.22s/it]Running generate_until requests:  14%|█▍        | 23/165 [05:56<33:50, 14.30s/it]Running generate_until requests:  15%|█▍        | 24/165 [06:18<39:19, 16.74s/it]Running generate_until requests:  15%|█▌        | 25/165 [06:39<41:46, 17.90s/it]Running generate_until requests:  16%|█▌        | 26/165 [06:52<38:08, 16.46s/it]Running generate_until requests:  16%|█▋        | 27/165 [07:02<33:40, 14.64s/it]Running generate_until requests:  17%|█▋        | 28/165 [07:15<32:23, 14.18s/it]Running generate_until requests:  18%|█▊        | 29/165 [07:26<29:24, 12.98s/it]Running generate_until requests:  18%|█▊        | 30/165 [07:39<29:12, 12.98s/it]Running generate_until requests:  19%|█▉        | 31/165 [07:49<27:08, 12.16s/it]Running generate_until requests:  19%|█▉        | 32/165 [08:03<28:26, 12.83s/it]Running generate_until requests:  20%|██        | 33/165 [08:12<25:25, 11.56s/it]Running generate_until requests:  21%|██        | 34/165 [08:25<26:08, 11.98s/it]Running generate_until requests:  21%|██        | 35/165 [08:35<24:45, 11.43s/it]Running generate_until requests:  22%|██▏       | 36/165 [08:46<24:32, 11.41s/it]Running generate_until requests:  22%|██▏       | 37/165 [08:56<23:25, 10.98s/it]Running generate_until requests:  23%|██▎       | 38/165 [09:11<25:21, 11.98s/it]Running generate_until requests:  24%|██▎       | 39/165 [09:35<33:12, 15.81s/it]Running generate_until requests:  24%|██▍       | 40/165 [09:45<29:16, 14.06s/it]Running generate_until requests:  25%|██▍       | 41/165 [09:54<25:38, 12.40s/it]Running generate_until requests:  25%|██▌       | 42/165 [10:07<25:41, 12.53s/it]Running generate_until requests:  26%|██▌       | 43/165 [10:15<23:09, 11.39s/it]Running generate_until requests:  27%|██▋       | 44/165 [10:32<26:25, 13.10s/it]Running generate_until requests:  27%|██▋       | 45/165 [10:47<26:49, 13.41s/it]Running generate_until requests:  28%|██▊       | 46/165 [11:02<28:00, 14.12s/it]Running generate_until requests:  28%|██▊       | 47/165 [11:16<27:46, 14.13s/it]Running generate_until requests:  29%|██▉       | 48/165 [11:26<25:02, 12.84s/it]Running generate_until requests:  30%|██▉       | 49/165 [11:32<20:40, 10.69s/it]Running generate_until requests:  30%|███       | 50/165 [11:43<20:47, 10.85s/it]Running generate_until requests:  31%|███       | 51/165 [11:55<20:55, 11.01s/it]Running generate_until requests:  32%|███▏      | 52/165 [12:02<18:30,  9.83s/it]Running generate_until requests:  32%|███▏      | 53/165 [12:13<19:07, 10.25s/it]Running generate_until requests:  33%|███▎      | 54/165 [12:23<18:43, 10.12s/it]Running generate_until requests:  33%|███▎      | 55/165 [12:34<19:11, 10.47s/it]Running generate_until requests:  34%|███▍      | 56/165 [12:50<22:03, 12.14s/it]Running generate_until requests:  35%|███▍      | 57/165 [13:01<21:24, 11.90s/it]Running generate_until requests:  35%|███▌      | 58/165 [13:19<24:17, 13.63s/it]Running generate_until requests:  36%|███▌      | 59/165 [13:37<26:17, 14.88s/it]Running generate_until requests:  36%|███▋      | 60/165 [13:46<23:17, 13.31s/it]Running generate_until requests:  37%|███▋      | 61/165 [13:58<22:00, 12.70s/it]Running generate_until requests:  38%|███▊      | 62/165 [14:09<21:04, 12.28s/it]Running generate_until requests:  38%|███▊      | 63/165 [14:24<22:04, 12.99s/it]Running generate_until requests:  39%|███▉      | 64/165 [14:37<21:46, 12.94s/it]Running generate_until requests:  39%|███▉      | 65/165 [14:48<20:41, 12.42s/it]Running generate_until requests:  40%|████      | 66/165 [15:02<21:30, 13.03s/it]Running generate_until requests:  41%|████      | 67/165 [15:12<19:37, 12.01s/it]Running generate_until requests:  41%|████      | 68/165 [15:30<22:13, 13.75s/it]Running generate_until requests:  42%|████▏     | 69/165 [15:41<20:46, 12.99s/it]Running generate_until requests:  42%|████▏     | 70/165 [15:54<20:28, 12.94s/it]Running generate_until requests:  43%|████▎     | 71/165 [16:08<20:58, 13.39s/it]Running generate_until requests:  44%|████▎     | 72/165 [16:32<25:47, 16.64s/it]Running generate_until requests:  44%|████▍     | 73/165 [16:45<23:45, 15.49s/it]Running generate_until requests:  45%|████▍     | 74/165 [16:58<22:17, 14.69s/it]Running generate_until requests:  45%|████▌     | 75/165 [17:09<20:36, 13.73s/it]Running generate_until requests:  46%|████▌     | 76/165 [17:21<19:14, 12.97s/it]Running generate_until requests:  47%|████▋     | 77/165 [17:45<23:49, 16.25s/it]Running generate_until requests:  47%|████▋     | 78/165 [17:59<22:49, 15.74s/it]Running generate_until requests:  48%|████▊     | 79/165 [18:17<23:19, 16.27s/it]Running generate_until requests:  48%|████▊     | 80/165 [18:33<22:54, 16.17s/it]Running generate_until requests:  49%|████▉     | 81/165 [18:48<22:30, 16.08s/it]Running generate_until requests:  50%|████▉     | 82/165 [19:06<22:56, 16.59s/it]Running generate_until requests:  50%|█████     | 83/165 [19:32<26:19, 19.26s/it]Running generate_until requests:  51%|█████     | 84/165 [19:43<22:42, 16.82s/it]Running generate_until requests:  52%|█████▏    | 85/165 [20:05<24:42, 18.53s/it]Running generate_until requests:  52%|█████▏    | 86/165 [20:21<23:20, 17.73s/it]Running generate_until requests:  53%|█████▎    | 87/165 [20:32<20:30, 15.77s/it]Running generate_until requests:  53%|█████▎    | 88/165 [20:50<20:56, 16.32s/it]Running generate_until requests:  54%|█████▍    | 89/165 [21:03<19:18, 15.25s/it]Running generate_until requests:  55%|█████▍    | 90/165 [21:15<18:06, 14.48s/it]Running generate_until requests:  55%|█████▌    | 91/165 [21:28<17:12, 13.95s/it]Running generate_until requests:  56%|█████▌    | 92/165 [21:52<20:37, 16.95s/it]Running generate_until requests:  56%|█████▋    | 93/165 [22:02<17:42, 14.75s/it]Running generate_until requests:  57%|█████▋    | 94/165 [22:11<15:36, 13.19s/it]Running generate_until requests:  58%|█████▊    | 95/165 [22:26<15:46, 13.52s/it]Running generate_until requests:  58%|█████▊    | 96/165 [22:51<19:41, 17.12s/it]Running generate_until requests:  59%|█████▉    | 97/165 [23:02<17:23, 15.34s/it]Running generate_until requests:  59%|█████▉    | 98/165 [23:15<16:14, 14.54s/it]Running generate_until requests:  60%|██████    | 99/165 [23:31<16:29, 15.00s/it]Running generate_until requests:  61%|██████    | 100/165 [23:44<15:28, 14.28s/it]Running generate_until requests:  61%|██████    | 101/165 [23:58<15:12, 14.26s/it]Running generate_until requests:  62%|██████▏   | 102/165 [24:04<12:31, 11.93s/it]Running generate_until requests:  62%|██████▏   | 103/165 [24:11<10:36, 10.26s/it]Running generate_until requests:  63%|██████▎   | 104/165 [24:38<15:31, 15.27s/it]Running generate_until requests:  64%|██████▎   | 105/165 [25:03<18:16, 18.27s/it]Running generate_until requests:  64%|██████▍   | 106/165 [25:16<16:20, 16.63s/it]Running generate_until requests:  65%|██████▍   | 107/165 [25:24<13:32, 14.02s/it]Running generate_until requests:  65%|██████▌   | 108/165 [25:27<10:15, 10.80s/it]Running generate_until requests:  66%|██████▌   | 109/165 [25:38<10:08, 10.87s/it]Running generate_until requests:  67%|██████▋   | 110/165 [25:52<10:51, 11.84s/it]Running generate_until requests:  67%|██████▋   | 111/165 [26:02<10:05, 11.22s/it]Running generate_until requests:  68%|██████▊   | 112/165 [26:10<09:02, 10.23s/it]Running generate_until requests:  68%|██████▊   | 113/165 [26:18<08:15,  9.52s/it]Running generate_until requests:  69%|██████▉   | 114/165 [26:35<10:05, 11.86s/it]Running generate_until requests:  70%|██████▉   | 115/165 [26:46<09:39, 11.59s/it]Running generate_until requests:  70%|███████   | 116/165 [26:57<09:22, 11.47s/it]Running generate_until requests:  71%|███████   | 117/165 [27:07<08:42, 10.88s/it]Running generate_until requests:  72%|███████▏  | 118/165 [27:16<08:10, 10.43s/it]Running generate_until requests:  72%|███████▏  | 119/165 [27:28<08:28, 11.05s/it]Running generate_until requests:  73%|███████▎  | 120/165 [27:33<06:52,  9.16s/it]Running generate_until requests:  73%|███████▎  | 121/165 [27:41<06:25,  8.76s/it]Running generate_until requests:  74%|███████▍  | 122/165 [28:02<08:47, 12.27s/it]Running generate_until requests:  75%|███████▍  | 123/165 [28:20<09:56, 14.19s/it]Running generate_until requests:  75%|███████▌  | 124/165 [28:34<09:39, 14.14s/it]Running generate_until requests:  76%|███████▌  | 125/165 [28:44<08:30, 12.75s/it]Running generate_until requests:  76%|███████▋  | 126/165 [28:50<07:01, 10.80s/it]Running generate_until requests:  77%|███████▋  | 127/165 [28:56<05:58,  9.44s/it]Running generate_until requests:  78%|███████▊  | 128/165 [29:13<07:14, 11.75s/it]Running generate_until requests:  78%|███████▊  | 129/165 [29:32<08:17, 13.83s/it]Running generate_until requests:  79%|███████▉  | 130/165 [29:48<08:23, 14.37s/it]Running generate_until requests:  79%|███████▉  | 131/165 [30:06<08:52, 15.65s/it]Running generate_until requests:  80%|████████  | 132/165 [30:16<07:33, 13.74s/it]Running generate_until requests:  81%|████████  | 133/165 [30:25<06:37, 12.43s/it]Running generate_until requests:  81%|████████  | 134/165 [30:39<06:40, 12.92s/it]Running generate_until requests:  82%|████████▏ | 135/165 [30:50<06:08, 12.29s/it]Running generate_until requests:  82%|████████▏ | 136/165 [30:56<05:04, 10.48s/it]Running generate_until requests:  83%|████████▎ | 137/165 [31:12<05:35, 11.97s/it]Running generate_until requests:  84%|████████▎ | 138/165 [31:27<05:53, 13.08s/it]Running generate_until requests:  84%|████████▍ | 139/165 [31:37<05:10, 11.93s/it]Running generate_until requests:  85%|████████▍ | 140/165 [31:44<04:26, 10.67s/it]Running generate_until requests:  85%|████████▌ | 141/165 [32:01<05:02, 12.59s/it]Running generate_until requests:  86%|████████▌ | 142/165 [32:11<04:26, 11.59s/it]Running generate_until requests:  87%|████████▋ | 143/165 [32:21<04:10, 11.38s/it]Running generate_until requests:  87%|████████▋ | 144/165 [32:32<03:55, 11.20s/it]Running generate_until requests:  88%|████████▊ | 145/165 [32:41<03:31, 10.60s/it]Running generate_until requests:  88%|████████▊ | 146/165 [32:51<03:13, 10.17s/it]Running generate_until requests:  89%|████████▉ | 147/165 [33:11<03:57, 13.17s/it]Running generate_until requests:  90%|████████▉ | 148/165 [33:21<03:31, 12.42s/it]Running generate_until requests:  90%|█████████ | 149/165 [33:37<03:32, 13.27s/it]Running generate_until requests:  91%|█████████ | 150/165 [33:44<02:53, 11.58s/it]Running generate_until requests:  92%|█████████▏| 151/165 [33:58<02:51, 12.27s/it]Running generate_until requests:  92%|█████████▏| 152/165 [34:06<02:21, 10.90s/it]Running generate_until requests:  93%|█████████▎| 153/165 [34:17<02:09, 10.81s/it]Running generate_until requests:  93%|█████████▎| 154/165 [34:29<02:03, 11.21s/it]Running generate_until requests:  94%|█████████▍| 155/165 [34:38<01:45, 10.57s/it]Running generate_until requests:  95%|█████████▍| 156/165 [34:47<01:31, 10.13s/it]Running generate_until requests:  95%|█████████▌| 157/165 [34:55<01:15,  9.43s/it]Running generate_until requests:  96%|█████████▌| 158/165 [35:11<01:21, 11.59s/it]Running generate_until requests:  96%|█████████▋| 159/165 [35:29<01:21, 13.54s/it]Running generate_until requests:  97%|█████████▋| 160/165 [35:38<01:00, 12.19s/it]Running generate_until requests:  98%|█████████▊| 161/165 [35:48<00:45, 11.29s/it]Running generate_until requests:  98%|█████████▊| 162/165 [35:55<00:30, 10.16s/it]Running generate_until requests:  99%|█████████▉| 163/165 [36:03<00:18,  9.36s/it]Running generate_until requests:  99%|█████████▉| 164/165 [36:12<00:09,  9.24s/it]Running generate_until requests: 100%|██████████| 165/165 [36:25<00:00, 10.48s/it]Running generate_until requests: 100%|██████████| 165/165 [36:25<00:00, 13.24s/it]
Traceback (most recent call last):
  File "/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/GRIFFIN2/main.py", line 465, in <module>
    cli_evaluate()
  File "/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/GRIFFIN2/main.py", line 384, in cli_evaluate
    results = xevaluator.simple_evaluate(
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/lm_eval/utils.py", line 288, in _wrapper
    return fn(*args, **kwargs)
  File "/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/GRIFFIN2/xevaluator.py", line 262, in simple_evaluate
    results = evaluate(
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/lm_eval/utils.py", line 288, in _wrapper
    return fn(*args, **kwargs)
  File "/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/GRIFFIN2/xevaluator.py", line 485, in evaluate
    torch.distributed.gather_object(
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/distributed/c10d_logger.py", line 72, in wrapper
    return func(*args, **kwargs)
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 2316, in gather_object
    gather(
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/distributed/c10d_logger.py", line 72, in wrapper
    return func(*args, **kwargs)
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 2890, in gather
    work = default_pg.gather(output_tensors, input_tensors, opts)
RuntimeError: NCCL Error 1: unhandled cuda error (run with NCCL_DEBUG=INFO for details)
[2024-07-06 21:53:04,505] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 3182115 closing signal SIGTERM
[2024-07-06 21:53:04,506] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 3182116 closing signal SIGTERM
[2024-07-06 21:53:04,506] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 3182117 closing signal SIGTERM
[2024-07-06 21:53:04,506] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 3182118 closing signal SIGTERM
[2024-07-06 21:53:04,506] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 3182119 closing signal SIGTERM
[2024-07-06 21:53:04,506] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 3182120 closing signal SIGTERM
[2024-07-06 21:53:04,507] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 3182121 closing signal SIGTERM
[2024-07-06 21:53:06,373] torch.distributed.elastic.multiprocessing.api: [ERROR] failed (exitcode: 1) local_rank: 0 (pid: 3182114) of binary: /fsx-storygen/beidic/anaconda3/envs/griffin/bin/python3.9
Traceback (most recent call last):
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/bin/accelerate", line 8, in <module>
    sys.exit(main())
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/accelerate/commands/accelerate_cli.py", line 47, in main
    args.func(args)
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/accelerate/commands/launch.py", line 985, in launch_command
    multi_gpu_launcher(args)
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/accelerate/commands/launch.py", line 654, in multi_gpu_launcher
    distrib_run.run(args)
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/distributed/run.py", line 803, in run
    elastic_launch(
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 135, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 268, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
main.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-06_21:53:04
  host      : a100-st-p4de24xlarge-796.fair-a100.hpcaas
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 3182114)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
