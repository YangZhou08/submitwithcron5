Already on 'addinggriffin'
wandb: Currently logged in as: stevenzhou0816100. Use `wandb login --relogin` to force relogin
The following values were not passed to `accelerate launch` and had defaults used instead:
		More than one GPU was found, enabling multi-GPU training.
		If this was unintended please pass in `--num_processes=1`.
	`--mixed_precision` was set to a value of `'no'`
	`--dynamo_backend` was set to a value of `'no'`
To avoid this warning pass in values for each of the problematic parameters or run `accelerate config`.
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:18<00:54, 18.17s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:19<00:59, 19.77s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:19<00:57, 19.17s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:19<00:57, 19.18s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:19<00:57, 19.08s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:19<00:57, 19.11s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:19<00:57, 19.13s/it]Loading checkpoint shards:  25%|██▌       | 1/4 [00:19<00:58, 19.46s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:35<00:34, 17.23s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:35<00:35, 17.58s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:35<00:35, 17.80s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:35<00:35, 17.66s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:35<00:35, 17.64s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:36<00:35, 17.91s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:35<00:35, 17.67s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:36<00:35, 17.78s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:53<00:17, 17.92s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:55<00:18, 18.53s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:55<00:18, 18.43s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:55<00:18, 18.44s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:55<00:18, 18.53s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:55<00:18, 18.44s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:55<00:18, 18.51s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:55<00:18, 18.43s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:56<00:00, 11.76s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:56<00:00, 14.07s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:57<00:00, 11.86s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:57<00:00, 14.32s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:56<00:00, 11.81s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:56<00:00, 14.15s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:56<00:00, 11.79s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:56<00:00, 14.18s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:56<00:00, 11.85s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:56<00:00, 14.18s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:56<00:00, 11.80s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:56<00:00, 14.17s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:56<00:00, 11.80s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:56<00:00, 14.19s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:57<00:00, 11.85s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:57<00:00, 14.26s/it]
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:369: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:369: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:369: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:369: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]  0%|          | 0/32 [00:00<?, ?it/s]  0%|          | 0/32 [00:00<?, ?it/s]  0%|          | 0/32 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:369: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:369: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:369: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:369: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
  3%|▎         | 1/32 [00:03<01:59,  3.86s/it]  6%|▋         | 2/32 [00:05<01:07,  2.27s/it]  3%|▎         | 1/32 [00:05<02:36,  5.05s/it]  3%|▎         | 1/32 [00:05<02:39,  5.14s/it]  6%|▋         | 2/32 [00:07<01:46,  3.56s/it]  6%|▋         | 2/32 [00:09<02:23,  4.79s/it]  9%|▉         | 3/32 [00:10<01:33,  3.24s/it]  3%|▎         | 1/32 [00:18<09:23, 18.18s/it]  6%|▋         | 2/32 [00:20<04:31,  9.07s/it]  9%|▉         | 3/32 [00:21<03:54,  8.10s/it] 12%|█▎        | 4/32 [00:28<03:30,  7.51s/it]  3%|▎         | 1/32 [00:32<16:40, 32.26s/it]  3%|▎         | 1/32 [00:32<16:44, 32.41s/it]  3%|▎         | 1/32 [00:32<17:00, 32.92s/it]  9%|▉         | 3/32 [00:36<07:31, 15.58s/it]  6%|▋         | 2/32 [00:36<07:59, 16.00s/it]  9%|▉         | 3/32 [00:38<04:32,  9.41s/it] 12%|█▎        | 4/32 [00:41<06:39, 14.27s/it] 12%|█▎        | 4/32 [00:41<03:17,  7.06s/it] 16%|█▌        | 5/32 [00:46<05:04, 11.27s/it]  6%|▋         | 2/32 [00:47<11:05, 22.20s/it]  3%|▎         | 1/32 [00:48<25:17, 48.94s/it] 16%|█▌        | 5/32 [00:54<04:01,  8.95s/it]  6%|▋         | 2/32 [01:02<15:34, 31.16s/it]  9%|▉         | 3/32 [01:06<08:55, 18.46s/it]  6%|▋         | 2/32 [01:06<15:15, 30.51s/it] 12%|█▎        | 4/32 [01:07<10:05, 21.63s/it] 12%|█▎        | 4/32 [01:09<05:54, 12.65s/it] 16%|█▌        | 5/32 [01:12<09:07, 20.28s/it] 16%|█▌        | 5/32 [01:13<04:09,  9.25s/it] 19%|█▉        | 6/32 [01:14<02:48,  6.47s/it]  9%|▉         | 3/32 [01:14<14:17, 29.56s/it] 19%|█▉        | 6/32 [01:16<07:44, 17.85s/it] 19%|█▉        | 6/32 [01:17<06:29, 14.99s/it] 22%|██▏       | 7/32 [01:18<02:22,  5.71s/it]  9%|▉         | 3/32 [01:18<12:39, 26.18s/it] 22%|██▏       | 7/32 [01:18<04:26, 10.64s/it] 22%|██▏       | 7/32 [01:20<05:32, 13.30s/it] 25%|██▌       | 8/32 [01:22<03:20,  8.37s/it] 25%|██▌       | 8/32 [01:24<04:04, 10.20s/it] 19%|█▉        | 6/32 [01:24<07:02, 16.25s/it] 12%|█▎        | 4/32 [01:25<10:21, 22.19s/it] 28%|██▊       | 9/32 [01:27<02:48,  7.33s/it] 31%|███▏      | 10/32 [01:29<02:08,  5.84s/it] 28%|██▊       | 9/32 [01:34<03:54, 10.21s/it] 16%|█▌        | 5/32 [01:38<11:18, 25.12s/it] 25%|██▌       | 8/32 [01:48<05:26, 13.58s/it] 12%|█▎        | 4/32 [01:49<13:03, 28.00s/it] 22%|██▏       | 7/32 [01:55<08:43, 20.94s/it]  9%|▉         | 3/32 [01:59<19:40, 40.69s/it] 34%|███▍      | 11/32 [02:00<04:44, 13.54s/it] 38%|███▊      | 12/32 [02:03<03:26, 10.32s/it] 31%|███▏      | 10/32 [02:05<06:03, 16.52s/it] 34%|███▍      | 11/32 [02:07<04:16, 12.20s/it] 41%|████      | 13/32 [02:08<02:41,  8.50s/it] 19%|█▉        | 6/32 [02:09<11:47, 27.21s/it] 44%|████▍     | 14/32 [02:11<02:04,  6.93s/it] 22%|██▏       | 7/32 [02:13<08:10, 19.64s/it] 28%|██▊       | 9/32 [02:19<07:12, 18.82s/it] 16%|█▌        | 5/32 [02:19<15:05, 33.55s/it] 16%|█▌        | 5/32 [02:20<13:03, 29.02s/it] 31%|███▏      | 10/32 [02:20<04:58, 13.55s/it] 34%|███▍      | 11/32 [02:21<03:25,  9.76s/it] 25%|██▌       | 8/32 [02:25<09:33, 23.89s/it] 28%|██▊       | 9/32 [02:27<06:29, 16.92s/it] 38%|███▊      | 12/32 [02:38<05:56, 17.81s/it] 47%|████▋     | 15/32 [02:42<04:01, 14.21s/it] 25%|██▌       | 8/32 [02:45<09:20, 23.35s/it] 50%|█████     | 16/32 [02:48<03:05, 11.61s/it] 19%|█▉        | 6/32 [02:50<12:49, 29.58s/it] 12%|█▎        | 4/32 [02:51<21:09, 45.33s/it] 53%|█████▎    | 17/32 [02:52<02:20,  9.38s/it] 38%|███▊      | 12/32 [02:52<05:21, 16.09s/it] 56%|█████▋    | 18/32 [02:55<01:43,  7.36s/it] 22%|██▏       | 7/32 [02:55<08:53, 21.33s/it] 41%|████      | 13/32 [02:56<03:53, 12.28s/it] 31%|███▏      | 10/32 [02:57<07:44, 21.12s/it] 25%|██▌       | 8/32 [02:58<06:17, 15.75s/it] 34%|███▍      | 11/32 [03:00<05:25, 15.51s/it] 38%|███▊      | 12/32 [03:02<03:51, 11.57s/it] 41%|████      | 13/32 [03:08<06:50, 21.58s/it] 16%|█▌        | 5/32 [03:10<16:01, 35.62s/it] 44%|████▍     | 14/32 [03:12<04:51, 16.18s/it] 19%|█▉        | 6/32 [03:13<17:31, 40.42s/it] 47%|████▋     | 15/32 [03:15<03:26, 12.13s/it] 28%|██▊       | 9/32 [03:16<09:52, 25.78s/it] 50%|█████     | 16/32 [03:19<02:35,  9.72s/it] 53%|█████▎    | 17/32 [03:20<01:49,  7.33s/it] 56%|█████▋    | 18/32 [03:23<01:24,  6.04s/it] 59%|█████▉    | 19/32 [03:26<03:07, 14.45s/it] 59%|█████▉    | 19/32 [03:26<01:04,  4.94s/it] 44%|████▍     | 14/32 [03:26<05:20, 17.79s/it] 47%|████▋     | 15/32 [03:28<03:38, 12.88s/it] 28%|██▊       | 9/32 [03:29<07:51, 20.52s/it] 62%|██████▎   | 20/32 [03:32<01:02,  5.17s/it] 41%|████      | 13/32 [03:33<05:28, 17.30s/it] 66%|██████▌   | 21/32 [03:37<00:56,  5.11s/it] 69%|██████▉   | 22/32 [03:38<00:39,  3.94s/it] 31%|███▏      | 10/32 [03:47<10:03, 27.44s/it] 50%|█████     | 16/32 [03:48<04:01, 15.10s/it] 34%|███▍      | 11/32 [03:50<07:01, 20.06s/it] 53%|█████▎    | 17/32 [03:53<03:01, 12.10s/it] 62%|██████▎   | 20/32 [03:56<03:52, 19.34s/it] 56%|█████▋    | 18/32 [03:57<02:16,  9.75s/it] 66%|██████▌   | 21/32 [03:59<02:39, 14.50s/it] 31%|███▏      | 10/32 [04:00<08:39, 23.62s/it] 59%|█████▉    | 19/32 [04:00<01:40,  7.75s/it] 34%|███▍      | 11/32 [04:02<05:57, 17.02s/it] 19%|█▉        | 6/32 [04:03<17:58, 41.50s/it] 44%|████▍     | 14/32 [04:03<06:23, 21.31s/it] 47%|████▋     | 15/32 [04:05<04:19, 15.28s/it] 22%|██▏       | 7/32 [04:07<18:41, 44.86s/it] 72%|███████▏  | 23/32 [04:08<01:47, 11.92s/it] 25%|██▌       | 8/32 [04:10<12:38, 31.61s/it] 78%|███████▊  | 25/32 [04:10<00:48,  6.93s/it] 38%|███▊      | 12/32 [04:22<07:49, 23.49s/it] 69%|██████▉   | 22/32 [04:30<03:13, 19.40s/it] 62%|██████▎   | 20/32 [04:31<02:54, 14.52s/it] 38%|███▊      | 12/32 [04:32<07:00, 21.02s/it] 50%|█████     | 16/32 [04:35<05:16, 19.77s/it] 41%|████      | 13/32 [04:37<05:03, 15.97s/it] 81%|████████▏ | 26/32 [04:41<01:16, 12.79s/it] 84%|████████▍ | 27/32 [04:43<00:49,  9.89s/it] 66%|██████▌   | 21/32 [04:44<02:36, 14.26s/it] 41%|████      | 13/32 [04:53<08:11, 25.85s/it] 22%|██▏       | 7/32 [04:55<18:47, 45.11s/it] 88%|████████▊ | 28/32 [04:56<00:43, 10.78s/it] 72%|███████▏  | 23/32 [05:01<03:25, 22.81s/it] 28%|██▊       | 9/32 [05:03<14:44, 38.47s/it] 75%|███████▌  | 24/32 [05:04<02:13, 16.69s/it] 78%|███████▊  | 25/32 [05:05<01:25, 12.21s/it] 53%|█████▎    | 17/32 [05:05<05:44, 22.99s/it] 31%|███▏      | 10/32 [05:06<10:03, 27.45s/it] 44%|████▍     | 14/32 [05:07<06:07, 20.41s/it] 81%|████████▏ | 26/32 [05:07<00:55,  9.18s/it] 34%|███▍      | 11/32 [05:09<06:59, 19.96s/it] 84%|████████▍ | 27/32 [05:10<00:35,  7.10s/it] 69%|██████▉   | 22/32 [05:14<03:10, 19.04s/it] 72%|███████▏  | 23/32 [05:16<02:03, 13.71s/it] 47%|████▋     | 15/32 [05:20<05:08, 18.13s/it] 75%|███████▌  | 24/32 [05:21<01:29, 11.15s/it] 44%|████▍     | 14/32 [05:24<08:14, 27.47s/it] 50%|█████     | 16/32 [05:25<03:45, 14.09s/it] 78%|███████▊  | 25/32 [05:25<01:04,  9.15s/it] 47%|████▋     | 15/32 [05:26<05:37, 19.85s/it] 91%|█████████ | 29/32 [05:26<00:48, 16.32s/it] 53%|█████▎    | 17/32 [05:29<02:46, 11.10s/it] 56%|█████▋    | 18/32 [05:33<02:06,  9.01s/it] 56%|█████▋    | 18/32 [05:36<05:52, 25.21s/it] 88%|████████▊ | 28/32 [05:41<00:57, 14.25s/it] 91%|█████████ | 29/32 [05:44<00:33, 11.10s/it] 94%|█████████▍| 30/32 [05:45<00:33, 16.99s/it] 97%|█████████▋| 31/32 [05:48<00:12, 12.81s/it] 25%|██▌       | 8/32 [05:48<18:59, 47.47s/it]100%|██████████| 32/32 [05:50<00:00,  9.74s/it]100%|██████████| 32/32 [05:50<00:00, 10.95s/it]
 28%|██▊       | 9/32 [05:50<12:48, 33.42s/it] 31%|███▏      | 10/32 [05:53<08:48, 24.02s/it] 81%|████████▏ | 26/32 [05:56<01:33, 15.51s/it] 50%|█████     | 16/32 [05:57<06:11, 23.21s/it] 84%|████████▍ | 27/32 [05:59<00:59, 12.00s/it] 88%|████████▊ | 28/32 [06:02<00:37,  9.26s/it] 38%|███▊      | 12/32 [06:03<10:02, 30.14s/it] 59%|█████▉    | 19/32 [06:04<03:20, 15.44s/it] 62%|██████▎   | 20/32 [06:05<02:15, 11.30s/it] 91%|█████████ | 29/32 [06:06<00:22,  7.46s/it] 59%|█████▉    | 19/32 [06:06<05:47, 26.71s/it] 66%|██████▌   | 21/32 [06:07<01:32,  8.41s/it] 94%|█████████▍| 30/32 [06:08<00:11,  5.91s/it] 97%|█████████▋| 31/32 [06:11<00:04,  4.96s/it] 94%|█████████▍| 30/32 [06:15<00:34, 17.03s/it] 62%|██████▎   | 20/32 [06:17<04:25, 22.10s/it] 97%|█████████▋| 31/32 [06:18<00:12, 12.72s/it] 53%|█████▎    | 17/32 [06:29<06:24, 25.63s/it] 66%|██████▌   | 21/32 [06:33<03:42, 20.26s/it] 69%|██████▉   | 22/32 [06:38<02:31, 15.18s/it] 69%|██████▉   | 22/32 [06:39<02:39, 15.91s/it] 72%|███████▏  | 23/32 [06:40<01:43, 11.49s/it]100%|██████████| 32/32 [06:41<00:00, 12.53s/it]100%|██████████| 32/32 [06:41<00:00, 12.54s/it]
 75%|███████▌  | 24/32 [06:43<01:11,  8.91s/it] 78%|███████▊  | 25/32 [06:46<00:48,  6.94s/it] 34%|███▍      | 11/32 [06:46<11:27, 32.76s/it]100%|██████████| 32/32 [06:49<00:00, 18.13s/it]100%|██████████| 32/32 [06:49<00:00, 12.78s/it]
 41%|████      | 13/32 [06:57<11:51, 37.45s/it] 56%|█████▋    | 18/32 [07:00<06:22, 27.30s/it] 59%|█████▉    | 19/32 [07:02<04:14, 19.61s/it] 72%|███████▏  | 23/32 [07:08<02:58, 19.78s/it] 75%|███████▌  | 24/32 [07:11<01:56, 14.58s/it] 81%|████████▏ | 26/32 [07:16<01:23, 13.90s/it] 78%|███████▊  | 25/32 [07:17<01:24, 12.05s/it] 81%|████████▏ | 26/32 [07:19<00:54,  9.03s/it] 84%|████████▍ | 27/32 [07:28<00:45,  9.04s/it] 88%|████████▊ | 28/32 [07:31<00:28,  7.13s/it] 62%|██████▎   | 20/32 [07:32<04:35, 22.96s/it] 38%|███▊      | 12/32 [07:39<12:57, 38.87s/it] 41%|████      | 13/32 [07:44<09:06, 28.77s/it] 84%|████████▍ | 27/32 [07:46<01:34, 18.83s/it] 44%|████▍     | 14/32 [07:50<12:40, 42.24s/it] 88%|████████▊ | 28/32 [07:51<00:59, 14.82s/it] 47%|████▋     | 15/32 [07:54<08:39, 30.56s/it] 94%|█████████▍| 30/32 [07:57<00:18,  9.33s/it] 97%|█████████▋| 31/32 [08:01<00:07,  7.99s/it]100%|██████████| 32/32 [08:03<00:00,  6.26s/it]100%|██████████| 32/32 [08:03<00:00, 15.10s/it]
 66%|██████▌   | 21/32 [08:03<04:39, 25.42s/it] 91%|█████████ | 29/32 [08:08<00:49, 16.34s/it] 50%|█████     | 16/32 [08:14<07:19, 27.49s/it] 94%|█████████▍| 30/32 [08:15<00:27, 13.50s/it] 97%|█████████▋| 31/32 [08:20<00:10, 10.86s/it]100%|██████████| 32/32 [08:27<00:00,  9.71s/it]100%|██████████| 32/32 [08:27<00:00, 15.86s/it]
 69%|██████▉   | 22/32 [08:34<04:30, 27.07s/it] 44%|████▍     | 14/32 [08:37<10:46, 35.92s/it] 72%|███████▏  | 23/32 [08:38<02:59, 19.97s/it] 75%|███████▌  | 24/32 [08:41<01:58, 14.82s/it] 78%|███████▊  | 25/32 [08:45<01:22, 11.75s/it] 53%|█████▎    | 17/32 [09:08<08:49, 35.32s/it] 56%|█████▋    | 18/32 [09:13<06:09, 26.42s/it] 81%|████████▏ | 26/32 [09:16<01:44, 17.44s/it] 84%|████████▍ | 27/32 [09:20<01:07, 13.42s/it] 59%|█████▉    | 19/32 [09:20<04:26, 20.51s/it] 62%|██████▎   | 20/32 [09:24<03:08, 15.67s/it] 47%|████▋     | 15/32 [09:29<11:34, 40.85s/it] 88%|████████▊ | 28/32 [09:51<01:14, 18.66s/it] 91%|█████████ | 29/32 [09:53<00:41, 13.73s/it] 66%|██████▌   | 21/32 [10:18<04:57, 27.09s/it] 50%|█████     | 16/32 [10:21<11:50, 44.38s/it] 94%|█████████▍| 30/32 [10:24<00:37, 18.84s/it] 97%|█████████▋| 31/32 [10:29<00:14, 14.68s/it]100%|██████████| 32/32 [10:36<00:00, 12.29s/it]100%|██████████| 32/32 [10:36<00:00, 19.88s/it]
 69%|██████▉   | 22/32 [10:44<04:26, 26.70s/it] 72%|███████▏  | 23/32 [10:47<02:55, 19.54s/it] 75%|███████▌  | 24/32 [10:54<02:05, 15.72s/it] 53%|█████▎    | 17/32 [11:14<11:41, 46.79s/it] 78%|███████▊  | 25/32 [11:19<02:11, 18.77s/it] 56%|█████▋    | 18/32 [11:37<09:13, 39.56s/it] 59%|█████▉    | 19/32 [11:43<06:24, 29.60s/it] 62%|██████▎   | 20/32 [11:50<04:33, 22.80s/it] 66%|██████▌   | 21/32 [11:56<03:14, 17.65s/it] 81%|████████▏ | 26/32 [12:13<02:55, 29.19s/it] 69%|██████▉   | 22/32 [12:48<04:41, 28.11s/it] 84%|████████▍ | 27/32 [13:06<03:02, 36.44s/it] 88%|████████▊ | 28/32 [13:09<01:45, 26.44s/it] 72%|███████▏  | 23/32 [13:41<05:18, 35.42s/it] 91%|█████████ | 29/32 [14:03<01:43, 34.55s/it] 75%|███████▌  | 24/32 [14:32<05:22, 40.34s/it] 94%|█████████▍| 30/32 [14:56<01:20, 40.25s/it] 97%|█████████▋| 31/32 [15:16<00:34, 34.10s/it] 78%|███████▊  | 25/32 [15:25<05:07, 43.95s/it]100%|██████████| 32/32 [15:27<00:00, 27.01s/it]100%|██████████| 32/32 [15:27<00:00, 28.97s/it]
[rank6]:[E ProcessGroupNCCL.cpp:523] [Rank 6] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=53, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600522 milliseconds before timing out.
[rank6]:[E ProcessGroupNCCL.cpp:537] Some NCCL operations have failed or timed out. Due to the asynchronous nature of CUDA kernels, subsequent GPU operations might run on corrupted/incomplete data.
[rank6]:[E ProcessGroupNCCL.cpp:543] To avoid data inconsistency, we are taking the entire process down.
[rank6]:[E ProcessGroupNCCL.cpp:1182] [Rank 6] NCCL watchdog thread terminated with exception: [Rank 6] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=53, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600522 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:525 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7f3e85c28d87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x1e6 (0x7f3e86dd06e6 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::workCleanupLoop() + 0x19d (0x7f3e86dd3c3d in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x119 (0x7f3e86dd4839 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd6df4 (0x7f3ed0ae7df4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #5: <unknown function> + 0x8609 (0x7f3ed1edb609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #6: clone + 0x43 (0x7f3ed1ca6353 in /lib/x86_64-linux-gnu/libc.so.6)

terminate called after throwing an instance of 'c10::DistBackendError'
  what():  [Rank 6] NCCL watchdog thread terminated with exception: [Rank 6] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=53, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600522 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:525 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7f3e85c28d87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x1e6 (0x7f3e86dd06e6 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::workCleanupLoop() + 0x19d (0x7f3e86dd3c3d in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x119 (0x7f3e86dd4839 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd6df4 (0x7f3ed0ae7df4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #5: <unknown function> + 0x8609 (0x7f3ed1edb609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #6: clone + 0x43 (0x7f3ed1ca6353 in /lib/x86_64-linux-gnu/libc.so.6)

Exception raised from ncclCommWatchdog at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:1186 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7f3e85c28d87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0xdf6b11 (0x7f3e86b2ab11 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: <unknown function> + 0xd6df4 (0x7f3ed0ae7df4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #3: <unknown function> + 0x8609 (0x7f3ed1edb609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #4: clone + 0x43 (0x7f3ed1ca6353 in /lib/x86_64-linux-gnu/libc.so.6)

 81%|████████▏ | 26/32 [16:05<04:16, 42.83s/it][rank4]:[E ProcessGroupNCCL.cpp:523] [Rank 4] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=53, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600627 milliseconds before timing out.
 84%|████████▍ | 27/32 [16:45<03:29, 41.92s/it][rank4]:[E ProcessGroupNCCL.cpp:537] Some NCCL operations have failed or timed out. Due to the asynchronous nature of CUDA kernels, subsequent GPU operations might run on corrupted/incomplete data.
[rank4]:[E ProcessGroupNCCL.cpp:543] To avoid data inconsistency, we are taking the entire process down.
[rank4]:[E ProcessGroupNCCL.cpp:1182] [Rank 4] NCCL watchdog thread terminated with exception: [Rank 4] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=53, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600627 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:525 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7fe119684d87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x1e6 (0x7fe11a82c6e6 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::workCleanupLoop() + 0x19d (0x7fe11a82fc3d in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x119 (0x7fe11a830839 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd6df4 (0x7fe164543df4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #5: <unknown function> + 0x8609 (0x7fe165937609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #6: clone + 0x43 (0x7fe165702353 in /lib/x86_64-linux-gnu/libc.so.6)

terminate called after throwing an instance of 'c10::DistBackendError'
  what():  [Rank 4] NCCL watchdog thread terminated with exception: [Rank 4] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=53, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600627 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:525 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7fe119684d87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x1e6 (0x7fe11a82c6e6 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::workCleanupLoop() + 0x19d (0x7fe11a82fc3d in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x119 (0x7fe11a830839 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd6df4 (0x7fe164543df4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #5: <unknown function> + 0x8609 (0x7fe165937609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #6: clone + 0x43 (0x7fe165702353 in /lib/x86_64-linux-gnu/libc.so.6)

Exception raised from ncclCommWatchdog at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:1186 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7fe119684d87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0xdf6b11 (0x7fe11a586b11 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: <unknown function> + 0xd6df4 (0x7fe164543df4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #3: <unknown function> + 0x8609 (0x7fe165937609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #4: clone + 0x43 (0x7fe165702353 in /lib/x86_64-linux-gnu/libc.so.6)

[rank2]:[E ProcessGroupNCCL.cpp:523] [Rank 2] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=53, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600603 milliseconds before timing out.
[rank2]:[E ProcessGroupNCCL.cpp:537] Some NCCL operations have failed or timed out. Due to the asynchronous nature of CUDA kernels, subsequent GPU operations might run on corrupted/incomplete data.
[rank2]:[E ProcessGroupNCCL.cpp:543] To avoid data inconsistency, we are taking the entire process down.
[rank2]:[E ProcessGroupNCCL.cpp:1182] [Rank 2] NCCL watchdog thread terminated with exception: [Rank 2] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=53, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600603 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:525 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7f7814c9cd87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x1e6 (0x7f7815e446e6 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::workCleanupLoop() + 0x19d (0x7f7815e47c3d in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x119 (0x7f7815e48839 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd6df4 (0x7f785fb5bdf4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #5: <unknown function> + 0x8609 (0x7f7860f4f609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #6: clone + 0x43 (0x7f7860d1a353 in /lib/x86_64-linux-gnu/libc.so.6)

terminate called after throwing an instance of 'c10::DistBackendError'
  what():  [Rank 2] NCCL watchdog thread terminated with exception: [Rank 2] Watchdog caught collective operation timeout: WorkNCCL(SeqNum=53, OpType=ALLREDUCE, NumelIn=1, NumelOut=1, Timeout(ms)=600000) ran for 600603 milliseconds before timing out.
Exception raised from checkTimeout at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:525 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7f7814c9cd87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::WorkNCCL::checkTimeout(std::optional<std::chrono::duration<long, std::ratio<1l, 1000l> > >) + 0x1e6 (0x7f7815e446e6 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::workCleanupLoop() + 0x19d (0x7f7815e47c3d in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x119 (0x7f7815e48839 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #4: <unknown function> + 0xd6df4 (0x7f785fb5bdf4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #5: <unknown function> + 0x8609 (0x7f7860f4f609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #6: clone + 0x43 (0x7f7860d1a353 in /lib/x86_64-linux-gnu/libc.so.6)

Exception raised from ncclCommWatchdog at ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:1186 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7f7814c9cd87 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0xdf6b11 (0x7f7815b9eb11 in /fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/lib/libtorch_cuda.so)
frame #2: <unknown function> + 0xd6df4 (0x7f785fb5bdf4 in /lib/x86_64-linux-gnu/libstdc++.so.6)
frame #3: <unknown function> + 0x8609 (0x7f7860f4f609 in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #4: clone + 0x43 (0x7f7860d1a353 in /lib/x86_64-linux-gnu/libc.so.6)

[2024-07-11 15:16:28,346] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 204794 closing signal SIGTERM
[2024-07-11 15:16:28,346] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 204795 closing signal SIGTERM
[2024-07-11 15:16:28,346] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 204797 closing signal SIGTERM
[2024-07-11 15:16:28,347] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 204799 closing signal SIGTERM
[2024-07-11 15:16:28,347] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 204801 closing signal SIGTERM
[2024-07-11 15:16:29,576] torch.distributed.elastic.multiprocessing.api: [ERROR] failed (exitcode: -6) local_rank: 2 (pid: 204796) of binary: /fsx-storygen/beidic/anaconda3/envs/griffin/bin/python3.9
Traceback (most recent call last):
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/bin/accelerate", line 8, in <module>
    sys.exit(main())
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/accelerate/commands/accelerate_cli.py", line 47, in main
    args.func(args)
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/accelerate/commands/launch.py", line 985, in launch_command
    multi_gpu_launcher(args)
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/accelerate/commands/launch.py", line 654, in multi_gpu_launcher
    distrib_run.run(args)
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/distributed/run.py", line 803, in run
    elastic_launch(
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 135, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 268, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
=======================================================
main.py FAILED
-------------------------------------------------------
Failures:
[1]:
  time      : 2024-07-11_15:16:28
  host      : a100-st-p4de24xlarge-408.fair-a100.hpcaas
  rank      : 4 (local_rank: 4)
  exitcode  : -6 (pid: 204798)
  error_file: <N/A>
  traceback : Signal 6 (SIGABRT) received by PID 204798
[2]:
  time      : 2024-07-11_15:16:28
  host      : a100-st-p4de24xlarge-408.fair-a100.hpcaas
  rank      : 6 (local_rank: 6)
  exitcode  : -6 (pid: 204800)
  error_file: <N/A>
  traceback : Signal 6 (SIGABRT) received by PID 204800
-------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-11_15:16:28
  host      : a100-st-p4de24xlarge-408.fair-a100.hpcaas
  rank      : 2 (local_rank: 2)
  exitcode  : -6 (pid: 204796)
  error_file: <N/A>
  traceback : Signal 6 (SIGABRT) received by PID 204796
=======================================================
