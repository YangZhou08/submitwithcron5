Already on 'yangexppp'
wandb: Currently logged in as: stevenzhou0816100. Use `wandb login --relogin` to force relogin
2024-08-04:12:53:02,128 INFO     [main.py:288] Verbosity set to INFO
2024-08-04:12:53:12,302 WARNING  [main.py:303]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2024-08-04:12:53:12,303 INFO     [main.py:378] Selected Tasks: ['mmlu_flan_cot_fewshot']
2024-08-04:12:53:12,337 INFO     [xevaluator.py:137] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2024-08-04:12:53:12,337 INFO     [xevaluator.py:184] Initializing xhf model, with arguments: {'pretrained': 'meta-llama/Meta-Llama-3-8B-Instruct', 'griffin': True, 'check': False, 'contextlength': 1500, 'kernel_size': 16, 'thr': 0.05}
2024-08-04:12:53:12,346 INFO     [xhuggingface.py:176] Using device 'cuda'
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:05<00:17,  5.87s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:11<00:11,  5.76s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:17<00:05,  5.69s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:18<00:00,  4.04s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:18<00:00,  4.67s/it]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
2024-08-04:12:54:30,232 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_prehistory on rank 0...
  0%|          | 0/35 [00:00<?, ?it/s]100%|██████████| 35/35 [00:00<00:00, 593.88it/s]
2024-08-04:12:54:30,293 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_logical_fallacies on rank 0...
  0%|          | 0/18 [00:00<?, ?it/s]100%|██████████| 18/18 [00:00<00:00, 601.20it/s]
2024-08-04:12:54:30,324 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_us_history on rank 0...
  0%|          | 0/22 [00:00<?, ?it/s]100%|██████████| 22/22 [00:00<00:00, 375.58it/s]
2024-08-04:12:54:30,385 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_international_law on rank 0...
  0%|          | 0/13 [00:00<?, ?it/s]100%|██████████| 13/13 [00:00<00:00, 573.73it/s]
2024-08-04:12:54:30,409 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_professional_law on rank 0...
  0%|          | 0/170 [00:00<?, ?it/s] 28%|██▊       | 47/170 [00:00<00:00, 466.45it/s] 55%|█████▌    | 94/170 [00:00<00:00, 388.46it/s] 79%|███████▉  | 134/170 [00:00<00:00, 370.87it/s]100%|██████████| 170/170 [00:00<00:00, 394.21it/s]
2024-08-04:12:54:30,849 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_moral_disputes on rank 0...
  0%|          | 0/38 [00:00<?, ?it/s]100%|██████████| 38/38 [00:00<00:00, 591.53it/s]
2024-08-04:12:54:30,916 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_jurisprudence on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 597.94it/s]
2024-08-04:12:54:30,935 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_world_history on rank 0...
  0%|          | 0/26 [00:00<?, ?it/s]100%|██████████| 26/26 [00:00<00:00, 478.47it/s]
2024-08-04:12:54:30,993 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_moral_scenarios on rank 0...
  0%|          | 0/100 [00:00<?, ?it/s] 58%|█████▊    | 58/100 [00:00<00:00, 576.97it/s]100%|██████████| 100/100 [00:00<00:00, 587.74it/s]
2024-08-04:12:54:31,168 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_philosophy on rank 0...
  0%|          | 0/34 [00:00<?, ?it/s]100%|██████████| 34/34 [00:00<00:00, 623.64it/s]
2024-08-04:12:54:31,225 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_formal_logic on rank 0...
  0%|          | 0/14 [00:00<?, ?it/s]100%|██████████| 14/14 [00:00<00:00, 541.16it/s]
2024-08-04:12:54:31,252 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_world_religions on rank 0...
  0%|          | 0/19 [00:00<?, ?it/s]100%|██████████| 19/19 [00:00<00:00, 634.27it/s]
2024-08-04:12:54:31,283 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_european_history on rank 0...
  0%|          | 0/18 [00:00<?, ?it/s]100%|██████████| 18/18 [00:00<00:00, 348.49it/s]
2024-08-04:12:54:31,336 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_human_sexuality on rank 0...
  0%|          | 0/12 [00:00<?, ?it/s]100%|██████████| 12/12 [00:00<00:00, 633.37it/s]
2024-08-04:12:54:31,356 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_econometrics on rank 0...
  0%|          | 0/12 [00:00<?, ?it/s]100%|██████████| 12/12 [00:00<00:00, 524.96it/s]
2024-08-04:12:54:31,380 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_macroeconomics on rank 0...
  0%|          | 0/43 [00:00<?, ?it/s]100%|██████████| 43/43 [00:00<00:00, 622.47it/s]
2024-08-04:12:54:31,452 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_geography on rank 0...
  0%|          | 0/22 [00:00<?, ?it/s]100%|██████████| 22/22 [00:00<00:00, 623.84it/s]
2024-08-04:12:54:31,488 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_security_studies on rank 0...
  0%|          | 0/27 [00:00<?, ?it/s]100%|██████████| 27/27 [00:00<00:00, 511.47it/s]
2024-08-04:12:54:31,543 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_psychology on rank 0...
  0%|          | 0/60 [00:00<?, ?it/s]100%|██████████| 60/60 [00:00<00:00, 596.84it/s]100%|██████████| 60/60 [00:00<00:00, 596.14it/s]
2024-08-04:12:54:31,647 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_microeconomics on rank 0...
  0%|          | 0/26 [00:00<?, ?it/s]100%|██████████| 26/26 [00:00<00:00, 618.80it/s]
2024-08-04:12:54:31,690 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_government_and_politics on rank 0...
  0%|          | 0/21 [00:00<?, ?it/s]100%|██████████| 21/21 [00:00<00:00, 609.57it/s]
2024-08-04:12:54:31,726 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_professional_psychology on rank 0...
  0%|          | 0/69 [00:00<?, ?it/s] 81%|████████  | 56/69 [00:00<00:00, 556.16it/s]100%|██████████| 69/69 [00:00<00:00, 557.24it/s]
2024-08-04:12:54:31,854 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_public_relations on rank 0...
  0%|          | 0/12 [00:00<?, ?it/s]100%|██████████| 12/12 [00:00<00:00, 621.30it/s]
2024-08-04:12:54:31,874 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_us_foreign_policy on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 613.81it/s]
2024-08-04:12:54:31,893 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_sociology on rank 0...
  0%|          | 0/22 [00:00<?, ?it/s]100%|██████████| 22/22 [00:00<00:00, 611.63it/s]
2024-08-04:12:54:31,930 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_global_facts on rank 0...
  0%|          | 0/10 [00:00<?, ?it/s]100%|██████████| 10/10 [00:00<00:00, 611.55it/s]
2024-08-04:12:54:31,947 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_professional_medicine on rank 0...
  0%|          | 0/31 [00:00<?, ?it/s]100%|██████████| 31/31 [00:00<00:00, 537.74it/s]
2024-08-04:12:54:32,008 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_business_ethics on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 542.32it/s]
2024-08-04:12:54:32,029 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_medicine on rank 0...
  0%|          | 0/22 [00:00<?, ?it/s]100%|██████████| 22/22 [00:00<00:00, 552.20it/s]
2024-08-04:12:54:32,070 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_management on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 630.86it/s]
2024-08-04:12:54:32,088 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_human_aging on rank 0...
  0%|          | 0/23 [00:00<?, ?it/s]100%|██████████| 23/23 [00:00<00:00, 653.94it/s]
2024-08-04:12:54:32,124 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_marketing on rank 0...
  0%|          | 0/25 [00:00<?, ?it/s]100%|██████████| 25/25 [00:00<00:00, 599.40it/s]
2024-08-04:12:54:32,168 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_nutrition on rank 0...
  0%|          | 0/33 [00:00<?, ?it/s]100%|██████████| 33/33 [00:00<00:00, 599.13it/s]
2024-08-04:12:54:32,225 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_virology on rank 0...
  0%|          | 0/18 [00:00<?, ?it/s]100%|██████████| 18/18 [00:00<00:00, 641.11it/s]
2024-08-04:12:54:32,254 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_professional_accounting on rank 0...
  0%|          | 0/31 [00:00<?, ?it/s]100%|██████████| 31/31 [00:00<00:00, 568.46it/s]
2024-08-04:12:54:32,310 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_miscellaneous on rank 0...
  0%|          | 0/86 [00:00<?, ?it/s] 77%|███████▋  | 66/86 [00:00<00:00, 654.10it/s]100%|██████████| 86/86 [00:00<00:00, 650.01it/s]
2024-08-04:12:54:32,446 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_medical_genetics on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 613.28it/s]
2024-08-04:12:54:32,465 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_clinical_knowledge on rank 0...
  0%|          | 0/29 [00:00<?, ?it/s]100%|██████████| 29/29 [00:00<00:00, 563.01it/s]
2024-08-04:12:54:32,519 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_mathematics on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 483.86it/s]
2024-08-04:12:54:32,543 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_elementary_mathematics on rank 0...
  0%|          | 0/41 [00:00<?, ?it/s]100%|██████████| 41/41 [00:00<00:00, 559.87it/s]
2024-08-04:12:54:32,619 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_statistics on rank 0...
  0%|          | 0/23 [00:00<?, ?it/s]100%|██████████| 23/23 [00:00<00:00, 534.00it/s]
2024-08-04:12:54:32,664 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_astronomy on rank 0...
  0%|          | 0/16 [00:00<?, ?it/s]100%|██████████| 16/16 [00:00<00:00, 546.01it/s]
2024-08-04:12:54:32,694 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_electrical_engineering on rank 0...
  0%|          | 0/16 [00:00<?, ?it/s]100%|██████████| 16/16 [00:00<00:00, 602.75it/s]
2024-08-04:12:54:32,722 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_abstract_algebra on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 612.90it/s]
2024-08-04:12:54:32,741 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_machine_learning on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 533.60it/s]
2024-08-04:12:54:32,762 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_computer_science on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 515.43it/s]
2024-08-04:12:54:32,784 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_biology on rank 0...
  0%|          | 0/32 [00:00<?, ?it/s]100%|██████████| 32/32 [00:00<00:00, 545.69it/s]
2024-08-04:12:54:32,845 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_anatomy on rank 0...
  0%|          | 0/14 [00:00<?, ?it/s]100%|██████████| 14/14 [00:00<00:00, 534.30it/s]
2024-08-04:12:54:32,872 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_physics on rank 0...
  0%|          | 0/17 [00:00<?, ?it/s]100%|██████████| 17/17 [00:00<00:00, 590.29it/s]
2024-08-04:12:54:32,902 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_computer_science on rank 0...
  0%|          | 0/9 [00:00<?, ?it/s]100%|██████████| 9/9 [00:00<00:00, 503.34it/s]
2024-08-04:12:54:32,921 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_conceptual_physics on rank 0...
  0%|          | 0/26 [00:00<?, ?it/s]100%|██████████| 26/26 [00:00<00:00, 611.83it/s]
2024-08-04:12:54:32,965 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_mathematics on rank 0...
  0%|          | 0/29 [00:00<?, ?it/s]100%|██████████| 29/29 [00:00<00:00, 597.33it/s]
2024-08-04:12:54:33,015 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_computer_security on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 603.65it/s]
2024-08-04:12:54:33,034 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_chemistry on rank 0...
  0%|          | 0/22 [00:00<?, ?it/s]100%|██████████| 22/22 [00:00<00:00, 584.98it/s]
2024-08-04:12:54:33,073 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_physics on rank 0...
  0%|          | 0/11 [00:00<?, ?it/s]100%|██████████| 11/11 [00:00<00:00, 596.23it/s]
2024-08-04:12:54:33,092 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_chemistry on rank 0...
  0%|          | 0/8 [00:00<?, ?it/s]100%|██████████| 8/8 [00:00<00:00, 593.37it/s]
2024-08-04:12:54:33,106 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_biology on rank 0...
  0%|          | 0/16 [00:00<?, ?it/s]100%|██████████| 16/16 [00:00<00:00, 498.92it/s]
2024-08-04:12:54:33,139 INFO     [xevaluator.py:395] Running generate_until requests
Running generate_until requests:   0%|          | 0/1531 [00:00<?, ?it/s]Running generate_until requests:   0%|          | 1/1531 [00:48<20:34:15, 48.40s/it]Running generate_until requests:   0%|          | 2/1531 [01:31<19:16:15, 45.37s/it]Running generate_until requests:   0%|          | 3/1531 [01:41<12:26:32, 29.31s/it]Running generate_until requests:   0%|          | 4/1531 [02:26<14:57:19, 35.26s/it]Running generate_until requests:   0%|          | 5/1531 [03:13<16:45:20, 39.53s/it]Running generate_until requests:   0%|          | 6/1531 [03:58<17:35:29, 41.53s/it]Running generate_until requests:   0%|          | 7/1531 [04:43<18:04:58, 42.72s/it]Running generate_until requests:   1%|          | 8/1531 [05:29<18:25:28, 43.55s/it]Running generate_until requests:   1%|          | 9/1531 [06:14<18:37:33, 44.06s/it]Running generate_until requests:   1%|          | 10/1531 [07:00<18:49:12, 44.54s/it]Running generate_until requests:   1%|          | 11/1531 [07:46<19:04:43, 45.19s/it]Running generate_until requests:   1%|          | 12/1531 [08:33<19:16:24, 45.68s/it]Running generate_until requests:   1%|          | 13/1531 [09:23<19:51:06, 47.08s/it]Running generate_until requests:   1%|          | 14/1531 [10:12<20:01:14, 47.51s/it]Running generate_until requests:   1%|          | 15/1531 [11:00<20:06:20, 47.74s/it]Running generate_until requests:   1%|          | 16/1531 [11:48<20:07:19, 47.81s/it]Running generate_until requests:   1%|          | 17/1531 [12:36<20:04:59, 47.75s/it]Running generate_until requests:   1%|          | 18/1531 [13:23<19:59:13, 47.56s/it]Running generate_until requests:   1%|          | 19/1531 [14:10<19:56:02, 47.46s/it]Running generate_until requests:   1%|▏         | 20/1531 [14:57<19:53:27, 47.39s/it]Running generate_until requests:   1%|▏         | 21/1531 [15:44<19:51:22, 47.34s/it]Running generate_until requests:   1%|▏         | 22/1531 [16:32<19:52:45, 47.43s/it]Running generate_until requests:   2%|▏         | 23/1531 [17:19<19:50:48, 47.38s/it]Running generate_until requests:   2%|▏         | 24/1531 [18:06<19:45:14, 47.19s/it]Running generate_until requests:   2%|▏         | 25/1531 [18:53<19:42:11, 47.10s/it]Running generate_until requests:   2%|▏         | 26/1531 [19:44<20:07:22, 48.13s/it]Running generate_until requests:   2%|▏         | 27/1531 [20:32<20:10:53, 48.31s/it]Running generate_until requests:   2%|▏         | 28/1531 [21:20<20:04:48, 48.10s/it]Running generate_until requests:   2%|▏         | 29/1531 [22:08<20:04:41, 48.12s/it]Running generate_until requests:   2%|▏         | 30/1531 [22:55<19:54:58, 47.77s/it]Running generate_until requests:   2%|▏         | 31/1531 [23:45<20:10:40, 48.43s/it]Running generate_until requests:   2%|▏         | 32/1531 [24:35<20:20:19, 48.85s/it]Running generate_until requests:   2%|▏         | 33/1531 [25:23<20:17:15, 48.76s/it]