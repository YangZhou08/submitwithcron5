Already on 'addinggriffin'
wandb: Currently logged in as: stevenzhou0816100. Use `wandb login --relogin` to force relogin
The following values were not passed to `accelerate launch` and had defaults used instead:
		More than one GPU was found, enabling multi-GPU training.
		If this was unintended please pass in `--num_processes=1`.
	`--mixed_precision` was set to a value of `'no'`
	`--dynamo_backend` was set to a value of `'no'`
To avoid this warning pass in values for each of the problematic parameters or run `accelerate config`.
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:51<01:42, 51.04s/it]Loading checkpoint shards:  33%|███▎      | 1/3 [00:52<01:44, 52.46s/it]Loading checkpoint shards:  33%|███▎      | 1/3 [00:52<01:44, 52.46s/it]Loading checkpoint shards:  33%|███▎      | 1/3 [00:53<01:46, 53.22s/it]Loading checkpoint shards:  33%|███▎      | 1/3 [00:52<01:45, 52.69s/it]Loading checkpoint shards:  33%|███▎      | 1/3 [00:52<01:44, 52.39s/it]Loading checkpoint shards:  33%|███▎      | 1/3 [00:52<01:44, 52.44s/it]Loading checkpoint shards:  33%|███▎      | 1/3 [00:52<01:45, 52.84s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [01:50<00:55, 55.74s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [01:51<00:56, 56.51s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [01:52<00:56, 56.86s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [01:51<00:56, 56.54s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [01:52<00:56, 56.64s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [01:51<00:56, 56.53s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [01:51<00:56, 56.55s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [01:51<00:56, 56.55s/it]Loading checkpoint shards: 100%|██████████| 3/3 [02:23<00:00, 45.40s/it]Loading checkpoint shards: 100%|██████████| 3/3 [02:23<00:00, 47.99s/it]
Loading checkpoint shards: 100%|██████████| 3/3 [02:26<00:00, 46.33s/it]Loading checkpoint shards: 100%|██████████| 3/3 [02:26<00:00, 48.81s/it]
Loading checkpoint shards: 100%|██████████| 3/3 [02:25<00:00, 46.16s/it]Loading checkpoint shards: 100%|██████████| 3/3 [02:25<00:00, 48.56s/it]
Loading checkpoint shards: 100%|██████████| 3/3 [02:25<00:00, 46.22s/it]Loading checkpoint shards: 100%|██████████| 3/3 [02:25<00:00, 48.64s/it]
Loading checkpoint shards: 100%|██████████| 3/3 [02:25<00:00, 46.17s/it]Loading checkpoint shards: 100%|██████████| 3/3 [02:25<00:00, 48.56s/it]
Loading checkpoint shards: 100%|██████████| 3/3 [02:25<00:00, 46.17s/it]Loading checkpoint shards: 100%|██████████| 3/3 [02:25<00:00, 48.56s/it]
Loading checkpoint shards: 100%|██████████| 3/3 [02:25<00:00, 46.15s/it]Loading checkpoint shards: 100%|██████████| 3/3 [02:25<00:00, 48.59s/it]
Loading checkpoint shards: 100%|██████████| 3/3 [02:25<00:00, 46.58s/it]Loading checkpoint shards: 100%|██████████| 3/3 [02:25<00:00, 48.58s/it]
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:397: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:397: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]  0%|          | 0/32 [00:00<?, ?it/s]/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:397: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:397: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:397: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:397: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:397: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
/opt/hpcaas/.mounts/fs-03efe25c053395d1f/beidic/yang/CommonSenseReasoning/main.py:397: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  promptids = torch.tensor(promptids, dtype = torch.long).to(args.device)
  0%|          | 0/32 [00:00<?, ?it/s]/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/fsx-storygen/beidic/anaconda3/envs/griffin/lib/python3.9/site-packages/transformers/generation/configuration_utils.py:415: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
  3%|▎         | 1/32 [00:04<02:31,  4.87s/it]  3%|▎         | 1/32 [00:06<03:29,  6.76s/it]  3%|▎         | 1/32 [00:06<03:14,  6.27s/it]  6%|▋         | 2/32 [00:07<01:48,  3.62s/it]  3%|▎         | 1/32 [00:09<04:46,  9.24s/it]  6%|▋         | 2/32 [00:09<02:07,  4.23s/it]  9%|▉         | 3/32 [00:12<01:55,  3.98s/it]  6%|▋         | 2/32 [00:12<03:10,  6.33s/it]  9%|▉         | 3/32 [00:15<02:26,  5.05s/it]  3%|▎         | 1/32 [00:15<08:13, 15.93s/it]  3%|▎         | 1/32 [00:16<08:17, 16.04s/it]  6%|▋         | 2/32 [00:16<04:04,  8.14s/it] 12%|█▎        | 4/32 [00:17<02:05,  4.47s/it]  3%|▎         | 1/32 [00:18<09:40, 18.73s/it]  9%|▉         | 3/32 [00:19<03:10,  6.56s/it] 16%|█▌        | 5/32 [00:19<01:43,  3.83s/it]  6%|▋         | 2/32 [00:21<04:50,  9.67s/it] 12%|█▎        | 4/32 [00:21<02:41,  5.75s/it] 19%|█▉        | 6/32 [00:23<01:37,  3.74s/it]  6%|▋         | 2/32 [00:24<05:28, 10.94s/it]  9%|▉         | 3/32 [00:24<03:19,  6.87s/it]  3%|▎         | 1/32 [00:26<13:34, 26.28s/it]  9%|▉         | 3/32 [00:27<03:36,  7.47s/it]  6%|▋         | 2/32 [00:29<06:18, 12.61s/it]  6%|▋         | 2/32 [00:30<07:41, 15.38s/it] 16%|█▌        | 5/32 [00:32<03:18,  7.34s/it] 12%|█▎        | 4/32 [00:33<04:28,  9.60s/it] 16%|█▌        | 5/32 [00:36<03:11,  7.10s/it] 22%|██▏       | 7/32 [00:37<03:01,  7.25s/it] 12%|█▎        | 4/32 [00:38<04:26,  9.53s/it]  9%|▉         | 3/32 [00:39<07:13, 14.96s/it] 16%|█▌        | 5/32 [00:41<03:19,  7.38s/it]  9%|▉         | 3/32 [00:46<07:23, 15.28s/it] 12%|█▎        | 4/32 [00:46<05:39, 12.13s/it] 19%|█▉        | 6/32 [00:48<03:00,  6.93s/it] 12%|█▎        | 4/32 [00:48<05:50, 12.53s/it] 19%|█▉        | 6/32 [00:48<04:28, 10.32s/it] 22%|██▏       | 7/32 [00:50<02:18,  5.55s/it] 25%|██▌       | 8/32 [00:51<03:42,  9.29s/it] 16%|█▌        | 5/32 [00:53<04:32, 10.11s/it] 19%|█▉        | 6/32 [00:53<04:30, 10.42s/it] 12%|█▎        | 4/32 [00:53<05:42, 12.24s/it]  9%|▉         | 3/32 [00:53<08:41, 18.00s/it] 22%|██▏       | 7/32 [00:53<03:36,  8.64s/it] 25%|██▌       | 8/32 [00:56<02:41,  6.74s/it] 19%|█▉        | 6/32 [00:56<03:23,  7.81s/it] 22%|██▏       | 7/32 [00:56<03:23,  8.16s/it] 25%|██▌       | 8/32 [00:57<02:23,  5.98s/it] 28%|██▊       | 9/32 [01:00<03:28,  9.07s/it] 22%|██▏       | 7/32 [01:01<02:47,  6.71s/it] 25%|██▌       | 8/32 [01:03<03:05,  7.74s/it] 28%|██▊       | 9/32 [01:03<02:42,  7.05s/it] 31%|███▏      | 10/32 [01:04<02:47,  7.62s/it] 31%|███▏      | 10/32 [01:05<01:59,  5.44s/it] 16%|█▌        | 5/32 [01:07<05:42, 12.67s/it] 28%|██▊       | 9/32 [01:07<02:42,  7.08s/it] 34%|███▍      | 11/32 [01:08<02:14,  6.41s/it] 34%|███▍      | 11/32 [01:08<01:36,  4.62s/it] 28%|██▊       | 9/32 [01:09<02:46,  7.23s/it] 19%|█▉        | 6/32 [01:11<04:15,  9.84s/it]