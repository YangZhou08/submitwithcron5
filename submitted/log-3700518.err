Already on 'yangexppp'
wandb: Currently logged in as: stevenzhou0816100. Use `wandb login --relogin` to force relogin
2024-08-06:13:25:06,440 INFO     [main.py:288] Verbosity set to INFO
2024-08-06:13:25:16,011 WARNING  [main.py:303]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2024-08-06:13:25:16,012 INFO     [main.py:378] Selected Tasks: ['mmlu_flan_cot_fewshot']
2024-08-06:13:25:16,046 INFO     [xevaluator.py:137] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2024-08-06:13:25:16,046 INFO     [xevaluator.py:184] Initializing xhf model, with arguments: {'pretrained': 'meta-llama/Meta-Llama-3-8B-Instruct', 'cats': True, 'check': False, 'contextlength': 1500, 'kernel_size': 16, 'thr': 0.05}
2024-08-06:13:25:16,056 INFO     [xhuggingface.py:177] Using device 'cuda'
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:06<00:18,  6.29s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:12<00:12,  6.20s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:18<00:06,  6.12s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:20<00:00,  4.64s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:20<00:00,  5.21s/it]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
2024-08-06:13:26:42,006 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_prehistory on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 599.59it/s]
2024-08-06:13:26:42,018 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_logical_fallacies on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 594.75it/s]
2024-08-06:13:26:42,025 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_us_history on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 390.49it/s]
2024-08-06:13:26:42,037 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_international_law on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 578.82it/s]
2024-08-06:13:26:42,044 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_professional_law on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 472.84it/s]
2024-08-06:13:26:42,054 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_moral_disputes on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 581.84it/s]
2024-08-06:13:26:42,062 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_jurisprudence on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 600.32it/s]
2024-08-06:13:26:42,069 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_world_history on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 483.47it/s]
2024-08-06:13:26:42,078 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_moral_scenarios on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 604.61it/s]
2024-08-06:13:26:42,085 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_philosophy on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 566.09it/s]
2024-08-06:13:26:42,093 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_formal_logic on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 535.64it/s]
2024-08-06:13:26:42,101 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_world_religions on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 652.66it/s]
2024-08-06:13:26:42,108 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_european_history on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 346.16it/s]
2024-08-06:13:26:42,121 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_human_sexuality on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 633.87it/s]
2024-08-06:13:26:42,128 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_econometrics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 524.34it/s]
2024-08-06:13:26:42,136 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_macroeconomics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 616.81it/s]
2024-08-06:13:26:42,144 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_geography on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 626.11it/s]
2024-08-06:13:26:42,151 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_security_studies on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 511.02it/s]
2024-08-06:13:26:42,159 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_psychology on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 596.71it/s]
2024-08-06:13:26:42,167 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_microeconomics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 620.57it/s]
2024-08-06:13:26:42,174 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_government_and_politics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 601.10it/s]
2024-08-06:13:26:42,181 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_professional_psychology on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 567.37it/s]
2024-08-06:13:26:42,188 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_public_relations on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 622.60it/s]
2024-08-06:13:26:42,195 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_us_foreign_policy on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 615.79it/s]
2024-08-06:13:26:42,202 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_sociology on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 606.62it/s]
2024-08-06:13:26:42,210 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_global_facts on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 601.12it/s]
2024-08-06:13:26:42,217 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_professional_medicine on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 540.71it/s]
2024-08-06:13:26:42,225 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_business_ethics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 540.07it/s]
2024-08-06:13:26:42,233 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_medicine on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 549.82it/s]
2024-08-06:13:26:42,241 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_management on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 638.77it/s]
2024-08-06:13:26:42,248 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_human_aging on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 636.10it/s]
2024-08-06:13:26:42,255 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_marketing on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 619.15it/s]
2024-08-06:13:26:42,262 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_nutrition on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 595.19it/s]
2024-08-06:13:26:42,269 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_virology on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 644.01it/s]
2024-08-06:13:26:42,276 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_professional_accounting on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 572.58it/s]
2024-08-06:13:26:42,283 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_miscellaneous on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 642.19it/s]
2024-08-06:13:26:42,290 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_medical_genetics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 624.69it/s]
2024-08-06:13:26:42,297 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_clinical_knowledge on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 632.58it/s]
2024-08-06:13:26:42,304 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_mathematics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 561.45it/s]
2024-08-06:13:26:42,312 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_elementary_mathematics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 609.08it/s]
2024-08-06:13:26:42,319 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_statistics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 561.64it/s]
2024-08-06:13:26:42,326 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_astronomy on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 550.81it/s]
2024-08-06:13:26:42,334 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_electrical_engineering on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 606.18it/s]
2024-08-06:13:26:42,341 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_abstract_algebra on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 612.53it/s]
2024-08-06:13:26:42,348 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_machine_learning on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 532.97it/s]
2024-08-06:13:26:42,356 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_computer_science on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 508.51it/s]
2024-08-06:13:26:42,365 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_biology on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 551.30it/s]
2024-08-06:13:26:42,373 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_anatomy on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 539.48it/s]
2024-08-06:13:26:42,381 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_physics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 589.83it/s]
2024-08-06:13:26:42,389 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_computer_science on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 504.24it/s]
2024-08-06:13:26:42,397 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_conceptual_physics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 603.24it/s]
2024-08-06:13:26:42,404 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_mathematics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 605.26it/s]
2024-08-06:13:26:42,411 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_computer_security on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 607.19it/s]
2024-08-06:13:26:42,418 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_chemistry on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 589.58it/s]
2024-08-06:13:26:42,426 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_physics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 603.89it/s]
2024-08-06:13:26:42,433 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_chemistry on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 573.17it/s]
2024-08-06:13:26:42,441 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_biology on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 538.72it/s]
2024-08-06:13:26:42,448 INFO     [xevaluator.py:395] Running generate_until requests
Running generate_until requests:   0%|          | 0/228 [00:00<?, ?it/s]Running generate_until requests:   0%|          | 1/228 [00:54<3:27:14, 54.78s/it]Running generate_until requests:   1%|          | 2/228 [01:46<3:19:36, 52.99s/it]Running generate_until requests:   1%|▏         | 3/228 [01:59<2:10:38, 34.84s/it]Running generate_until requests:   2%|▏         | 4/228 [02:12<1:37:25, 26.09s/it]Running generate_until requests:   2%|▏         | 5/228 [02:31<1:28:08, 23.72s/it]Running generate_until requests:   3%|▎         | 6/228 [02:41<1:10:23, 19.02s/it]Running generate_until requests:   3%|▎         | 7/228 [03:33<1:49:44, 29.80s/it]Running generate_until requests:   4%|▎         | 8/228 [04:25<2:15:13, 36.88s/it]Running generate_until requests:   4%|▍         | 9/228 [05:17<2:31:51, 41.60s/it]Running generate_until requests:   4%|▍         | 10/228 [06:09<2:42:27, 44.71s/it]Running generate_until requests:   5%|▍         | 11/228 [07:01<2:49:48, 46.95s/it]Running generate_until requests:   5%|▌         | 12/228 [07:52<2:53:48, 48.28s/it]Running generate_until requests:   6%|▌         | 13/228 [08:44<2:56:15, 49.19s/it]Running generate_until requests:   6%|▌         | 14/228 [09:35<2:58:15, 49.98s/it]Running generate_until requests:   7%|▋         | 15/228 [10:27<2:59:25, 50.54s/it]Running generate_until requests:   7%|▋         | 16/228 [11:19<2:59:52, 50.91s/it]Running generate_until requests:   7%|▋         | 17/228 [12:10<2:59:30, 51.04s/it]Running generate_until requests:   8%|▊         | 18/228 [13:03<2:59:57, 51.41s/it]Running generate_until requests:   8%|▊         | 19/228 [13:18<2:21:05, 40.51s/it]Running generate_until requests:   9%|▉         | 20/228 [14:11<2:33:33, 44.30s/it]Running generate_until requests:   9%|▉         | 21/228 [15:03<2:40:29, 46.52s/it]Running generate_until requests:  10%|▉         | 22/228 [15:12<2:00:54, 35.22s/it]Running generate_until requests:  10%|█         | 23/228 [16:04<2:17:35, 40.27s/it]Running generate_until requests:  11%|█         | 24/228 [16:55<2:28:46, 43.76s/it]Running generate_until requests:  11%|█         | 25/228 [17:47<2:36:17, 46.20s/it]Running generate_until requests:  11%|█▏        | 26/228 [18:38<2:40:31, 47.68s/it]Running generate_until requests:  12%|█▏        | 27/228 [19:30<2:43:31, 48.81s/it]Running generate_until requests:  12%|█▏        | 28/228 [20:21<2:45:21, 49.61s/it]Running generate_until requests:  13%|█▎        | 29/228 [21:13<2:46:09, 50.10s/it]Running generate_until requests:  13%|█▎        | 30/228 [22:03<2:45:57, 50.29s/it]Running generate_until requests:  14%|█▎        | 31/228 [22:55<2:46:01, 50.57s/it]Running generate_until requests:  14%|█▍        | 32/228 [23:46<2:45:34, 50.69s/it]Running generate_until requests:  14%|█▍        | 33/228 [24:37<2:45:31, 50.93s/it]Running generate_until requests:  15%|█▍        | 34/228 [25:28<2:44:51, 50.99s/it]Running generate_until requests:  15%|█▌        | 35/228 [26:19<2:44:10, 51.04s/it]Running generate_until requests:  16%|█▌        | 36/228 [27:10<2:43:23, 51.06s/it]Running generate_until requests:  16%|█▌        | 37/228 [28:02<2:42:50, 51.15s/it]Running generate_until requests:  17%|█▋        | 38/228 [28:53<2:42:28, 51.31s/it]Running generate_until requests:  17%|█▋        | 39/228 [29:46<2:42:38, 51.63s/it]Running generate_until requests:  18%|█▊        | 40/228 [30:38<2:42:05, 51.73s/it]Running generate_until requests:  18%|█▊        | 41/228 [31:30<2:41:28, 51.81s/it]Running generate_until requests:  18%|█▊        | 42/228 [32:22<2:40:31, 51.78s/it]Running generate_until requests:  19%|█▉        | 43/228 [33:14<2:39:55, 51.87s/it]Running generate_until requests:  19%|█▉        | 44/228 [34:06<2:39:19, 51.95s/it]Running generate_until requests:  20%|█▉        | 45/228 [34:58<2:38:22, 51.93s/it]Running generate_until requests:  20%|██        | 46/228 [35:17<2:07:41, 42.10s/it]Running generate_until requests:  21%|██        | 47/228 [36:09<2:15:50, 45.03s/it]Running generate_until requests:  21%|██        | 48/228 [37:00<2:21:07, 47.04s/it]Running generate_until requests:  21%|██▏       | 49/228 [37:52<2:24:17, 48.37s/it]Running generate_until requests:  22%|██▏       | 50/228 [38:43<2:26:23, 49.35s/it]Running generate_until requests:  22%|██▏       | 51/228 [39:35<2:27:49, 50.11s/it]Running generate_until requests:  23%|██▎       | 52/228 [40:27<2:28:31, 50.63s/it]Running generate_until requests:  23%|██▎       | 53/228 [41:19<2:28:47, 51.01s/it]Running generate_until requests:  24%|██▎       | 54/228 [42:12<2:29:08, 51.43s/it]Running generate_until requests:  24%|██▍       | 55/228 [43:03<2:28:31, 51.51s/it]Running generate_until requests:  25%|██▍       | 56/228 [43:58<2:30:52, 52.63s/it]Running generate_until requests:  25%|██▌       | 57/228 [44:51<2:30:06, 52.67s/it]Running generate_until requests:  25%|██▌       | 58/228 [45:43<2:28:39, 52.47s/it]Running generate_until requests:  26%|██▌       | 59/228 [46:35<2:27:24, 52.34s/it]Running generate_until requests:  26%|██▋       | 60/228 [47:27<2:26:06, 52.18s/it]Running generate_until requests:  27%|██▋       | 61/228 [48:19<2:24:43, 52.00s/it]