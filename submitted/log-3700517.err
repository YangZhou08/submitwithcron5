Already on 'yangexppp'
wandb: Currently logged in as: stevenzhou0816100. Use `wandb login --relogin` to force relogin
2024-08-06:13:25:00,913 INFO     [main.py:288] Verbosity set to INFO
2024-08-06:13:25:10,541 WARNING  [main.py:303]  --limit SHOULD ONLY BE USED FOR TESTING.REAL METRICS SHOULD NOT BE COMPUTED USING LIMIT.
2024-08-06:13:25:10,543 INFO     [main.py:378] Selected Tasks: ['mmlu_flan_cot_fewshot']
2024-08-06:13:25:10,578 INFO     [xevaluator.py:137] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2024-08-06:13:25:10,578 INFO     [xevaluator.py:184] Initializing xhf model, with arguments: {'pretrained': 'meta-llama/Meta-Llama-3-70B-Instruct', 'griffin': True, 'check': False, 'contextlength': 1500, 'kernel_size': 16, 'thr': 0.05}
2024-08-06:13:25:10,588 INFO     [xhuggingface.py:177] Using device 'cuda'
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:05<02:47,  5.78s/it]Loading checkpoint shards:   7%|▋         | 2/30 [00:11<02:40,  5.72s/it]Loading checkpoint shards:  10%|█         | 3/30 [00:17<02:38,  5.88s/it]Loading checkpoint shards:  13%|█▎        | 4/30 [00:23<02:33,  5.91s/it]Loading checkpoint shards:  17%|█▋        | 5/30 [00:30<02:35,  6.22s/it]Loading checkpoint shards:  20%|██        | 6/30 [00:36<02:26,  6.09s/it]Loading checkpoint shards:  23%|██▎       | 7/30 [00:41<02:14,  5.87s/it]Loading checkpoint shards:  27%|██▋       | 8/30 [00:47<02:10,  5.94s/it]Loading checkpoint shards:  30%|███       | 9/30 [00:53<02:03,  5.88s/it]Loading checkpoint shards:  33%|███▎      | 10/30 [00:58<01:55,  5.76s/it]Loading checkpoint shards:  37%|███▋      | 11/30 [01:04<01:48,  5.73s/it]Loading checkpoint shards:  40%|████      | 12/30 [01:10<01:43,  5.77s/it]Loading checkpoint shards:  43%|████▎     | 13/30 [01:16<01:39,  5.86s/it]Loading checkpoint shards:  47%|████▋     | 14/30 [01:22<01:33,  5.87s/it]Loading checkpoint shards:  50%|█████     | 15/30 [01:28<01:28,  5.88s/it]Loading checkpoint shards:  53%|█████▎    | 16/30 [01:33<01:20,  5.78s/it]Loading checkpoint shards:  57%|█████▋    | 17/30 [01:40<01:17,  5.94s/it]Loading checkpoint shards:  60%|██████    | 18/30 [01:45<01:10,  5.87s/it]Loading checkpoint shards:  63%|██████▎   | 19/30 [01:51<01:04,  5.83s/it]Loading checkpoint shards:  67%|██████▋   | 20/30 [01:57<00:57,  5.76s/it]Loading checkpoint shards:  70%|███████   | 21/30 [02:04<00:55,  6.12s/it]Loading checkpoint shards:  73%|███████▎  | 22/30 [02:09<00:48,  6.02s/it]Loading checkpoint shards:  77%|███████▋  | 23/30 [02:15<00:41,  5.96s/it]Loading checkpoint shards:  80%|████████  | 24/30 [02:22<00:36,  6.05s/it]Loading checkpoint shards:  83%|████████▎ | 25/30 [02:27<00:29,  5.94s/it]Loading checkpoint shards:  87%|████████▋ | 26/30 [02:34<00:24,  6.18s/it]Loading checkpoint shards:  90%|█████████ | 27/30 [02:40<00:18,  6.14s/it]Loading checkpoint shards:  93%|█████████▎| 28/30 [02:46<00:12,  6.08s/it]Loading checkpoint shards:  97%|█████████▋| 29/30 [02:53<00:06,  6.48s/it]Loading checkpoint shards: 100%|██████████| 30/30 [02:56<00:00,  5.36s/it]Loading checkpoint shards: 100%|██████████| 30/30 [02:56<00:00,  5.88s/it]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
2024-08-06:13:35:10,125 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_prehistory on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 597.59it/s]
2024-08-06:13:35:10,143 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_logical_fallacies on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 576.24it/s]
2024-08-06:13:35:10,151 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_us_history on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 384.08it/s]
2024-08-06:13:35:10,162 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_international_law on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 580.47it/s]
2024-08-06:13:35:10,170 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_professional_law on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 475.17it/s]
2024-08-06:13:35:10,180 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_moral_disputes on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 582.26it/s]
2024-08-06:13:35:10,187 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_jurisprudence on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 605.92it/s]
2024-08-06:13:35:10,194 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_world_history on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 481.84it/s]
2024-08-06:13:35:10,204 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_moral_scenarios on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 602.13it/s]
2024-08-06:13:35:10,211 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_philosophy on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 622.99it/s]
2024-08-06:13:35:10,218 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_formal_logic on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 539.44it/s]
2024-08-06:13:35:10,226 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_world_religions on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 656.44it/s]
2024-08-06:13:35:10,233 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_european_history on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 349.52it/s]
2024-08-06:13:35:10,246 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_human_sexuality on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 632.17it/s]
2024-08-06:13:35:10,253 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_econometrics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 524.55it/s]
2024-08-06:13:35:10,261 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_macroeconomics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 610.57it/s]
2024-08-06:13:35:10,268 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_geography on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 620.39it/s]
2024-08-06:13:35:10,275 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_security_studies on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 510.21it/s]
2024-08-06:13:35:10,284 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_psychology on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 592.83it/s]
2024-08-06:13:35:10,292 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_microeconomics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 615.50it/s]
2024-08-06:13:35:10,299 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_government_and_politics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 600.60it/s]
2024-08-06:13:35:10,306 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_professional_psychology on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 565.96it/s]
2024-08-06:13:35:10,313 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_public_relations on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 614.89it/s]
2024-08-06:13:35:10,320 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_us_foreign_policy on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 611.84it/s]
2024-08-06:13:35:10,328 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_sociology on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 605.59it/s]
2024-08-06:13:35:10,335 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_global_facts on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 604.76it/s]
2024-08-06:13:35:10,342 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_professional_medicine on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 542.88it/s]
2024-08-06:13:35:10,350 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_business_ethics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 545.69it/s]
2024-08-06:13:35:10,358 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_medicine on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 552.50it/s]
2024-08-06:13:35:10,366 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_management on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 637.46it/s]
2024-08-06:13:35:10,373 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_human_aging on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 636.37it/s]
2024-08-06:13:35:10,380 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_marketing on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 615.88it/s]
2024-08-06:13:35:10,387 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_nutrition on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 595.95it/s]
2024-08-06:13:35:10,394 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_virology on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 601.40it/s]
2024-08-06:13:35:10,401 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_professional_accounting on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 568.24it/s]
2024-08-06:13:35:10,409 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_miscellaneous on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 635.93it/s]
2024-08-06:13:35:10,416 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_medical_genetics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 624.29it/s]
2024-08-06:13:35:10,423 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_clinical_knowledge on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 633.77it/s]
2024-08-06:13:35:10,430 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_mathematics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 561.17it/s]
2024-08-06:13:35:10,437 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_elementary_mathematics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 604.76it/s]
2024-08-06:13:35:10,444 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_statistics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 560.98it/s]
2024-08-06:13:35:10,452 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_astronomy on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 547.56it/s]
2024-08-06:13:35:10,460 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_electrical_engineering on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 564.93it/s]
2024-08-06:13:35:10,468 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_abstract_algebra on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 611.06it/s]
2024-08-06:13:35:10,475 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_machine_learning on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 534.80it/s]
2024-08-06:13:35:10,483 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_computer_science on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 509.78it/s]
2024-08-06:13:35:10,491 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_biology on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 548.60it/s]
2024-08-06:13:35:10,499 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_anatomy on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 539.84it/s]
2024-08-06:13:35:10,507 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_physics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 562.50it/s]
2024-08-06:13:35:10,515 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_computer_science on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 504.29it/s]
2024-08-06:13:35:10,523 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_conceptual_physics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 599.68it/s]
2024-08-06:13:35:10,531 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_mathematics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 605.04it/s]
2024-08-06:13:35:10,538 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_computer_security on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 602.02it/s]
2024-08-06:13:35:10,545 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_high_school_chemistry on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 585.16it/s]
2024-08-06:13:35:10,552 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_physics on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 602.74it/s]
2024-08-06:13:35:10,560 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_chemistry on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 586.47it/s]
2024-08-06:13:35:10,567 INFO     [task.py:395] Building contexts for mmlu_flan_cot_fewshot_college_biology on rank 0...
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 539.25it/s]
2024-08-06:13:35:10,575 INFO     [xevaluator.py:395] Running generate_until requests
Running generate_until requests:   0%|          | 0/228 [00:00<?, ?it/s]Running generate_until requests:   0%|          | 1/228 [01:19<5:02:23, 79.93s/it]Running generate_until requests:   1%|          | 2/228 [01:51<3:14:45, 51.71s/it]Running generate_until requests:   1%|▏         | 3/228 [03:08<3:56:50, 63.16s/it]Running generate_until requests:   2%|▏         | 4/228 [04:25<4:15:29, 68.44s/it]Running generate_until requests:   2%|▏         | 5/228 [05:39<4:22:51, 70.72s/it]Running generate_until requests:   3%|▎         | 6/228 [06:54<4:26:25, 72.01s/it]Running generate_until requests:   3%|▎         | 7/228 [08:08<4:28:02, 72.77s/it]Running generate_until requests:   4%|▎         | 8/228 [08:21<3:16:37, 53.63s/it]Running generate_until requests:   4%|▍         | 9/228 [09:34<3:38:23, 59.83s/it]Running generate_until requests:   4%|▍         | 10/228 [10:48<3:52:48, 64.07s/it]Running generate_until requests:   5%|▍         | 11/228 [12:01<4:01:52, 66.88s/it]Running generate_until requests:   5%|▌         | 12/228 [13:14<4:07:36, 68.78s/it]Running generate_until requests:   6%|▌         | 13/228 [14:27<4:10:55, 70.03s/it]Running generate_until requests:   6%|▌         | 14/228 [15:40<4:12:30, 70.80s/it]Running generate_until requests:   7%|▋         | 15/228 [16:53<4:13:33, 71.43s/it]Running generate_until requests:   7%|▋         | 16/228 [18:06<4:13:54, 71.86s/it]Running generate_until requests:   7%|▋         | 17/228 [19:18<4:13:37, 72.12s/it]